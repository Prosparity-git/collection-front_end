var y3=Object.defineProperty;var gy=e=>{throw TypeError(e)};var x3=(e,t,r)=>t in e?y3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ja=(e,t,r)=>x3(e,typeof t!="symbol"?t+"":t,r),jm=(e,t,r)=>t.has(e)||gy("Cannot "+r);var ue=(e,t,r)=>(jm(e,t,"read from private field"),r?r.call(e):t.get(e)),qe=(e,t,r)=>t.has(e)?gy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Le=(e,t,r,n)=>(jm(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Nr=(e,t,r)=>(jm(e,t,"access private method"),r);var kf=(e,t,r,n)=>({set _(a){Le(e,t,a,r)},get _(){return ue(e,t,n)}});function w3(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function t_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var r_={exports:{}},kh={},n_={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yu=Symbol.for("react.element"),_3=Symbol.for("react.portal"),S3=Symbol.for("react.fragment"),k3=Symbol.for("react.strict_mode"),b3=Symbol.for("react.profiler"),E3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),N3=Symbol.for("react.forward_ref"),C3=Symbol.for("react.suspense"),A3=Symbol.for("react.memo"),P3=Symbol.for("react.lazy"),vy=Symbol.iterator;function D3(e){return e===null||typeof e!="object"?null:(e=vy&&e[vy]||e["@@iterator"],typeof e=="function"?e:null)}var a_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},s_=Object.assign,i_={};function Ul(e,t,r){this.props=e,this.context=t,this.refs=i_,this.updater=r||a_}Ul.prototype.isReactComponent={};Ul.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ul.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function o_(){}o_.prototype=Ul.prototype;function Cg(e,t,r){this.props=e,this.context=t,this.refs=i_,this.updater=r||a_}var Ag=Cg.prototype=new o_;Ag.constructor=Cg;s_(Ag,Ul.prototype);Ag.isPureReactComponent=!0;var yy=Array.isArray,l_=Object.prototype.hasOwnProperty,Pg={current:null},c_={key:!0,ref:!0,__self:!0,__source:!0};function u_(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)l_.call(t,n)&&!c_.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Yu,type:e,key:s,ref:i,props:a,_owner:Pg.current}}function j3(e,t){return{$$typeof:Yu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Dg(e){return typeof e=="object"&&e!==null&&e.$$typeof===Yu}function R3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var xy=/\/+/g;function Rm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?R3(""+e.key):t.toString(36)}function cd(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Yu:case _3:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Rm(i,0):n,yy(a)?(r="",e!=null&&(r=e.replace(xy,"$&/")+"/"),cd(a,t,r,"",function(u){return u})):a!=null&&(Dg(a)&&(a=j3(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(xy,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",yy(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Rm(s,o);i+=cd(s,t,r,l,a)}else if(l=D3(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Rm(s,o++),i+=cd(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function bf(e,t,r){if(e==null)return e;var n=[],a=0;return cd(e,n,"","",function(s){return t.call(r,s,a++)}),n}function M3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var en={current:null},ud={transition:null},I3={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:ud,ReactCurrentOwner:Pg};function f_(){throw Error("act(...) is not supported in production builds of React.")}Ke.Children={map:bf,forEach:function(e,t,r){bf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return bf(e,function(){t++}),t},toArray:function(e){return bf(e,function(t){return t})||[]},only:function(e){if(!Dg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ke.Component=Ul;Ke.Fragment=S3;Ke.Profiler=b3;Ke.PureComponent=Cg;Ke.StrictMode=k3;Ke.Suspense=C3;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I3;Ke.act=f_;Ke.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=s_({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Pg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)l_.call(t,l)&&!c_.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Yu,type:e.type,key:a,ref:s,props:n,_owner:i}};Ke.createContext=function(e){return e={$$typeof:T3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:E3,_context:e},e.Consumer=e};Ke.createElement=u_;Ke.createFactory=function(e){var t=u_.bind(null,e);return t.type=e,t};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(e){return{$$typeof:N3,render:e}};Ke.isValidElement=Dg;Ke.lazy=function(e){return{$$typeof:P3,_payload:{_status:-1,_result:e},_init:M3}};Ke.memo=function(e,t){return{$$typeof:A3,type:e,compare:t===void 0?null:t}};Ke.startTransition=function(e){var t=ud.transition;ud.transition={};try{e()}finally{ud.transition=t}};Ke.unstable_act=f_;Ke.useCallback=function(e,t){return en.current.useCallback(e,t)};Ke.useContext=function(e){return en.current.useContext(e)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(e){return en.current.useDeferredValue(e)};Ke.useEffect=function(e,t){return en.current.useEffect(e,t)};Ke.useId=function(){return en.current.useId()};Ke.useImperativeHandle=function(e,t,r){return en.current.useImperativeHandle(e,t,r)};Ke.useInsertionEffect=function(e,t){return en.current.useInsertionEffect(e,t)};Ke.useLayoutEffect=function(e,t){return en.current.useLayoutEffect(e,t)};Ke.useMemo=function(e,t){return en.current.useMemo(e,t)};Ke.useReducer=function(e,t,r){return en.current.useReducer(e,t,r)};Ke.useRef=function(e){return en.current.useRef(e)};Ke.useState=function(e){return en.current.useState(e)};Ke.useSyncExternalStore=function(e,t,r){return en.current.useSyncExternalStore(e,t,r)};Ke.useTransition=function(){return en.current.useTransition()};Ke.version="18.3.1";n_.exports=Ke;var _=n_.exports;const ge=t_(_),jg=w3({__proto__:null,default:ge},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O3=_,F3=Symbol.for("react.element"),L3=Symbol.for("react.fragment"),B3=Object.prototype.hasOwnProperty,U3=O3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$3={key:!0,ref:!0,__self:!0,__source:!0};function d_(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)B3.call(t,n)&&!$3.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:F3,type:e,key:s,ref:i,props:a,_owner:U3.current}}kh.Fragment=L3;kh.jsx=d_;kh.jsxs=d_;r_.exports=kh;var c=r_.exports,h_={exports:{}},jn={},m_={exports:{}},p_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,P){var Z=F.length;F.push(P);e:for(;0<Z;){var le=Z-1>>>1,D=F[le];if(0<a(D,P))F[le]=P,F[Z]=D,Z=le;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var P=F[0],Z=F.pop();if(Z!==P){F[0]=Z;e:for(var le=0,D=F.length,V=D>>>1;le<V;){var O=2*(le+1)-1,L=F[O],Y=O+1,G=F[Y];if(0>a(L,Z))Y<D&&0>a(G,L)?(F[le]=G,F[Y]=Z,le=Y):(F[le]=L,F[O]=Z,le=O);else if(Y<D&&0>a(G,Z))F[le]=G,F[Y]=Z,le=Y;else break e}}return P}function a(F,P){var Z=F.sortIndex-P.sortIndex;return Z!==0?Z:F.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],f=1,d=null,m=3,h=!1,g=!1,p=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var P=r(u);P!==null;){if(P.callback===null)n(u);else if(P.startTime<=F)n(u),P.sortIndex=P.expirationTime,t(l,P);else break;P=r(u)}}function S(F){if(p=!1,w(F),!g)if(r(l)!==null)g=!0,Q(b);else{var P=r(u);P!==null&&X(S,P.startTime-F)}}function b(F,P){g=!1,p&&(p=!1,v(T),T=-1),h=!0;var Z=m;try{for(w(P),d=r(l);d!==null&&(!(d.expirationTime>P)||F&&!H());){var le=d.callback;if(typeof le=="function"){d.callback=null,m=d.priorityLevel;var D=le(d.expirationTime<=P);P=e.unstable_now(),typeof D=="function"?d.callback=D:d===r(l)&&n(l),w(P)}else n(l);d=r(l)}if(d!==null)var V=!0;else{var O=r(u);O!==null&&X(S,O.startTime-P),V=!1}return V}finally{d=null,m=Z,h=!1}}var E=!1,k=null,T=-1,N=5,I=-1;function H(){return!(e.unstable_now()-I<N)}function j(){if(k!==null){var F=e.unstable_now();I=F;var P=!0;try{P=k(!0,F)}finally{P?z():(E=!1,k=null)}}else E=!1}var z;if(typeof x=="function")z=function(){x(j)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,q=K.port2;K.port1.onmessage=j,z=function(){q.postMessage(null)}}else z=function(){y(j,0)};function Q(F){k=F,E||(E=!0,z())}function X(F,P){T=y(function(){F(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){g||h||(g=!0,Q(b))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(F){switch(m){case 1:case 2:case 3:var P=3;break;default:P=m}var Z=m;m=P;try{return F()}finally{m=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,P){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Z=m;m=F;try{return P()}finally{m=Z}},e.unstable_scheduleCallback=function(F,P,Z){var le=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?le+Z:le):Z=le,F){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=Z+D,F={id:f++,callback:P,priorityLevel:F,startTime:Z,expirationTime:D,sortIndex:-1},Z>le?(F.sortIndex=Z,t(u,F),r(l)===null&&F===r(u)&&(p?(v(T),T=-1):p=!0,X(S,Z-le))):(F.sortIndex=D,t(l,F),g||h||(g=!0,Q(b))),F},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(F){var P=m;return function(){var Z=m;m=P;try{return F.apply(this,arguments)}finally{m=Z}}}})(p_);m_.exports=p_;var W3=m_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H3=_,Cn=W3;function he(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g_=new Set,ru={};function _o(e,t){bl(e,t),bl(e+"Capture",t)}function bl(e,t){for(ru[e]=t,e=0;e<t.length;e++)g_.add(t[e])}var ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xp=Object.prototype.hasOwnProperty,V3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wy={},_y={};function z3(e){return Xp.call(_y,e)?!0:Xp.call(wy,e)?!1:V3.test(e)?_y[e]=!0:(wy[e]=!0,!1)}function G3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Y3(e,t,r,n){if(t===null||typeof t>"u"||G3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function tn(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){br[e]=new tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];br[t]=new tn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){br[e]=new tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){br[e]=new tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){br[e]=new tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){br[e]=new tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){br[e]=new tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){br[e]=new tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){br[e]=new tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Rg=/[\-:]([a-z])/g;function Mg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Rg,Mg);br[t]=new tn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Rg,Mg);br[t]=new tn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Rg,Mg);br[t]=new tn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){br[e]=new tn(e,1,!1,e.toLowerCase(),null,!1,!1)});br.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){br[e]=new tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ig(e,t,r,n){var a=br.hasOwnProperty(t)?br[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Y3(t,r,a,n)&&(r=null),n||a===null?z3(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Cs=H3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ef=Symbol.for("react.element"),Vo=Symbol.for("react.portal"),zo=Symbol.for("react.fragment"),Og=Symbol.for("react.strict_mode"),Kp=Symbol.for("react.profiler"),v_=Symbol.for("react.provider"),y_=Symbol.for("react.context"),Fg=Symbol.for("react.forward_ref"),qp=Symbol.for("react.suspense"),Qp=Symbol.for("react.suspense_list"),Lg=Symbol.for("react.memo"),Ws=Symbol.for("react.lazy"),x_=Symbol.for("react.offscreen"),Sy=Symbol.iterator;function hc(e){return e===null||typeof e!="object"?null:(e=Sy&&e[Sy]||e["@@iterator"],typeof e=="function"?e:null)}var Lt=Object.assign,Mm;function Cc(e){if(Mm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Mm=t&&t[1]||""}return`
`+Mm+e}var Im=!1;function Om(e,t){if(!e||Im)return"";Im=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Im=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Cc(e):""}function X3(e){switch(e.tag){case 5:return Cc(e.type);case 16:return Cc("Lazy");case 13:return Cc("Suspense");case 19:return Cc("SuspenseList");case 0:case 2:case 15:return e=Om(e.type,!1),e;case 11:return e=Om(e.type.render,!1),e;case 1:return e=Om(e.type,!0),e;default:return""}}function Jp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zo:return"Fragment";case Vo:return"Portal";case Kp:return"Profiler";case Og:return"StrictMode";case qp:return"Suspense";case Qp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case y_:return(e.displayName||"Context")+".Consumer";case v_:return(e._context.displayName||"Context")+".Provider";case Fg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Lg:return t=e.displayName||null,t!==null?t:Jp(e.type)||"Memo";case Ws:t=e._payload,e=e._init;try{return Jp(e(t))}catch{}}return null}function K3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jp(t);case 8:return t===Og?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function di(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function w_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function q3(e){var t=w_(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tf(e){e._valueTracker||(e._valueTracker=q3(e))}function __(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=w_(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Cd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Zp(e,t){var r=t.checked;return Lt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ky(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=di(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function S_(e,t){t=t.checked,t!=null&&Ig(e,"checked",t,!1)}function e0(e,t){S_(e,t);var r=di(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?t0(e,t.type,r):t.hasOwnProperty("defaultValue")&&t0(e,t.type,di(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function by(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function t0(e,t,r){(t!=="number"||Cd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ac=Array.isArray;function nl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+di(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function r0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(he(91));return Lt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ey(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(he(92));if(Ac(r)){if(1<r.length)throw Error(he(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:di(r)}}function k_(e,t){var r=di(t.value),n=di(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ty(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function b_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function n0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?b_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Nf,E_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Nf=Nf||document.createElement("div"),Nf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Nf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function nu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Q3=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(e){Q3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fc[t]=Fc[e]})});function T_(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fc.hasOwnProperty(e)&&Fc[e]?(""+t).trim():t+"px"}function N_(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=T_(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var J3=Lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a0(e,t){if(t){if(J3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(he(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(he(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(he(61))}if(t.style!=null&&typeof t.style!="object")throw Error(he(62))}}function s0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var i0=null;function Bg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var o0=null,al=null,sl=null;function Ny(e){if(e=qu(e)){if(typeof o0!="function")throw Error(he(280));var t=e.stateNode;t&&(t=Ch(t),o0(e.stateNode,e.type,t))}}function C_(e){al?sl?sl.push(e):sl=[e]:al=e}function A_(){if(al){var e=al,t=sl;if(sl=al=null,Ny(e),t)for(e=0;e<t.length;e++)Ny(t[e])}}function P_(e,t){return e(t)}function D_(){}var Fm=!1;function j_(e,t,r){if(Fm)return e(t,r);Fm=!0;try{return P_(e,t,r)}finally{Fm=!1,(al!==null||sl!==null)&&(D_(),A_())}}function au(e,t){var r=e.stateNode;if(r===null)return null;var n=Ch(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(he(231,t,typeof r));return r}var l0=!1;if(ws)try{var mc={};Object.defineProperty(mc,"passive",{get:function(){l0=!0}}),window.addEventListener("test",mc,mc),window.removeEventListener("test",mc,mc)}catch{l0=!1}function Z3(e,t,r,n,a,s,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Lc=!1,Ad=null,Pd=!1,c0=null,e5={onError:function(e){Lc=!0,Ad=e}};function t5(e,t,r,n,a,s,i,o,l){Lc=!1,Ad=null,Z3.apply(e5,arguments)}function r5(e,t,r,n,a,s,i,o,l){if(t5.apply(this,arguments),Lc){if(Lc){var u=Ad;Lc=!1,Ad=null}else throw Error(he(198));Pd||(Pd=!0,c0=u)}}function So(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function R_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cy(e){if(So(e)!==e)throw Error(he(188))}function n5(e){var t=e.alternate;if(!t){if(t=So(e),t===null)throw Error(he(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Cy(a),e;if(s===n)return Cy(a),t;s=s.sibling}throw Error(he(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?e:t}function M_(e){return e=n5(e),e!==null?I_(e):null}function I_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=I_(e);if(t!==null)return t;e=e.sibling}return null}var O_=Cn.unstable_scheduleCallback,Ay=Cn.unstable_cancelCallback,a5=Cn.unstable_shouldYield,s5=Cn.unstable_requestPaint,Yt=Cn.unstable_now,i5=Cn.unstable_getCurrentPriorityLevel,Ug=Cn.unstable_ImmediatePriority,F_=Cn.unstable_UserBlockingPriority,Dd=Cn.unstable_NormalPriority,o5=Cn.unstable_LowPriority,L_=Cn.unstable_IdlePriority,bh=null,Ga=null;function l5(e){if(Ga&&typeof Ga.onCommitFiberRoot=="function")try{Ga.onCommitFiberRoot(bh,e,void 0,(e.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:f5,c5=Math.log,u5=Math.LN2;function f5(e){return e>>>=0,e===0?32:31-(c5(e)/u5|0)|0}var Cf=64,Af=4194304;function Pc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function jd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Pc(o):(s&=i,s!==0&&(n=Pc(s)))}else i=r&~a,i!==0?n=Pc(i):s!==0&&(n=Pc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ya(t),a=1<<r,n|=e[r],t&=~a;return n}function d5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-ya(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=d5(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function u0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function B_(){var e=Cf;return Cf<<=1,!(Cf&4194240)&&(Cf=64),e}function Lm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Xu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ya(t),e[t]=r}function m5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ya(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function $g(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ya(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var dt=0;function U_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $_,Wg,W_,H_,V_,f0=!1,Pf=[],ni=null,ai=null,si=null,su=new Map,iu=new Map,Vs=[],p5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Py(e,t){switch(e){case"focusin":case"focusout":ni=null;break;case"dragenter":case"dragleave":ai=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":su.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":iu.delete(t.pointerId)}}function pc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=qu(t),t!==null&&Wg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function g5(e,t,r,n,a){switch(t){case"focusin":return ni=pc(ni,e,t,r,n,a),!0;case"dragenter":return ai=pc(ai,e,t,r,n,a),!0;case"mouseover":return si=pc(si,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return su.set(s,pc(su.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,iu.set(s,pc(iu.get(s)||null,e,t,r,n,a)),!0}return!1}function z_(e){var t=Ii(e.target);if(t!==null){var r=So(t);if(r!==null){if(t=r.tag,t===13){if(t=R_(r),t!==null){e.blockedOn=t,V_(e.priority,function(){W_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=d0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);i0=n,r.target.dispatchEvent(n),i0=null}else return t=qu(r),t!==null&&Wg(t),e.blockedOn=r,!1;t.shift()}return!0}function Dy(e,t,r){fd(e)&&r.delete(t)}function v5(){f0=!1,ni!==null&&fd(ni)&&(ni=null),ai!==null&&fd(ai)&&(ai=null),si!==null&&fd(si)&&(si=null),su.forEach(Dy),iu.forEach(Dy)}function gc(e,t){e.blockedOn===t&&(e.blockedOn=null,f0||(f0=!0,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,v5)))}function ou(e){function t(a){return gc(a,e)}if(0<Pf.length){gc(Pf[0],e);for(var r=1;r<Pf.length;r++){var n=Pf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ni!==null&&gc(ni,e),ai!==null&&gc(ai,e),si!==null&&gc(si,e),su.forEach(t),iu.forEach(t),r=0;r<Vs.length;r++)n=Vs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vs.length&&(r=Vs[0],r.blockedOn===null);)z_(r),r.blockedOn===null&&Vs.shift()}var il=Cs.ReactCurrentBatchConfig,Rd=!0;function y5(e,t,r,n){var a=dt,s=il.transition;il.transition=null;try{dt=1,Hg(e,t,r,n)}finally{dt=a,il.transition=s}}function x5(e,t,r,n){var a=dt,s=il.transition;il.transition=null;try{dt=4,Hg(e,t,r,n)}finally{dt=a,il.transition=s}}function Hg(e,t,r,n){if(Rd){var a=d0(e,t,r,n);if(a===null)Xm(e,t,n,Md,r),Py(e,n);else if(g5(a,e,t,r,n))n.stopPropagation();else if(Py(e,n),t&4&&-1<p5.indexOf(e)){for(;a!==null;){var s=qu(a);if(s!==null&&$_(s),s=d0(e,t,r,n),s===null&&Xm(e,t,n,Md,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Xm(e,t,n,null,r)}}var Md=null;function d0(e,t,r,n){if(Md=null,e=Bg(n),e=Ii(e),e!==null)if(t=So(e),t===null)e=null;else if(r=t.tag,r===13){if(e=R_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Md=e,null}function G_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i5()){case Ug:return 1;case F_:return 4;case Dd:case o5:return 16;case L_:return 536870912;default:return 16}default:return 16}}var Js=null,Vg=null,dd=null;function Y_(){if(dd)return dd;var e,t=Vg,r=t.length,n,a="value"in Js?Js.value:Js.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return dd=a.slice(e,1<n?1-n:void 0)}function hd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Df(){return!0}function jy(){return!1}function Rn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Df:jy,this.isPropagationStopped=jy,this}return Lt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Df)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Df)},persist:function(){},isPersistent:Df}),t}var $l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zg=Rn($l),Ku=Lt({},$l,{view:0,detail:0}),w5=Rn(Ku),Bm,Um,vc,Eh=Lt({},Ku,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vc&&(vc&&e.type==="mousemove"?(Bm=e.screenX-vc.screenX,Um=e.screenY-vc.screenY):Um=Bm=0,vc=e),Bm)},movementY:function(e){return"movementY"in e?e.movementY:Um}}),Ry=Rn(Eh),_5=Lt({},Eh,{dataTransfer:0}),S5=Rn(_5),k5=Lt({},Ku,{relatedTarget:0}),$m=Rn(k5),b5=Lt({},$l,{animationName:0,elapsedTime:0,pseudoElement:0}),E5=Rn(b5),T5=Lt({},$l,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),N5=Rn(T5),C5=Lt({},$l,{data:0}),My=Rn(C5),A5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},D5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=D5[e])?!!t[e]:!1}function Gg(){return j5}var R5=Lt({},Ku,{key:function(e){if(e.key){var t=A5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gg,charCode:function(e){return e.type==="keypress"?hd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),M5=Rn(R5),I5=Lt({},Eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Iy=Rn(I5),O5=Lt({},Ku,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gg}),F5=Rn(O5),L5=Lt({},$l,{propertyName:0,elapsedTime:0,pseudoElement:0}),B5=Rn(L5),U5=Lt({},Eh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$5=Rn(U5),W5=[9,13,27,32],Yg=ws&&"CompositionEvent"in window,Bc=null;ws&&"documentMode"in document&&(Bc=document.documentMode);var H5=ws&&"TextEvent"in window&&!Bc,X_=ws&&(!Yg||Bc&&8<Bc&&11>=Bc),Oy=" ",Fy=!1;function K_(e,t){switch(e){case"keyup":return W5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function q_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Go=!1;function V5(e,t){switch(e){case"compositionend":return q_(t);case"keypress":return t.which!==32?null:(Fy=!0,Oy);case"textInput":return e=t.data,e===Oy&&Fy?null:e;default:return null}}function z5(e,t){if(Go)return e==="compositionend"||!Yg&&K_(e,t)?(e=Y_(),dd=Vg=Js=null,Go=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return X_&&t.locale!=="ko"?null:t.data;default:return null}}var G5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ly(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!G5[e.type]:t==="textarea"}function Q_(e,t,r,n){C_(n),t=Id(t,"onChange"),0<t.length&&(r=new zg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Uc=null,lu=null;function Y5(e){lS(e,0)}function Th(e){var t=Ko(e);if(__(t))return e}function X5(e,t){if(e==="change")return t}var J_=!1;if(ws){var Wm;if(ws){var Hm="oninput"in document;if(!Hm){var By=document.createElement("div");By.setAttribute("oninput","return;"),Hm=typeof By.oninput=="function"}Wm=Hm}else Wm=!1;J_=Wm&&(!document.documentMode||9<document.documentMode)}function Uy(){Uc&&(Uc.detachEvent("onpropertychange",Z_),lu=Uc=null)}function Z_(e){if(e.propertyName==="value"&&Th(lu)){var t=[];Q_(t,lu,e,Bg(e)),j_(Y5,t)}}function K5(e,t,r){e==="focusin"?(Uy(),Uc=t,lu=r,Uc.attachEvent("onpropertychange",Z_)):e==="focusout"&&Uy()}function q5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Th(lu)}function Q5(e,t){if(e==="click")return Th(t)}function J5(e,t){if(e==="input"||e==="change")return Th(t)}function Z5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ka=typeof Object.is=="function"?Object.is:Z5;function cu(e,t){if(ka(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Xp.call(t,a)||!ka(e[a],t[a]))return!1}return!0}function $y(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Wy(e,t){var r=$y(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$y(r)}}function eS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?eS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tS(){for(var e=window,t=Cd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Cd(e.document)}return t}function Xg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function eA(e){var t=tS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&eS(r.ownerDocument.documentElement,r)){if(n!==null&&Xg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Wy(r,s);var i=Wy(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tA=ws&&"documentMode"in document&&11>=document.documentMode,Yo=null,h0=null,$c=null,m0=!1;function Hy(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;m0||Yo==null||Yo!==Cd(n)||(n=Yo,"selectionStart"in n&&Xg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),$c&&cu($c,n)||($c=n,n=Id(h0,"onSelect"),0<n.length&&(t=new zg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Yo)))}function jf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xo={animationend:jf("Animation","AnimationEnd"),animationiteration:jf("Animation","AnimationIteration"),animationstart:jf("Animation","AnimationStart"),transitionend:jf("Transition","TransitionEnd")},Vm={},rS={};ws&&(rS=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Nh(e){if(Vm[e])return Vm[e];if(!Xo[e])return e;var t=Xo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in rS)return Vm[e]=t[r];return e}var nS=Nh("animationend"),aS=Nh("animationiteration"),sS=Nh("animationstart"),iS=Nh("transitionend"),oS=new Map,Vy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _i(e,t){oS.set(e,t),_o(t,[e])}for(var zm=0;zm<Vy.length;zm++){var Gm=Vy[zm],rA=Gm.toLowerCase(),nA=Gm[0].toUpperCase()+Gm.slice(1);_i(rA,"on"+nA)}_i(nS,"onAnimationEnd");_i(aS,"onAnimationIteration");_i(sS,"onAnimationStart");_i("dblclick","onDoubleClick");_i("focusin","onFocus");_i("focusout","onBlur");_i(iS,"onTransitionEnd");bl("onMouseEnter",["mouseout","mouseover"]);bl("onMouseLeave",["mouseout","mouseover"]);bl("onPointerEnter",["pointerout","pointerover"]);bl("onPointerLeave",["pointerout","pointerover"]);_o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_o("onBeforeInput",["compositionend","keypress","textInput","paste"]);_o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dc));function zy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,r5(n,t,void 0,e),e.currentTarget=null}function lS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;zy(a,o,u),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;zy(a,o,u),s=l}}}if(Pd)throw e=c0,Pd=!1,c0=null,e}function xt(e,t){var r=t[x0];r===void 0&&(r=t[x0]=new Set);var n=e+"__bubble";r.has(n)||(cS(t,e,2,!1),r.add(n))}function Ym(e,t,r){var n=0;t&&(n|=4),cS(r,e,n,t)}var Rf="_reactListening"+Math.random().toString(36).slice(2);function uu(e){if(!e[Rf]){e[Rf]=!0,g_.forEach(function(r){r!=="selectionchange"&&(aA.has(r)||Ym(r,!1,e),Ym(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rf]||(t[Rf]=!0,Ym("selectionchange",!1,t))}}function cS(e,t,r,n){switch(G_(t)){case 1:var a=y5;break;case 4:a=x5;break;default:a=Hg}r=a.bind(null,t,r,e),a=void 0,!l0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Xm(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Ii(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}j_(function(){var u=s,f=Bg(r),d=[];e:{var m=oS.get(e);if(m!==void 0){var h=zg,g=e;switch(e){case"keypress":if(hd(r)===0)break e;case"keydown":case"keyup":h=M5;break;case"focusin":g="focus",h=$m;break;case"focusout":g="blur",h=$m;break;case"beforeblur":case"afterblur":h=$m;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Ry;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=S5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=F5;break;case nS:case aS:case sS:h=E5;break;case iS:h=B5;break;case"scroll":h=w5;break;case"wheel":h=$5;break;case"copy":case"cut":case"paste":h=N5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Iy}var p=(t&4)!==0,y=!p&&e==="scroll",v=p?m!==null?m+"Capture":null:m;p=[];for(var x=u,w;x!==null;){w=x;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,v!==null&&(S=au(x,v),S!=null&&p.push(fu(x,S,w)))),y)break;x=x.return}0<p.length&&(m=new h(m,g,null,r,f),d.push({event:m,listeners:p}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==i0&&(g=r.relatedTarget||r.fromElement)&&(Ii(g)||g[_s]))break e;if((h||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=u,g=g?Ii(g):null,g!==null&&(y=So(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=u),h!==g)){if(p=Ry,S="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(p=Iy,S="onPointerLeave",v="onPointerEnter",x="pointer"),y=h==null?m:Ko(h),w=g==null?m:Ko(g),m=new p(S,x+"leave",h,r,f),m.target=y,m.relatedTarget=w,S=null,Ii(f)===u&&(p=new p(v,x+"enter",g,r,f),p.target=w,p.relatedTarget=y,S=p),y=S,h&&g)t:{for(p=h,v=g,x=0,w=p;w;w=Mo(w))x++;for(w=0,S=v;S;S=Mo(S))w++;for(;0<x-w;)p=Mo(p),x--;for(;0<w-x;)v=Mo(v),w--;for(;x--;){if(p===v||v!==null&&p===v.alternate)break t;p=Mo(p),v=Mo(v)}p=null}else p=null;h!==null&&Gy(d,m,h,p,!1),g!==null&&y!==null&&Gy(d,y,g,p,!0)}}e:{if(m=u?Ko(u):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var b=X5;else if(Ly(m))if(J_)b=J5;else{b=q5;var E=K5}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(b=Q5);if(b&&(b=b(e,u))){Q_(d,b,r,f);break e}E&&E(e,m,u),e==="focusout"&&(E=m._wrapperState)&&E.controlled&&m.type==="number"&&t0(m,"number",m.value)}switch(E=u?Ko(u):window,e){case"focusin":(Ly(E)||E.contentEditable==="true")&&(Yo=E,h0=u,$c=null);break;case"focusout":$c=h0=Yo=null;break;case"mousedown":m0=!0;break;case"contextmenu":case"mouseup":case"dragend":m0=!1,Hy(d,r,f);break;case"selectionchange":if(tA)break;case"keydown":case"keyup":Hy(d,r,f)}var k;if(Yg)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Go?K_(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(X_&&r.locale!=="ko"&&(Go||T!=="onCompositionStart"?T==="onCompositionEnd"&&Go&&(k=Y_()):(Js=f,Vg="value"in Js?Js.value:Js.textContent,Go=!0)),E=Id(u,T),0<E.length&&(T=new My(T,e,null,r,f),d.push({event:T,listeners:E}),k?T.data=k:(k=q_(r),k!==null&&(T.data=k)))),(k=H5?V5(e,r):z5(e,r))&&(u=Id(u,"onBeforeInput"),0<u.length&&(f=new My("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=k))}lS(d,t)})}function fu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Id(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=au(e,r),s!=null&&n.unshift(fu(e,s,a)),s=au(e,t),s!=null&&n.push(fu(e,s,a))),e=e.return}return n}function Mo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gy(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,a?(l=au(r,s),l!=null&&i.unshift(fu(r,l,o))):a||(l=au(r,s),l!=null&&i.push(fu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var sA=/\r\n?/g,iA=/\u0000|\uFFFD/g;function Yy(e){return(typeof e=="string"?e:""+e).replace(sA,`
`).replace(iA,"")}function Mf(e,t,r){if(t=Yy(t),Yy(e)!==t&&r)throw Error(he(425))}function Od(){}var p0=null,g0=null;function v0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var y0=typeof setTimeout=="function"?setTimeout:void 0,oA=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,lA=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(e){return Xy.resolve(null).then(e).catch(cA)}:y0;function cA(e){setTimeout(function(){throw e})}function Km(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),ou(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);ou(t)}function ii(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ky(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Wl=Math.random().toString(36).slice(2),$a="__reactFiber$"+Wl,du="__reactProps$"+Wl,_s="__reactContainer$"+Wl,x0="__reactEvents$"+Wl,uA="__reactListeners$"+Wl,fA="__reactHandles$"+Wl;function Ii(e){var t=e[$a];if(t)return t;for(var r=e.parentNode;r;){if(t=r[_s]||r[$a]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ky(e);e!==null;){if(r=e[$a])return r;e=Ky(e)}return t}e=r,r=e.parentNode}return null}function qu(e){return e=e[$a]||e[_s],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ko(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(he(33))}function Ch(e){return e[du]||null}var w0=[],qo=-1;function Si(e){return{current:e}}function kt(e){0>qo||(e.current=w0[qo],w0[qo]=null,qo--)}function gt(e,t){qo++,w0[qo]=e.current,e.current=t}var hi={},Ur=Si(hi),ln=Si(!1),to=hi;function El(e,t){var r=e.type.contextTypes;if(!r)return hi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function cn(e){return e=e.childContextTypes,e!=null}function Fd(){kt(ln),kt(Ur)}function qy(e,t,r){if(Ur.current!==hi)throw Error(he(168));gt(Ur,t),gt(ln,r)}function uS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(he(108,K3(e)||"Unknown",a));return Lt({},r,n)}function Ld(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hi,to=Ur.current,gt(Ur,e),gt(ln,ln.current),!0}function Qy(e,t,r){var n=e.stateNode;if(!n)throw Error(he(169));r?(e=uS(e,t,to),n.__reactInternalMemoizedMergedChildContext=e,kt(ln),kt(Ur),gt(Ur,e)):kt(ln),gt(ln,r)}var ls=null,Ah=!1,qm=!1;function fS(e){ls===null?ls=[e]:ls.push(e)}function dA(e){Ah=!0,fS(e)}function ki(){if(!qm&&ls!==null){qm=!0;var e=0,t=dt;try{var r=ls;for(dt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ls=null,Ah=!1}catch(a){throw ls!==null&&(ls=ls.slice(e+1)),O_(Ug,ki),a}finally{dt=t,qm=!1}}return null}var Qo=[],Jo=0,Bd=null,Ud=0,zn=[],Gn=0,ro=null,us=1,fs="";function Di(e,t){Qo[Jo++]=Ud,Qo[Jo++]=Bd,Bd=e,Ud=t}function dS(e,t,r){zn[Gn++]=us,zn[Gn++]=fs,zn[Gn++]=ro,ro=e;var n=us;e=fs;var a=32-ya(n)-1;n&=~(1<<a),r+=1;var s=32-ya(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,us=1<<32-ya(t)+a|r<<a|n,fs=s+e}else us=1<<s|r<<a|n,fs=e}function Kg(e){e.return!==null&&(Di(e,1),dS(e,1,0))}function qg(e){for(;e===Bd;)Bd=Qo[--Jo],Qo[Jo]=null,Ud=Qo[--Jo],Qo[Jo]=null;for(;e===ro;)ro=zn[--Gn],zn[Gn]=null,fs=zn[--Gn],zn[Gn]=null,us=zn[--Gn],zn[Gn]=null}var Tn=null,En=null,Nt=!1,ha=null;function hS(e,t){var r=Yn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Jy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Tn=e,En=ii(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Tn=e,En=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ro!==null?{id:us,overflow:fs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Yn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Tn=e,En=null,!0):!1;default:return!1}}function _0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function S0(e){if(Nt){var t=En;if(t){var r=t;if(!Jy(e,t)){if(_0(e))throw Error(he(418));t=ii(r.nextSibling);var n=Tn;t&&Jy(e,t)?hS(n,r):(e.flags=e.flags&-4097|2,Nt=!1,Tn=e)}}else{if(_0(e))throw Error(he(418));e.flags=e.flags&-4097|2,Nt=!1,Tn=e}}}function Zy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Tn=e}function If(e){if(e!==Tn)return!1;if(!Nt)return Zy(e),Nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!v0(e.type,e.memoizedProps)),t&&(t=En)){if(_0(e))throw mS(),Error(he(418));for(;t;)hS(e,t),t=ii(t.nextSibling)}if(Zy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(he(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){En=ii(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}En=null}}else En=Tn?ii(e.stateNode.nextSibling):null;return!0}function mS(){for(var e=En;e;)e=ii(e.nextSibling)}function Tl(){En=Tn=null,Nt=!1}function Qg(e){ha===null?ha=[e]:ha.push(e)}var hA=Cs.ReactCurrentBatchConfig;function yc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,e))}return e}function Of(e,t){throw e=Object.prototype.toString.call(t),Error(he(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ex(e){var t=e._init;return t(e._payload)}function pS(e){function t(v,x){if(e){var w=v.deletions;w===null?(v.deletions=[x],v.flags|=16):w.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function a(v,x){return v=ui(v,x),v.index=0,v.sibling=null,v}function s(v,x,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<x?(v.flags|=2,x):w):(v.flags|=2,x)):(v.flags|=1048576,x)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,x,w,S){return x===null||x.tag!==6?(x=np(w,v.mode,S),x.return=v,x):(x=a(x,w),x.return=v,x)}function l(v,x,w,S){var b=w.type;return b===zo?f(v,x,w.props.children,S,w.key):x!==null&&(x.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ws&&ex(b)===x.type)?(S=a(x,w.props),S.ref=yc(v,x,w),S.return=v,S):(S=wd(w.type,w.key,w.props,null,v.mode,S),S.ref=yc(v,x,w),S.return=v,S)}function u(v,x,w,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=ap(w,v.mode,S),x.return=v,x):(x=a(x,w.children||[]),x.return=v,x)}function f(v,x,w,S,b){return x===null||x.tag!==7?(x=Xi(w,v.mode,S,b),x.return=v,x):(x=a(x,w),x.return=v,x)}function d(v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=np(""+x,v.mode,w),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ef:return w=wd(x.type,x.key,x.props,null,v.mode,w),w.ref=yc(v,null,x),w.return=v,w;case Vo:return x=ap(x,v.mode,w),x.return=v,x;case Ws:var S=x._init;return d(v,S(x._payload),w)}if(Ac(x)||hc(x))return x=Xi(x,v.mode,w,null),x.return=v,x;Of(v,x)}return null}function m(v,x,w,S){var b=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:o(v,x,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ef:return w.key===b?l(v,x,w,S):null;case Vo:return w.key===b?u(v,x,w,S):null;case Ws:return b=w._init,m(v,x,b(w._payload),S)}if(Ac(w)||hc(w))return b!==null?null:f(v,x,w,S,null);Of(v,w)}return null}function h(v,x,w,S,b){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(w)||null,o(x,v,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ef:return v=v.get(S.key===null?w:S.key)||null,l(x,v,S,b);case Vo:return v=v.get(S.key===null?w:S.key)||null,u(x,v,S,b);case Ws:var E=S._init;return h(v,x,w,E(S._payload),b)}if(Ac(S)||hc(S))return v=v.get(w)||null,f(x,v,S,b,null);Of(x,S)}return null}function g(v,x,w,S){for(var b=null,E=null,k=x,T=x=0,N=null;k!==null&&T<w.length;T++){k.index>T?(N=k,k=null):N=k.sibling;var I=m(v,k,w[T],S);if(I===null){k===null&&(k=N);break}e&&k&&I.alternate===null&&t(v,k),x=s(I,x,T),E===null?b=I:E.sibling=I,E=I,k=N}if(T===w.length)return r(v,k),Nt&&Di(v,T),b;if(k===null){for(;T<w.length;T++)k=d(v,w[T],S),k!==null&&(x=s(k,x,T),E===null?b=k:E.sibling=k,E=k);return Nt&&Di(v,T),b}for(k=n(v,k);T<w.length;T++)N=h(k,v,T,w[T],S),N!==null&&(e&&N.alternate!==null&&k.delete(N.key===null?T:N.key),x=s(N,x,T),E===null?b=N:E.sibling=N,E=N);return e&&k.forEach(function(H){return t(v,H)}),Nt&&Di(v,T),b}function p(v,x,w,S){var b=hc(w);if(typeof b!="function")throw Error(he(150));if(w=b.call(w),w==null)throw Error(he(151));for(var E=b=null,k=x,T=x=0,N=null,I=w.next();k!==null&&!I.done;T++,I=w.next()){k.index>T?(N=k,k=null):N=k.sibling;var H=m(v,k,I.value,S);if(H===null){k===null&&(k=N);break}e&&k&&H.alternate===null&&t(v,k),x=s(H,x,T),E===null?b=H:E.sibling=H,E=H,k=N}if(I.done)return r(v,k),Nt&&Di(v,T),b;if(k===null){for(;!I.done;T++,I=w.next())I=d(v,I.value,S),I!==null&&(x=s(I,x,T),E===null?b=I:E.sibling=I,E=I);return Nt&&Di(v,T),b}for(k=n(v,k);!I.done;T++,I=w.next())I=h(k,v,T,I.value,S),I!==null&&(e&&I.alternate!==null&&k.delete(I.key===null?T:I.key),x=s(I,x,T),E===null?b=I:E.sibling=I,E=I);return e&&k.forEach(function(j){return t(v,j)}),Nt&&Di(v,T),b}function y(v,x,w,S){if(typeof w=="object"&&w!==null&&w.type===zo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ef:e:{for(var b=w.key,E=x;E!==null;){if(E.key===b){if(b=w.type,b===zo){if(E.tag===7){r(v,E.sibling),x=a(E,w.props.children),x.return=v,v=x;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ws&&ex(b)===E.type){r(v,E.sibling),x=a(E,w.props),x.ref=yc(v,E,w),x.return=v,v=x;break e}r(v,E);break}else t(v,E);E=E.sibling}w.type===zo?(x=Xi(w.props.children,v.mode,S,w.key),x.return=v,v=x):(S=wd(w.type,w.key,w.props,null,v.mode,S),S.ref=yc(v,x,w),S.return=v,v=S)}return i(v);case Vo:e:{for(E=w.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){r(v,x.sibling),x=a(x,w.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=ap(w,v.mode,S),x.return=v,v=x}return i(v);case Ws:return E=w._init,y(v,x,E(w._payload),S)}if(Ac(w))return g(v,x,w,S);if(hc(w))return p(v,x,w,S);Of(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(r(v,x.sibling),x=a(x,w),x.return=v,v=x):(r(v,x),x=np(w,v.mode,S),x.return=v,v=x),i(v)):r(v,x)}return y}var Nl=pS(!0),gS=pS(!1),$d=Si(null),Wd=null,Zo=null,Jg=null;function Zg(){Jg=Zo=Wd=null}function e1(e){var t=$d.current;kt($d),e._currentValue=t}function k0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ol(e,t){Wd=e,Jg=Zo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(on=!0),e.firstContext=null)}function qn(e){var t=e._currentValue;if(Jg!==e)if(e={context:e,memoizedValue:t,next:null},Zo===null){if(Wd===null)throw Error(he(308));Zo=e,Wd.dependencies={lanes:0,firstContext:e}}else Zo=Zo.next=e;return t}var Oi=null;function t1(e){Oi===null?Oi=[e]:Oi.push(e)}function vS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,t1(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ss(e,n)}function Ss(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hs=!1;function r1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ps(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function oi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ze&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ss(e,r)}return a=n.interleaved,a===null?(t.next=t,t1(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ss(e,r)}function md(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$g(e,r)}}function tx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Hd(e,t,r,n){var a=e.updateQueue;Hs=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?s=u:i.next=u,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=u=l=null,o=s;do{var m=o.lane,h=o.eventTime;if((n&m)===m){f!==null&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,p=o;switch(m=t,h=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){d=g.call(h,d,m);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,m=typeof g=="function"?g.call(h,d,m):g,m==null)break e;d=Lt({},d,m);break e;case 2:Hs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=h,l=d):f=f.next=h,i|=m;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;m=o,o=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);ao|=i,e.lanes=i,e.memoizedState=d}}function rx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(he(191,a));a.call(n)}}}var Qu={},Ya=Si(Qu),hu=Si(Qu),mu=Si(Qu);function Fi(e){if(e===Qu)throw Error(he(174));return e}function n1(e,t){switch(gt(mu,t),gt(hu,e),gt(Ya,Qu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:n0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=n0(t,e)}kt(Ya),gt(Ya,t)}function Cl(){kt(Ya),kt(hu),kt(mu)}function xS(e){Fi(mu.current);var t=Fi(Ya.current),r=n0(t,e.type);t!==r&&(gt(hu,e),gt(Ya,r))}function a1(e){hu.current===e&&(kt(Ya),kt(hu))}var jt=Si(0);function Vd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qm=[];function s1(){for(var e=0;e<Qm.length;e++)Qm[e]._workInProgressVersionPrimary=null;Qm.length=0}var pd=Cs.ReactCurrentDispatcher,Jm=Cs.ReactCurrentBatchConfig,no=0,Ot=null,ar=null,fr=null,zd=!1,Wc=!1,pu=0,mA=0;function Cr(){throw Error(he(321))}function i1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ka(e[r],t[r]))return!1;return!0}function o1(e,t,r,n,a,s){if(no=s,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pd.current=e===null||e.memoizedState===null?yA:xA,e=r(n,a),Wc){s=0;do{if(Wc=!1,pu=0,25<=s)throw Error(he(301));s+=1,fr=ar=null,t.updateQueue=null,pd.current=wA,e=r(n,a)}while(Wc)}if(pd.current=Gd,t=ar!==null&&ar.next!==null,no=0,fr=ar=Ot=null,zd=!1,t)throw Error(he(300));return e}function l1(){var e=pu!==0;return pu=0,e}function Fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?Ot.memoizedState=fr=e:fr=fr.next=e,fr}function Qn(){if(ar===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=ar.next;var t=fr===null?Ot.memoizedState:fr.next;if(t!==null)fr=t,ar=e;else{if(e===null)throw Error(he(310));ar=e,e={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},fr===null?Ot.memoizedState=fr=e:fr=fr.next=e}return fr}function gu(e,t){return typeof t=="function"?t(e):t}function Zm(e){var t=Qn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=ar,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,u=s;do{var f=u.lane;if((no&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Ot.lanes|=f,ao|=f}u=u.next}while(u!==null&&u!==s);l===null?i=n:l.next=o,ka(n,t.memoizedState)||(on=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Ot.lanes|=s,ao|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ep(e){var t=Qn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);ka(s,t.memoizedState)||(on=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function wS(){}function _S(e,t){var r=Ot,n=Qn(),a=t(),s=!ka(n.memoizedState,a);if(s&&(n.memoizedState=a,on=!0),n=n.queue,c1(bS.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,vu(9,kS.bind(null,r,n,a,t),void 0,null),pr===null)throw Error(he(349));no&30||SS(r,t,a)}return a}function SS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kS(e,t,r,n){t.value=r,t.getSnapshot=n,ES(t)&&TS(e)}function bS(e,t,r){return r(function(){ES(t)&&TS(e)})}function ES(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ka(e,r)}catch{return!0}}function TS(e){var t=Ss(e,1);t!==null&&xa(t,e,1,-1)}function nx(e){var t=Fa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gu,lastRenderedState:e},t.queue=e,e=e.dispatch=vA.bind(null,Ot,e),[t.memoizedState,e]}function vu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function NS(){return Qn().memoizedState}function gd(e,t,r,n){var a=Fa();Ot.flags|=e,a.memoizedState=vu(1|t,r,void 0,n===void 0?null:n)}function Ph(e,t,r,n){var a=Qn();n=n===void 0?null:n;var s=void 0;if(ar!==null){var i=ar.memoizedState;if(s=i.destroy,n!==null&&i1(n,i.deps)){a.memoizedState=vu(t,r,s,n);return}}Ot.flags|=e,a.memoizedState=vu(1|t,r,s,n)}function ax(e,t){return gd(8390656,8,e,t)}function c1(e,t){return Ph(2048,8,e,t)}function CS(e,t){return Ph(4,2,e,t)}function AS(e,t){return Ph(4,4,e,t)}function PS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function DS(e,t,r){return r=r!=null?r.concat([e]):null,Ph(4,4,PS.bind(null,t,e),r)}function u1(){}function jS(e,t){var r=Qn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&i1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function RS(e,t){var r=Qn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&i1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function MS(e,t,r){return no&21?(ka(r,t)||(r=B_(),Ot.lanes|=r,ao|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,on=!0),e.memoizedState=r)}function pA(e,t){var r=dt;dt=r!==0&&4>r?r:4,e(!0);var n=Jm.transition;Jm.transition={};try{e(!1),t()}finally{dt=r,Jm.transition=n}}function IS(){return Qn().memoizedState}function gA(e,t,r){var n=ci(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},OS(e))FS(t,r);else if(r=vS(e,t,r,n),r!==null){var a=Jr();xa(r,e,n,a),LS(r,t,n)}}function vA(e,t,r){var n=ci(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(OS(e))FS(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,ka(o,i)){var l=t.interleaved;l===null?(a.next=a,t1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=vS(e,t,a,n),r!==null&&(a=Jr(),xa(r,e,n,a),LS(r,t,n))}}function OS(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function FS(e,t){Wc=zd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function LS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$g(e,r)}}var Gd={readContext:qn,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useInsertionEffect:Cr,useLayoutEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useMutableSource:Cr,useSyncExternalStore:Cr,useId:Cr,unstable_isNewReconciler:!1},yA={readContext:qn,useCallback:function(e,t){return Fa().memoizedState=[e,t===void 0?null:t],e},useContext:qn,useEffect:ax,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gd(4194308,4,PS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gd(4194308,4,e,t)},useInsertionEffect:function(e,t){return gd(4,2,e,t)},useMemo:function(e,t){var r=Fa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Fa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=gA.bind(null,Ot,e),[n.memoizedState,e]},useRef:function(e){var t=Fa();return e={current:e},t.memoizedState=e},useState:nx,useDebugValue:u1,useDeferredValue:function(e){return Fa().memoizedState=e},useTransition:function(){var e=nx(!1),t=e[0];return e=pA.bind(null,e[1]),Fa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ot,a=Fa();if(Nt){if(r===void 0)throw Error(he(407));r=r()}else{if(r=t(),pr===null)throw Error(he(349));no&30||SS(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,ax(bS.bind(null,n,s,e),[e]),n.flags|=2048,vu(9,kS.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Fa(),t=pr.identifierPrefix;if(Nt){var r=fs,n=us;r=(n&~(1<<32-ya(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=pu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=mA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},xA={readContext:qn,useCallback:jS,useContext:qn,useEffect:c1,useImperativeHandle:DS,useInsertionEffect:CS,useLayoutEffect:AS,useMemo:RS,useReducer:Zm,useRef:NS,useState:function(){return Zm(gu)},useDebugValue:u1,useDeferredValue:function(e){var t=Qn();return MS(t,ar.memoizedState,e)},useTransition:function(){var e=Zm(gu)[0],t=Qn().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:_S,useId:IS,unstable_isNewReconciler:!1},wA={readContext:qn,useCallback:jS,useContext:qn,useEffect:c1,useImperativeHandle:DS,useInsertionEffect:CS,useLayoutEffect:AS,useMemo:RS,useReducer:ep,useRef:NS,useState:function(){return ep(gu)},useDebugValue:u1,useDeferredValue:function(e){var t=Qn();return ar===null?t.memoizedState=e:MS(t,ar.memoizedState,e)},useTransition:function(){var e=ep(gu)[0],t=Qn().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:_S,useId:IS,unstable_isNewReconciler:!1};function la(e,t){if(e&&e.defaultProps){t=Lt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function b0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Lt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Dh={isMounted:function(e){return(e=e._reactInternals)?So(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),a=ci(e),s=ps(n,a);s.payload=t,r!=null&&(s.callback=r),t=oi(e,s,a),t!==null&&(xa(t,e,a,n),md(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),a=ci(e),s=ps(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=oi(e,s,a),t!==null&&(xa(t,e,a,n),md(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=ci(e),a=ps(r,n);a.tag=2,t!=null&&(a.callback=t),t=oi(e,a,n),t!==null&&(xa(t,e,n,r),md(t,e,n))}};function sx(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!cu(r,n)||!cu(a,s):!0}function BS(e,t,r){var n=!1,a=hi,s=t.contextType;return typeof s=="object"&&s!==null?s=qn(s):(a=cn(t)?to:Ur.current,n=t.contextTypes,s=(n=n!=null)?El(e,a):hi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Dh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function ix(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Dh.enqueueReplaceState(t,t.state,null)}function E0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},r1(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=qn(s):(s=cn(t)?to:Ur.current,a.context=El(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(b0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Dh.enqueueReplaceState(a,a.state,null),Hd(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Al(e,t){try{var r="",n=t;do r+=X3(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function tp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function T0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function US(e,t,r){r=ps(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Xd||(Xd=!0,O0=n),T0(e,t)},r}function $S(e,t,r){r=ps(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){T0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){T0(e,t),typeof n!="function"&&(li===null?li=new Set([this]):li.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function ox(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new _A;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=IA.bind(null,e,t,r),t.then(e,e))}function lx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cx(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ps(-1,1),t.tag=2,oi(r,t,1))),r.lanes|=1),e)}var SA=Cs.ReactCurrentOwner,on=!1;function Xr(e,t,r,n){t.child=e===null?gS(t,null,r,n):Nl(t,e.child,r,n)}function ux(e,t,r,n,a){r=r.render;var s=t.ref;return ol(t,a),n=o1(e,t,r,n,s,a),r=l1(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ks(e,t,a)):(Nt&&r&&Kg(t),t.flags|=1,Xr(e,t,n,a),t.child)}function fx(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!y1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,WS(e,t,s,n,a)):(e=wd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:cu,r(i,n)&&e.ref===t.ref)return ks(e,t,a)}return t.flags|=1,e=ui(s,n),e.ref=t.ref,e.return=t,t.child=e}function WS(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(cu(s,n)&&e.ref===t.ref)if(on=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(on=!0);else return t.lanes=e.lanes,ks(e,t,a)}return N0(e,t,r,n,a)}function HS(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(tl,xn),xn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gt(tl,xn),xn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,gt(tl,xn),xn|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,gt(tl,xn),xn|=n;return Xr(e,t,a,r),t.child}function VS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function N0(e,t,r,n,a){var s=cn(r)?to:Ur.current;return s=El(t,s),ol(t,a),r=o1(e,t,r,n,s,a),n=l1(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ks(e,t,a)):(Nt&&n&&Kg(t),t.flags|=1,Xr(e,t,r,a),t.child)}function dx(e,t,r,n,a){if(cn(r)){var s=!0;Ld(t)}else s=!1;if(ol(t,a),t.stateNode===null)vd(e,t),BS(t,r,n),E0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=qn(u):(u=cn(r)?to:Ur.current,u=El(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&ix(t,i,n,u),Hs=!1;var m=t.memoizedState;i.state=m,Hd(t,n,i,a),l=t.memoizedState,o!==n||m!==l||ln.current||Hs?(typeof f=="function"&&(b0(t,r,f,n),l=t.memoizedState),(o=Hs||sx(t,r,o,n,m,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,yS(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:la(t.type,o),i.props=u,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=qn(l):(l=cn(r)?to:Ur.current,l=El(t,l));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&ix(t,i,n,l),Hs=!1,m=t.memoizedState,i.state=m,Hd(t,n,i,a);var g=t.memoizedState;o!==d||m!==g||ln.current||Hs?(typeof h=="function"&&(b0(t,r,h,n),g=t.memoizedState),(u=Hs||sx(t,r,u,n,m,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return C0(e,t,r,n,s,a)}function C0(e,t,r,n,a,s){VS(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Qy(t,r,!1),ks(e,t,s);n=t.stateNode,SA.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Nl(t,e.child,null,s),t.child=Nl(t,null,o,s)):Xr(e,t,o,s),t.memoizedState=n.state,a&&Qy(t,r,!0),t.child}function zS(e){var t=e.stateNode;t.pendingContext?qy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qy(e,t.context,!1),n1(e,t.containerInfo)}function hx(e,t,r,n,a){return Tl(),Qg(a),t.flags|=256,Xr(e,t,r,n),t.child}var A0={dehydrated:null,treeContext:null,retryLane:0};function P0(e){return{baseLanes:e,cachePool:null,transitions:null}}function GS(e,t,r){var n=t.pendingProps,a=jt.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),gt(jt,a&1),e===null)return S0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Mh(i,n,0,null),e=Xi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=P0(r),t.memoizedState=A0,e):f1(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return kA(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ui(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=ui(o,s):(s=Xi(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?P0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=A0,n}return s=e.child,e=s.sibling,n=ui(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function f1(e,t){return t=Mh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ff(e,t,r,n){return n!==null&&Qg(n),Nl(t,e.child,null,r),e=f1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kA(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=tp(Error(he(422))),Ff(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Mh({mode:"visible",children:n.children},a,0,null),s=Xi(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Nl(t,e.child,null,i),t.child.memoizedState=P0(i),t.memoizedState=A0,s);if(!(t.mode&1))return Ff(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(he(419)),n=tp(s,n,void 0),Ff(e,t,i,n)}if(o=(i&e.childLanes)!==0,on||o){if(n=pr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Ss(e,a),xa(n,e,a,-1))}return v1(),n=tp(Error(he(421))),Ff(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=OA.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,En=ii(a.nextSibling),Tn=t,Nt=!0,ha=null,e!==null&&(zn[Gn++]=us,zn[Gn++]=fs,zn[Gn++]=ro,us=e.id,fs=e.overflow,ro=t),t=f1(t,n.children),t.flags|=4096,t)}function mx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),k0(e.return,t,r)}function rp(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function YS(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Xr(e,t,n.children,r),n=jt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mx(e,r,t);else if(e.tag===19)mx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(gt(jt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Vd(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),rp(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Vd(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}rp(t,!0,r,null,s);break;case"together":rp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ks(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ao|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(he(153));if(t.child!==null){for(e=t.child,r=ui(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ui(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bA(e,t,r){switch(t.tag){case 3:zS(t),Tl();break;case 5:xS(t);break;case 1:cn(t.type)&&Ld(t);break;case 4:n1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;gt($d,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(gt(jt,jt.current&1),t.flags|=128,null):r&t.child.childLanes?GS(e,t,r):(gt(jt,jt.current&1),e=ks(e,t,r),e!==null?e.sibling:null);gt(jt,jt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return YS(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),gt(jt,jt.current),n)break;return null;case 22:case 23:return t.lanes=0,HS(e,t,r)}return ks(e,t,r)}var XS,D0,KS,qS;XS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};D0=function(){};KS=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Fi(Ya.current);var s=null;switch(r){case"input":a=Zp(e,a),n=Zp(e,n),s=[];break;case"select":a=Lt({},a,{value:void 0}),n=Lt({},n,{value:void 0}),s=[];break;case"textarea":a=r0(e,a),n=r0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Od)}a0(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ru.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ru.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&xt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};qS=function(e,t,r,n){r!==n&&(t.flags|=4)};function xc(e,t){if(!Nt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ar(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function EA(e,t,r){var n=t.pendingProps;switch(qg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(t),null;case 1:return cn(t.type)&&Fd(),Ar(t),null;case 3:return n=t.stateNode,Cl(),kt(ln),kt(Ur),s1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(If(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ha!==null&&(B0(ha),ha=null))),D0(e,t),Ar(t),null;case 5:a1(t);var a=Fi(mu.current);if(r=t.type,e!==null&&t.stateNode!=null)KS(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(he(166));return Ar(t),null}if(e=Fi(Ya.current),If(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[$a]=t,n[du]=s,e=(t.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(a=0;a<Dc.length;a++)xt(Dc[a],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":ky(n,s),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xt("invalid",n);break;case"textarea":Ey(n,s),xt("invalid",n)}a0(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Mf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Mf(n.textContent,o,e),a=["children",""+o]):ru.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&xt("scroll",n)}switch(r){case"input":Tf(n),by(n,s,!0);break;case"textarea":Tf(n),Ty(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Od)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=b_(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[$a]=t,e[du]=n,XS(e,t,!1,!1),t.stateNode=e;e:{switch(i=s0(r,n),r){case"dialog":xt("cancel",e),xt("close",e),a=n;break;case"iframe":case"object":case"embed":xt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Dc.length;a++)xt(Dc[a],e);a=n;break;case"source":xt("error",e),a=n;break;case"img":case"image":case"link":xt("error",e),xt("load",e),a=n;break;case"details":xt("toggle",e),a=n;break;case"input":ky(e,n),a=Zp(e,n),xt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Lt({},n,{value:void 0}),xt("invalid",e);break;case"textarea":Ey(e,n),a=r0(e,n),xt("invalid",e);break;default:a=n}a0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?N_(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&E_(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&nu(e,l):typeof l=="number"&&nu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ru.hasOwnProperty(s)?l!=null&&s==="onScroll"&&xt("scroll",e):l!=null&&Ig(e,s,l,i))}switch(r){case"input":Tf(e),by(e,n,!1);break;case"textarea":Tf(e),Ty(e);break;case"option":n.value!=null&&e.setAttribute("value",""+di(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?nl(e,!!n.multiple,s,!1):n.defaultValue!=null&&nl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Od)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ar(t),null;case 6:if(e&&t.stateNode!=null)qS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(he(166));if(r=Fi(mu.current),Fi(Ya.current),If(t)){if(n=t.stateNode,r=t.memoizedProps,n[$a]=t,(s=n.nodeValue!==r)&&(e=Tn,e!==null))switch(e.tag){case 3:Mf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Mf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$a]=t,t.stateNode=n}return Ar(t),null;case 13:if(kt(jt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Nt&&En!==null&&t.mode&1&&!(t.flags&128))mS(),Tl(),t.flags|=98560,s=!1;else if(s=If(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(he(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[$a]=t}else Tl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ar(t),s=!1}else ha!==null&&(B0(ha),ha=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||jt.current&1?ir===0&&(ir=3):v1())),t.updateQueue!==null&&(t.flags|=4),Ar(t),null);case 4:return Cl(),D0(e,t),e===null&&uu(t.stateNode.containerInfo),Ar(t),null;case 10:return e1(t.type._context),Ar(t),null;case 17:return cn(t.type)&&Fd(),Ar(t),null;case 19:if(kt(jt),s=t.memoizedState,s===null)return Ar(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)xc(s,!1);else{if(ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Vd(e),i!==null){for(t.flags|=128,xc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return gt(jt,jt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Yt()>Pl&&(t.flags|=128,n=!0,xc(s,!1),t.lanes=4194304)}else{if(!n)if(e=Vd(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Nt)return Ar(t),null}else 2*Yt()-s.renderingStartTime>Pl&&r!==1073741824&&(t.flags|=128,n=!0,xc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Yt(),t.sibling=null,r=jt.current,gt(jt,n?r&1|2:r&1),t):(Ar(t),null);case 22:case 23:return g1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xn&1073741824&&(Ar(t),t.subtreeFlags&6&&(t.flags|=8192)):Ar(t),null;case 24:return null;case 25:return null}throw Error(he(156,t.tag))}function TA(e,t){switch(qg(t),t.tag){case 1:return cn(t.type)&&Fd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cl(),kt(ln),kt(Ur),s1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return a1(t),null;case 13:if(kt(jt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(he(340));Tl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return kt(jt),null;case 4:return Cl(),null;case 10:return e1(t.type._context),null;case 22:case 23:return g1(),null;case 24:return null;default:return null}}var Lf=!1,Ir=!1,NA=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function el(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){$t(e,t,n)}else r.current=null}function j0(e,t,r){try{r()}catch(n){$t(e,t,n)}}var px=!1;function CA(e,t){if(p0=Rd,e=tS(),Xg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,f=0,d=e,m=null;t:for(;;){for(var h;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)m=d,d=h;for(;;){if(d===e)break t;if(m===r&&++u===a&&(o=i),m===s&&++f===n&&(l=i),(h=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(g0={focusedElem:e,selectionRange:r},Rd=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,y=g.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?p:la(t.type,p),y);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(S){$t(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return g=px,px=!1,g}function Hc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&j0(t,r,s)}a=a.next}while(a!==n)}}function jh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function R0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function QS(e){var t=e.alternate;t!==null&&(e.alternate=null,QS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$a],delete t[du],delete t[x0],delete t[uA],delete t[fA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function JS(e){return e.tag===5||e.tag===3||e.tag===4}function gx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||JS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function M0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Od));else if(n!==4&&(e=e.child,e!==null))for(M0(e,t,r),e=e.sibling;e!==null;)M0(e,t,r),e=e.sibling}function I0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(I0(e,t,r),e=e.sibling;e!==null;)I0(e,t,r),e=e.sibling}var xr=null,da=!1;function Ms(e,t,r){for(r=r.child;r!==null;)ZS(e,t,r),r=r.sibling}function ZS(e,t,r){if(Ga&&typeof Ga.onCommitFiberUnmount=="function")try{Ga.onCommitFiberUnmount(bh,r)}catch{}switch(r.tag){case 5:Ir||el(r,t);case 6:var n=xr,a=da;xr=null,Ms(e,t,r),xr=n,da=a,xr!==null&&(da?(e=xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):xr.removeChild(r.stateNode));break;case 18:xr!==null&&(da?(e=xr,r=r.stateNode,e.nodeType===8?Km(e.parentNode,r):e.nodeType===1&&Km(e,r),ou(e)):Km(xr,r.stateNode));break;case 4:n=xr,a=da,xr=r.stateNode.containerInfo,da=!0,Ms(e,t,r),xr=n,da=a;break;case 0:case 11:case 14:case 15:if(!Ir&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&j0(r,t,i),a=a.next}while(a!==n)}Ms(e,t,r);break;case 1:if(!Ir&&(el(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){$t(r,t,o)}Ms(e,t,r);break;case 21:Ms(e,t,r);break;case 22:r.mode&1?(Ir=(n=Ir)||r.memoizedState!==null,Ms(e,t,r),Ir=n):Ms(e,t,r);break;default:Ms(e,t,r)}}function vx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new NA),t.forEach(function(n){var a=FA.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function aa(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:xr=o.stateNode,da=!1;break e;case 3:xr=o.stateNode.containerInfo,da=!0;break e;case 4:xr=o.stateNode.containerInfo,da=!0;break e}o=o.return}if(xr===null)throw Error(he(160));ZS(s,i,a),xr=null,da=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){$t(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ek(t,e),t=t.sibling}function ek(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(aa(t,e),Ra(e),n&4){try{Hc(3,e,e.return),jh(3,e)}catch(p){$t(e,e.return,p)}try{Hc(5,e,e.return)}catch(p){$t(e,e.return,p)}}break;case 1:aa(t,e),Ra(e),n&512&&r!==null&&el(r,r.return);break;case 5:if(aa(t,e),Ra(e),n&512&&r!==null&&el(r,r.return),e.flags&32){var a=e.stateNode;try{nu(a,"")}catch(p){$t(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&S_(a,s),s0(o,i);var u=s0(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?N_(a,d):f==="dangerouslySetInnerHTML"?E_(a,d):f==="children"?nu(a,d):Ig(a,f,d,u)}switch(o){case"input":e0(a,s);break;case"textarea":k_(a,s);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?nl(a,!!s.multiple,h,!1):m!==!!s.multiple&&(s.defaultValue!=null?nl(a,!!s.multiple,s.defaultValue,!0):nl(a,!!s.multiple,s.multiple?[]:"",!1))}a[du]=s}catch(p){$t(e,e.return,p)}}break;case 6:if(aa(t,e),Ra(e),n&4){if(e.stateNode===null)throw Error(he(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){$t(e,e.return,p)}}break;case 3:if(aa(t,e),Ra(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ou(t.containerInfo)}catch(p){$t(e,e.return,p)}break;case 4:aa(t,e),Ra(e);break;case 13:aa(t,e),Ra(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(m1=Yt())),n&4&&vx(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Ir=(u=Ir)||f,aa(t,e),Ir=u):aa(t,e),Ra(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ee=e,f=e.child;f!==null;){for(d=Ee=f;Ee!==null;){switch(m=Ee,h=m.child,m.tag){case 0:case 11:case 14:case 15:Hc(4,m,m.return);break;case 1:el(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){$t(n,r,p)}}break;case 5:el(m,m.return);break;case 22:if(m.memoizedState!==null){xx(d);continue}}h!==null?(h.return=m,Ee=h):xx(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=T_("display",i))}catch(p){$t(e,e.return,p)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){$t(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:aa(t,e),Ra(e),n&4&&vx(e);break;case 21:break;default:aa(t,e),Ra(e)}}function Ra(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(JS(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(nu(a,""),n.flags&=-33);var s=gx(e);I0(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=gx(e);M0(e,o,i);break;default:throw Error(he(161))}}catch(l){$t(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function AA(e,t,r){Ee=e,tk(e)}function tk(e,t,r){for(var n=(e.mode&1)!==0;Ee!==null;){var a=Ee,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Lf;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Ir;o=Lf;var u=Ir;if(Lf=i,(Ir=l)&&!u)for(Ee=a;Ee!==null;)i=Ee,l=i.child,i.tag===22&&i.memoizedState!==null?wx(a):l!==null?(l.return=i,Ee=l):wx(a);for(;s!==null;)Ee=s,tk(s),s=s.sibling;Ee=a,Lf=o,Ir=u}yx(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ee=s):yx(e)}}function yx(e){for(;Ee!==null;){var t=Ee;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ir||jh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ir)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:la(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&rx(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rx(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&ou(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}Ir||t.flags&512&&R0(t)}catch(m){$t(t,t.return,m)}}if(t===e){Ee=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function xx(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function wx(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{jh(4,t)}catch(l){$t(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){$t(t,a,l)}}var s=t.return;try{R0(t)}catch(l){$t(t,s,l)}break;case 5:var i=t.return;try{R0(t)}catch(l){$t(t,i,l)}}}catch(l){$t(t,t.return,l)}if(t===e){Ee=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ee=o;break}Ee=t.return}}var PA=Math.ceil,Yd=Cs.ReactCurrentDispatcher,d1=Cs.ReactCurrentOwner,Xn=Cs.ReactCurrentBatchConfig,Ze=0,pr=null,tr=null,kr=0,xn=0,tl=Si(0),ir=0,yu=null,ao=0,Rh=0,h1=0,Vc=null,sn=null,m1=0,Pl=1/0,os=null,Xd=!1,O0=null,li=null,Bf=!1,Zs=null,Kd=0,zc=0,F0=null,yd=-1,xd=0;function Jr(){return Ze&6?Yt():yd!==-1?yd:yd=Yt()}function ci(e){return e.mode&1?Ze&2&&kr!==0?kr&-kr:hA.transition!==null?(xd===0&&(xd=B_()),xd):(e=dt,e!==0||(e=window.event,e=e===void 0?16:G_(e.type)),e):1}function xa(e,t,r,n){if(50<zc)throw zc=0,F0=null,Error(he(185));Xu(e,r,n),(!(Ze&2)||e!==pr)&&(e===pr&&(!(Ze&2)&&(Rh|=r),ir===4&&zs(e,kr)),un(e,n),r===1&&Ze===0&&!(t.mode&1)&&(Pl=Yt()+500,Ah&&ki()))}function un(e,t){var r=e.callbackNode;h5(e,t);var n=jd(e,e===pr?kr:0);if(n===0)r!==null&&Ay(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ay(r),t===1)e.tag===0?dA(_x.bind(null,e)):fS(_x.bind(null,e)),lA(function(){!(Ze&6)&&ki()}),r=null;else{switch(U_(n)){case 1:r=Ug;break;case 4:r=F_;break;case 16:r=Dd;break;case 536870912:r=L_;break;default:r=Dd}r=ck(r,rk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rk(e,t){if(yd=-1,xd=0,Ze&6)throw Error(he(327));var r=e.callbackNode;if(ll()&&e.callbackNode!==r)return null;var n=jd(e,e===pr?kr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=qd(e,n);else{t=n;var a=Ze;Ze|=2;var s=ak();(pr!==e||kr!==t)&&(os=null,Pl=Yt()+500,Yi(e,t));do try{RA();break}catch(o){nk(e,o)}while(!0);Zg(),Yd.current=s,Ze=a,tr!==null?t=0:(pr=null,kr=0,t=ir)}if(t!==0){if(t===2&&(a=u0(e),a!==0&&(n=a,t=L0(e,a))),t===1)throw r=yu,Yi(e,0),zs(e,n),un(e,Yt()),r;if(t===6)zs(e,n);else{if(a=e.current.alternate,!(n&30)&&!DA(a)&&(t=qd(e,n),t===2&&(s=u0(e),s!==0&&(n=s,t=L0(e,s))),t===1))throw r=yu,Yi(e,0),zs(e,n),un(e,Yt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(he(345));case 2:ji(e,sn,os);break;case 3:if(zs(e,n),(n&130023424)===n&&(t=m1+500-Yt(),10<t)){if(jd(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=y0(ji.bind(null,e,sn,os),t);break}ji(e,sn,os);break;case 4:if(zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-ya(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Yt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PA(n/1960))-n,10<n){e.timeoutHandle=y0(ji.bind(null,e,sn,os),n);break}ji(e,sn,os);break;case 5:ji(e,sn,os);break;default:throw Error(he(329))}}}return un(e,Yt()),e.callbackNode===r?rk.bind(null,e):null}function L0(e,t){var r=Vc;return e.current.memoizedState.isDehydrated&&(Yi(e,t).flags|=256),e=qd(e,t),e!==2&&(t=sn,sn=r,t!==null&&B0(t)),e}function B0(e){sn===null?sn=e:sn.push.apply(sn,e)}function DA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!ka(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~h1,t&=~Rh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ya(t),n=1<<r;e[r]=-1,t&=~n}}function _x(e){if(Ze&6)throw Error(he(327));ll();var t=jd(e,0);if(!(t&1))return un(e,Yt()),null;var r=qd(e,t);if(e.tag!==0&&r===2){var n=u0(e);n!==0&&(t=n,r=L0(e,n))}if(r===1)throw r=yu,Yi(e,0),zs(e,t),un(e,Yt()),r;if(r===6)throw Error(he(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ji(e,sn,os),un(e,Yt()),null}function p1(e,t){var r=Ze;Ze|=1;try{return e(t)}finally{Ze=r,Ze===0&&(Pl=Yt()+500,Ah&&ki())}}function so(e){Zs!==null&&Zs.tag===0&&!(Ze&6)&&ll();var t=Ze;Ze|=1;var r=Xn.transition,n=dt;try{if(Xn.transition=null,dt=1,e)return e()}finally{dt=n,Xn.transition=r,Ze=t,!(Ze&6)&&ki()}}function g1(){xn=tl.current,kt(tl)}function Yi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,oA(r)),tr!==null)for(r=tr.return;r!==null;){var n=r;switch(qg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fd();break;case 3:Cl(),kt(ln),kt(Ur),s1();break;case 5:a1(n);break;case 4:Cl();break;case 13:kt(jt);break;case 19:kt(jt);break;case 10:e1(n.type._context);break;case 22:case 23:g1()}r=r.return}if(pr=e,tr=e=ui(e.current,null),kr=xn=t,ir=0,yu=null,h1=Rh=ao=0,sn=Vc=null,Oi!==null){for(t=0;t<Oi.length;t++)if(r=Oi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Oi=null}return e}function nk(e,t){do{var r=tr;try{if(Zg(),pd.current=Gd,zd){for(var n=Ot.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}zd=!1}if(no=0,fr=ar=Ot=null,Wc=!1,pu=0,d1.current=null,r===null||r.return===null){ir=1,yu=t,tr=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=kr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=lx(i);if(h!==null){h.flags&=-257,cx(h,i,o,s,t),h.mode&1&&ox(s,u,t),t=h,l=u;var g=t.updateQueue;if(g===null){var p=new Set;p.add(l),t.updateQueue=p}else g.add(l);break e}else{if(!(t&1)){ox(s,u,t),v1();break e}l=Error(he(426))}}else if(Nt&&o.mode&1){var y=lx(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),cx(y,i,o,s,t),Qg(Al(l,o));break e}}s=l=Al(l,o),ir!==4&&(ir=2),Vc===null?Vc=[s]:Vc.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=US(s,l,t);tx(s,v);break e;case 1:o=l;var x=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(li===null||!li.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=$S(s,o,t);tx(s,S);break e}}s=s.return}while(s!==null)}ik(r)}catch(b){t=b,tr===r&&r!==null&&(tr=r=r.return);continue}break}while(!0)}function ak(){var e=Yd.current;return Yd.current=Gd,e===null?Gd:e}function v1(){(ir===0||ir===3||ir===2)&&(ir=4),pr===null||!(ao&268435455)&&!(Rh&268435455)||zs(pr,kr)}function qd(e,t){var r=Ze;Ze|=2;var n=ak();(pr!==e||kr!==t)&&(os=null,Yi(e,t));do try{jA();break}catch(a){nk(e,a)}while(!0);if(Zg(),Ze=r,Yd.current=n,tr!==null)throw Error(he(261));return pr=null,kr=0,ir}function jA(){for(;tr!==null;)sk(tr)}function RA(){for(;tr!==null&&!a5();)sk(tr)}function sk(e){var t=lk(e.alternate,e,xn);e.memoizedProps=e.pendingProps,t===null?ik(e):tr=t,d1.current=null}function ik(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=TA(r,t),r!==null){r.flags&=32767,tr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ir=6,tr=null;return}}else if(r=EA(r,t,xn),r!==null){tr=r;return}if(t=t.sibling,t!==null){tr=t;return}tr=t=e}while(t!==null);ir===0&&(ir=5)}function ji(e,t,r){var n=dt,a=Xn.transition;try{Xn.transition=null,dt=1,MA(e,t,r,n)}finally{Xn.transition=a,dt=n}return null}function MA(e,t,r,n){do ll();while(Zs!==null);if(Ze&6)throw Error(he(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(he(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(m5(e,s),e===pr&&(tr=pr=null,kr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Bf||(Bf=!0,ck(Dd,function(){return ll(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Xn.transition,Xn.transition=null;var i=dt;dt=1;var o=Ze;Ze|=4,d1.current=null,CA(e,r),ek(r,e),eA(g0),Rd=!!p0,g0=p0=null,e.current=r,AA(r),s5(),Ze=o,dt=i,Xn.transition=s}else e.current=r;if(Bf&&(Bf=!1,Zs=e,Kd=a),s=e.pendingLanes,s===0&&(li=null),l5(r.stateNode),un(e,Yt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Xd)throw Xd=!1,e=O0,O0=null,e;return Kd&1&&e.tag!==0&&ll(),s=e.pendingLanes,s&1?e===F0?zc++:(zc=0,F0=e):zc=0,ki(),null}function ll(){if(Zs!==null){var e=U_(Kd),t=Xn.transition,r=dt;try{if(Xn.transition=null,dt=16>e?16:e,Zs===null)var n=!1;else{if(e=Zs,Zs=null,Kd=0,Ze&6)throw Error(he(331));var a=Ze;for(Ze|=4,Ee=e.current;Ee!==null;){var s=Ee,i=s.child;if(Ee.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Ee=u;Ee!==null;){var f=Ee;switch(f.tag){case 0:case 11:case 15:Hc(8,f,s)}var d=f.child;if(d!==null)d.return=f,Ee=d;else for(;Ee!==null;){f=Ee;var m=f.sibling,h=f.return;if(QS(f),f===u){Ee=null;break}if(m!==null){m.return=h,Ee=m;break}Ee=h}}}var g=s.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var y=p.sibling;p.sibling=null,p=y}while(p!==null)}}Ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ee=i;else e:for(;Ee!==null;){if(s=Ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hc(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ee=v;break e}Ee=s.return}}var x=e.current;for(Ee=x;Ee!==null;){i=Ee;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Ee=w;else e:for(i=x;Ee!==null;){if(o=Ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:jh(9,o)}}catch(b){$t(o,o.return,b)}if(o===i){Ee=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,Ee=S;break e}Ee=o.return}}if(Ze=a,ki(),Ga&&typeof Ga.onPostCommitFiberRoot=="function")try{Ga.onPostCommitFiberRoot(bh,e)}catch{}n=!0}return n}finally{dt=r,Xn.transition=t}}return!1}function Sx(e,t,r){t=Al(r,t),t=US(e,t,1),e=oi(e,t,1),t=Jr(),e!==null&&(Xu(e,1,t),un(e,t))}function $t(e,t,r){if(e.tag===3)Sx(e,e,r);else for(;t!==null;){if(t.tag===3){Sx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(li===null||!li.has(n))){e=Al(r,e),e=$S(t,e,1),t=oi(t,e,1),e=Jr(),t!==null&&(Xu(t,1,e),un(t,e));break}}t=t.return}}function IA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,pr===e&&(kr&r)===r&&(ir===4||ir===3&&(kr&130023424)===kr&&500>Yt()-m1?Yi(e,0):h1|=r),un(e,t)}function ok(e,t){t===0&&(e.mode&1?(t=Af,Af<<=1,!(Af&130023424)&&(Af=4194304)):t=1);var r=Jr();e=Ss(e,t),e!==null&&(Xu(e,t,r),un(e,r))}function OA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ok(e,r)}function FA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(t),ok(e,r)}var lk;lk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ln.current)on=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return on=!1,bA(e,t,r);on=!!(e.flags&131072)}else on=!1,Nt&&t.flags&1048576&&dS(t,Ud,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vd(e,t),e=t.pendingProps;var a=El(t,Ur.current);ol(t,r),a=o1(null,t,n,e,a,r);var s=l1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,cn(n)?(s=!0,Ld(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,r1(t),a.updater=Dh,t.stateNode=a,a._reactInternals=t,E0(t,n,e,r),t=C0(null,t,n,!0,s,r)):(t.tag=0,Nt&&s&&Kg(t),Xr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vd(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=BA(n),e=la(n,e),a){case 0:t=N0(null,t,n,e,r);break e;case 1:t=dx(null,t,n,e,r);break e;case 11:t=ux(null,t,n,e,r);break e;case 14:t=fx(null,t,n,la(n.type,e),r);break e}throw Error(he(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),N0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),dx(e,t,n,a,r);case 3:e:{if(zS(t),e===null)throw Error(he(387));n=t.pendingProps,s=t.memoizedState,a=s.element,yS(e,t),Hd(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Al(Error(he(423)),t),t=hx(e,t,n,r,a);break e}else if(n!==a){a=Al(Error(he(424)),t),t=hx(e,t,n,r,a);break e}else for(En=ii(t.stateNode.containerInfo.firstChild),Tn=t,Nt=!0,ha=null,r=gS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Tl(),n===a){t=ks(e,t,r);break e}Xr(e,t,n,r)}t=t.child}return t;case 5:return xS(t),e===null&&S0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,v0(n,a)?i=null:s!==null&&v0(n,s)&&(t.flags|=32),VS(e,t),Xr(e,t,i,r),t.child;case 6:return e===null&&S0(t),null;case 13:return GS(e,t,r);case 4:return n1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Nl(t,null,n,r):Xr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),ux(e,t,n,a,r);case 7:return Xr(e,t,t.pendingProps,r),t.child;case 8:return Xr(e,t,t.pendingProps.children,r),t.child;case 12:return Xr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,gt($d,n._currentValue),n._currentValue=i,s!==null)if(ka(s.value,i)){if(s.children===a.children&&!ln.current){t=ks(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ps(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),k0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(he(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),k0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Xr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ol(t,r),a=qn(a),n=n(a),t.flags|=1,Xr(e,t,n,r),t.child;case 14:return n=t.type,a=la(n,t.pendingProps),a=la(n.type,a),fx(e,t,n,a,r);case 15:return WS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),vd(e,t),t.tag=1,cn(n)?(e=!0,Ld(t)):e=!1,ol(t,r),BS(t,n,a),E0(t,n,a,r),C0(null,t,n,!0,e,r);case 19:return YS(e,t,r);case 22:return HS(e,t,r)}throw Error(he(156,t.tag))};function ck(e,t){return O_(e,t)}function LA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(e,t,r,n){return new LA(e,t,r,n)}function y1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function BA(e){if(typeof e=="function")return y1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fg)return 11;if(e===Lg)return 14}return 2}function ui(e,t){var r=e.alternate;return r===null?(r=Yn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function wd(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")y1(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case zo:return Xi(r.children,a,s,t);case Og:i=8,a|=8;break;case Kp:return e=Yn(12,r,t,a|2),e.elementType=Kp,e.lanes=s,e;case qp:return e=Yn(13,r,t,a),e.elementType=qp,e.lanes=s,e;case Qp:return e=Yn(19,r,t,a),e.elementType=Qp,e.lanes=s,e;case x_:return Mh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case v_:i=10;break e;case y_:i=9;break e;case Fg:i=11;break e;case Lg:i=14;break e;case Ws:i=16,n=null;break e}throw Error(he(130,e==null?e:typeof e,""))}return t=Yn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Xi(e,t,r,n){return e=Yn(7,e,n,t),e.lanes=r,e}function Mh(e,t,r,n){return e=Yn(22,e,n,t),e.elementType=x_,e.lanes=r,e.stateNode={isHidden:!1},e}function np(e,t,r){return e=Yn(6,e,null,t),e.lanes=r,e}function ap(e,t,r){return t=Yn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function UA(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lm(0),this.expirationTimes=Lm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lm(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function x1(e,t,r,n,a,s,i,o,l){return e=new UA(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Yn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},r1(s),e}function $A(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function uk(e){if(!e)return hi;e=e._reactInternals;e:{if(So(e)!==e||e.tag!==1)throw Error(he(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(cn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(he(171))}if(e.tag===1){var r=e.type;if(cn(r))return uS(e,r,t)}return t}function fk(e,t,r,n,a,s,i,o,l){return e=x1(r,n,!0,e,a,s,i,o,l),e.context=uk(null),r=e.current,n=Jr(),a=ci(r),s=ps(n,a),s.callback=t??null,oi(r,s,a),e.current.lanes=a,Xu(e,a,n),un(e,n),e}function Ih(e,t,r,n){var a=t.current,s=Jr(),i=ci(a);return r=uk(r),t.context===null?t.context=r:t.pendingContext=r,t=ps(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=oi(a,t,i),e!==null&&(xa(e,a,i,s),md(e,a,i)),i}function Qd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function kx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function w1(e,t){kx(e,t),(e=e.alternate)&&kx(e,t)}function WA(){return null}var dk=typeof reportError=="function"?reportError:function(e){console.error(e)};function _1(e){this._internalRoot=e}Oh.prototype.render=_1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(he(409));Ih(e,t,null,null)};Oh.prototype.unmount=_1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;so(function(){Ih(null,e,null,null)}),t[_s]=null}};function Oh(e){this._internalRoot=e}Oh.prototype.unstable_scheduleHydration=function(e){if(e){var t=H_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vs.length&&t!==0&&t<Vs[r].priority;r++);Vs.splice(r,0,e),r===0&&z_(e)}};function S1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Fh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function bx(){}function HA(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=Qd(i);s.call(u)}}var i=fk(t,n,e,0,null,!1,!1,"",bx);return e._reactRootContainer=i,e[_s]=i.current,uu(e.nodeType===8?e.parentNode:e),so(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=Qd(l);o.call(u)}}var l=x1(e,0,!1,null,null,!1,!1,"",bx);return e._reactRootContainer=l,e[_s]=l.current,uu(e.nodeType===8?e.parentNode:e),so(function(){Ih(t,l,r,n)}),l}function Lh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Qd(i);o.call(l)}}Ih(t,i,e,a)}else i=HA(r,t,e,a,n);return Qd(i)}$_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Pc(t.pendingLanes);r!==0&&($g(t,r|1),un(t,Yt()),!(Ze&6)&&(Pl=Yt()+500,ki()))}break;case 13:so(function(){var n=Ss(e,1);if(n!==null){var a=Jr();xa(n,e,1,a)}}),w1(e,1)}};Wg=function(e){if(e.tag===13){var t=Ss(e,134217728);if(t!==null){var r=Jr();xa(t,e,134217728,r)}w1(e,134217728)}};W_=function(e){if(e.tag===13){var t=ci(e),r=Ss(e,t);if(r!==null){var n=Jr();xa(r,e,t,n)}w1(e,t)}};H_=function(){return dt};V_=function(e,t){var r=dt;try{return dt=e,t()}finally{dt=r}};o0=function(e,t,r){switch(t){case"input":if(e0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Ch(n);if(!a)throw Error(he(90));__(n),e0(n,a)}}}break;case"textarea":k_(e,r);break;case"select":t=r.value,t!=null&&nl(e,!!r.multiple,t,!1)}};P_=p1;D_=so;var VA={usingClientEntryPoint:!1,Events:[qu,Ko,Ch,C_,A_,p1]},wc={findFiberByHostInstance:Ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zA={bundleType:wc.bundleType,version:wc.version,rendererPackageName:wc.rendererPackageName,rendererConfig:wc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=M_(e),e===null?null:e.stateNode},findFiberByHostInstance:wc.findFiberByHostInstance||WA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uf.isDisabled&&Uf.supportsFiber)try{bh=Uf.inject(zA),Ga=Uf}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VA;jn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S1(t))throw Error(he(200));return $A(e,t,null,r)};jn.createRoot=function(e,t){if(!S1(e))throw Error(he(299));var r=!1,n="",a=dk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=x1(e,1,!1,null,null,r,!1,n,a),e[_s]=t.current,uu(e.nodeType===8?e.parentNode:e),new _1(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(he(188)):(e=Object.keys(e).join(","),Error(he(268,e)));return e=M_(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return so(e)};jn.hydrate=function(e,t,r){if(!Fh(t))throw Error(he(200));return Lh(null,e,t,!0,r)};jn.hydrateRoot=function(e,t,r){if(!S1(e))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=dk;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=fk(t,null,e,1,r??null,a,!1,s,i),e[_s]=t.current,uu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Oh(t)};jn.render=function(e,t,r){if(!Fh(t))throw Error(he(200));return Lh(null,e,t,!1,r)};jn.unmountComponentAtNode=function(e){if(!Fh(e))throw Error(he(40));return e._reactRootContainer?(so(function(){Lh(null,null,e,!1,function(){e._reactRootContainer=null,e[_s]=null})}),!0):!1};jn.unstable_batchedUpdates=p1;jn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Fh(r))throw Error(he(200));if(e==null||e._reactInternals===void 0)throw Error(he(38));return Lh(e,t,r,!1,n)};jn.version="18.3.1-next-f1338f8080-20240426";function hk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hk)}catch(e){console.error(e)}}hk(),h_.exports=jn;var ko=h_.exports;const mk=t_(ko);var pk,Ex=ko;pk=Ex.createRoot,Ex.hydrateRoot;const GA=1,YA=1e6;let sp=0;function XA(){return sp=(sp+1)%Number.MAX_SAFE_INTEGER,sp.toString()}const ip=new Map,Tx=e=>{if(ip.has(e))return;const t=setTimeout(()=>{ip.delete(e),Gc({type:"REMOVE_TOAST",toastId:e})},YA);ip.set(e,t)},KA=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,GA)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Tx(r):e.toasts.forEach(n=>{Tx(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},_d=[];let Sd={toasts:[]};function Gc(e){Sd=KA(Sd,e),_d.forEach(t=>{t(Sd)})}function qA({...e}){const t=XA(),r=a=>Gc({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>Gc({type:"DISMISS_TOAST",toastId:t});return Gc({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function QA(){const[e,t]=_.useState(Sd);return _.useEffect(()=>(_d.push(t),()=>{const r=_d.indexOf(t);r>-1&&_d.splice(r,1)}),[e]),{...e,toast:qA,dismiss:r=>Gc({type:"DISMISS_TOAST",toastId:r})}}function Ne(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Nx(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function gk(...e){return t=>{let r=!1;const n=e.map(a=>{const s=Nx(a,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let a=0;a<n.length;a++){const s=n[a];typeof s=="function"?s():Nx(e[a],null)}}}}function Je(...e){return _.useCallback(gk(...e),e)}function JA(e,t){const r=_.createContext(t),n=s=>{const{children:i,...o}=s,l=_.useMemo(()=>o,Object.values(o));return c.jsx(r.Provider,{value:l,children:i})};n.displayName=e+"Provider";function a(s){const i=_.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,a]}function Mn(e,t=[]){let r=[];function n(s,i){const o=_.createContext(i),l=r.length;r=[...r,i];const u=d=>{var v;const{scope:m,children:h,...g}=d,p=((v=m==null?void 0:m[e])==null?void 0:v[l])||o,y=_.useMemo(()=>g,Object.values(g));return c.jsx(p.Provider,{value:y,children:h})};u.displayName=s+"Provider";function f(d,m){var p;const h=((p=m==null?void 0:m[e])==null?void 0:p[l])||o,g=_.useContext(h);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[u,f]}const a=()=>{const s=r.map(i=>_.createContext(i));return function(o){const l=(o==null?void 0:o[e])||s;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[n,ZA(a,...t)]}function ZA(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=n.reduce((o,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function io(e){const t=tP(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(nP);if(l){const u=l.props.children,f=o.map(d=>d===l?_.Children.count(u)>1?_.Children.only(null):_.isValidElement(u)?u.props.children:null:d);return c.jsx(t,{...i,ref:a,children:_.isValidElement(u)?_.cloneElement(u,void 0,f):null})}return c.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}var eP=io("Slot");function tP(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=sP(a),o=aP(s,a.props);return a.type!==_.Fragment&&(o.ref=n?gk(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var vk=Symbol("radix.slottable");function rP(e){const t=({children:r})=>c.jsx(c.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=vk,t}function nP(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===vk}function aP(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function sP(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function k1(e){const t=e+"CollectionProvider",[r,n]=Mn(t),[a,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:y,children:v}=p,x=ge.useRef(null),w=ge.useRef(new Map).current;return c.jsx(a,{scope:y,itemMap:w,collectionRef:x,children:v})};i.displayName=t;const o=e+"CollectionSlot",l=io(o),u=ge.forwardRef((p,y)=>{const{scope:v,children:x}=p,w=s(o,v),S=Je(y,w.collectionRef);return c.jsx(l,{ref:S,children:x})});u.displayName=o;const f=e+"CollectionItemSlot",d="data-radix-collection-item",m=io(f),h=ge.forwardRef((p,y)=>{const{scope:v,children:x,...w}=p,S=ge.useRef(null),b=Je(y,S),E=s(f,v);return ge.useEffect(()=>(E.itemMap.set(S,{ref:S,...w}),()=>void E.itemMap.delete(S))),c.jsx(m,{[d]:"",ref:b,children:x})});h.displayName=f;function g(p){const y=s(e+"CollectionConsumer",p);return ge.useCallback(()=>{const x=y.collectionRef.current;if(!x)return[];const w=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((E,k)=>w.indexOf(E.ref.current)-w.indexOf(k.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:u,ItemSlot:h},g,n]}var iP=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],De=iP.reduce((e,t)=>{const r=io(`Primitive.${t}`),n=_.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function yk(e,t){e&&ko.flushSync(()=>e.dispatchEvent(t))}function Jn(e){const t=_.useRef(e);return _.useEffect(()=>{t.current=e}),_.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function oP(e,t=globalThis==null?void 0:globalThis.document){const r=Jn(e);_.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var lP="DismissableLayer",U0="dismissableLayer.update",cP="dismissableLayer.pointerDownOutside",uP="dismissableLayer.focusOutside",Cx,xk=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Hl=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,onDismiss:o,...l}=e,u=_.useContext(xk),[f,d]=_.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=_.useState({}),g=Je(t,k=>d(k)),p=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=p.indexOf(y),x=f?p.indexOf(f):-1,w=u.layersWithOutsidePointerEventsDisabled.size>0,S=x>=v,b=dP(k=>{const T=k.target,N=[...u.branches].some(I=>I.contains(T));!S||N||(a==null||a(k),i==null||i(k),k.defaultPrevented||o==null||o())},m),E=hP(k=>{const T=k.target;[...u.branches].some(I=>I.contains(T))||(s==null||s(k),i==null||i(k),k.defaultPrevented||o==null||o())},m);return oP(k=>{x===u.layers.size-1&&(n==null||n(k),!k.defaultPrevented&&o&&(k.preventDefault(),o()))},m),_.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Cx=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Ax(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=Cx)}},[f,m,r,u]),_.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Ax())},[f,u]),_.useEffect(()=>{const k=()=>h({});return document.addEventListener(U0,k),()=>document.removeEventListener(U0,k)},[]),c.jsx(De.div,{...l,ref:g,style:{pointerEvents:w?S?"auto":"none":void 0,...e.style},onFocusCapture:Ne(e.onFocusCapture,E.onFocusCapture),onBlurCapture:Ne(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Ne(e.onPointerDownCapture,b.onPointerDownCapture)})});Hl.displayName=lP;var fP="DismissableLayerBranch",wk=_.forwardRef((e,t)=>{const r=_.useContext(xk),n=_.useRef(null),a=Je(t,n);return _.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),c.jsx(De.div,{...e,ref:a})});wk.displayName=fP;function dP(e,t=globalThis==null?void 0:globalThis.document){const r=Jn(e),n=_.useRef(!1),a=_.useRef(()=>{});return _.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){_k(cP,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function hP(e,t=globalThis==null?void 0:globalThis.document){const r=Jn(e),n=_.useRef(!1);return _.useEffect(()=>{const a=s=>{s.target&&!n.current&&_k(uP,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Ax(){const e=new CustomEvent(U0);document.dispatchEvent(e)}function _k(e,t,r,{discrete:n}){const a=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?yk(a,s):a.dispatchEvent(s)}var mP=Hl,pP=wk,gr=globalThis!=null&&globalThis.document?_.useLayoutEffect:()=>{},gP="Portal",Ju=_.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[a,s]=_.useState(!1);gr(()=>s(!0),[]);const i=r||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?mk.createPortal(c.jsx(De.div,{...n,ref:t}),i):null});Ju.displayName=gP;function vP(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var Ca=e=>{const{present:t,children:r}=e,n=yP(t),a=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),s=Je(n.ref,xP(a));return typeof r=="function"||n.isPresent?_.cloneElement(a,{ref:s}):null};Ca.displayName="Presence";function yP(e){const[t,r]=_.useState(),n=_.useRef(null),a=_.useRef(e),s=_.useRef("none"),i=e?"mounted":"unmounted",[o,l]=vP(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const u=$f(n.current);s.current=o==="mounted"?u:"none"},[o]),gr(()=>{const u=n.current,f=a.current;if(f!==e){const m=s.current,h=$f(u);e?l("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(f&&m!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),gr(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=h=>{const p=$f(n.current).includes(CSS.escape(h.animationName));if(h.target===t&&p&&(l("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},m=h=>{h.target===t&&(s.current=$f(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function $f(e){return(e==null?void 0:e.animationName)||"none"}function xP(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var wP=jg[" useInsertionEffect ".trim().toString()]||gr;function qa({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,s,i]=_P({defaultProp:t,onChange:r}),o=e!==void 0,l=o?e:a;{const f=_.useRef(e!==void 0);_.useEffect(()=>{const d=f.current;d!==o&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=o},[o,n])}const u=_.useCallback(f=>{var d;if(o){const m=SP(f)?f(e):f;m!==e&&((d=i.current)==null||d.call(i,m))}else s(f)},[o,e,s,i]);return[l,u]}function _P({defaultProp:e,onChange:t}){const[r,n]=_.useState(e),a=_.useRef(r),s=_.useRef(t);return wP(()=>{s.current=t},[t]),_.useEffect(()=>{var i;a.current!==r&&((i=s.current)==null||i.call(s,r),a.current=r)},[r,a]),[r,n,s]}function SP(e){return typeof e=="function"}var Sk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),kP="VisuallyHidden",Bh=_.forwardRef((e,t)=>c.jsx(De.span,{...e,ref:t,style:{...Sk,...e.style}}));Bh.displayName=kP;var bP=Bh,b1="ToastProvider",[E1,EP,TP]=k1("Toast"),[kk,Qq]=Mn("Toast",[TP]),[NP,Uh]=kk(b1),bk=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:i}=e,[o,l]=_.useState(null),[u,f]=_.useState(0),d=_.useRef(!1),m=_.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${b1}\`. Expected non-empty \`string\`.`),c.jsx(E1.Provider,{scope:t,children:c.jsx(NP,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:s,toastCount:u,viewport:o,onViewportChange:l,onToastAdd:_.useCallback(()=>f(h=>h+1),[]),onToastRemove:_.useCallback(()=>f(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:m,children:i})})};bk.displayName=b1;var Ek="ToastViewport",CP=["F8"],$0="toast.viewportPause",W0="toast.viewportResume",Tk=_.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=CP,label:a="Notifications ({hotkey})",...s}=e,i=Uh(Ek,r),o=EP(r),l=_.useRef(null),u=_.useRef(null),f=_.useRef(null),d=_.useRef(null),m=Je(t,d,i.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;_.useEffect(()=>{const y=v=>{var w;n.length!==0&&n.every(S=>v[S]||v.code===S)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),_.useEffect(()=>{const y=l.current,v=d.current;if(g&&y&&v){const x=()=>{if(!i.isClosePausedRef.current){const E=new CustomEvent($0);v.dispatchEvent(E),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const E=new CustomEvent(W0);v.dispatchEvent(E),i.isClosePausedRef.current=!1}},S=E=>{!y.contains(E.relatedTarget)&&w()},b=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",x),y.addEventListener("focusout",S),y.addEventListener("pointermove",x),y.addEventListener("pointerleave",b),window.addEventListener("blur",x),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",x),y.removeEventListener("focusout",S),y.removeEventListener("pointermove",x),y.removeEventListener("pointerleave",b),window.removeEventListener("blur",x),window.removeEventListener("focus",w)}}},[g,i.isClosePausedRef]);const p=_.useCallback(({tabbingDirection:y})=>{const x=o().map(w=>{const S=w.ref.current,b=[S,...$P(S)];return y==="forwards"?b:b.reverse()});return(y==="forwards"?x.reverse():x).flat()},[o]);return _.useEffect(()=>{const y=d.current;if(y){const v=x=>{var b,E,k;const w=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!w){const T=document.activeElement,N=x.shiftKey;if(x.target===y&&N){(b=u.current)==null||b.focus();return}const j=p({tabbingDirection:N?"backwards":"forwards"}),z=j.findIndex(K=>K===T);op(j.slice(z+1))?x.preventDefault():N?(E=u.current)==null||E.focus():(k=f.current)==null||k.focus()}};return y.addEventListener("keydown",v),()=>y.removeEventListener("keydown",v)}},[o,p]),c.jsxs(pP,{ref:l,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&c.jsx(H0,{ref:u,onFocusFromOutsideViewport:()=>{const y=p({tabbingDirection:"forwards"});op(y)}}),c.jsx(E1.Slot,{scope:r,children:c.jsx(De.ol,{tabIndex:-1,...s,ref:m})}),g&&c.jsx(H0,{ref:f,onFocusFromOutsideViewport:()=>{const y=p({tabbingDirection:"backwards"});op(y)}})]})});Tk.displayName=Ek;var Nk="ToastFocusProxy",H0=_.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,s=Uh(Nk,r);return c.jsx(Bh,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:i=>{var u;const o=i.relatedTarget;!((u=s.viewport)!=null&&u.contains(o))&&n()}})});H0.displayName=Nk;var Zu="Toast",AP="toast.swipeStart",PP="toast.swipeMove",DP="toast.swipeCancel",jP="toast.swipeEnd",Ck=_.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:s,...i}=e,[o,l]=qa({prop:n,defaultProp:a??!0,onChange:s,caller:Zu});return c.jsx(Ca,{present:r||o,children:c.jsx(IP,{open:o,...i,ref:t,onClose:()=>l(!1),onPause:Jn(e.onPause),onResume:Jn(e.onResume),onSwipeStart:Ne(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ne(e.onSwipeMove,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Ne(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ne(e.onSwipeEnd,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});Ck.displayName=Zu;var[RP,MP]=kk(Zu,{onClose(){}}),IP=_.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:s,onClose:i,onEscapeKeyDown:o,onPause:l,onResume:u,onSwipeStart:f,onSwipeMove:d,onSwipeCancel:m,onSwipeEnd:h,...g}=e,p=Uh(Zu,r),[y,v]=_.useState(null),x=Je(t,K=>v(K)),w=_.useRef(null),S=_.useRef(null),b=a||p.duration,E=_.useRef(0),k=_.useRef(b),T=_.useRef(0),{onToastAdd:N,onToastRemove:I}=p,H=Jn(()=>{var q;(y==null?void 0:y.contains(document.activeElement))&&((q=p.viewport)==null||q.focus()),i()}),j=_.useCallback(K=>{!K||K===1/0||(window.clearTimeout(T.current),E.current=new Date().getTime(),T.current=window.setTimeout(H,K))},[H]);_.useEffect(()=>{const K=p.viewport;if(K){const q=()=>{j(k.current),u==null||u()},Q=()=>{const X=new Date().getTime()-E.current;k.current=k.current-X,window.clearTimeout(T.current),l==null||l()};return K.addEventListener($0,Q),K.addEventListener(W0,q),()=>{K.removeEventListener($0,Q),K.removeEventListener(W0,q)}}},[p.viewport,b,l,u,j]),_.useEffect(()=>{s&&!p.isClosePausedRef.current&&j(b)},[s,b,p.isClosePausedRef,j]),_.useEffect(()=>(N(),()=>I()),[N,I]);const z=_.useMemo(()=>y?Ik(y):null,[y]);return p.viewport?c.jsxs(c.Fragment,{children:[z&&c.jsx(OP,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:z}),c.jsx(RP,{scope:r,onClose:H,children:ko.createPortal(c.jsx(E1.ItemSlot,{scope:r,children:c.jsx(mP,{asChild:!0,onEscapeKeyDown:Ne(o,()=>{p.isFocusedToastEscapeKeyDownRef.current||H(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:c.jsx(De.li,{tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":p.swipeDirection,...g,ref:x,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ne(e.onKeyDown,K=>{K.key==="Escape"&&(o==null||o(K.nativeEvent),K.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,H()))}),onPointerDown:Ne(e.onPointerDown,K=>{K.button===0&&(w.current={x:K.clientX,y:K.clientY})}),onPointerMove:Ne(e.onPointerMove,K=>{if(!w.current)return;const q=K.clientX-w.current.x,Q=K.clientY-w.current.y,X=!!S.current,F=["left","right"].includes(p.swipeDirection),P=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,Z=F?P(0,q):0,le=F?0:P(0,Q),D=K.pointerType==="touch"?10:2,V={x:Z,y:le},O={originalEvent:K,delta:V};X?(S.current=V,Wf(PP,d,O,{discrete:!1})):Px(V,p.swipeDirection,D)?(S.current=V,Wf(AP,f,O,{discrete:!1}),K.target.setPointerCapture(K.pointerId)):(Math.abs(q)>D||Math.abs(Q)>D)&&(w.current=null)}),onPointerUp:Ne(e.onPointerUp,K=>{const q=S.current,Q=K.target;if(Q.hasPointerCapture(K.pointerId)&&Q.releasePointerCapture(K.pointerId),S.current=null,w.current=null,q){const X=K.currentTarget,F={originalEvent:K,delta:q};Px(q,p.swipeDirection,p.swipeThreshold)?Wf(jP,h,F,{discrete:!0}):Wf(DP,m,F,{discrete:!0}),X.addEventListener("click",P=>P.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),OP=e=>{const{__scopeToast:t,children:r,...n}=e,a=Uh(Zu,t),[s,i]=_.useState(!1),[o,l]=_.useState(!1);return BP(()=>i(!0)),_.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),o?null:c.jsx(Ju,{asChild:!0,children:c.jsx(Bh,{...n,children:s&&c.jsxs(c.Fragment,{children:[a.label," ",r]})})})},FP="ToastTitle",Ak=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(De.div,{...n,ref:t})});Ak.displayName=FP;var LP="ToastDescription",Pk=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(De.div,{...n,ref:t})});Pk.displayName=LP;var Dk="ToastAction",jk=_.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?c.jsx(Mk,{altText:r,asChild:!0,children:c.jsx(T1,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Dk}\`. Expected non-empty \`string\`.`),null)});jk.displayName=Dk;var Rk="ToastClose",T1=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=MP(Rk,r);return c.jsx(Mk,{asChild:!0,children:c.jsx(De.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,a.onClose)})})});T1.displayName=Rk;var Mk=_.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return c.jsx(De.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function Ik(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),UP(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...Ik(n))}}),t}function Wf(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?yk(a,s):a.dispatchEvent(s)}var Px=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),s=n>a;return t==="left"||t==="right"?s&&n>r:!s&&a>r};function BP(e=()=>{}){const t=Jn(e);gr(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function UP(e){return e.nodeType===e.ELEMENT_NODE}function $P(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function op(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var WP=bk,Ok=Tk,Fk=Ck,Lk=Ak,Bk=Pk,Uk=jk,$k=T1;function Wk(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Wk(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Hk(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Wk(e))&&(n&&(n+=" "),n+=t);return n}const Dx=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,jx=Hk,ef=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return jx(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:s}=t,i=Object.keys(a).map(u=>{const f=r==null?void 0:r[u],d=s==null?void 0:s[u];if(f===null)return null;const m=Dx(f)||Dx(d);return a[u][m]}),o=r&&Object.entries(r).reduce((u,f)=>{let[d,m]=f;return m===void 0||(u[d]=m),u},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:d,className:m,...h}=f;return Object.entries(h).every(g=>{let[p,y]=g;return Array.isArray(y)?y.includes({...s,...o}[p]):{...s,...o}[p]===y})?[...u,d,m]:u},[]);return jx(e,i,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vk=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var VP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>_.createElement("svg",{ref:l,...VP,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Vk("lucide",a),...o},[...i.map(([u,f])=>_.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(e,t)=>{const r=_.forwardRef(({className:n,...a},s)=>_.createElement(zP,{ref:s,iconNode:t,className:Vk(`lucide-${HP(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=$e("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=$e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=$e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=$e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=$e("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=$e("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=$e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=$e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N1=$e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=$e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=$e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=$e("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=$e("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=$e("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=$e("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=$e("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=$e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=$e("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=$e("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=$e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=$e("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=$e("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=$e("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=$e("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=$e("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=$e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=$e("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=$e("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=$e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=$e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=$e("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=$e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=$e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=$e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=$e("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=$e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=$e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=$e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=$e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=$e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=$e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=$e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=$e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),D1="-",o6=e=>{const t=c6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split(D1);return o[0]===""&&o.length!==1&&o.shift(),Jk(o,t)||l6(i)},getConflictingClassGroupIds:(i,o)=>{const l=r[i]||[];return o&&n[i]?[...l,...n[i]]:l}}},Jk=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?Jk(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join(D1);return(i=t.validators.find(({validator:o})=>o(s)))==null?void 0:i.classGroupId},Rx=/^\[(.+)\]$/,l6=e=>{if(Rx.test(e)){const t=Rx.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},c6=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return f6(Object.entries(e.classGroups),r).forEach(([s,i])=>{X0(i,n,s,t)}),n},X0=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:Mx(t,a);s.classGroupId=r;return}if(typeof a=="function"){if(u6(a)){X0(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([s,i])=>{X0(i,Mx(t,s),r,n)})})},Mx=(e,t)=>{let r=e;return t.split(D1).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},u6=e=>e.isThemeGetter,f6=(e,t)=>t?e.map(([r,n])=>{const a=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,o])=>[t+i,o])):s);return[r,a]}):e,d6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return a(s,i),i},set(s,i){r.has(s)?r.set(s,i):a(s,i)}}},Zk="!",h6=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],s=t.length,i=o=>{const l=[];let u=0,f=0,d;for(let y=0;y<o.length;y++){let v=o[y];if(u===0){if(v===a&&(n||o.slice(y,y+s)===t)){l.push(o.slice(f,y)),f=y+s;continue}if(v==="/"){d=y;continue}}v==="["?u++:v==="]"&&u--}const m=l.length===0?o:o.substring(f),h=m.startsWith(Zk),g=h?m.substring(1):m,p=d&&d>f?d-f:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:g,maybePostfixModifierPosition:p}};return r?o=>r({className:o,parseClassName:i}):i},m6=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},p6=e=>({cache:d6(e.cacheSize),parseClassName:h6(e),...o6(e)}),g6=/\s+/,v6=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split(g6);let o="";for(let l=i.length-1;l>=0;l-=1){const u=i[l],{modifiers:f,hasImportantModifier:d,baseClassName:m,maybePostfixModifierPosition:h}=r(u);let g=!!h,p=n(g?m.substring(0,h):m);if(!p){if(!g){o=u+(o.length>0?" "+o:o);continue}if(p=n(m),!p){o=u+(o.length>0?" "+o:o);continue}g=!1}const y=m6(f).join(":"),v=d?y+Zk:y,x=v+p;if(s.includes(x))continue;s.push(x);const w=a(p,g);for(let S=0;S<w.length;++S){const b=w[S];s.push(v+b)}o=u+(o.length>0?" "+o:o)}return o};function y6(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=eb(t))&&(n&&(n+=" "),n+=r);return n}const eb=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=eb(e[n]))&&(r&&(r+=" "),r+=t);return r};function x6(e,...t){let r,n,a,s=i;function i(l){const u=t.reduce((f,d)=>d(f),e());return r=p6(u),n=r.cache.get,a=r.cache.set,s=o,o(l)}function o(l){const u=n(l);if(u)return u;const f=v6(l,r);return a(l,f),f}return function(){return s(y6.apply(null,arguments))}}const yt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},tb=/^\[(?:([a-z-]+):)?(.+)\]$/i,w6=/^\d+\/\d+$/,_6=new Set(["px","full","screen"]),S6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,k6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,b6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,E6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,T6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,as=e=>cl(e)||_6.has(e)||w6.test(e),Is=e=>zl(e,"length",M6),cl=e=>!!e&&!Number.isNaN(Number(e)),cp=e=>zl(e,"number",cl),_c=e=>!!e&&Number.isInteger(Number(e)),N6=e=>e.endsWith("%")&&cl(e.slice(0,-1)),Ve=e=>tb.test(e),Os=e=>S6.test(e),C6=new Set(["length","size","percentage"]),A6=e=>zl(e,C6,rb),P6=e=>zl(e,"position",rb),D6=new Set(["image","url"]),j6=e=>zl(e,D6,O6),R6=e=>zl(e,"",I6),Sc=()=>!0,zl=(e,t,r)=>{const n=tb.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},M6=e=>k6.test(e)&&!b6.test(e),rb=()=>!1,I6=e=>E6.test(e),O6=e=>T6.test(e),F6=()=>{const e=yt("colors"),t=yt("spacing"),r=yt("blur"),n=yt("brightness"),a=yt("borderColor"),s=yt("borderRadius"),i=yt("borderSpacing"),o=yt("borderWidth"),l=yt("contrast"),u=yt("grayscale"),f=yt("hueRotate"),d=yt("invert"),m=yt("gap"),h=yt("gradientColorStops"),g=yt("gradientColorStopPositions"),p=yt("inset"),y=yt("margin"),v=yt("opacity"),x=yt("padding"),w=yt("saturate"),S=yt("scale"),b=yt("sepia"),E=yt("skew"),k=yt("space"),T=yt("translate"),N=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",Ve,t],j=()=>[Ve,t],z=()=>["",as,Is],K=()=>["auto",cl,Ve],q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],X=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>["start","end","center","between","around","evenly","stretch"],P=()=>["","0",Ve],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],le=()=>[cl,Ve];return{cacheSize:500,separator:":",theme:{colors:[Sc],spacing:[as,Is],blur:["none","",Os,Ve],brightness:le(),borderColor:[e],borderRadius:["none","","full",Os,Ve],borderSpacing:j(),borderWidth:z(),contrast:le(),grayscale:P(),hueRotate:le(),invert:P(),gap:j(),gradientColorStops:[e],gradientColorStopPositions:[N6,Is],inset:H(),margin:H(),opacity:le(),padding:j(),saturate:le(),scale:le(),sepia:P(),skew:le(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",Ve]}],container:["container"],columns:[{columns:[Os]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...q(),Ve]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",_c,Ve]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ve]}],grow:[{grow:P()}],shrink:[{shrink:P()}],order:[{order:["first","last","none",_c,Ve]}],"grid-cols":[{"grid-cols":[Sc]}],"col-start-end":[{col:["auto",{span:["full",_c,Ve]},Ve]}],"col-start":[{"col-start":K()}],"col-end":[{"col-end":K()}],"grid-rows":[{"grid-rows":[Sc]}],"row-start-end":[{row:["auto",{span:[_c,Ve]},Ve]}],"row-start":[{"row-start":K()}],"row-end":[{"row-end":K()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...F()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...F(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...F(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ve,t]}],"min-w":[{"min-w":[Ve,t,"min","max","fit"]}],"max-w":[{"max-w":[Ve,t,"none","full","min","max","fit","prose",{screen:[Os]},Os]}],h:[{h:[Ve,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ve,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ve,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ve,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Os,Is]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",cp]}],"font-family":[{font:[Sc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ve]}],"line-clamp":[{"line-clamp":["none",cl,cp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",as,Ve]}],"list-image":[{"list-image":["none",Ve]}],"list-style-type":[{list:["none","disc","decimal",Ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",as,Is]}],"underline-offset":[{"underline-offset":["auto",as,Ve]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...q(),P6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",A6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},j6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:Q()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[as,Ve]}],"outline-w":[{outline:[as,Is]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[as,Is]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Os,R6]}],"shadow-color":[{shadow:[Sc]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...X(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":X()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Os,Ve]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ve]}],duration:[{duration:le()}],ease:[{ease:["linear","in","out","in-out",Ve]}],delay:[{delay:le()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[_c,Ve]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ve]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ve]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ve]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[as,Is,cp]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},L6=x6(F6);function Ce(...e){return L6(Hk(e))}const B6=WP,nb=_.forwardRef(({className:e,...t},r)=>c.jsx(Ok,{ref:r,className:Ce("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));nb.displayName=Ok.displayName;const U6=ef("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ab=_.forwardRef(({className:e,variant:t,...r},n)=>c.jsx(Fk,{ref:n,className:Ce(U6({variant:t}),e),...r}));ab.displayName=Fk.displayName;const $6=_.forwardRef(({className:e,...t},r)=>c.jsx(Uk,{ref:r,className:Ce("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));$6.displayName=Uk.displayName;const sb=_.forwardRef(({className:e,...t},r)=>c.jsx($k,{ref:r,className:Ce("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:c.jsx(Vl,{className:"h-4 w-4"})}));sb.displayName=$k.displayName;const ib=_.forwardRef(({className:e,...t},r)=>c.jsx(Lk,{ref:r,className:Ce("text-sm font-semibold",e),...t}));ib.displayName=Lk.displayName;const ob=_.forwardRef(({className:e,...t},r)=>c.jsx(Bk,{ref:r,className:Ce("text-sm opacity-90",e),...t}));ob.displayName=Bk.displayName;function W6(){const{toasts:e}=QA();return c.jsxs(B6,{children:[e.map(function({id:t,title:r,description:n,action:a,...s}){return c.jsxs(ab,{...s,children:[c.jsxs("div",{className:"grid gap-1",children:[r&&c.jsx(ib,{children:r}),n&&c.jsx(ob,{children:n})]}),a,c.jsx(sb,{})]},t)}),c.jsx(nb,{})]})}var Ix=["light","dark"],H6="(prefers-color-scheme: dark)",V6=_.createContext(void 0),z6={setTheme:e=>{},themes:[]},G6=()=>{var e;return(e=_.useContext(V6))!=null?e:z6};_.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:s,value:i,attrs:o,nonce:l})=>{let u=s==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,d=a?Ix.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(g,p=!1,y=!0)=>{let v=i?i[g]:g,x=p?g+"|| ''":`'${v}'`,w="";return a&&y&&!p&&Ix.includes(g)&&(w+=`d.style.colorScheme = '${g}';`),r==="class"?p||v?w+=`c.add(${x})`:w+="null":v&&(w+=`d[s](n,${x})`),w},h=e?`!function(){${f}${m(e)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${H6}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${m(i?"x[e]":"e",!0)}}${u?"":"else{"+m(s,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${m(i?"x[e]":"e",!0)}}else{${m(s,!1,!1)};}${d}}catch(t){}}();`;return _.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:h}})});var Y6=e=>{switch(e){case"success":return q6;case"info":return J6;case"warning":return Q6;case"error":return Z6;default:return null}},X6=Array(12).fill(0),K6=({visible:e,className:t})=>ge.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ge.createElement("div",{className:"sonner-spinner"},X6.map((r,n)=>ge.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),q6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Q6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),J6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Z6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),eD=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ge.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ge.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),tD=()=>{let[e,t]=ge.useState(document.hidden);return ge.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},K0=1,rD=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:K0++,s=this.toasts.find(o=>o.id===a),i=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(o=>o.id===a?(this.publish({...o,...e,id:a,title:r}),{...o,...e,id:a,dismissible:i,title:r}):o):this.addToast({title:r,...n,dismissible:i,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0,s,i=n.then(async l=>{if(s=["resolve",l],ge.isValidElement(l))a=!1,this.create({id:r,type:"default",message:l});else if(aD(l)&&!l.ok){a=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:u,description:f})}else if(t.success!==void 0){a=!1;let u=typeof t.success=="function"?await t.success(l):t.success,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:u,description:f})}}).catch(async l=>{if(s=["reject",l],t.error!==void 0){a=!1;let u=typeof t.error=="function"?await t.error(l):t.error,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:u,description:f})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),o=()=>new Promise((l,u)=>i.then(()=>s[0]==="reject"?u(s[1]):l(s[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:o}:Object.assign(r,{unwrap:o})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||K0++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},nn=new rD,nD=(e,t)=>{let r=(t==null?void 0:t.id)||K0++;return nn.addToast({title:e,...t,id:r}),r},aD=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",sD=nD,iD=()=>nn.toasts,oD=()=>nn.getActiveToasts(),Se=Object.assign(sD,{success:nn.success,info:nn.info,warning:nn.warning,error:nn.error,custom:nn.custom,message:nn.message,promise:nn.promise,dismiss:nn.dismiss,loading:nn.loading},{getHistory:iD,getToasts:oD});function lD(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}lD(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Hf(e){return e.label!==void 0}var cD=3,uD="32px",fD="16px",Ox=4e3,dD=356,hD=14,mD=20,pD=200;function sa(...e){return e.filter(Boolean).join(" ")}function gD(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var vD=e=>{var t,r,n,a,s,i,o,l,u,f,d;let{invert:m,toast:h,unstyled:g,interacting:p,setHeights:y,visibleToasts:v,heights:x,index:w,toasts:S,expanded:b,removeToast:E,defaultRichColors:k,closeButton:T,style:N,cancelButtonStyle:I,actionButtonStyle:H,className:j="",descriptionClassName:z="",duration:K,position:q,gap:Q,loadingIcon:X,expandByDefault:F,classNames:P,icons:Z,closeButtonAriaLabel:le="Close toast",pauseWhenPageIsHidden:D}=e,[V,O]=ge.useState(null),[L,Y]=ge.useState(null),[G,ie]=ge.useState(!1),[se,ae]=ge.useState(!1),[J,A]=ge.useState(!1),[me,ke]=ge.useState(!1),[We,Me]=ge.useState(!1),[xe,mt]=ge.useState(0),[nr,pn]=ge.useState(0),Hr=ge.useRef(h.duration||K||Ox),js=ge.useRef(null),Er=ge.useRef(null),Vr=w===0,na=w+1<=v,zt=h.type,In=h.dismissible!==!1,vr=h.className||"",On=h.descriptionClassName||"",Be=ge.useMemo(()=>x.findIndex(Fe=>Fe.toastId===h.id)||0,[x,h.id]),Ct=ge.useMemo(()=>{var Fe;return(Fe=h.closeButton)!=null?Fe:T},[h.closeButton,T]),zr=ge.useMemo(()=>h.duration||K||Ox,[h.duration,K]),At=ge.useRef(0),rn=ge.useRef(0),ic=ge.useRef(0),Rs=ge.useRef(null),[Cm,Sf]=q.split("-"),oc=ge.useMemo(()=>x.reduce((Fe,st,pt)=>pt>=Be?Fe:Fe+st.height,0),[x,Be]),lc=tD(),Am=h.invert||m,cc=zt==="loading";rn.current=ge.useMemo(()=>Be*Q+oc,[Be,oc]),ge.useEffect(()=>{Hr.current=zr},[zr]),ge.useEffect(()=>{ie(!0)},[]),ge.useEffect(()=>{let Fe=Er.current;if(Fe){let st=Fe.getBoundingClientRect().height;return pn(st),y(pt=>[{toastId:h.id,height:st,position:h.position},...pt]),()=>y(pt=>pt.filter(vn=>vn.toastId!==h.id))}},[y,h.id]),ge.useLayoutEffect(()=>{if(!G)return;let Fe=Er.current,st=Fe.style.height;Fe.style.height="auto";let pt=Fe.getBoundingClientRect().height;Fe.style.height=st,pn(pt),y(vn=>vn.find(yn=>yn.toastId===h.id)?vn.map(yn=>yn.toastId===h.id?{...yn,height:pt}:yn):[{toastId:h.id,height:pt,position:h.position},...vn])},[G,h.title,h.description,y,h.id]);let gn=ge.useCallback(()=>{ae(!0),mt(rn.current),y(Fe=>Fe.filter(st=>st.toastId!==h.id)),setTimeout(()=>{E(h)},pD)},[h,E,y,rn]);ge.useEffect(()=>{if(h.promise&&zt==="loading"||h.duration===1/0||h.type==="loading")return;let Fe;return b||p||D&&lc?(()=>{if(ic.current<At.current){let st=new Date().getTime()-At.current;Hr.current=Hr.current-st}ic.current=new Date().getTime()})():Hr.current!==1/0&&(At.current=new Date().getTime(),Fe=setTimeout(()=>{var st;(st=h.onAutoClose)==null||st.call(h,h),gn()},Hr.current)),()=>clearTimeout(Fe)},[b,p,h,zt,D,lc,gn]),ge.useEffect(()=>{h.delete&&gn()},[gn,h.delete]);function Pm(){var Fe,st,pt;return Z!=null&&Z.loading?ge.createElement("div",{className:sa(P==null?void 0:P.loader,(Fe=h==null?void 0:h.classNames)==null?void 0:Fe.loader,"sonner-loader"),"data-visible":zt==="loading"},Z.loading):X?ge.createElement("div",{className:sa(P==null?void 0:P.loader,(st=h==null?void 0:h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":zt==="loading"},X):ge.createElement(K6,{className:sa(P==null?void 0:P.loader,(pt=h==null?void 0:h.classNames)==null?void 0:pt.loader),visible:zt==="loading"})}return ge.createElement("li",{tabIndex:0,ref:Er,className:sa(j,vr,P==null?void 0:P.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,P==null?void 0:P.default,P==null?void 0:P[zt],(r=h==null?void 0:h.classNames)==null?void 0:r[zt]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:k,"data-styled":!(h.jsx||h.unstyled||g),"data-mounted":G,"data-promise":!!h.promise,"data-swiped":We,"data-removed":se,"data-visible":na,"data-y-position":Cm,"data-x-position":Sf,"data-index":w,"data-front":Vr,"data-swiping":J,"data-dismissible":In,"data-type":zt,"data-invert":Am,"data-swipe-out":me,"data-swipe-direction":L,"data-expanded":!!(b||F&&G),style:{"--index":w,"--toasts-before":w,"--z-index":S.length-w,"--offset":`${se?xe:rn.current}px`,"--initial-height":F?"auto":`${nr}px`,...N,...h.style},onDragEnd:()=>{A(!1),O(null),Rs.current=null},onPointerDown:Fe=>{cc||!In||(js.current=new Date,mt(rn.current),Fe.target.setPointerCapture(Fe.pointerId),Fe.target.tagName!=="BUTTON"&&(A(!0),Rs.current={x:Fe.clientX,y:Fe.clientY}))},onPointerUp:()=>{var Fe,st,pt,vn;if(me||!In)return;Rs.current=null;let yn=Number(((Fe=Er.current)==null?void 0:Fe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Pa=Number(((st=Er.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),rs=new Date().getTime()-((pt=js.current)==null?void 0:pt.getTime()),Gr=V==="x"?yn:Pa,Da=Math.abs(Gr)/rs;if(Math.abs(Gr)>=mD||Da>.11){mt(rn.current),(vn=h.onDismiss)==null||vn.call(h,h),Y(V==="x"?yn>0?"right":"left":Pa>0?"down":"up"),gn(),ke(!0),Me(!1);return}A(!1),O(null)},onPointerMove:Fe=>{var st,pt,vn,yn;if(!Rs.current||!In||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;let Pa=Fe.clientY-Rs.current.y,rs=Fe.clientX-Rs.current.x,Gr=(pt=e.swipeDirections)!=null?pt:gD(q);!V&&(Math.abs(rs)>1||Math.abs(Pa)>1)&&O(Math.abs(rs)>Math.abs(Pa)?"x":"y");let Da={x:0,y:0};V==="y"?(Gr.includes("top")||Gr.includes("bottom"))&&(Gr.includes("top")&&Pa<0||Gr.includes("bottom")&&Pa>0)&&(Da.y=Pa):V==="x"&&(Gr.includes("left")||Gr.includes("right"))&&(Gr.includes("left")&&rs<0||Gr.includes("right")&&rs>0)&&(Da.x=rs),(Math.abs(Da.x)>0||Math.abs(Da.y)>0)&&Me(!0),(vn=Er.current)==null||vn.style.setProperty("--swipe-amount-x",`${Da.x}px`),(yn=Er.current)==null||yn.style.setProperty("--swipe-amount-y",`${Da.y}px`)}},Ct&&!h.jsx?ge.createElement("button",{"aria-label":le,"data-disabled":cc,"data-close-button":!0,onClick:cc||!In?()=>{}:()=>{var Fe;gn(),(Fe=h.onDismiss)==null||Fe.call(h,h)},className:sa(P==null?void 0:P.closeButton,(a=h==null?void 0:h.classNames)==null?void 0:a.closeButton)},(s=Z==null?void 0:Z.close)!=null?s:eD):null,h.jsx||_.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:ge.createElement(ge.Fragment,null,zt||h.icon||h.promise?ge.createElement("div",{"data-icon":"",className:sa(P==null?void 0:P.icon,(i=h==null?void 0:h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Pm():null,h.type!=="loading"?h.icon||(Z==null?void 0:Z[zt])||Y6(zt):null):null,ge.createElement("div",{"data-content":"",className:sa(P==null?void 0:P.content,(o=h==null?void 0:h.classNames)==null?void 0:o.content)},ge.createElement("div",{"data-title":"",className:sa(P==null?void 0:P.title,(l=h==null?void 0:h.classNames)==null?void 0:l.title)},typeof h.title=="function"?h.title():h.title),h.description?ge.createElement("div",{"data-description":"",className:sa(z,On,P==null?void 0:P.description,(u=h==null?void 0:h.classNames)==null?void 0:u.description)},typeof h.description=="function"?h.description():h.description):null),_.isValidElement(h.cancel)?h.cancel:h.cancel&&Hf(h.cancel)?ge.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||I,onClick:Fe=>{var st,pt;Hf(h.cancel)&&In&&((pt=(st=h.cancel).onClick)==null||pt.call(st,Fe),gn())},className:sa(P==null?void 0:P.cancelButton,(f=h==null?void 0:h.classNames)==null?void 0:f.cancelButton)},h.cancel.label):null,_.isValidElement(h.action)?h.action:h.action&&Hf(h.action)?ge.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||H,onClick:Fe=>{var st,pt;Hf(h.action)&&((pt=(st=h.action).onClick)==null||pt.call(st,Fe),!Fe.defaultPrevented&&gn())},className:sa(P==null?void 0:P.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Fx(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function yD(e,t){let r={};return[e,t].forEach((n,a)=>{let s=a===1,i=s?"--mobile-offset":"--offset",o=s?fD:uD;function l(u){["top","right","bottom","left"].forEach(f=>{r[`${i}-${f}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${i}-${u}`]=o:r[`${i}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):l(o)}),r}var xD=_.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:l,mobileOffset:u,theme:f="light",richColors:d,duration:m,style:h,visibleToasts:g=cD,toastOptions:p,dir:y=Fx(),gap:v=hD,loadingIcon:x,icons:w,containerAriaLabel:S="Notifications",pauseWhenPageIsHidden:b}=e,[E,k]=ge.useState([]),T=ge.useMemo(()=>Array.from(new Set([n].concat(E.filter(D=>D.position).map(D=>D.position)))),[E,n]),[N,I]=ge.useState([]),[H,j]=ge.useState(!1),[z,K]=ge.useState(!1),[q,Q]=ge.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=ge.useRef(null),F=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=ge.useRef(null),Z=ge.useRef(!1),le=ge.useCallback(D=>{k(V=>{var O;return(O=V.find(L=>L.id===D.id))!=null&&O.delete||nn.dismiss(D.id),V.filter(({id:L})=>L!==D.id)})},[]);return ge.useEffect(()=>nn.subscribe(D=>{if(D.dismiss){k(V=>V.map(O=>O.id===D.id?{...O,delete:!0}:O));return}setTimeout(()=>{mk.flushSync(()=>{k(V=>{let O=V.findIndex(L=>L.id===D.id);return O!==-1?[...V.slice(0,O),{...V[O],...D},...V.slice(O+1)]:[D,...V]})})})}),[]),ge.useEffect(()=>{if(f!=="system"){Q(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Q("dark"):Q("light")),typeof window>"u")return;let D=window.matchMedia("(prefers-color-scheme: dark)");try{D.addEventListener("change",({matches:V})=>{Q(V?"dark":"light")})}catch{D.addListener(({matches:O})=>{try{Q(O?"dark":"light")}catch(L){console.error(L)}})}},[f]),ge.useEffect(()=>{E.length<=1&&j(!1)},[E]),ge.useEffect(()=>{let D=V=>{var O,L;a.every(Y=>V[Y]||V.code===Y)&&(j(!0),(O=X.current)==null||O.focus()),V.code==="Escape"&&(document.activeElement===X.current||(L=X.current)!=null&&L.contains(document.activeElement))&&j(!1)};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[a]),ge.useEffect(()=>{if(X.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,Z.current=!1)}},[X.current]),ge.createElement("section",{ref:t,"aria-label":`${S} ${F}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((D,V)=>{var O;let[L,Y]=D.split("-");return E.length?ge.createElement("ol",{key:D,dir:y==="auto"?Fx():y,tabIndex:-1,ref:X,className:o,"data-sonner-toaster":!0,"data-theme":q,"data-y-position":L,"data-lifted":H&&E.length>1&&!s,"data-x-position":Y,style:{"--front-toast-height":`${((O=N[0])==null?void 0:O.height)||0}px`,"--width":`${dD}px`,"--gap":`${v}px`,...h,...yD(l,u)},onBlur:G=>{Z.current&&!G.currentTarget.contains(G.relatedTarget)&&(Z.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:G=>{G.target instanceof HTMLElement&&G.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,P.current=G.relatedTarget)},onMouseEnter:()=>j(!0),onMouseMove:()=>j(!0),onMouseLeave:()=>{z||j(!1)},onDragEnd:()=>j(!1),onPointerDown:G=>{G.target instanceof HTMLElement&&G.target.dataset.dismissible==="false"||K(!0)},onPointerUp:()=>K(!1)},E.filter(G=>!G.position&&V===0||G.position===D).map((G,ie)=>{var se,ae;return ge.createElement(vD,{key:G.id,icons:w,index:ie,toast:G,defaultRichColors:d,duration:(se=p==null?void 0:p.duration)!=null?se:m,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:r,visibleToasts:g,closeButton:(ae=p==null?void 0:p.closeButton)!=null?ae:i,interacting:z,position:D,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:le,toasts:E.filter(J=>J.position==G.position),heights:N.filter(J=>J.position==G.position),setHeights:I,expandByDefault:s,gap:v,loadingIcon:x,expanded:H,pauseWhenPageIsHidden:b,swipeDirections:e.swipeDirections})})):null}))});const wD=({...e})=>{const{theme:t="system"}=G6();return c.jsx(xD,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var _D=jg[" useId ".trim().toString()]||(()=>{}),SD=0;function Xa(e){const[t,r]=_.useState(_D());return gr(()=>{r(n=>n??String(SD++))},[e]),t?`radix-${t}`:""}const kD=["top","right","bottom","left"],mi=Math.min,wn=Math.max,Jd=Math.round,Vf=Math.floor,Ka=e=>({x:e,y:e}),bD={left:"right",right:"left",bottom:"top",top:"bottom"},ED={start:"end",end:"start"};function q0(e,t,r){return wn(e,mi(t,r))}function Es(e,t){return typeof e=="function"?e(t):e}function Ts(e){return e.split("-")[0]}function Gl(e){return e.split("-")[1]}function j1(e){return e==="x"?"y":"x"}function R1(e){return e==="y"?"height":"width"}const TD=new Set(["top","bottom"]);function Ha(e){return TD.has(Ts(e))?"y":"x"}function M1(e){return j1(Ha(e))}function ND(e,t,r){r===void 0&&(r=!1);const n=Gl(e),a=M1(e),s=R1(a);let i=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=Zd(i)),[i,Zd(i)]}function CD(e){const t=Zd(e);return[Q0(e),t,Q0(t)]}function Q0(e){return e.replace(/start|end/g,t=>ED[t])}const Lx=["left","right"],Bx=["right","left"],AD=["top","bottom"],PD=["bottom","top"];function DD(e,t,r){switch(e){case"top":case"bottom":return r?t?Bx:Lx:t?Lx:Bx;case"left":case"right":return t?AD:PD;default:return[]}}function jD(e,t,r,n){const a=Gl(e);let s=DD(Ts(e),r==="start",n);return a&&(s=s.map(i=>i+"-"+a),t&&(s=s.concat(s.map(Q0)))),s}function Zd(e){return e.replace(/left|right|bottom|top/g,t=>bD[t])}function RD(e){return{top:0,right:0,bottom:0,left:0,...e}}function lb(e){return typeof e!="number"?RD(e):{top:e,right:e,bottom:e,left:e}}function eh(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function Ux(e,t,r){let{reference:n,floating:a}=e;const s=Ha(t),i=M1(t),o=R1(i),l=Ts(t),u=s==="y",f=n.x+n.width/2-a.width/2,d=n.y+n.height/2-a.height/2,m=n[o]/2-a[o]/2;let h;switch(l){case"top":h={x:f,y:n.y-a.height};break;case"bottom":h={x:f,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-a.width,y:d};break;default:h={x:n.x,y:n.y}}switch(Gl(t)){case"start":h[i]-=m*(r&&u?-1:1);break;case"end":h[i]+=m*(r&&u?-1:1);break}return h}const MD=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:i}=r,o=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:f,y:d}=Ux(u,n,l),m=n,h={},g=0;for(let p=0;p<o.length;p++){const{name:y,fn:v}=o[p],{x,y:w,data:S,reset:b}=await v({x:f,y:d,initialPlacement:n,placement:m,strategy:a,middlewareData:h,rects:u,platform:i,elements:{reference:e,floating:t}});f=x??f,d=w??d,h={...h,[y]:{...h[y],...S}},b&&g<=50&&(g++,typeof b=="object"&&(b.placement&&(m=b.placement),b.rects&&(u=b.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):b.rects),{x:f,y:d}=Ux(u,m,l)),p=-1)}return{x:f,y:d,placement:m,strategy:a,middlewareData:h}};async function _u(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:s,rects:i,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:m=!1,padding:h=0}=Es(t,e),g=lb(h),y=o[m?d==="floating"?"reference":"floating":d],v=eh(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(y)))==null||r?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:f,strategy:l})),x=d==="floating"?{x:n,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),S=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},b=eh(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:w,strategy:l}):x);return{top:(v.top-b.top+g.top)/S.y,bottom:(b.bottom-v.bottom+g.bottom)/S.y,left:(v.left-b.left+g.left)/S.x,right:(b.right-v.right+g.right)/S.x}}const ID=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:s,platform:i,elements:o,middlewareData:l}=t,{element:u,padding:f=0}=Es(e,t)||{};if(u==null)return{};const d=lb(f),m={x:r,y:n},h=M1(a),g=R1(h),p=await i.getDimensions(u),y=h==="y",v=y?"top":"left",x=y?"bottom":"right",w=y?"clientHeight":"clientWidth",S=s.reference[g]+s.reference[h]-m[h]-s.floating[g],b=m[h]-s.reference[h],E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let k=E?E[w]:0;(!k||!await(i.isElement==null?void 0:i.isElement(E)))&&(k=o.floating[w]||s.floating[g]);const T=S/2-b/2,N=k/2-p[g]/2-1,I=mi(d[v],N),H=mi(d[x],N),j=I,z=k-p[g]-H,K=k/2-p[g]/2+T,q=q0(j,K,z),Q=!l.arrow&&Gl(a)!=null&&K!==q&&s.reference[g]/2-(K<j?I:H)-p[g]/2<0,X=Q?K<j?K-j:K-z:0;return{[h]:m[h]+X,data:{[h]:q,centerOffset:K-q-X,...Q&&{alignmentOffset:X}},reset:Q}}}),OD=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:s,rects:i,initialPlacement:o,platform:l,elements:u}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:m,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:p=!0,...y}=Es(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const v=Ts(a),x=Ha(o),w=Ts(o)===o,S=await(l.isRTL==null?void 0:l.isRTL(u.floating)),b=m||(w||!p?[Zd(o)]:CD(o)),E=g!=="none";!m&&E&&b.push(...jD(o,p,g,S));const k=[o,...b],T=await _u(t,y),N=[];let I=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&N.push(T[v]),d){const K=ND(a,i,S);N.push(T[K[0]],T[K[1]])}if(I=[...I,{placement:a,overflows:N}],!N.every(K=>K<=0)){var H,j;const K=(((H=s.flip)==null?void 0:H.index)||0)+1,q=k[K];if(q&&(!(d==="alignment"?x!==Ha(q):!1)||I.every(F=>Ha(F.placement)===x?F.overflows[0]>0:!0)))return{data:{index:K,overflows:I},reset:{placement:q}};let Q=(j=I.filter(X=>X.overflows[0]<=0).sort((X,F)=>X.overflows[1]-F.overflows[1])[0])==null?void 0:j.placement;if(!Q)switch(h){case"bestFit":{var z;const X=(z=I.filter(F=>{if(E){const P=Ha(F.placement);return P===x||P==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(P=>P>0).reduce((P,Z)=>P+Z,0)]).sort((F,P)=>F[1]-P[1])[0])==null?void 0:z[0];X&&(Q=X);break}case"initialPlacement":Q=o;break}if(a!==Q)return{reset:{placement:Q}}}return{}}}};function $x(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Wx(e){return kD.some(t=>e[t]>=0)}const FD=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Es(e,t);switch(n){case"referenceHidden":{const s=await _u(t,{...a,elementContext:"reference"}),i=$x(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Wx(i)}}}case"escaped":{const s=await _u(t,{...a,altBoundary:!0}),i=$x(s,r.floating);return{data:{escapedOffsets:i,escaped:Wx(i)}}}default:return{}}}}},cb=new Set(["left","top"]);async function LD(e,t){const{placement:r,platform:n,elements:a}=e,s=await(n.isRTL==null?void 0:n.isRTL(a.floating)),i=Ts(r),o=Gl(r),l=Ha(r)==="y",u=cb.has(i)?-1:1,f=s&&l?-1:1,d=Es(t,e);let{mainAxis:m,crossAxis:h,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof g=="number"&&(h=o==="end"?g*-1:g),l?{x:h*f,y:m*u}:{x:m*u,y:h*f}}const BD=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:s,placement:i,middlewareData:o}=t,l=await LD(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:{...l,placement:i}}}}},UD=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:o={fn:y=>{let{x:v,y:x}=y;return{x:v,y:x}}},...l}=Es(e,t),u={x:r,y:n},f=await _u(t,l),d=Ha(Ts(a)),m=j1(d);let h=u[m],g=u[d];if(s){const y=m==="y"?"top":"left",v=m==="y"?"bottom":"right",x=h+f[y],w=h-f[v];h=q0(x,h,w)}if(i){const y=d==="y"?"top":"left",v=d==="y"?"bottom":"right",x=g+f[y],w=g-f[v];g=q0(x,g,w)}const p=o.fn({...t,[m]:h,[d]:g});return{...p,data:{x:p.x-r,y:p.y-n,enabled:{[m]:s,[d]:i}}}}}},$D=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Es(e,t),f={x:r,y:n},d=Ha(a),m=j1(d);let h=f[m],g=f[d];const p=Es(o,t),y=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const w=m==="y"?"height":"width",S=s.reference[m]-s.floating[w]+y.mainAxis,b=s.reference[m]+s.reference[w]-y.mainAxis;h<S?h=S:h>b&&(h=b)}if(u){var v,x;const w=m==="y"?"width":"height",S=cb.has(Ts(a)),b=s.reference[d]-s.floating[w]+(S&&((v=i.offset)==null?void 0:v[d])||0)+(S?0:y.crossAxis),E=s.reference[d]+s.reference[w]+(S?0:((x=i.offset)==null?void 0:x[d])||0)-(S?y.crossAxis:0);g<b?g=b:g>E&&(g=E)}return{[m]:h,[d]:g}}}},WD=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:s,platform:i,elements:o}=t,{apply:l=()=>{},...u}=Es(e,t),f=await _u(t,u),d=Ts(a),m=Gl(a),h=Ha(a)==="y",{width:g,height:p}=s.floating;let y,v;d==="top"||d==="bottom"?(y=d,v=m===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(v=d,y=m==="end"?"top":"bottom");const x=p-f.top-f.bottom,w=g-f.left-f.right,S=mi(p-f[y],x),b=mi(g-f[v],w),E=!t.middlewareData.shift;let k=S,T=b;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(T=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(k=x),E&&!m){const I=wn(f.left,0),H=wn(f.right,0),j=wn(f.top,0),z=wn(f.bottom,0);h?T=g-2*(I!==0||H!==0?I+H:wn(f.left,f.right)):k=p-2*(j!==0||z!==0?j+z:wn(f.top,f.bottom))}await l({...t,availableWidth:T,availableHeight:k});const N=await i.getDimensions(o.floating);return g!==N.width||p!==N.height?{reset:{rects:!0}}:{}}}};function Vh(){return typeof window<"u"}function Yl(e){return ub(e)?(e.nodeName||"").toLowerCase():"#document"}function Nn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Za(e){var t;return(t=(ub(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function ub(e){return Vh()?e instanceof Node||e instanceof Nn(e).Node:!1}function ba(e){return Vh()?e instanceof Element||e instanceof Nn(e).Element:!1}function Qa(e){return Vh()?e instanceof HTMLElement||e instanceof Nn(e).HTMLElement:!1}function Hx(e){return!Vh()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Nn(e).ShadowRoot}const HD=new Set(["inline","contents"]);function tf(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Ea(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!HD.has(a)}const VD=new Set(["table","td","th"]);function zD(e){return VD.has(Yl(e))}const GD=[":popover-open",":modal"];function zh(e){return GD.some(t=>{try{return e.matches(t)}catch{return!1}})}const YD=["transform","translate","scale","rotate","perspective"],XD=["transform","translate","scale","rotate","perspective","filter"],KD=["paint","layout","strict","content"];function I1(e){const t=O1(),r=ba(e)?Ea(e):e;return YD.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||XD.some(n=>(r.willChange||"").includes(n))||KD.some(n=>(r.contain||"").includes(n))}function qD(e){let t=pi(e);for(;Qa(t)&&!Dl(t);){if(I1(t))return t;if(zh(t))return null;t=pi(t)}return null}function O1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const QD=new Set(["html","body","#document"]);function Dl(e){return QD.has(Yl(e))}function Ea(e){return Nn(e).getComputedStyle(e)}function Gh(e){return ba(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function pi(e){if(Yl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Hx(e)&&e.host||Za(e);return Hx(t)?t.host:t}function fb(e){const t=pi(e);return Dl(t)?e.ownerDocument?e.ownerDocument.body:e.body:Qa(t)&&tf(t)?t:fb(t)}function Su(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=fb(e),s=a===((n=e.ownerDocument)==null?void 0:n.body),i=Nn(a);if(s){const o=J0(i);return t.concat(i,i.visualViewport||[],tf(a)?a:[],o&&r?Su(o):[])}return t.concat(a,Su(a,[],r))}function J0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function db(e){const t=Ea(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Qa(e),s=a?e.offsetWidth:r,i=a?e.offsetHeight:n,o=Jd(r)!==s||Jd(n)!==i;return o&&(r=s,n=i),{width:r,height:n,$:o}}function F1(e){return ba(e)?e:e.contextElement}function ul(e){const t=F1(e);if(!Qa(t))return Ka(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:s}=db(t);let i=(s?Jd(r.width):r.width)/n,o=(s?Jd(r.height):r.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const JD=Ka(0);function hb(e){const t=Nn(e);return!O1()||!t.visualViewport?JD:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function ZD(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Nn(e)?!1:t}function lo(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),s=F1(e);let i=Ka(1);t&&(n?ba(n)&&(i=ul(n)):i=ul(e));const o=ZD(s,r,n)?hb(s):Ka(0);let l=(a.left+o.x)/i.x,u=(a.top+o.y)/i.y,f=a.width/i.x,d=a.height/i.y;if(s){const m=Nn(s),h=n&&ba(n)?Nn(n):n;let g=m,p=J0(g);for(;p&&n&&h!==g;){const y=ul(p),v=p.getBoundingClientRect(),x=Ea(p),w=v.left+(p.clientLeft+parseFloat(x.paddingLeft))*y.x,S=v.top+(p.clientTop+parseFloat(x.paddingTop))*y.y;l*=y.x,u*=y.y,f*=y.x,d*=y.y,l+=w,u+=S,g=Nn(p),p=J0(g)}}return eh({width:f,height:d,x:l,y:u})}function Yh(e,t){const r=Gh(e).scrollLeft;return t?t.left+r:lo(Za(e)).left+r}function mb(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Yh(e,r),a=r.top+t.scrollTop;return{x:n,y:a}}function ej(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const s=a==="fixed",i=Za(n),o=t?zh(t.floating):!1;if(n===i||o&&s)return r;let l={scrollLeft:0,scrollTop:0},u=Ka(1);const f=Ka(0),d=Qa(n);if((d||!d&&!s)&&((Yl(n)!=="body"||tf(i))&&(l=Gh(n)),Qa(n))){const h=lo(n);u=ul(n),f.x=h.x+n.clientLeft,f.y=h.y+n.clientTop}const m=i&&!d&&!s?mb(i,l):Ka(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-l.scrollLeft*u.x+f.x+m.x,y:r.y*u.y-l.scrollTop*u.y+f.y+m.y}}function tj(e){return Array.from(e.getClientRects())}function rj(e){const t=Za(e),r=Gh(e),n=e.ownerDocument.body,a=wn(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=wn(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Yh(e);const o=-r.scrollTop;return Ea(n).direction==="rtl"&&(i+=wn(t.clientWidth,n.clientWidth)-a),{width:a,height:s,x:i,y:o}}const Vx=25;function nj(e,t){const r=Nn(e),n=Za(e),a=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;const f=O1();(!f||f&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}const u=Yh(n);if(u<=0){const f=n.ownerDocument,d=f.body,m=getComputedStyle(d),h=f.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,g=Math.abs(n.clientWidth-d.clientWidth-h);g<=Vx&&(s-=g)}else u<=Vx&&(s+=u);return{width:s,height:i,x:o,y:l}}const aj=new Set(["absolute","fixed"]);function sj(e,t){const r=lo(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,s=Qa(e)?ul(e):Ka(1),i=e.clientWidth*s.x,o=e.clientHeight*s.y,l=a*s.x,u=n*s.y;return{width:i,height:o,x:l,y:u}}function zx(e,t,r){let n;if(t==="viewport")n=nj(e,r);else if(t==="document")n=rj(Za(e));else if(ba(t))n=sj(t,r);else{const a=hb(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return eh(n)}function pb(e,t){const r=pi(e);return r===t||!ba(r)||Dl(r)?!1:Ea(r).position==="fixed"||pb(r,t)}function ij(e,t){const r=t.get(e);if(r)return r;let n=Su(e,[],!1).filter(o=>ba(o)&&Yl(o)!=="body"),a=null;const s=Ea(e).position==="fixed";let i=s?pi(e):e;for(;ba(i)&&!Dl(i);){const o=Ea(i),l=I1(i);!l&&o.position==="fixed"&&(a=null),(s?!l&&!a:!l&&o.position==="static"&&!!a&&aj.has(a.position)||tf(i)&&!l&&pb(e,i))?n=n.filter(f=>f!==i):a=o,i=pi(i)}return t.set(e,n),n}function oj(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const i=[...r==="clippingAncestors"?zh(t)?[]:ij(t,this._c):[].concat(r),n],o=i[0],l=i.reduce((u,f)=>{const d=zx(t,f,a);return u.top=wn(d.top,u.top),u.right=mi(d.right,u.right),u.bottom=mi(d.bottom,u.bottom),u.left=wn(d.left,u.left),u},zx(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function lj(e){const{width:t,height:r}=db(e);return{width:t,height:r}}function cj(e,t,r){const n=Qa(t),a=Za(t),s=r==="fixed",i=lo(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Ka(0);function u(){l.x=Yh(a)}if(n||!n&&!s)if((Yl(t)!=="body"||tf(a))&&(o=Gh(t)),n){const h=lo(t,!0,s,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else a&&u();s&&!n&&a&&u();const f=a&&!n&&!s?mb(a,o):Ka(0),d=i.left+o.scrollLeft-l.x-f.x,m=i.top+o.scrollTop-l.y-f.y;return{x:d,y:m,width:i.width,height:i.height}}function up(e){return Ea(e).position==="static"}function Gx(e,t){if(!Qa(e)||Ea(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Za(e)===r&&(r=r.ownerDocument.body),r}function gb(e,t){const r=Nn(e);if(zh(e))return r;if(!Qa(e)){let a=pi(e);for(;a&&!Dl(a);){if(ba(a)&&!up(a))return a;a=pi(a)}return r}let n=Gx(e,t);for(;n&&zD(n)&&up(n);)n=Gx(n,t);return n&&Dl(n)&&up(n)&&!I1(n)?r:n||qD(e)||r}const uj=async function(e){const t=this.getOffsetParent||gb,r=this.getDimensions,n=await r(e.floating);return{reference:cj(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function fj(e){return Ea(e).direction==="rtl"}const dj={convertOffsetParentRelativeRectToViewportRelativeRect:ej,getDocumentElement:Za,getClippingRect:oj,getOffsetParent:gb,getElementRects:uj,getClientRects:tj,getDimensions:lj,getScale:ul,isElement:ba,isRTL:fj};function vb(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function hj(e,t){let r=null,n;const a=Za(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const u=e.getBoundingClientRect(),{left:f,top:d,width:m,height:h}=u;if(o||t(),!m||!h)return;const g=Vf(d),p=Vf(a.clientWidth-(f+m)),y=Vf(a.clientHeight-(d+h)),v=Vf(f),w={rootMargin:-g+"px "+-p+"px "+-y+"px "+-v+"px",threshold:wn(0,mi(1,l))||1};let S=!0;function b(E){const k=E[0].intersectionRatio;if(k!==l){if(!S)return i();k?i(!1,k):n=setTimeout(()=>{i(!1,1e-7)},1e3)}k===1&&!vb(u,e.getBoundingClientRect())&&i(),S=!1}try{r=new IntersectionObserver(b,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(b,w)}r.observe(e)}return i(!0),s}function mj(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=F1(e),f=a||s?[...u?Su(u):[],...Su(t)]:[];f.forEach(v=>{a&&v.addEventListener("scroll",r,{passive:!0}),s&&v.addEventListener("resize",r)});const d=u&&o?hj(u,r):null;let m=-1,h=null;i&&(h=new ResizeObserver(v=>{let[x]=v;x&&x.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),u&&!l&&h.observe(u),h.observe(t));let g,p=l?lo(e):null;l&&y();function y(){const v=lo(e);p&&!vb(p,v)&&r(),p=v,g=requestAnimationFrame(y)}return r(),()=>{var v;f.forEach(x=>{a&&x.removeEventListener("scroll",r),s&&x.removeEventListener("resize",r)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,l&&cancelAnimationFrame(g)}}const pj=BD,gj=UD,vj=OD,yj=WD,xj=FD,Yx=ID,wj=$D,_j=(e,t,r)=>{const n=new Map,a={platform:dj,...r},s={...a.platform,_c:n};return MD(e,t,{...a,platform:s})};var Sj=typeof document<"u",kj=function(){},kd=Sj?_.useLayoutEffect:kj;function th(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!th(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const s=a[n];if(!(s==="_owner"&&e.$$typeof)&&!th(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function yb(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Xx(e,t){const r=yb(e);return Math.round(t*r)/r}function fp(e){const t=_.useRef(e);return kd(()=>{t.current=e}),t}function bj(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:s,floating:i}={},transform:o=!0,whileElementsMounted:l,open:u}=e,[f,d]=_.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,h]=_.useState(n);th(m,n)||h(n);const[g,p]=_.useState(null),[y,v]=_.useState(null),x=_.useCallback(F=>{F!==E.current&&(E.current=F,p(F))},[]),w=_.useCallback(F=>{F!==k.current&&(k.current=F,v(F))},[]),S=s||g,b=i||y,E=_.useRef(null),k=_.useRef(null),T=_.useRef(f),N=l!=null,I=fp(l),H=fp(a),j=fp(u),z=_.useCallback(()=>{if(!E.current||!k.current)return;const F={placement:t,strategy:r,middleware:m};H.current&&(F.platform=H.current),_j(E.current,k.current,F).then(P=>{const Z={...P,isPositioned:j.current!==!1};K.current&&!th(T.current,Z)&&(T.current=Z,ko.flushSync(()=>{d(Z)}))})},[m,t,r,H,j]);kd(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(F=>({...F,isPositioned:!1})))},[u]);const K=_.useRef(!1);kd(()=>(K.current=!0,()=>{K.current=!1}),[]),kd(()=>{if(S&&(E.current=S),b&&(k.current=b),S&&b){if(I.current)return I.current(S,b,z);z()}},[S,b,z,I,N]);const q=_.useMemo(()=>({reference:E,floating:k,setReference:x,setFloating:w}),[x,w]),Q=_.useMemo(()=>({reference:S,floating:b}),[S,b]),X=_.useMemo(()=>{const F={position:r,left:0,top:0};if(!Q.floating)return F;const P=Xx(Q.floating,f.x),Z=Xx(Q.floating,f.y);return o?{...F,transform:"translate("+P+"px, "+Z+"px)",...yb(Q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:P,top:Z}},[r,o,Q.floating,f.x,f.y]);return _.useMemo(()=>({...f,update:z,refs:q,elements:Q,floatingStyles:X}),[f,z,q,Q,X])}const Ej=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Yx({element:n.current,padding:a}).fn(r):{}:n?Yx({element:n,padding:a}).fn(r):{}}}},Tj=(e,t)=>({...pj(e),options:[e,t]}),Nj=(e,t)=>({...gj(e),options:[e,t]}),Cj=(e,t)=>({...wj(e),options:[e,t]}),Aj=(e,t)=>({...vj(e),options:[e,t]}),Pj=(e,t)=>({...yj(e),options:[e,t]}),Dj=(e,t)=>({...xj(e),options:[e,t]}),jj=(e,t)=>({...Ej(e),options:[e,t]});var Rj="Arrow",xb=_.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...s}=e;return c.jsx(De.svg,{...s,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});xb.displayName=Rj;var Mj=xb;function L1(e){const[t,r]=_.useState(void 0);return gr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let i,o;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;i=u.inlineSize,o=u.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var B1="Popper",[wb,Xl]=Mn(B1),[Ij,_b]=wb(B1),Sb=e=>{const{__scopePopper:t,children:r}=e,[n,a]=_.useState(null);return c.jsx(Ij,{scope:t,anchor:n,onAnchorChange:a,children:r})};Sb.displayName=B1;var kb="PopperAnchor",bb=_.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,s=_b(kb,r),i=_.useRef(null),o=Je(t,i),l=_.useRef(null);return _.useEffect(()=>{const u=l.current;l.current=(n==null?void 0:n.current)||i.current,u!==l.current&&s.onAnchorChange(l.current)}),n?null:c.jsx(De.div,{...a,ref:o})});bb.displayName=kb;var U1="PopperContent",[Oj,Fj]=wb(U1),Eb=_.forwardRef((e,t)=>{var G,ie,se,ae,J,A;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:s="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:m=!1,updatePositionStrategy:h="optimized",onPlaced:g,...p}=e,y=_b(U1,r),[v,x]=_.useState(null),w=Je(t,me=>x(me)),[S,b]=_.useState(null),E=L1(S),k=(E==null?void 0:E.width)??0,T=(E==null?void 0:E.height)??0,N=n+(s!=="center"?"-"+s:""),I=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},H=Array.isArray(u)?u:[u],j=H.length>0,z={padding:I,boundary:H.filter(Bj),altBoundary:j},{refs:K,floatingStyles:q,placement:Q,isPositioned:X,middlewareData:F}=bj({strategy:"fixed",placement:N,whileElementsMounted:(...me)=>mj(...me,{animationFrame:h==="always"}),elements:{reference:y.anchor},middleware:[Tj({mainAxis:a+T,alignmentAxis:i}),l&&Nj({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Cj():void 0,...z}),l&&Aj({...z}),Pj({...z,apply:({elements:me,rects:ke,availableWidth:We,availableHeight:Me})=>{const{width:xe,height:mt}=ke.reference,nr=me.floating.style;nr.setProperty("--radix-popper-available-width",`${We}px`),nr.setProperty("--radix-popper-available-height",`${Me}px`),nr.setProperty("--radix-popper-anchor-width",`${xe}px`),nr.setProperty("--radix-popper-anchor-height",`${mt}px`)}}),S&&jj({element:S,padding:o}),Uj({arrowWidth:k,arrowHeight:T}),m&&Dj({strategy:"referenceHidden",...z})]}),[P,Z]=Cb(Q),le=Jn(g);gr(()=>{X&&(le==null||le())},[X,le]);const D=(G=F.arrow)==null?void 0:G.x,V=(ie=F.arrow)==null?void 0:ie.y,O=((se=F.arrow)==null?void 0:se.centerOffset)!==0,[L,Y]=_.useState();return gr(()=>{v&&Y(window.getComputedStyle(v).zIndex)},[v]),c.jsx("div",{ref:K.setFloating,"data-radix-popper-content-wrapper":"",style:{...q,transform:X?q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[(ae=F.transformOrigin)==null?void 0:ae.x,(J=F.transformOrigin)==null?void 0:J.y].join(" "),...((A=F.hide)==null?void 0:A.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(Oj,{scope:r,placedSide:P,onArrowChange:b,arrowX:D,arrowY:V,shouldHideArrow:O,children:c.jsx(De.div,{"data-side":P,"data-align":Z,...p,ref:w,style:{...p.style,animation:X?void 0:"none"}})})})});Eb.displayName=U1;var Tb="PopperArrow",Lj={top:"bottom",right:"left",bottom:"top",left:"right"},Nb=_.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,s=Fj(Tb,n),i=Lj[s.placedSide];return c.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:c.jsx(Mj,{...a,ref:r,style:{...a.style,display:"block"}})})});Nb.displayName=Tb;function Bj(e){return e!==null}var Uj=e=>({name:"transformOrigin",options:e,fn(t){var y,v,x;const{placement:r,rects:n,middlewareData:a}=t,i=((y=a.arrow)==null?void 0:y.centerOffset)!==0,o=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[u,f]=Cb(r),d={start:"0%",center:"50%",end:"100%"}[f],m=(((v=a.arrow)==null?void 0:v.x)??0)+o/2,h=(((x=a.arrow)==null?void 0:x.y)??0)+l/2;let g="",p="";return u==="bottom"?(g=i?d:`${m}px`,p=`${-l}px`):u==="top"?(g=i?d:`${m}px`,p=`${n.floating.height+l}px`):u==="right"?(g=`${-l}px`,p=i?d:`${h}px`):u==="left"&&(g=`${n.floating.width+l}px`,p=i?d:`${h}px`),{data:{x:g,y:p}}}});function Cb(e){const[t,r="center"]=e.split("-");return[t,r]}var Ab=Sb,Xh=bb,$1=Eb,W1=Nb,[Kh,Jq]=Mn("Tooltip",[Xl]),H1=Xl(),Pb="TooltipProvider",$j=700,Kx="tooltip.open",[Wj,Db]=Kh(Pb),jb=e=>{const{__scopeTooltip:t,delayDuration:r=$j,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:s}=e,i=_.useRef(!0),o=_.useRef(!1),l=_.useRef(0);return _.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),c.jsx(Wj,{scope:t,isOpenDelayedRef:i,delayDuration:r,onOpen:_.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:_.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:_.useCallback(u=>{o.current=u},[]),disableHoverableContent:a,children:s})};jb.displayName=Pb;var Rb="Tooltip",[Zq,qh]=Kh(Rb),Z0="TooltipTrigger",Hj=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=qh(Z0,r),s=Db(Z0,r),i=H1(r),o=_.useRef(null),l=Je(t,o,a.onTriggerChange),u=_.useRef(!1),f=_.useRef(!1),d=_.useCallback(()=>u.current=!1,[]);return _.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),c.jsx(Xh,{asChild:!0,...i,children:c.jsx(De.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:Ne(e.onPointerMove,m=>{m.pointerType!=="touch"&&!f.current&&!s.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:Ne(e.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:Ne(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Ne(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:Ne(e.onBlur,a.onClose),onClick:Ne(e.onClick,a.onClose)})})});Hj.displayName=Z0;var Vj="TooltipPortal",[eQ,zj]=Kh(Vj,{forceMount:void 0}),jl="TooltipContent",Mb=_.forwardRef((e,t)=>{const r=zj(jl,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...s}=e,i=qh(jl,e.__scopeTooltip);return c.jsx(Ca,{present:n||i.open,children:i.disableHoverableContent?c.jsx(Ib,{side:a,...s,ref:t}):c.jsx(Gj,{side:a,...s,ref:t})})}),Gj=_.forwardRef((e,t)=>{const r=qh(jl,e.__scopeTooltip),n=Db(jl,e.__scopeTooltip),a=_.useRef(null),s=Je(t,a),[i,o]=_.useState(null),{trigger:l,onClose:u}=r,f=a.current,{onPointerInTransitChange:d}=n,m=_.useCallback(()=>{o(null),d(!1)},[d]),h=_.useCallback((g,p)=>{const y=g.currentTarget,v={x:g.clientX,y:g.clientY},x=Qj(v,y.getBoundingClientRect()),w=Jj(v,x),S=Zj(p.getBoundingClientRect()),b=tR([...w,...S]);o(b),d(!0)},[d]);return _.useEffect(()=>()=>m(),[m]),_.useEffect(()=>{if(l&&f){const g=y=>h(y,f),p=y=>h(y,l);return l.addEventListener("pointerleave",g),f.addEventListener("pointerleave",p),()=>{l.removeEventListener("pointerleave",g),f.removeEventListener("pointerleave",p)}}},[l,f,h,m]),_.useEffect(()=>{if(i){const g=p=>{const y=p.target,v={x:p.clientX,y:p.clientY},x=(l==null?void 0:l.contains(y))||(f==null?void 0:f.contains(y)),w=!eR(v,i);x?m():w&&(m(),u())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,f,i,u,m]),c.jsx(Ib,{...e,ref:s})}),[Yj,Xj]=Kh(Rb,{isInside:!1}),Kj=rP("TooltipContent"),Ib=_.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:i,...o}=e,l=qh(jl,r),u=H1(r),{onClose:f}=l;return _.useEffect(()=>(document.addEventListener(Kx,f),()=>document.removeEventListener(Kx,f)),[f]),_.useEffect(()=>{if(l.trigger){const d=m=>{const h=m.target;h!=null&&h.contains(l.trigger)&&f()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,f]),c.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:f,children:c.jsxs($1,{"data-state":l.stateAttribute,...u,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(Kj,{children:n}),c.jsx(Yj,{scope:r,isInside:!0,children:c.jsx(bP,{id:l.contentId,role:"tooltip",children:a||n})})]})})});Mb.displayName=jl;var Ob="TooltipArrow",qj=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=H1(r);return Xj(Ob,r).isInside?null:c.jsx(W1,{...a,...n,ref:t})});qj.displayName=Ob;function Qj(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,a,s)){case s:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Jj(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function Zj(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function eR(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],u=o.x,f=o.y,d=l.x,m=l.y;f>n!=m>n&&r<(d-u)*(n-f)/(m-f)+u&&(a=!a)}return a}function tR(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),rR(t)}function rR(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const s=r[r.length-1],i=r[r.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var nR=jb,Fb=Mb;const aR=nR,sR=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>c.jsx(Fb,{ref:n,sideOffset:t,className:Ce("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));sR.displayName=Fb.displayName;var Qh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},iR={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Gs,Ng,G2,oR=(G2=class{constructor(){qe(this,Gs,iR);qe(this,Ng,!1)}setTimeoutProvider(e){Le(this,Gs,e)}setTimeout(e,t){return ue(this,Gs).setTimeout(e,t)}clearTimeout(e){ue(this,Gs).clearTimeout(e)}setInterval(e,t){return ue(this,Gs).setInterval(e,t)}clearInterval(e){ue(this,Gs).clearInterval(e)}},Gs=new WeakMap,Ng=new WeakMap,G2),eg=new oR;function lR(e){setTimeout(e,0)}var Jh=typeof window>"u"||"Deno"in globalThis;function ca(){}function cR(e,t){return typeof e=="function"?e(t):e}function uR(e){return typeof e=="number"&&e>=0&&e!==1/0}function fR(e,t){return Math.max(e+(t||0)-Date.now(),0)}function tg(e,t){return typeof e=="function"?e(t):e}function dR(e,t){return typeof e=="function"?e(t):e}function qx(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==V1(i,t.options))return!1}else if(!bu(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function Qx(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(ku(t.options.mutationKey)!==ku(s))return!1}else if(!bu(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function V1(e,t){return((t==null?void 0:t.queryKeyHashFn)||ku)(e)}function ku(e){return JSON.stringify(e,(t,r)=>rg(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function bu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>bu(e[r],t[r])):!1}var hR=Object.prototype.hasOwnProperty;function Lb(e,t){if(e===t)return e;const r=Jx(e)&&Jx(t);if(!r&&!(rg(e)&&rg(t)))return t;const a=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),i=s.length,o=r?new Array(i):{};let l=0;for(let u=0;u<i;u++){const f=r?u:s[u],d=e[f],m=t[f];if(d===m){o[f]=d,(r?u<a:hR.call(e,f))&&l++;continue}if(d===null||m===null||typeof d!="object"||typeof m!="object"){o[f]=m;continue}const h=Lb(d,m);o[f]=h,h===d&&l++}return a===i&&l===a?e:o}function Jx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function rg(e){if(!Zx(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Zx(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Zx(e){return Object.prototype.toString.call(e)==="[object Object]"}function mR(e){return new Promise(t=>{eg.setTimeout(t,e)})}function pR(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Lb(e,t):t}function gR(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function vR(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var z1=Symbol();function Bb(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===z1?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var $i,Ys,gl,Y2,yR=(Y2=class extends Qh{constructor(){super();qe(this,$i);qe(this,Ys);qe(this,gl);Le(this,gl,t=>{if(!Jh&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ue(this,Ys)||this.setEventListener(ue(this,gl))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Ys))==null||t.call(this),Le(this,Ys,void 0))}setEventListener(t){var r;Le(this,gl,t),(r=ue(this,Ys))==null||r.call(this),Le(this,Ys,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){ue(this,$i)!==t&&(Le(this,$i,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ue(this,$i)=="boolean"?ue(this,$i):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},$i=new WeakMap,Ys=new WeakMap,gl=new WeakMap,Y2),Ub=new yR;function xR(){let e,t;const r=new Promise((a,s)=>{e=a,t=s});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var wR=lR;function _R(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=wR;const s=o=>{t?e.push(o):a(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var Qr=_R(),vl,Xs,yl,X2,SR=(X2=class extends Qh{constructor(){super();qe(this,vl,!0);qe(this,Xs);qe(this,yl);Le(this,yl,t=>{if(!Jh&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){ue(this,Xs)||this.setEventListener(ue(this,yl))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Xs))==null||t.call(this),Le(this,Xs,void 0))}setEventListener(t){var r;Le(this,yl,t),(r=ue(this,Xs))==null||r.call(this),Le(this,Xs,t(this.setOnline.bind(this)))}setOnline(t){ue(this,vl)!==t&&(Le(this,vl,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return ue(this,vl)}},vl=new WeakMap,Xs=new WeakMap,yl=new WeakMap,X2),rh=new SR;function kR(e){return Math.min(1e3*2**e,3e4)}function $b(e){return(e??"online")==="online"?rh.isOnline():!0}var ng=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Wb(e){let t=!1,r=0,n;const a=xR(),s=()=>a.status!=="pending",i=p=>{var y;if(!s()){const v=new ng(p);m(v),(y=e.onCancel)==null||y.call(e,v)}},o=()=>{t=!0},l=()=>{t=!1},u=()=>Ub.isFocused()&&(e.networkMode==="always"||rh.isOnline())&&e.canRun(),f=()=>$b(e.networkMode)&&e.canRun(),d=p=>{s()||(n==null||n(),a.resolve(p))},m=p=>{s()||(n==null||n(),a.reject(p))},h=()=>new Promise(p=>{var y;n=v=>{(s()||u())&&p(v)},(y=e.onPause)==null||y.call(e)}).then(()=>{var p;n=void 0,s()||(p=e.onContinue)==null||p.call(e)}),g=()=>{if(s())return;let p;const y=r===0?e.initialPromise:void 0;try{p=y??e.fn()}catch(v){p=Promise.reject(v)}Promise.resolve(p).then(d).catch(v=>{var E;if(s())return;const x=e.retry??(Jh?0:3),w=e.retryDelay??kR,S=typeof w=="function"?w(r,v):w,b=x===!0||typeof x=="number"&&r<x||typeof x=="function"&&x(r,v);if(t||!b){m(v);return}r++,(E=e.onFail)==null||E.call(e,r,v),mR(S).then(()=>u()?void 0:h()).then(()=>{t?m(v):g()})})};return{promise:a,status:()=>a.status,cancel:i,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:l,canStart:f,start:()=>(f()?g():h().then(g),a)}}var Wi,K2,Hb=(K2=class{constructor(){qe(this,Wi)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),uR(this.gcTime)&&Le(this,Wi,eg.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Jh?1/0:5*60*1e3))}clearGcTimeout(){ue(this,Wi)&&(eg.clearTimeout(ue(this,Wi)),Le(this,Wi,void 0))}},Wi=new WeakMap,K2),Hi,xl,Wn,Vi,cr,zu,zi,ua,is,q2,bR=(q2=class extends Hb{constructor(t){super();qe(this,ua);qe(this,Hi);qe(this,xl);qe(this,Wn);qe(this,Vi);qe(this,cr);qe(this,zu);qe(this,zi);Le(this,zi,!1),Le(this,zu,t.defaultOptions),this.setOptions(t.options),this.observers=[],Le(this,Vi,t.client),Le(this,Wn,ue(this,Vi).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Le(this,Hi,ew(this.options)),this.state=t.state??ue(this,Hi),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ue(this,cr))==null?void 0:t.promise}setOptions(t){if(this.options={...ue(this,zu),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=ew(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Le(this,Hi,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,Wn).remove(this)}setData(t,r){const n=pR(this.state.data,t,this.options);return Nr(this,ua,is).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Nr(this,ua,is).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=ue(this,cr))==null?void 0:n.promise;return(a=ue(this,cr))==null||a.cancel(t),r?r.then(ca).catch(ca):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,Hi))}isActive(){return this.observers.some(t=>dR(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===z1||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>tg(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!fR(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,cr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,cr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ue(this,Wn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ue(this,cr)&&(ue(this,zi)?ue(this,cr).cancel({revert:!0}):ue(this,cr).cancelRetry()),this.scheduleGc()),ue(this,Wn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nr(this,ua,is).call(this,{type:"invalidate"})}async fetch(t,r){var l,u,f,d,m,h,g,p,y,v,x,w;if(this.state.fetchStatus!=="idle"&&((l=ue(this,cr))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ue(this,cr))return ue(this,cr).continueRetry(),ue(this,cr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(b=>b.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,a=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(Le(this,zi,!0),n.signal)})},s=()=>{const S=Bb(this.options,r),E=(()=>{const k={client:ue(this,Vi),queryKey:this.queryKey,meta:this.meta};return a(k),k})();return Le(this,zi,!1),this.options.persister?this.options.persister(S,E,this):S(E)},o=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ue(this,Vi),state:this.state,fetchFn:s};return a(S),S})();(u=this.options.behavior)==null||u.onFetch(o,this),Le(this,xl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=o.fetchOptions)==null?void 0:f.meta))&&Nr(this,ua,is).call(this,{type:"fetch",meta:(d=o.fetchOptions)==null?void 0:d.meta}),Le(this,cr,Wb({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:S=>{S instanceof ng&&S.revert&&this.setState({...ue(this,xl),fetchStatus:"idle"}),n.abort()},onFail:(S,b)=>{Nr(this,ua,is).call(this,{type:"failed",failureCount:S,error:b})},onPause:()=>{Nr(this,ua,is).call(this,{type:"pause"})},onContinue:()=>{Nr(this,ua,is).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await ue(this,cr).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(h=(m=ue(this,Wn).config).onSuccess)==null||h.call(m,S,this),(p=(g=ue(this,Wn).config).onSettled)==null||p.call(g,S,this.state.error,this),S}catch(S){if(S instanceof ng){if(S.silent)return ue(this,cr).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw Nr(this,ua,is).call(this,{type:"error",error:S}),(v=(y=ue(this,Wn).config).onError)==null||v.call(y,S,this),(w=(x=ue(this,Wn).config).onSettled)==null||w.call(x,this.state.data,S,this),S}finally{this.scheduleGc()}}},Hi=new WeakMap,xl=new WeakMap,Wn=new WeakMap,Vi=new WeakMap,cr=new WeakMap,zu=new WeakMap,zi=new WeakMap,ua=new WeakSet,is=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ER(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Le(this,xl,t.manual?a:void 0),a;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Qr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),ue(this,Wn).notify({query:this,type:"updated",action:t})})},q2);function ER(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:$b(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function ew(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function tw(e){return{onFetch:(t,r)=>{var f,d,m,h,g;const n=t.options,a=(m=(d=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:d.fetchMore)==null?void 0:m.direction,s=((h=t.state.data)==null?void 0:h.pages)||[],i=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let p=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},v=Bb(t.options,t.fetchOptions),x=async(w,S,b)=>{if(p)return Promise.reject();if(S==null&&w.pages.length)return Promise.resolve(w);const k=(()=>{const H={client:t.client,queryKey:t.queryKey,pageParam:S,direction:b?"backward":"forward",meta:t.options.meta};return y(H),H})(),T=await v(k),{maxPages:N}=t.options,I=b?vR:gR;return{pages:I(w.pages,T,N),pageParams:I(w.pageParams,S,N)}};if(a&&s.length){const w=a==="backward",S=w?TR:rw,b={pages:s,pageParams:i},E=S(n,b);o=await x(b,E,w)}else{const w=e??s.length;do{const S=l===0?i[0]??n.initialPageParam:rw(n,o);if(l>0&&S==null)break;o=await x(o,S),l++}while(l<w)}return o};t.options.persister?t.fetchFn=()=>{var p,y;return(y=(p=t.options).persister)==null?void 0:y.call(p,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function rw(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function TR(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var La,Yr,Gi,Ba,Us,Q2,NR=(Q2=class extends Hb{constructor(t){super();qe(this,Ba);qe(this,La);qe(this,Yr);qe(this,Gi);this.mutationId=t.mutationId,Le(this,Yr,t.mutationCache),Le(this,La,[]),this.state=t.state||CR(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ue(this,La).includes(t)||(ue(this,La).push(t),this.clearGcTimeout(),ue(this,Yr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Le(this,La,ue(this,La).filter(r=>r!==t)),this.scheduleGc(),ue(this,Yr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ue(this,La).length||(this.state.status==="pending"?this.scheduleGc():ue(this,Yr).remove(this))}continue(){var t;return((t=ue(this,Gi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,l,u,f,d,m,h,g,p,y,v,x,w,S,b,E,k,T;const r=()=>{Nr(this,Ba,Us).call(this,{type:"continue"})};Le(this,Gi,Wb({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(N,I)=>{Nr(this,Ba,Us).call(this,{type:"failed",failureCount:N,error:I})},onPause:()=>{Nr(this,Ba,Us).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,Yr).canRun(this)}));const n=this.state.status==="pending",a=!ue(this,Gi).canStart();try{if(n)r();else{Nr(this,Ba,Us).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(s=ue(this,Yr).config).onMutate)==null?void 0:i.call(s,t,this));const I=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));I!==this.state.context&&Nr(this,Ba,Us).call(this,{type:"pending",context:I,variables:t,isPaused:a})}const N=await ue(this,Gi).start();return await((f=(u=ue(this,Yr).config).onSuccess)==null?void 0:f.call(u,N,t,this.state.context,this)),await((m=(d=this.options).onSuccess)==null?void 0:m.call(d,N,t,this.state.context)),await((g=(h=ue(this,Yr).config).onSettled)==null?void 0:g.call(h,N,null,this.state.variables,this.state.context,this)),await((y=(p=this.options).onSettled)==null?void 0:y.call(p,N,null,t,this.state.context)),Nr(this,Ba,Us).call(this,{type:"success",data:N}),N}catch(N){try{throw await((x=(v=ue(this,Yr).config).onError)==null?void 0:x.call(v,N,t,this.state.context,this)),await((S=(w=this.options).onError)==null?void 0:S.call(w,N,t,this.state.context)),await((E=(b=ue(this,Yr).config).onSettled)==null?void 0:E.call(b,void 0,N,this.state.variables,this.state.context,this)),await((T=(k=this.options).onSettled)==null?void 0:T.call(k,void 0,N,t,this.state.context)),N}finally{Nr(this,Ba,Us).call(this,{type:"error",error:N})}}finally{ue(this,Yr).runNext(this)}}},La=new WeakMap,Yr=new WeakMap,Gi=new WeakMap,Ba=new WeakSet,Us=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Qr.batch(()=>{ue(this,La).forEach(n=>{n.onMutationUpdate(t)}),ue(this,Yr).notify({mutation:this,type:"updated",action:t})})},Q2);function CR(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var cs,fa,Gu,J2,AR=(J2=class extends Qh{constructor(t={}){super();qe(this,cs);qe(this,fa);qe(this,Gu);this.config=t,Le(this,cs,new Set),Le(this,fa,new Map),Le(this,Gu,0)}build(t,r,n){const a=new NR({mutationCache:this,mutationId:++kf(this,Gu)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){ue(this,cs).add(t);const r=zf(t);if(typeof r=="string"){const n=ue(this,fa).get(r);n?n.push(t):ue(this,fa).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ue(this,cs).delete(t)){const r=zf(t);if(typeof r=="string"){const n=ue(this,fa).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&ue(this,fa).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=zf(t);if(typeof r=="string"){const n=ue(this,fa).get(r),a=n==null?void 0:n.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=zf(t);if(typeof r=="string"){const a=(n=ue(this,fa).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Qr.batch(()=>{ue(this,cs).forEach(t=>{this.notify({type:"removed",mutation:t})}),ue(this,cs).clear(),ue(this,fa).clear()})}getAll(){return Array.from(ue(this,cs))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Qx(r,n))}findAll(t={}){return this.getAll().filter(r=>Qx(t,r))}notify(t){Qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Qr.batch(()=>Promise.all(t.map(r=>r.continue().catch(ca))))}},cs=new WeakMap,fa=new WeakMap,Gu=new WeakMap,J2);function zf(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Ua,Z2,PR=(Z2=class extends Qh{constructor(t={}){super();qe(this,Ua);this.config=t,Le(this,Ua,new Map)}build(t,r,n){const a=r.queryKey,s=r.queryHash??V1(a,r);let i=this.get(s);return i||(i=new bR({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){ue(this,Ua).has(t.queryHash)||(ue(this,Ua).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ue(this,Ua).get(t.queryHash);r&&(t.destroy(),r===t&&ue(this,Ua).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Qr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ue(this,Ua).get(t)}getAll(){return[...ue(this,Ua).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>qx(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>qx(t,n)):r}notify(t){Qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Qr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Qr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ua=new WeakMap,Z2),Ut,Ks,qs,wl,_l,Qs,Sl,kl,e_,DR=(e_=class{constructor(e={}){qe(this,Ut);qe(this,Ks);qe(this,qs);qe(this,wl);qe(this,_l);qe(this,Qs);qe(this,Sl);qe(this,kl);Le(this,Ut,e.queryCache||new PR),Le(this,Ks,e.mutationCache||new AR),Le(this,qs,e.defaultOptions||{}),Le(this,wl,new Map),Le(this,_l,new Map),Le(this,Qs,0)}mount(){kf(this,Qs)._++,ue(this,Qs)===1&&(Le(this,Sl,Ub.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Ut).onFocus())})),Le(this,kl,rh.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Ut).onOnline())})))}unmount(){var e,t;kf(this,Qs)._--,ue(this,Qs)===0&&((e=ue(this,Sl))==null||e.call(this),Le(this,Sl,void 0),(t=ue(this,kl))==null||t.call(this),Le(this,kl,void 0))}isFetching(e){return ue(this,Ut).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ue(this,Ks).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Ut).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ue(this,Ut).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(tg(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return ue(this,Ut).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=ue(this,Ut).get(n.queryHash),s=a==null?void 0:a.state.data,i=cR(t,s);if(i!==void 0)return ue(this,Ut).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return Qr.batch(()=>ue(this,Ut).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Ut).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ue(this,Ut);Qr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ue(this,Ut);return Qr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Qr.batch(()=>ue(this,Ut).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(ca).catch(ca)}invalidateQueries(e,t={}){return Qr.batch(()=>(ue(this,Ut).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Qr.batch(()=>ue(this,Ut).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(ca)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(ca)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ue(this,Ut).build(this,t);return r.isStaleByTime(tg(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ca).catch(ca)}fetchInfiniteQuery(e){return e.behavior=tw(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ca).catch(ca)}ensureInfiniteQueryData(e){return e.behavior=tw(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return rh.isOnline()?ue(this,Ks).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,Ut)}getMutationCache(){return ue(this,Ks)}getDefaultOptions(){return ue(this,qs)}setDefaultOptions(e){Le(this,qs,e)}setQueryDefaults(e,t){ue(this,wl).set(ku(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ue(this,wl).values()],r={};return t.forEach(n=>{bu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){ue(this,_l).set(ku(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ue(this,_l).values()],r={};return t.forEach(n=>{bu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ue(this,qs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=V1(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===z1&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ue(this,qs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ue(this,Ut).clear(),ue(this,Ks).clear()}},Ut=new WeakMap,Ks=new WeakMap,qs=new WeakMap,wl=new WeakMap,_l=new WeakMap,Qs=new WeakMap,Sl=new WeakMap,kl=new WeakMap,e_),jR=_.createContext(void 0),RR=({client:e,children:t})=>(_.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(jR.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eu(){return Eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eu.apply(this,arguments)}var ei;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ei||(ei={}));const nw="popstate";function MR(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return ag("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:zb(a)}return OR(t,r,null,e)}function rr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function IR(){return Math.random().toString(36).substr(2,8)}function aw(e,t){return{usr:e.state,key:e.key,idx:t}}function ag(e,t,r,n){return r===void 0&&(r=null),Eu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Kl(t):t,{state:r,key:t&&t.key||n||IR()})}function zb(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Kl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function OR(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=ei.Pop,l=null,u=f();u==null&&(u=0,i.replaceState(Eu({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=ei.Pop;let y=f(),v=y==null?null:y-u;u=y,l&&l({action:o,location:p.location,delta:v})}function m(y,v){o=ei.Push;let x=ag(p.location,y,v);u=f()+1;let w=aw(x,u),S=p.createHref(x);try{i.pushState(w,"",S)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;a.location.assign(S)}s&&l&&l({action:o,location:p.location,delta:1})}function h(y,v){o=ei.Replace;let x=ag(p.location,y,v);u=f();let w=aw(x,u),S=p.createHref(x);i.replaceState(w,"",S),s&&l&&l({action:o,location:p.location,delta:0})}function g(y){let v=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof y=="string"?y:zb(y);return x=x.replace(/ $/,"%20"),rr(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let p={get action(){return o},get location(){return e(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(nw,d),l=y,()=>{a.removeEventListener(nw,d),l=null}},createHref(y){return t(a,y)},createURL:g,encodeLocation(y){let v=g(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:h,go(y){return i.go(y)}};return p}var sw;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(sw||(sw={}));function FR(e,t,r){return r===void 0&&(r="/"),LR(e,t,r)}function LR(e,t,r,n){let a=typeof t=="string"?Kl(t):t,s=Xb(a.pathname||"/",r);if(s==null)return null;let i=Gb(e);BR(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=QR(s);o=XR(i[l],u)}return o}function Gb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(rr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Ki([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(rr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Gb(s.children,t,f,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:GR(u,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of Yb(s.path))a(s,i,l)}),t}function Yb(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Yb(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function BR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:YR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const UR=/^:[\w-]+$/,$R=3,WR=2,HR=1,VR=10,zR=-2,iw=e=>e==="*";function GR(e,t){let r=e.split("/"),n=r.length;return r.some(iw)&&(n+=zR),t&&(n+=WR),r.filter(a=>!iw(a)).reduce((a,s)=>a+(UR.test(s)?$R:s===""?HR:VR),n)}function YR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function XR(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=KR({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),m=l.route;if(!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Ki([s,d.pathname]),pathnameBase:t8(Ki([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Ki([s,d.pathnameBase]))}return i}function KR(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=qR(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,f,d)=>{let{paramName:m,isOptional:h}=f;if(m==="*"){let p=o[d]||"";i=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const g=o[d];return h&&!g?u[m]=void 0:u[m]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:i,pattern:e}}function qR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Vb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function QR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Xb(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function JR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Kl(e):e;return{pathname:r?r.startsWith("/")?r:ZR(r,t):t,search:r8(n),hash:n8(a)}}function ZR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function dp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function e8(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Kb(e,t){let r=e8(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function qb(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Kl(e):(a=Eu({},e),rr(!a.pathname||!a.pathname.includes("?"),dp("?","pathname","search",a)),rr(!a.pathname||!a.pathname.includes("#"),dp("#","pathname","hash",a)),rr(!a.search||!a.search.includes("#"),dp("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;a.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=JR(a,o),u=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const Ki=e=>e.join("/").replace(/\/\/+/g,"/"),t8=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),r8=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,n8=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function a8(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qb=["post","put","patch","delete"];new Set(Qb);const s8=["get",...Qb];new Set(s8);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tu(){return Tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tu.apply(this,arguments)}const G1=_.createContext(null),i8=_.createContext(null),rf=_.createContext(null),Zh=_.createContext(null),Eo=_.createContext({outlet:null,matches:[],isDataRoute:!1}),Jb=_.createContext(null);function nf(){return _.useContext(Zh)!=null}function em(){return nf()||rr(!1),_.useContext(Zh).location}function Zb(e){_.useContext(rf).static||_.useLayoutEffect(e)}function ql(){let{isDataRoute:e}=_.useContext(Eo);return e?x8():o8()}function o8(){nf()||rr(!1);let e=_.useContext(G1),{basename:t,future:r,navigator:n}=_.useContext(rf),{matches:a}=_.useContext(Eo),{pathname:s}=em(),i=JSON.stringify(Kb(a,r.v7_relativeSplatPath)),o=_.useRef(!1);return Zb(()=>{o.current=!0}),_.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=qb(u,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ki([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}function l8(e,t){return c8(e,t)}function c8(e,t,r,n){nf()||rr(!1);let{navigator:a}=_.useContext(rf),{matches:s}=_.useContext(Eo),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=em(),f;if(t){var d;let y=typeof t=="string"?Kl(t):t;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||rr(!1),f=y}else f=u;let m=f.pathname||"/",h=m;if(l!=="/"){let y=l.replace(/^\//,"").split("/");h="/"+m.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=FR(e,{pathname:h}),p=m8(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Ki([l,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Ki([l,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&p?_.createElement(Zh.Provider,{value:{location:Tu({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:ei.Pop}},p):p}function u8(){let e=y8(),t=a8(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:a},r):null,null)}const f8=_.createElement(u8,null);class d8 extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_.createElement(Eo.Provider,{value:this.props.routeContext},_.createElement(Jb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function h8(e){let{routeContext:t,match:r,children:n}=e,a=_.useContext(G1);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(Eo.Provider,{value:t},n)}function m8(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||rr(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:m,errors:h}=r,g=d.route.loader&&m[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||g){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,d,m)=>{let h,g=!1,p=null,y=null;r&&(h=o&&d.route.id?o[d.route.id]:void 0,p=d.route.errorElement||f8,l&&(u<0&&m===0?(w8("route-fallback"),g=!0,y=null):u===m&&(g=!0,y=d.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,m+1)),x=()=>{let w;return h?w=p:g?w=y:d.route.Component?w=_.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=f,_.createElement(h8,{match:d,routeContext:{outlet:f,matches:v,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?_.createElement(d8,{location:r.location,revalidation:r.revalidation,component:p,error:h,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var e4=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(e4||{}),t4=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(t4||{});function p8(e){let t=_.useContext(G1);return t||rr(!1),t}function g8(e){let t=_.useContext(i8);return t||rr(!1),t}function v8(e){let t=_.useContext(Eo);return t||rr(!1),t}function r4(e){let t=v8(),r=t.matches[t.matches.length-1];return r.route.id||rr(!1),r.route.id}function y8(){var e;let t=_.useContext(Jb),r=g8(),n=r4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function x8(){let{router:e}=p8(e4.UseNavigateStable),t=r4(t4.UseNavigateStable),r=_.useRef(!1);return Zb(()=>{r.current=!0}),_.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Tu({fromRouteId:t},s)))},[e,t])}const ow={};function w8(e,t,r){ow[e]||(ow[e]=!0)}function _8(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function bd(e){let{to:t,replace:r,state:n,relative:a}=e;nf()||rr(!1);let{future:s,static:i}=_.useContext(rf),{matches:o}=_.useContext(Eo),{pathname:l}=em(),u=ql(),f=qb(t,Kb(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return _.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:a}),[u,d,a,r,n]),null}function Wo(e){rr(!1)}function S8(e){let{basename:t="/",children:r=null,location:n,navigationType:a=ei.Pop,navigator:s,static:i=!1,future:o}=e;nf()&&rr(!1);let l=t.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:l,navigator:s,static:i,future:Tu({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=Kl(n));let{pathname:f="/",search:d="",hash:m="",state:h=null,key:g="default"}=n,p=_.useMemo(()=>{let y=Xb(f,l);return y==null?null:{location:{pathname:y,search:d,hash:m,state:h,key:g},navigationType:a}},[l,f,d,m,h,g,a]);return p==null?null:_.createElement(rf.Provider,{value:u},_.createElement(Zh.Provider,{children:r,value:p}))}function k8(e){let{children:t,location:r}=e;return l8(sg(t),r)}new Promise(()=>{});function sg(e,t){t===void 0&&(t=[]);let r=[];return _.Children.forEach(e,(n,a)=>{if(!_.isValidElement(n))return;let s=[...t,a];if(n.type===_.Fragment){r.push.apply(r,sg(n.props.children,s));return}n.type!==Wo&&rr(!1),!n.props.index||!n.props.children||rr(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=sg(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const b8="6";try{window.__reactRouterVersion=b8}catch{}const E8="startTransition",lw=jg[E8];function T8(e){let{basename:t,children:r,future:n,window:a}=e,s=_.useRef();s.current==null&&(s.current=MR({window:a,v5Compat:!0}));let i=s.current,[o,l]=_.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},f=_.useCallback(d=>{u&&lw?lw(()=>l(d)):l(d)},[l,u]);return _.useLayoutEffect(()=>i.listen(f),[i,f]),_.useEffect(()=>_8(n),[n]),_.createElement(S8,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var cw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(cw||(cw={}));var uw;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(uw||(uw={}));const N8="modulepreload",C8=function(e){return"/"+e},fw={},A8=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=C8(l),l in fw)return;fw[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":N8,u||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((m,h)=>{d.addEventListener("load",m),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},ma=e=>{if(!e)return"";if(/^[A-Za-z]{3}-\d{2}$/.test(e))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return e;const r=t.toLocaleString("en-US",{month:"short"}),n=t.getFullYear().toString().slice(-2);return`${r}-${n}`}catch{return e}},P8=e=>e?`tel:${e.replace(/[^\d+]/g,"")}`:null,Nu=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),ig=e=>{if(!e)return"Not Set";if(/^\d{2}-[A-Za-z]{3}-\d{2}$/.test(e))return e;try{if(/^\d{2}-\d{2}-\d{2}$/.test(e)){const[r,n,a]=e.split("-"),s=new Date(`20${r}-${n}-${a}`);if(!isNaN(s.getTime()))return s.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}).replace(/ /g,"-")}const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}).replace(/ /g,"-")}catch{return e}},fi=()=>{const e=new Date,t=e.toLocaleString("en-US",{month:"short"}),r=e.getFullYear().toString().slice(-2);return`${t}-${r}`},D8=()=>{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=fi(),[r,n]=t.split("-"),a=parseInt(n),s=[];let i=25,o=0;for(;;){const u=`${e[o]}-${i.toString().padStart(2,"0")}`;if(s.push(u),u===t||(o++,o>=12&&(o=0,i++),i>a+1))break}return s},Rt="http://0.0.0.0:8000/api/v1";function dr(){const e=localStorage.getItem("access_token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}function n4(e){var t,r,n,a;return{id:e.application_id,applicant_id:e.application_id,loan_id:e.loan_id,payment_id:e.payment_id,demand_num:e.demand_num,applicant_name:e.applicant_name,branch_name:e.branch,team_lead:e.tl_name,rm_name:e.rm_name,dealer_name:e.dealer,lender_name:e.lender,lms_status:e.status||"Unknown",field_status:e.status,status:e.status,emi_amount:e.emi_amount,principle_due:0,interest_due:0,demand_date:e.emi_month,emi_month:e.emi_month,user_id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),ptp_date:e.ptp_date,latest_calling_status:e.calling_status,calling_status:e.calling_status,recent_comments:e.comments.map(s=>({content:s,user_name:"Unknown"})),comments:e.comments,applicant_mobile:e.mobile||"",applicant_address:"",co_applicant_name:"",co_applicant_mobile:"",co_applicant_address:"",guarantor_name:"",guarantor_mobile:"",guarantor_address:"",reference_name:"",reference_mobile:"",reference_address:"",fi_location:"",repayment:"",last_month_bounce:0,collection_rm:"",paid_date:"",applicant_calling_status:((t=e.calling_statuses)==null?void 0:t.applicant)||"Not Called",co_applicant_calling_status:((r=e.calling_statuses)==null?void 0:r.co_applicant)||"Not Called",guarantor_calling_status:((n=e.calling_statuses)==null?void 0:n.guarantor)||"Not Called",reference_calling_status:((a=e.calling_statuses)==null?void 0:a.reference)||"Not Called",disbursement_date:e.disbursement_date||"",loan_amount:e.loan_amount||0,vehicle_status:"",amount_collected:e.amount_collected||0,payment_mode:e.payment_mode||"",calling_statuses:e.calling_statuses||{},house_ownership:e.house_ownership||"",demand_calling_status:e.demand_calling_status||""}}async function hp(e,t=fi()){const r=new URLSearchParams({emi_month:t,search:e,offset:"0",limit:"1"}),n=await fetch(`${Rt}/applications/?${r.toString()}`,{headers:dr()});if(!n.ok)throw new Error("Failed to fetch application details");const a=await n.json();if(a.results&&a.results.length>0)return n4(a.results[0]);throw new Error("Application not found")}async function j8(e,t){const{SummaryService:r}=await A8(async()=>{const{SummaryService:n}=await import("./summaryService-BS4RUgEY.js");return{SummaryService:n}},[]);return r.getSummaryStatus(e,t)}async function R8(){const e=await fetch(`${Rt}/filters/options`,{headers:dr()});if(!e.ok)throw new Error("Failed to fetch filter options");return e.json()}async function M8(e,t=0,r=20,n={}){const a=new URLSearchParams;e&&a.append("emi_month",e),a.append("offset",t.toString()),a.append("limit",r.toString()),n.search&&a.append("search",n.search),n.branch&&n.branch.length>0&&a.append("branch",n.branch.join(",")),n.teamLead&&n.teamLead.length>0&&a.append("tl_name",n.teamLead.join(",")),n.rm&&n.rm.length>0&&a.append("rm_name",n.rm.join(",")),n.dealer&&n.dealer.length>0&&a.append("dealer",n.dealer.join(",")),n.lender&&n.lender.length>0&&a.append("lender",n.lender.join(",")),n.status&&n.status.length>0&&a.append("status",n.status.join(",")),n.repayment&&n.repayment.length>0&&a.append("demand_num",n.repayment.join(",")),n.ptpDate&&n.ptpDate.length>0&&a.append("ptp_date_filter",n.ptpDate.join(",")),n.vehicleStatus&&n.vehicleStatus.length>0&&a.append("vehicle_status",n.vehicleStatus.join(","));const s=await fetch(`${Rt}/applications/?${a.toString()}`,{headers:dr()});if(!s.ok)throw new Error("Failed to fetch applications");return console.log("🌐 API Request URL:",`${Rt}/applications/?${a.toString()}`),console.log("🌐 API Response status:",s.status),console.log("🌐 EMI Month being sent:",e),console.log("🌐 Repayment filters being sent:",n.repayment),console.log("🌐 PTP Date filters being sent:",n.ptpDate),await s.json()}async function I8(){const e=await fetch(`${Rt}/paidpending-approval/`,{headers:dr()});if(!e.ok)throw new Error("Failed to fetch pending approvals");return await e.json()}class O8{constructor(){ja(this,"_single",!1);ja(this,"_maybeSingle",!1);ja(this,"_selectFields",[]);ja(this,"_whereConditions",[]);ja(this,"_orderBy",null);ja(this,"_limitValue",null);ja(this,"_table","");ja(this,"_operation","select");ja(this,"_data",null)}from(t){return this._table=t,this}select(...t){return this._selectFields=t.length>0?t:["*"],this._operation="select",this}insert(t){return this._data=t,this._operation="insert",this}update(t){return this._data=t,this._operation="update",this}upsert(t){return this._data=t,this._operation="upsert",this}delete(){return this._operation="delete",this}eq(t,r){return this._whereConditions.push({field:t,operator:"eq",value:r}),this}in(t,r){return this._whereConditions.push({field:t,operator:"in",value:r}),this}gte(t,r){return this._whereConditions.push({field:t,operator:"gte",value:r}),this}lte(t,r){return this._whereConditions.push({field:t,operator:"lte",value:r}),this}order(t,r){return this._orderBy={field:t,ascending:r.ascending},this}limit(t){return this._limitValue=t,this}single(){return this._single=!0,this}maybeSingle(){return this._maybeSingle=!0,this}then(t,r){let n;this._operation==="select"?this._table==="field_status"?this._single||this._maybeSingle?n={data:{status:"1",calling_status:"1"},error:null,count:1}:n={data:[{status:"1",calling_status:"1"}],error:null,count:1}:this._table==="payment_details"?this._single||this._maybeSingle?n={data:{amount_collected:"1000"},error:null,count:1}:n={data:[{amount_collected:"1000"}],error:null,count:1}:this._single||this._maybeSingle?n={data:{},error:null,count:0}:n={data:[],error:null,count:0}:n={data:this._single||this._maybeSingle?null:[],error:null,count:0};const s=(t??(i=>i))(n);return{then:i=>{const o=i?i(s):s;return{then:l=>l?l(o):o}}}}}const Pe={from(e){return new O8},auth:{signOut:async()=>({error:null}),signUp:async e=>({data:{user:{id:"user1",email:e==null?void 0:e.email}},error:null}),admin:{createUser:async e=>({data:{user:{id:"user1",email:e==null?void 0:e.email}},error:null})}},functions:{invoke:async(e,t)=>({data:{successful:1,failed:0,errors:[]},error:null})},channel:e=>({on:()=>({subscribe:()=>({})}),subscribe:()=>({}),unsubscribe:()=>({})}),removeChannel:e=>{}};class Vn{static getAuthHeaders(){const t=localStorage.getItem("access_token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}static async login(t){const r=new FormData;r.append("username",t.email),r.append("password",t.password);const n=await fetch(`${Rt}/users/login`,{method:"POST",body:r});if(!n.ok){const s=await n.json();throw new Error(s.detail||"Login failed")}const a=await n.json();return localStorage.setItem("access_token",a.access_token),localStorage.setItem("user_id",a.user_id.toString()),localStorage.setItem("user_name",a.user_name),localStorage.setItem("user_role",a.user_role),localStorage.setItem("token_expires_at",(Date.now()+a.expires_in*1e3).toString()),a}static async logout(){try{await fetch(`${Rt}/users/logout`,{method:"POST",headers:this.getAuthHeaders()})}catch(t){console.error("Logout error:",t)}finally{localStorage.removeItem("access_token"),localStorage.removeItem("user_id"),localStorage.removeItem("user_name"),localStorage.removeItem("user_role"),localStorage.removeItem("token_expires_at")}}static async getCurrentUser(){const t=await fetch(`${Rt}/users/me`,{headers:this.getAuthHeaders()});if(!t.ok)throw new Error("Failed to get current user");const r=await t.json();return{id:r.id,name:r.name||"",user_name:r.name||"User",email:r.email||"",role:r.role||"",status:r.status||"active"}}static isAuthenticated(){const t=localStorage.getItem("access_token"),r=localStorage.getItem("token_expires_at");return!t||!r?!1:Date.now()>parseInt(r)?(this.logout(),!1):!0}static getCurrentUserRole(){return localStorage.getItem("user_role")}static getCurrentUserName(){return localStorage.getItem("user_name")}static getCurrentUserId(){const t=localStorage.getItem("user_id");return t?parseInt(t):null}static isAdmin(){return this.getCurrentUserRole()==="admin"}static isRM(){return this.getCurrentUserRole()==="RM"}static isTL(){return this.getCurrentUserRole()==="TL"}static canViewPendingApprovals(){return this.isAdmin()}}const a4=_.createContext(void 0),F8=({children:e})=>{const[t,r]=_.useState(null),[n,a]=_.useState(!1),[s,i]=_.useState(!0),o=async()=>{try{if(Vn.isAuthenticated()){const f=await Vn.getCurrentUser();r(f),a(!0)}else r(null),a(!1)}catch(f){console.error("Auth check failed:",f),r(null),a(!1),Vn.logout()}finally{i(!1)}},l=async f=>{try{i(!0);const d=await Vn.login(f),m=await Vn.getCurrentUser();r(m),a(!0)}catch(d){throw console.error("Login failed:",d),d}finally{i(!1)}},u=async()=>{try{i(!0),await Vn.logout(),r(null),a(!1)}catch(f){console.error("Logout failed:",f)}finally{i(!1)}};return _.useEffect(()=>{o()},[]),_.useEffect(()=>{const d=setInterval(()=>{Vn.isAuthenticated()&&o()},6e4);return()=>clearInterval(d)},[]),c.jsx(a4.Provider,{value:{user:t,isAuthenticated:n,loading:s,login:l,logout:u,checkAuth:o},children:e})},Bt=()=>{const e=_.useContext(a4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},s4=_.createContext(null),tm=()=>{const e=_.useContext(s4);if(!e)throw new Error("useRealtimeUpdates must be used within a RealtimeUpdateProvider");return e},L8=()=>{const e=_.useRef(new Set),t=_.useCallback(f=>(e.current.add(f),()=>{e.current.delete(f)}),[]),r=_.useCallback(f=>{e.current.forEach(d=>{try{d(f)}catch(m){console.error("Error in realtime update callback:",m)}})},[]),n=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying application update:",{applicationId:f,updates:d}),r({type:"APPLICATION_UPDATE",applicationId:f,updates:d,timestamp:Date.now()})},[r]),a=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying status update:",{applicationId:f,status:d}),r({type:"STATUS_UPDATE",applicationId:f,status:d,timestamp:Date.now()})},[r]),s=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying pre-EMI status update:",{applicationId:f,preEmiStatus:d}),r({type:"PRE_EMI_STATUS_UPDATE",applicationId:f,preEmiStatus:d,timestamp:Date.now()})},[r]),i=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying PTP date update:",{applicationId:f,ptpDate:d}),r({type:"PTP_DATE_UPDATE",applicationId:f,ptpDate:d,timestamp:Date.now()})},[r]),o=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying amount collected update:",{applicationId:f,amount:d}),r({type:"AMOUNT_COLLECTED_UPDATE",applicationId:f,amount:d,timestamp:Date.now()})},[r]),l=_.useCallback((f,d)=>{console.log("🔄 RealtimeUpdate: Notifying comment added:",{applicationId:f,comment:d}),r({type:"COMMENT_ADDED",applicationId:f,comment:d,timestamp:Date.now()})},[r]),u=_.useCallback((f,d,m)=>{console.log("🔄 RealtimeUpdate: Notifying contact status update:",{applicationId:f,contactType:d,status:m}),r({type:"CONTACT_STATUS_UPDATE",applicationId:f,contactType:d,status:m,timestamp:Date.now()})},[r]);return{subscribe:t,notify:r,notifyApplicationUpdate:n,notifyStatusUpdate:a,notifyPreEmiStatusUpdate:s,notifyPtpDateUpdate:i,notifyAmountCollectedUpdate:o,notifyCommentAdded:l,notifyContactStatusUpdate:u}},mp=({children:e,requireAdmin:t=!1,requireRole:r})=>{const{isAuthenticated:n,loading:a}=Bt();if(a)return c.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!n)return c.jsx(bd,{to:"/login",replace:!0});if(t&&!Vn.isAdmin())return c.jsx(bd,{to:"/",replace:!0});if(r&&r.length>0){const s=Vn.getCurrentUserRole();if(!s||!r.includes(s))return c.jsx(bd,{to:"/",replace:!0})}return c.jsx(c.Fragment,{children:e})},og=ef("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Te=_.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},s)=>{const i=n?eP:"button";return c.jsx(i,{className:Ce(og({variant:t,size:r,className:e})),ref:s,...a})});Te.displayName="Button";const Sr=_.forwardRef(({className:e,type:t,...r},n)=>c.jsx("input",{type:t,className:Ce("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Sr.displayName="Input";var B8="Label",i4=_.forwardRef((e,t)=>c.jsx(De.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));i4.displayName=B8;var o4=i4;const U8=ef("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Xe=_.forwardRef(({className:e,...t},r)=>c.jsx(o4,{ref:r,className:Ce(U8(),e),...t}));Xe.displayName=o4.displayName;const Qe=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ce("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Qe.displayName="Card";const _t=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ce("flex flex-col space-y-1.5 p-6",e),...t}));_t.displayName="CardHeader";const St=_.forwardRef(({className:e,...t},r)=>c.jsx("h3",{ref:r,className:Ce("text-2xl font-semibold leading-none tracking-tight",e),...t}));St.displayName="CardTitle";const qi=_.forwardRef(({className:e,...t},r)=>c.jsx("p",{ref:r,className:Ce("text-sm text-muted-foreground",e),...t}));qi.displayName="CardDescription";const at=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ce("p-6 pt-0",e),...t}));at.displayName="CardContent";const $8=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ce("flex items-center p-6 pt-0",e),...t}));$8.displayName="CardFooter";const W8=ef("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l4=_.forwardRef(({className:e,variant:t,...r},n)=>c.jsx("div",{ref:n,role:"alert",className:Ce(W8({variant:t}),e),...r}));l4.displayName="Alert";const H8=_.forwardRef(({className:e,...t},r)=>c.jsx("h5",{ref:r,className:Ce("mb-1 font-medium leading-none tracking-tight",e),...t}));H8.displayName="AlertTitle";const c4=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ce("text-sm [&_p]:leading-relaxed",e),...t}));c4.displayName="AlertDescription";const V8=()=>{const e=ql(),{login:t,loading:r}=Bt(),[n,a]=_.useState({email:"",password:""}),[s,i]=_.useState(!1),[o,l]=_.useState(null),u=async d=>{if(d.preventDefault(),l(null),!n.email||!n.password){l("Please enter both email and password");return}try{await t(n),e("/")}catch(m){l(m instanceof Error?m.message:"Login failed. Please try again.")}},f=(d,m)=>{a(h=>({...h,[d]:m}))};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:c.jsxs(Qe,{className:"w-full max-w-md shadow-xl",children:[c.jsxs(_t,{className:"text-center",children:[c.jsx("div",{className:"mx-auto mb-4 w-16 h-16 flex items-center justify-center",children:c.jsx("img",{src:"/uploads/logo.png",alt:"Prosparity Logo",className:"h-16 w-auto"})}),c.jsx(St,{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"})]}),c.jsx(at,{children:c.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o&&c.jsx(l4,{variant:"destructive",children:c.jsx(c4,{children:o})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),c.jsx(Sr,{id:"email",type:"email",placeholder:"Enter your email",value:n.email,onChange:d=>f("email",d.target.value),className:"w-full",disabled:r,required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Sr,{id:"password",type:s?"text":"password",placeholder:"Enter your password",value:n.password,onChange:d=>f("password",d.target.value),className:"w-full pr-10",disabled:r,required:!0}),c.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",disabled:r,children:s?c.jsx(t6,{size:16}):c.jsx(Xk,{size:16})})]})]}),c.jsx(Te,{type:"submit",className:"w-full bg-green-600 hover:bg-green-500 text-white",disabled:r,children:r?c.jsxs(c.Fragment,{children:[c.jsx(Bi,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]})})]})})};var pp="focusScope.autoFocusOnMount",gp="focusScope.autoFocusOnUnmount",dw={bubbles:!1,cancelable:!0},z8="FocusScope",rm=_.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...i}=e,[o,l]=_.useState(null),u=Jn(a),f=Jn(s),d=_.useRef(null),m=Je(t,p=>l(p)),h=_.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;_.useEffect(()=>{if(n){let p=function(w){if(h.paused||!o)return;const S=w.target;o.contains(S)?d.current=S:$s(d.current,{select:!0})},y=function(w){if(h.paused||!o)return;const S=w.relatedTarget;S!==null&&(o.contains(S)||$s(d.current,{select:!0}))},v=function(w){if(document.activeElement===document.body)for(const b of w)b.removedNodes.length>0&&$s(o)};document.addEventListener("focusin",p),document.addEventListener("focusout",y);const x=new MutationObserver(v);return o&&x.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",y),x.disconnect()}}},[n,o,h.paused]),_.useEffect(()=>{if(o){mw.add(h);const p=document.activeElement;if(!o.contains(p)){const v=new CustomEvent(pp,dw);o.addEventListener(pp,u),o.dispatchEvent(v),v.defaultPrevented||(G8(Q8(u4(o)),{select:!0}),document.activeElement===p&&$s(o))}return()=>{o.removeEventListener(pp,u),setTimeout(()=>{const v=new CustomEvent(gp,dw);o.addEventListener(gp,f),o.dispatchEvent(v),v.defaultPrevented||$s(p??document.body,{select:!0}),o.removeEventListener(gp,f),mw.remove(h)},0)}}},[o,u,f,h]);const g=_.useCallback(p=>{if(!r&&!n||h.paused)return;const y=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,v=document.activeElement;if(y&&v){const x=p.currentTarget,[w,S]=Y8(x);w&&S?!p.shiftKey&&v===S?(p.preventDefault(),r&&$s(w,{select:!0})):p.shiftKey&&v===w&&(p.preventDefault(),r&&$s(S,{select:!0})):v===x&&p.preventDefault()}},[r,n,h.paused]);return c.jsx(De.div,{tabIndex:-1,...i,ref:m,onKeyDown:g})});rm.displayName=z8;function G8(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if($s(n,{select:t}),document.activeElement!==r)return}function Y8(e){const t=u4(e),r=hw(t,e),n=hw(t.reverse(),e);return[r,n]}function u4(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function hw(e,t){for(const r of e)if(!X8(r,{upTo:t}))return r}function X8(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function K8(e){return e instanceof HTMLInputElement&&"select"in e}function $s(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&K8(e)&&t&&e.select()}}var mw=q8();function q8(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=pw(e,t),e.unshift(t)},remove(t){var r;e=pw(e,t),(r=e[0])==null||r.resume()}}}function pw(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Q8(e){return e.filter(t=>t.tagName!=="A")}var vp=0;function Y1(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??gw()),document.body.insertAdjacentElement("beforeend",e[1]??gw()),vp++,()=>{vp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),vp--}},[])}function gw(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Wa=function(){return Wa=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Wa.apply(this,arguments)};function f4(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function J8(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Ed="right-scroll-bar-position",Td="width-before-scroll-bar",Z8="with-scroll-bars-hidden",eM="--removed-body-scroll-bar-size";function yp(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function tM(e,t){var r=_.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var rM=typeof window<"u"?_.useLayoutEffect:_.useEffect,vw=new WeakMap;function nM(e,t){var r=tM(null,function(n){return e.forEach(function(a){return yp(a,n)})});return rM(function(){var n=vw.get(r);if(n){var a=new Set(n),s=new Set(e),i=r.current;a.forEach(function(o){s.has(o)||yp(o,null)}),s.forEach(function(o){a.has(o)||yp(o,i)})}vw.set(r,e)},[e]),r}function aM(e){return e}function sM(e,t){t===void 0&&(t=aM);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var i=t(s,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(s),i=r}var l=function(){var f=i;i=[],f.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),r={push:function(f){i.push(f),u()},filter:function(f){return i=i.filter(f),r}}}};return a}function iM(e){e===void 0&&(e={});var t=sM(null);return t.options=Wa({async:!0,ssr:!1},e),t}var d4=function(e){var t=e.sideCar,r=f4(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return _.createElement(n,Wa({},r))};d4.isSideCarExport=!0;function oM(e,t){return e.useMedium(t),d4}var h4=iM(),xp=function(){},nm=_.forwardRef(function(e,t){var r=_.useRef(null),n=_.useState({onScrollCapture:xp,onWheelCapture:xp,onTouchMoveCapture:xp}),a=n[0],s=n[1],i=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,m=e.sideCar,h=e.noRelative,g=e.noIsolation,p=e.inert,y=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=f4(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=m,E=nM([r,t]),k=Wa(Wa({},S),a);return _.createElement(_.Fragment,null,f&&_.createElement(b,{sideCar:h4,removeScrollBar:u,shards:d,noRelative:h,noIsolation:g,inert:p,setCallbacks:s,allowPinchZoom:!!y,lockRef:r,gapMode:w}),i?_.cloneElement(_.Children.only(o),Wa(Wa({},k),{ref:E})):_.createElement(x,Wa({},k,{className:l,ref:E}),o))});nm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};nm.classNames={fullWidth:Td,zeroRight:Ed};var lM=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cM(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=lM();return t&&e.setAttribute("nonce",t),e}function uM(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function fM(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var dM=function(){var e=0,t=null;return{add:function(r){e==0&&(t=cM())&&(uM(t,r),fM(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},hM=function(){var e=dM();return function(t,r){_.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},m4=function(){var e=hM(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},mM={left:0,top:0,right:0,gap:0},wp=function(e){return parseInt(e||"",10)||0},pM=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[wp(r),wp(n),wp(a)]},gM=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return mM;var t=pM(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},vM=m4(),fl="data-scroll-locked",yM=function(e,t,r,n){var a=e.left,s=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Z8,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(fl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ed,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Td,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Ed," .").concat(Ed,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Td," .").concat(Td,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(fl,`] {
    `).concat(eM,": ").concat(o,`px;
  }
`)},yw=function(){var e=parseInt(document.body.getAttribute(fl)||"0",10);return isFinite(e)?e:0},xM=function(){_.useEffect(function(){return document.body.setAttribute(fl,(yw()+1).toString()),function(){var e=yw()-1;e<=0?document.body.removeAttribute(fl):document.body.setAttribute(fl,e.toString())}},[])},wM=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;xM();var s=_.useMemo(function(){return gM(a)},[a]);return _.createElement(vM,{styles:yM(s,!t,a,r?"":"!important")})},lg=!1;if(typeof window<"u")try{var Gf=Object.defineProperty({},"passive",{get:function(){return lg=!0,!0}});window.addEventListener("test",Gf,Gf),window.removeEventListener("test",Gf,Gf)}catch{lg=!1}var Io=lg?{passive:!1}:!1,_M=function(e){return e.tagName==="TEXTAREA"},p4=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!_M(e)&&r[t]==="visible")},SM=function(e){return p4(e,"overflowY")},kM=function(e){return p4(e,"overflowX")},xw=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=g4(e,n);if(a){var s=v4(e,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},bM=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},EM=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},g4=function(e,t){return e==="v"?SM(t):kM(t)},v4=function(e,t){return e==="v"?bM(t):EM(t)},TM=function(e,t){return e==="h"&&t==="rtl"?-1:1},NM=function(e,t,r,n,a){var s=TM(e,window.getComputedStyle(t).direction),i=s*n,o=r.target,l=t.contains(o),u=!1,f=i>0,d=0,m=0;do{if(!o)break;var h=v4(e,o),g=h[0],p=h[1],y=h[2],v=p-y-s*g;(g||v)&&g4(e,o)&&(d+=v,m+=g);var x=o.parentNode;o=x&&x.nodeType===Node.DOCUMENT_FRAGMENT_NODE?x.host:x}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(f&&Math.abs(d)<1||!f&&Math.abs(m)<1)&&(u=!0),u},Yf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ww=function(e){return[e.deltaX,e.deltaY]},_w=function(e){return e&&"current"in e?e.current:e},CM=function(e,t){return e[0]===t[0]&&e[1]===t[1]},AM=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},PM=0,Oo=[];function DM(e){var t=_.useRef([]),r=_.useRef([0,0]),n=_.useRef(),a=_.useState(PM++)[0],s=_.useState(m4)[0],i=_.useRef(e);_.useEffect(function(){i.current=e},[e]),_.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var p=J8([e.lockRef.current],(e.shards||[]).map(_w),!0).filter(Boolean);return p.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),p.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=_.useCallback(function(p,y){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!i.current.allowPinchZoom;var v=Yf(p),x=r.current,w="deltaX"in p?p.deltaX:x[0]-v[0],S="deltaY"in p?p.deltaY:x[1]-v[1],b,E=p.target,k=Math.abs(w)>Math.abs(S)?"h":"v";if("touches"in p&&k==="h"&&E.type==="range")return!1;var T=xw(k,E);if(!T)return!0;if(T?b=k:(b=k==="v"?"h":"v",T=xw(k,E)),!T)return!1;if(!n.current&&"changedTouches"in p&&(w||S)&&(n.current=b),!b)return!0;var N=n.current||b;return NM(N,y,p,N==="h"?w:S)},[]),l=_.useCallback(function(p){var y=p;if(!(!Oo.length||Oo[Oo.length-1]!==s)){var v="deltaY"in y?ww(y):Yf(y),x=t.current.filter(function(b){return b.name===y.type&&(b.target===y.target||y.target===b.shadowParent)&&CM(b.delta,v)})[0];if(x&&x.should){y.cancelable&&y.preventDefault();return}if(!x){var w=(i.current.shards||[]).map(_w).filter(Boolean).filter(function(b){return b.contains(y.target)}),S=w.length>0?o(y,w[0]):!i.current.noIsolation;S&&y.cancelable&&y.preventDefault()}}},[]),u=_.useCallback(function(p,y,v,x){var w={name:p,delta:y,target:v,should:x,shadowParent:jM(v)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(S){return S!==w})},1)},[]),f=_.useCallback(function(p){r.current=Yf(p),n.current=void 0},[]),d=_.useCallback(function(p){u(p.type,ww(p),p.target,o(p,e.lockRef.current))},[]),m=_.useCallback(function(p){u(p.type,Yf(p),p.target,o(p,e.lockRef.current))},[]);_.useEffect(function(){return Oo.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:m}),document.addEventListener("wheel",l,Io),document.addEventListener("touchmove",l,Io),document.addEventListener("touchstart",f,Io),function(){Oo=Oo.filter(function(p){return p!==s}),document.removeEventListener("wheel",l,Io),document.removeEventListener("touchmove",l,Io),document.removeEventListener("touchstart",f,Io)}},[]);var h=e.removeScrollBar,g=e.inert;return _.createElement(_.Fragment,null,g?_.createElement(s,{styles:AM(a)}):null,h?_.createElement(wM,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function jM(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const RM=oM(h4,DM);var am=_.forwardRef(function(e,t){return _.createElement(nm,Wa({},e,{ref:t,sideCar:RM}))});am.classNames=nm.classNames;var MM=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Fo=new WeakMap,Xf=new WeakMap,Kf={},_p=0,y4=function(e){return e&&(e.host||y4(e.parentNode))},IM=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=y4(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},OM=function(e,t,r,n){var a=IM(t,Array.isArray(e)?e:[e]);Kf[r]||(Kf[r]=new WeakMap);var s=Kf[r],i=[],o=new Set,l=new Set(a),u=function(d){!d||o.has(d)||(o.add(d),u(d.parentNode))};a.forEach(u);var f=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(m){if(o.has(m))f(m);else try{var h=m.getAttribute(n),g=h!==null&&h!=="false",p=(Fo.get(m)||0)+1,y=(s.get(m)||0)+1;Fo.set(m,p),s.set(m,y),i.push(m),p===1&&g&&Xf.set(m,!0),y===1&&m.setAttribute(r,"true"),g||m.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",m,v)}})};return f(t),o.clear(),_p++,function(){i.forEach(function(d){var m=Fo.get(d)-1,h=s.get(d)-1;Fo.set(d,m),s.set(d,h),m||(Xf.has(d)||d.removeAttribute(n),Xf.delete(d)),h||d.removeAttribute(r)}),_p--,_p||(Fo=new WeakMap,Fo=new WeakMap,Xf=new WeakMap,Kf={})}},X1=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=MM(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),OM(n,a,r,"aria-hidden")):function(){return null}},sm="Dialog",[x4,tQ]=Mn(sm),[FM,Aa]=x4(sm),w4=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!0}=e,o=_.useRef(null),l=_.useRef(null),[u,f]=qa({prop:n,defaultProp:a??!1,onChange:s,caller:sm});return c.jsx(FM,{scope:t,triggerRef:o,contentRef:l,contentId:Xa(),titleId:Xa(),descriptionId:Xa(),open:u,onOpenChange:f,onOpenToggle:_.useCallback(()=>f(d=>!d),[f]),modal:i,children:r})};w4.displayName=sm;var _4="DialogTrigger",S4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Aa(_4,r),s=Je(t,a.triggerRef);return c.jsx(De.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Q1(a.open),...n,ref:s,onClick:Ne(e.onClick,a.onOpenToggle)})});S4.displayName=_4;var K1="DialogPortal",[LM,k4]=x4(K1,{forceMount:void 0}),b4=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,s=Aa(K1,t);return c.jsx(LM,{scope:t,forceMount:r,children:_.Children.map(n,i=>c.jsx(Ca,{present:r||s.open,children:c.jsx(Ju,{asChild:!0,container:a,children:i})}))})};b4.displayName=K1;var nh="DialogOverlay",E4=_.forwardRef((e,t)=>{const r=k4(nh,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Aa(nh,e.__scopeDialog);return s.modal?c.jsx(Ca,{present:n||s.open,children:c.jsx(UM,{...a,ref:t})}):null});E4.displayName=nh;var BM=io("DialogOverlay.RemoveScroll"),UM=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Aa(nh,r);return c.jsx(am,{as:BM,allowPinchZoom:!0,shards:[a.contentRef],children:c.jsx(De.div,{"data-state":Q1(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),co="DialogContent",T4=_.forwardRef((e,t)=>{const r=k4(co,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Aa(co,e.__scopeDialog);return c.jsx(Ca,{present:n||s.open,children:s.modal?c.jsx($M,{...a,ref:t}):c.jsx(WM,{...a,ref:t})})});T4.displayName=co;var $M=_.forwardRef((e,t)=>{const r=Aa(co,e.__scopeDialog),n=_.useRef(null),a=Je(t,r.contentRef,n);return _.useEffect(()=>{const s=n.current;if(s)return X1(s)},[]),c.jsx(N4,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ne(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Ne(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&s.preventDefault()}),onFocusOutside:Ne(e.onFocusOutside,s=>s.preventDefault())})}),WM=_.forwardRef((e,t)=>{const r=Aa(co,e.__scopeDialog),n=_.useRef(!1),a=_.useRef(!1);return c.jsx(N4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),N4=_.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,...i}=e,o=Aa(co,r),l=_.useRef(null),u=Je(t,l);return Y1(),c.jsxs(c.Fragment,{children:[c.jsx(rm,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:c.jsx(Hl,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":Q1(o.open),...i,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(HM,{titleId:o.titleId}),c.jsx(zM,{contentRef:l,descriptionId:o.descriptionId})]})]})}),q1="DialogTitle",C4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Aa(q1,r);return c.jsx(De.h2,{id:a.titleId,...n,ref:t})});C4.displayName=q1;var A4="DialogDescription",P4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Aa(A4,r);return c.jsx(De.p,{id:a.descriptionId,...n,ref:t})});P4.displayName=A4;var D4="DialogClose",j4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Aa(D4,r);return c.jsx(De.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,()=>a.onOpenChange(!1))})});j4.displayName=D4;function Q1(e){return e?"open":"closed"}var R4="DialogTitleWarning",[rQ,M4]=JA(R4,{contentName:co,titleName:q1,docsSlug:"dialog"}),HM=({titleId:e})=>{const t=M4(R4),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return _.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},VM="DialogDescriptionWarning",zM=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${M4(VM).contentName}}.`;return _.useEffect(()=>{var s;const a=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},GM=w4,YM=S4,XM=b4,I4=E4,O4=T4,F4=C4,L4=P4,KM=j4;const Ql=GM,af=YM,qM=XM,B4=_.forwardRef(({className:e,...t},r)=>c.jsx(I4,{ref:r,className:Ce("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));B4.displayName=I4.displayName;const To=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(qM,{children:[c.jsx(B4,{}),c.jsxs(O4,{ref:n,className:Ce("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,c.jsxs(KM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(Vl,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));To.displayName=O4.displayName;const No=({className:e,...t})=>c.jsx("div",{className:Ce("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});No.displayName="DialogHeader";const Jl=_.forwardRef(({className:e,...t},r)=>c.jsx(F4,{ref:r,className:Ce("text-lg font-semibold leading-none tracking-tight",e),...t}));Jl.displayName=F4.displayName;const sf=_.forwardRef(({className:e,...t},r)=>c.jsx(L4,{ref:r,className:Ce("text-sm text-muted-foreground",e),...t}));sf.displayName=L4.displayName;var QM=_.createContext(void 0);function im(e){const t=_.useContext(QM);return e||t||"ltr"}var Sp="rovingFocusGroup.onEntryFocus",JM={bubbles:!1,cancelable:!0},of="RovingFocusGroup",[cg,U4,ZM]=k1(of),[eI,om]=Mn(of,[ZM]),[tI,rI]=eI(of),$4=_.forwardRef((e,t)=>c.jsx(cg.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(cg.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(nI,{...e,ref:t})})}));$4.displayName=of;var nI=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...d}=e,m=_.useRef(null),h=Je(t,m),g=im(s),[p,y]=qa({prop:i,defaultProp:o??null,onChange:l,caller:of}),[v,x]=_.useState(!1),w=Jn(u),S=U4(r),b=_.useRef(!1),[E,k]=_.useState(0);return _.useEffect(()=>{const T=m.current;if(T)return T.addEventListener(Sp,w),()=>T.removeEventListener(Sp,w)},[w]),c.jsx(tI,{scope:r,orientation:n,dir:g,loop:a,currentTabStopId:p,onItemFocus:_.useCallback(T=>y(T),[y]),onItemShiftTab:_.useCallback(()=>x(!0),[]),onFocusableItemAdd:_.useCallback(()=>k(T=>T+1),[]),onFocusableItemRemove:_.useCallback(()=>k(T=>T-1),[]),children:c.jsx(De.div,{tabIndex:v||E===0?-1:0,"data-orientation":n,...d,ref:h,style:{outline:"none",...e.style},onMouseDown:Ne(e.onMouseDown,()=>{b.current=!0}),onFocus:Ne(e.onFocus,T=>{const N=!b.current;if(T.target===T.currentTarget&&N&&!v){const I=new CustomEvent(Sp,JM);if(T.currentTarget.dispatchEvent(I),!I.defaultPrevented){const H=S().filter(Q=>Q.focusable),j=H.find(Q=>Q.active),z=H.find(Q=>Q.id===p),q=[j,z,...H].filter(Boolean).map(Q=>Q.ref.current);V4(q,f)}}b.current=!1}),onBlur:Ne(e.onBlur,()=>x(!1))})})}),W4="RovingFocusGroupItem",H4=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:s,children:i,...o}=e,l=Xa(),u=s||l,f=rI(W4,r),d=f.currentTabStopId===u,m=U4(r),{onFocusableItemAdd:h,onFocusableItemRemove:g,currentTabStopId:p}=f;return _.useEffect(()=>{if(n)return h(),()=>g()},[n,h,g]),c.jsx(cg.ItemSlot,{scope:r,id:u,focusable:n,active:a,children:c.jsx(De.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...o,ref:t,onMouseDown:Ne(e.onMouseDown,y=>{n?f.onItemFocus(u):y.preventDefault()}),onFocus:Ne(e.onFocus,()=>f.onItemFocus(u)),onKeyDown:Ne(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){f.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const v=iI(y,f.orientation,f.dir);if(v!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=m().filter(S=>S.focusable).map(S=>S.ref.current);if(v==="last")w.reverse();else if(v==="prev"||v==="next"){v==="prev"&&w.reverse();const S=w.indexOf(y.currentTarget);w=f.loop?oI(w,S+1):w.slice(S+1)}setTimeout(()=>V4(w))}}),children:typeof i=="function"?i({isCurrentTabStop:d,hasTabStop:p!=null}):i})})});H4.displayName=W4;var aI={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sI(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function iI(e,t,r){const n=sI(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return aI[n]}function V4(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function oI(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var z4=$4,G4=H4;function J1(e){const t=_.useRef({value:e,previous:e});return _.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Z1="Radio",[lI,Y4]=Mn(Z1),[cI,uI]=lI(Z1),X4=_.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:s,disabled:i,value:o="on",onCheck:l,form:u,...f}=e,[d,m]=_.useState(null),h=Je(t,y=>m(y)),g=_.useRef(!1),p=d?u||!!d.closest("form"):!0;return c.jsxs(cI,{scope:r,checked:a,disabled:i,children:[c.jsx(De.button,{type:"button",role:"radio","aria-checked":a,"data-state":J4(a),"data-disabled":i?"":void 0,disabled:i,value:o,...f,ref:h,onClick:Ne(e.onClick,y=>{a||l==null||l(),p&&(g.current=y.isPropagationStopped(),g.current||y.stopPropagation())})}),p&&c.jsx(Q4,{control:d,bubbles:!g.current,name:n,value:o,checked:a,required:s,disabled:i,form:u,style:{transform:"translateX(-100%)"}})]})});X4.displayName=Z1;var K4="RadioIndicator",q4=_.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,s=uI(K4,r);return c.jsx(Ca,{present:n||s.checked,children:c.jsx(De.span,{"data-state":J4(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})})});q4.displayName=K4;var fI="RadioBubbleInput",Q4=_.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=_.useRef(null),o=Je(i,s),l=J1(r),u=L1(t);return _.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&h){const g=new Event("click",{bubbles:n});h.call(f,r),f.dispatchEvent(g)}},[l,r,n]),c.jsx(De.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Q4.displayName=fI;function J4(e){return e?"checked":"unchecked"}var dI=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],lm="RadioGroup",[hI,nQ]=Mn(lm,[om,Y4]),Z4=om(),eE=Y4(),[mI,pI]=hI(lm),tE=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:s,required:i=!1,disabled:o=!1,orientation:l,dir:u,loop:f=!0,onValueChange:d,...m}=e,h=Z4(r),g=im(u),[p,y]=qa({prop:s,defaultProp:a??null,onChange:d,caller:lm});return c.jsx(mI,{scope:r,name:n,required:i,disabled:o,value:p,onValueChange:y,children:c.jsx(z4,{asChild:!0,...h,orientation:l,dir:g,loop:f,children:c.jsx(De.div,{role:"radiogroup","aria-required":i,"aria-orientation":l,"data-disabled":o?"":void 0,dir:g,...m,ref:t})})})});tE.displayName=lm;var rE="RadioGroupItem",nE=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,s=pI(rE,r),i=s.disabled||n,o=Z4(r),l=eE(r),u=_.useRef(null),f=Je(t,u),d=s.value===a.value,m=_.useRef(!1);return _.useEffect(()=>{const h=p=>{dI.includes(p.key)&&(m.current=!0)},g=()=>m.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",g)}},[]),c.jsx(G4,{asChild:!0,...o,focusable:!i,active:d,children:c.jsx(X4,{disabled:i,required:s.required,checked:d,...l,...a,name:s.name,ref:f,onCheck:()=>s.onValueChange(a.value),onKeyDown:Ne(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:Ne(a.onFocus,()=>{var h;m.current&&((h=u.current)==null||h.click())})})})});nE.displayName=rE;var gI="RadioGroupIndicator",aE=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=eE(r);return c.jsx(q4,{...a,...n,ref:t})});aE.displayName=gI;var sE=tE,iE=nE,vI=aE;const cm=_.forwardRef(({className:e,...t},r)=>c.jsx(sE,{className:Ce("grid gap-2",e),...t,ref:r}));cm.displayName=sE.displayName;const gs=_.forwardRef(({className:e,...t},r)=>c.jsx(iE,{ref:r,className:Ce("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx(vI,{className:"flex items-center justify-center",children:c.jsx(JP,{className:"h-2.5 w-2.5 fill-current text-current"})})}));gs.displayName=iE.displayName;function tt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function hn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Dr(e,t){const r=tt(e);return isNaN(t)?hn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Ta(e,t){const r=tt(e);if(isNaN(t))return hn(e,NaN);if(!t)return r;const n=r.getDate(),a=hn(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const s=a.getDate();return n>=s?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const ev=6048e5,yI=864e5;let xI={};function lf(){return xI}function Ja(e,t){var o,l,u,f;const r=lf(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,a=tt(e),s=a.getDay(),i=(s<n?7:0)+s-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function uo(e){return Ja(e,{weekStartsOn:1})}function oE(e){const t=tt(e),r=t.getFullYear(),n=hn(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=uo(n),s=hn(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const i=uo(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function fo(e){const t=tt(e);return t.setHours(0,0,0,0),t}function ah(e){const t=tt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Va(e,t){const r=fo(e),n=fo(t),a=+r-ah(r),s=+n-ah(n);return Math.round((a-s)/yI)}function wI(e){const t=oE(e),r=hn(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),uo(r)}function ug(e,t){const r=t*7;return Dr(e,r)}function _I(e,t){return Ta(e,t*12)}function SI(e){let t;return e.forEach(function(r){const n=tt(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function kI(e){let t;return e.forEach(r=>{const n=tt(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function lE(e){return hn(e,Date.now())}function Lr(e,t){const r=fo(e),n=fo(t);return+r==+n}function tv(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bI(e){if(!tv(e)&&typeof e!="number")return!1;const t=tt(e);return!isNaN(Number(t))}function Cu(e,t){const r=tt(e),n=tt(t),a=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return a*12+s}function EI(e,t,r){const n=Ja(e,r),a=Ja(t,r),s=+n-ah(n),i=+a-ah(a);return Math.round((s-i)/ev)}function rv(e){const t=tt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function fn(e){const t=tt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function cE(e){const t=tt(e),r=hn(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function nv(e,t){var o,l,u,f;const r=lf(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,a=tt(e),s=a.getDay(),i=(s<n?-7:0)+6-(s-n);return a.setDate(a.getDate()+i),a.setHours(23,59,59,999),a}function uE(e){return nv(e,{weekStartsOn:1})}const TI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},NI=(e,t,r)=>{let n;const a=TI[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function kp(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const CI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},AI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},PI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},DI={date:kp({formats:CI,defaultWidth:"full"}),time:kp({formats:AI,defaultWidth:"full"}),dateTime:kp({formats:PI,defaultWidth:"full"})},jI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},RI=(e,t,r,n)=>jI[e];function kc(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;a=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const MI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},II={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},OI={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},FI={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},BI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},UI=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},$I={ordinalNumber:UI,era:kc({values:MI,defaultWidth:"wide"}),quarter:kc({values:II,defaultWidth:"wide",argumentCallback:e=>e-1}),month:kc({values:OI,defaultWidth:"wide"}),day:kc({values:FI,defaultWidth:"wide"}),dayPeriod:kc({values:LI,defaultWidth:"wide",formattingValues:BI,defaultFormattingWidth:"wide"})};function bc(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?HI(o,d=>d.test(i)):WI(o,d=>d.test(i));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(i.length);return{value:u,rest:f}}}function WI(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function HI(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function VI(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(a.length);return{value:i,rest:o}}}const zI=/^(\d+)(th|st|nd|rd)?/i,GI=/\d+/i,YI={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},XI={any:[/^b/i,/^(a|c)/i]},KI={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qI={any:[/1/i,/2/i,/3/i,/4/i]},QI={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},JI={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ZI={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},eO={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},tO={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},rO={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nO={ordinalNumber:VI({matchPattern:zI,parsePattern:GI,valueCallback:e=>parseInt(e,10)}),era:bc({matchPatterns:YI,defaultMatchWidth:"wide",parsePatterns:XI,defaultParseWidth:"any"}),quarter:bc({matchPatterns:KI,defaultMatchWidth:"wide",parsePatterns:qI,defaultParseWidth:"any",valueCallback:e=>e+1}),month:bc({matchPatterns:QI,defaultMatchWidth:"wide",parsePatterns:JI,defaultParseWidth:"any"}),day:bc({matchPatterns:ZI,defaultMatchWidth:"wide",parsePatterns:eO,defaultParseWidth:"any"}),dayPeriod:bc({matchPatterns:tO,defaultMatchWidth:"any",parsePatterns:rO,defaultParseWidth:"any"})},fE={code:"en-US",formatDistance:NI,formatLong:DI,formatRelative:RI,localize:$I,match:nO,options:{weekStartsOn:0,firstWeekContainsDate:1}};function aO(e){const t=tt(e);return Va(t,cE(t))+1}function dE(e){const t=tt(e),r=+uo(t)-+wI(t);return Math.round(r/ev)+1}function hE(e,t){var f,d,m,h;const r=tt(e),n=r.getFullYear(),a=lf(),s=(t==null?void 0:t.firstWeekContainsDate)??((d=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(m=a.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,i=hn(e,0);i.setFullYear(n+1,0,s),i.setHours(0,0,0,0);const o=Ja(i,t),l=hn(e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=Ja(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function sO(e,t){var o,l,u,f;const r=lf(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,a=hE(e,t),s=hn(e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Ja(s,t)}function mE(e,t){const r=tt(e),n=+Ja(r,t)-+sO(r,t);return Math.round(n/ev)+1}function lt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Fs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return lt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):lt(r+1,2)},d(e,t){return lt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return lt(e.getHours()%12||12,t.length)},H(e,t){return lt(e.getHours(),t.length)},m(e,t){return lt(e.getMinutes(),t.length)},s(e,t){return lt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return lt(a,t.length)}},Lo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Sw={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Fs.y(e,t)},Y:function(e,t,r,n){const a=hE(e,n),s=a>0?a:1-a;if(t==="YY"){const i=s%100;return lt(i,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):lt(s,t.length)},R:function(e,t){const r=oE(e);return lt(r,t.length)},u:function(e,t){const r=e.getFullYear();return lt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return lt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return lt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Fs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return lt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=mE(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):lt(a,t.length)},I:function(e,t,r){const n=dE(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):lt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Fs.d(e,t)},D:function(e,t,r){const n=aO(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):lt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return lt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return lt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return lt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Lo.noon:n===0?a=Lo.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Lo.evening:n>=12?a=Lo.afternoon:n>=4?a=Lo.morning:a=Lo.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Fs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Fs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):lt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):lt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Fs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Fs.s(e,t)},S:function(e,t){return Fs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return bw(n);case"XXXX":case"XX":return Ri(n);case"XXXXX":case"XXX":default:return Ri(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return bw(n);case"xxxx":case"xx":return Ri(n);case"xxxxx":case"xxx":default:return Ri(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+kw(n,":");case"OOOO":default:return"GMT"+Ri(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+kw(n,":");case"zzzz":default:return"GMT"+Ri(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return lt(n,t.length)},T:function(e,t,r){const n=e.getTime();return lt(n,t.length)}};function kw(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+t+lt(s,2)}function bw(e,t){return e%60===0?(e>0?"-":"+")+lt(Math.abs(e)/60,2):Ri(e,t)}function Ri(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=lt(Math.trunc(n/60),2),s=lt(n%60,2);return r+a+t+s}const Ew=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},pE=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},iO=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Ew(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Ew(n,t)).replace("{{time}}",pE(a,t))},oO={p:pE,P:iO},lO=/^D+$/,cO=/^Y+$/,uO=["D","DD","YY","YYYY"];function fO(e){return lO.test(e)}function dO(e){return cO.test(e)}function hO(e,t,r){const n=mO(e,t,r);if(console.warn(n),uO.includes(e))throw new RangeError(n)}function mO(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const pO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,gO=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,vO=/^'([^]*?)'?$/,yO=/''/g,xO=/[a-zA-Z]/;function Ft(e,t,r){var f,d,m,h,g,p,y,v;const n=lf(),a=(r==null?void 0:r.locale)??n.locale??fE,s=(r==null?void 0:r.firstWeekContainsDate)??((d=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(m=n.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((p=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((v=(y=n.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??0,o=tt(e);if(!bI(o))throw new RangeError("Invalid time value");let l=t.match(gO).map(x=>{const w=x[0];if(w==="p"||w==="P"){const S=oO[w];return S(x,a.formatLong)}return x}).join("").match(pO).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const w=x[0];if(w==="'")return{isToken:!1,value:wO(x)};if(Sw[w])return{isToken:!0,value:x};if(w.match(xO))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:i,locale:a};return l.map(x=>{if(!x.isToken)return x.value;const w=x.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&dO(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&fO(w))&&hO(w,t,String(e));const S=Sw[w[0]];return S(o,w,a.localize,u)}).join("")}function wO(e){const t=e.match(vO);return t?t[1].replace(yO,"'"):e}function _O(e){const t=tt(e),r=t.getFullYear(),n=t.getMonth(),a=hn(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function SO(e){return Math.trunc(+tt(e)/1e3)}function kO(e){const t=tt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function bO(e,t){return EI(kO(e),fn(e),t)+1}function sh(e,t){const r=tt(e),n=tt(t);return r.getTime()>n.getTime()}function av(e,t){const r=tt(e),n=tt(t);return+r<+n}function sv(e,t){const r=tt(e),n=tt(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function EO(e,t){const r=tt(e),n=tt(t);return r.getFullYear()===n.getFullYear()}function TO(e){return Lr(e,lE(e))}function Tw(e){return Lr(e,Dr(lE(e),1))}function bp(e,t){return Dr(e,-t)}function Ep(e,t){const r=tt(e),n=r.getFullYear(),a=r.getDate(),s=hn(e,0);s.setFullYear(n,t,15),s.setHours(0,0,0,0);const i=_O(s);return r.setMonth(t,Math.min(a,i)),r}function Nw(e,t){const r=tt(e);return isNaN(+r)?hn(e,NaN):(r.setFullYear(t),r)}var Ie=function(){return Ie=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ie.apply(this,arguments)};function NO(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function gE(e,t,r){for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function cf(e){return e.mode==="multiple"}function uf(e){return e.mode==="range"}function um(e){return e.mode==="single"}var CO={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function AO(e,t){return Ft(e,"LLLL y",t)}function PO(e,t){return Ft(e,"d",t)}function DO(e,t){return Ft(e,"LLLL",t)}function jO(e){return"".concat(e)}function RO(e,t){return Ft(e,"cccccc",t)}function MO(e,t){return Ft(e,"yyyy",t)}var IO=Object.freeze({__proto__:null,formatCaption:AO,formatDay:PO,formatMonthCaption:DO,formatWeekNumber:jO,formatWeekdayName:RO,formatYearCaption:MO}),OO=function(e,t,r){return Ft(e,"do MMMM (EEEE)",r)},FO=function(){return"Month: "},LO=function(){return"Go to next month"},BO=function(){return"Go to previous month"},UO=function(e,t){return Ft(e,"cccc",t)},$O=function(e){return"Week n. ".concat(e)},WO=function(){return"Year: "},HO=Object.freeze({__proto__:null,labelDay:OO,labelMonthDropdown:FO,labelNext:LO,labelPrevious:BO,labelWeekNumber:$O,labelWeekday:UO,labelYearDropdown:WO});function VO(){var e="buttons",t=CO,r=fE,n={},a={},s=1,i={},o=new Date;return{captionLayout:e,classNames:t,formatters:IO,labels:HO,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:s,styles:i,today:o,mode:"default"}}function zO(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,s=e.fromDate,i=e.toDate;return n?s=fn(n):t&&(s=new Date(t,0,1)),a?i=rv(a):r&&(i=new Date(r,11,31)),{fromDate:s?fo(s):void 0,toDate:i?fo(i):void 0}}var vE=_.createContext(void 0);function GO(e){var t,r=e.initialProps,n=VO(),a=zO(r),s=a.fromDate,i=a.toDate,o=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;o!=="buttons"&&(!s||!i)&&(o="buttons");var l;(um(r)||cf(r)||uf(r))&&(l=r.onSelect);var u=Ie(Ie(Ie({},n),r),{captionLayout:o,classNames:Ie(Ie({},n.classNames),r.classNames),components:Ie({},r.components),formatters:Ie(Ie({},n.formatters),r.formatters),fromDate:s,labels:Ie(Ie({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Ie(Ie({},n.modifiers),r.modifiers),modifiersClassNames:Ie(Ie({},n.modifiersClassNames),r.modifiersClassNames),onSelect:l,styles:Ie(Ie({},n.styles),r.styles),toDate:i});return c.jsx(vE.Provider,{value:u,children:e.children})}function vt(){var e=_.useContext(vE);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function yE(e){var t=vt(),r=t.locale,n=t.classNames,a=t.styles,s=t.formatters.formatCaption;return c.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:r})})}function YO(e){return c.jsx("svg",Ie({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:c.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function xE(e){var t,r,n=e.onChange,a=e.value,s=e.children,i=e.caption,o=e.className,l=e.style,u=vt(),f=(r=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:YO;return c.jsxs("div",{className:o,style:l,children:[c.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),c.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:n,children:s}),c.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[i,c.jsx(f,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function XO(e){var t,r=vt(),n=r.fromDate,a=r.toDate,s=r.styles,i=r.locale,o=r.formatters.formatMonthCaption,l=r.classNames,u=r.components,f=r.labels.labelMonthDropdown;if(!n)return c.jsx(c.Fragment,{});if(!a)return c.jsx(c.Fragment,{});var d=[];if(EO(n,a))for(var m=fn(n),h=n.getMonth();h<=a.getMonth();h++)d.push(Ep(m,h));else for(var m=fn(new Date),h=0;h<=11;h++)d.push(Ep(m,h));var g=function(y){var v=Number(y.target.value),x=Ep(fn(e.displayMonth),v);e.onChange(x)},p=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:xE;return c.jsx(p,{name:"months","aria-label":f(),className:l.dropdown_month,style:s.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:i}),children:d.map(function(y){return c.jsx("option",{value:y.getMonth(),children:o(y,{locale:i})},y.getMonth())})})}function KO(e){var t,r=e.displayMonth,n=vt(),a=n.fromDate,s=n.toDate,i=n.locale,o=n.styles,l=n.classNames,u=n.components,f=n.formatters.formatYearCaption,d=n.labels.labelYearDropdown,m=[];if(!a)return c.jsx(c.Fragment,{});if(!s)return c.jsx(c.Fragment,{});for(var h=a.getFullYear(),g=s.getFullYear(),p=h;p<=g;p++)m.push(Nw(cE(new Date),p));var y=function(x){var w=Nw(fn(r),Number(x.target.value));e.onChange(w)},v=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:xE;return c.jsx(v,{name:"years","aria-label":d(),className:l.dropdown_year,style:o.dropdown_year,onChange:y,value:r.getFullYear(),caption:f(r,{locale:i}),children:m.map(function(x){return c.jsx("option",{value:x.getFullYear(),children:f(x,{locale:i})},x.getFullYear())})})}function qO(e,t){var r=_.useState(e),n=r[0],a=r[1],s=t===void 0?n:t;return[s,a]}function QO(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,s=e.toDate,i=e.fromDate,o=e.numberOfMonths,l=o===void 0?1:o;if(s&&Cu(s,a)<0){var u=-1*(l-1);a=Ta(s,u)}return i&&Cu(a,i)<0&&(a=i),fn(a)}function JO(){var e=vt(),t=QO(e),r=qO(t,e.month),n=r[0],a=r[1],s=function(i){var o;if(!e.disableNavigation){var l=fn(i);a(l),(o=e.onMonthChange)===null||o===void 0||o.call(e,l)}};return[n,s]}function ZO(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=fn(e),s=fn(Ta(a,n)),i=Cu(s,a),o=[],l=0;l<i;l++){var u=Ta(a,l);o.push(u)}return r&&(o=o.reverse()),o}function eF(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=fn(e);if(!r)return Ta(o,i);var l=Cu(r,e);if(!(l<s))return Ta(o,i)}}function tF(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=fn(e);if(!r)return Ta(o,-i);var l=Cu(o,r);if(!(l<=0))return Ta(o,-i)}}var wE=_.createContext(void 0);function rF(e){var t=vt(),r=JO(),n=r[0],a=r[1],s=ZO(n,t),i=eF(n,t),o=tF(n,t),l=function(d){return s.some(function(m){return sv(d,m)})},u=function(d,m){l(d)||(m&&av(d,m)?a(Ta(d,1+t.numberOfMonths*-1)):a(d))},f={currentMonth:n,displayMonths:s,goToMonth:a,goToDate:u,previousMonth:o,nextMonth:i,isDateDisplayed:l};return c.jsx(wE.Provider,{value:f,children:e.children})}function ff(){var e=_.useContext(wE);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Cw(e){var t,r=vt(),n=r.classNames,a=r.styles,s=r.components,i=ff().goToMonth,o=function(f){i(Ta(f,e.displayIndex?-e.displayIndex:0))},l=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:yE,u=c.jsx(l,{id:e.id,displayMonth:e.displayMonth});return c.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[c.jsx("div",{className:n.vhidden,children:u}),c.jsx(XO,{onChange:o,displayMonth:e.displayMonth}),c.jsx(KO,{onChange:o,displayMonth:e.displayMonth})]})}function nF(e){return c.jsx("svg",Ie({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:c.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function aF(e){return c.jsx("svg",Ie({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:c.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var ih=_.forwardRef(function(e,t){var r=vt(),n=r.classNames,a=r.styles,s=[n.button_reset,n.button];e.className&&s.push(e.className);var i=s.join(" "),o=Ie(Ie({},a.button_reset),a.button);return e.style&&Object.assign(o,e.style),c.jsx("button",Ie({},e,{ref:t,type:"button",className:i,style:o}))});function sF(e){var t,r,n=vt(),a=n.dir,s=n.locale,i=n.classNames,o=n.styles,l=n.labels,u=l.labelPrevious,f=l.labelNext,d=n.components;if(!e.nextMonth&&!e.previousMonth)return c.jsx(c.Fragment,{});var m=u(e.previousMonth,{locale:s}),h=[i.nav_button,i.nav_button_previous].join(" "),g=f(e.nextMonth,{locale:s}),p=[i.nav_button,i.nav_button_next].join(" "),y=(t=d==null?void 0:d.IconRight)!==null&&t!==void 0?t:aF,v=(r=d==null?void 0:d.IconLeft)!==null&&r!==void 0?r:nF;return c.jsxs("div",{className:i.nav,style:o.nav,children:[!e.hidePrevious&&c.jsx(ih,{name:"previous-month","aria-label":m,className:h,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?c.jsx(y,{className:i.nav_icon,style:o.nav_icon}):c.jsx(v,{className:i.nav_icon,style:o.nav_icon})}),!e.hideNext&&c.jsx(ih,{name:"next-month","aria-label":g,className:p,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?c.jsx(v,{className:i.nav_icon,style:o.nav_icon}):c.jsx(y,{className:i.nav_icon,style:o.nav_icon})})]})}function Aw(e){var t=vt().numberOfMonths,r=ff(),n=r.previousMonth,a=r.nextMonth,s=r.goToMonth,i=r.displayMonths,o=i.findIndex(function(g){return sv(e.displayMonth,g)}),l=o===0,u=o===i.length-1,f=t>1&&(l||!u),d=t>1&&(u||!l),m=function(){n&&s(n)},h=function(){a&&s(a)};return c.jsx(sF,{displayMonth:e.displayMonth,hideNext:f,hidePrevious:d,nextMonth:a,previousMonth:n,onPreviousClick:m,onNextClick:h})}function iF(e){var t,r=vt(),n=r.classNames,a=r.disableNavigation,s=r.styles,i=r.captionLayout,o=r.components,l=(t=o==null?void 0:o.CaptionLabel)!==null&&t!==void 0?t:yE,u;return a?u=c.jsx(l,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?u=c.jsx(Cw,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?u=c.jsxs(c.Fragment,{children:[c.jsx(Cw,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),c.jsx(Aw,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=c.jsxs(c.Fragment,{children:[c.jsx(l,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),c.jsx(Aw,{displayMonth:e.displayMonth,id:e.id})]}),c.jsx("div",{className:n.caption,style:s.caption,children:u})}function oF(e){var t=vt(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?c.jsx("tfoot",{className:a,style:n.tfoot,children:c.jsx("tr",{children:c.jsx("td",{colSpan:8,children:r})})}):c.jsx(c.Fragment,{})}function lF(e,t,r){for(var n=r?uo(new Date):Ja(new Date,{locale:e,weekStartsOn:t}),a=[],s=0;s<7;s++){var i=Dr(n,s);a.push(i)}return a}function cF(){var e=vt(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,s=e.weekStartsOn,i=e.ISOWeek,o=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,u=lF(a,s,i);return c.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&c.jsx("td",{style:r.head_cell,className:t.head_cell}),u.map(function(f,d){return c.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":l(f,{locale:a}),children:o(f,{locale:a})},d)})]})}function uF(){var e,t=vt(),r=t.classNames,n=t.styles,a=t.components,s=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:cF;return c.jsx("thead",{style:n.head,className:r.head,children:c.jsx(s,{})})}function fF(e){var t=vt(),r=t.locale,n=t.formatters.formatDay;return c.jsx(c.Fragment,{children:n(e.date,{locale:r})})}var iv=_.createContext(void 0);function dF(e){if(!cf(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return c.jsx(iv.Provider,{value:t,children:e.children})}return c.jsx(hF,{initialProps:e.initialProps,children:e.children})}function hF(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,s=t.max,i=function(u,f,d){var m,h;(m=t.onDayClick)===null||m===void 0||m.call(t,u,f,d);var g=!!(f.selected&&a&&(n==null?void 0:n.length)===a);if(!g){var p=!!(!f.selected&&s&&(n==null?void 0:n.length)===s);if(!p){var y=n?gE([],n):[];if(f.selected){var v=y.findIndex(function(x){return Lr(u,x)});y.splice(v,1)}else y.push(u);(h=t.onSelect)===null||h===void 0||h.call(t,y,u,f,d)}}},o={disabled:[]};n&&o.disabled.push(function(u){var f=s&&n.length>s-1,d=n.some(function(m){return Lr(m,u)});return!!(f&&!d)});var l={selected:n,onDayClick:i,modifiers:o};return c.jsx(iv.Provider,{value:l,children:r})}function ov(){var e=_.useContext(iv);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function mF(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Lr(a,e)&&Lr(n,e)?void 0:Lr(a,e)?{from:a,to:void 0}:Lr(n,e)?void 0:sh(n,e)?{from:e,to:a}:{from:n,to:e}:a?sh(e,a)?{from:a,to:e}:{from:e,to:a}:n?av(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var lv=_.createContext(void 0);function pF(e){if(!uf(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return c.jsx(lv.Provider,{value:t,children:e.children})}return c.jsx(gF,{initialProps:e.initialProps,children:e.children})}function gF(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},s=a.from,i=a.to,o=t.min,l=t.max,u=function(h,g,p){var y,v;(y=t.onDayClick)===null||y===void 0||y.call(t,h,g,p);var x=mF(h,n);(v=t.onSelect)===null||v===void 0||v.call(t,x,h,g,p)},f={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(f.range_start=[s],i?(f.range_end=[i],Lr(s,i)||(f.range_middle=[{after:s,before:i}])):f.range_end=[s]):i&&(f.range_start=[i],f.range_end=[i]),o&&(s&&!i&&f.disabled.push({after:bp(s,o-1),before:Dr(s,o-1)}),s&&i&&f.disabled.push({after:s,before:Dr(s,o-1)}),!s&&i&&f.disabled.push({after:bp(i,o-1),before:Dr(i,o-1)})),l){if(s&&!i&&(f.disabled.push({before:Dr(s,-l+1)}),f.disabled.push({after:Dr(s,l-1)})),s&&i){var d=Va(i,s)+1,m=l-d;f.disabled.push({before:bp(s,m)}),f.disabled.push({after:Dr(i,m)})}!s&&i&&(f.disabled.push({before:Dr(i,-l+1)}),f.disabled.push({after:Dr(i,l-1)}))}return c.jsx(lv.Provider,{value:{selected:n,onDayClick:u,modifiers:f},children:r})}function cv(){var e=_.useContext(lv);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Nd(e){return Array.isArray(e)?gE([],e):e!==void 0?[e]:[]}function vF(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=Nd(a)}),t}var Na;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Na||(Na={}));var yF=Na.Selected,ss=Na.Disabled,xF=Na.Hidden,wF=Na.Today,Tp=Na.RangeEnd,Np=Na.RangeMiddle,Cp=Na.RangeStart,_F=Na.Outside;function SF(e,t,r){var n,a=(n={},n[yF]=Nd(e.selected),n[ss]=Nd(e.disabled),n[xF]=Nd(e.hidden),n[wF]=[e.today],n[Tp]=[],n[Np]=[],n[Cp]=[],n[_F]=[],n);return e.fromDate&&a[ss].push({before:e.fromDate}),e.toDate&&a[ss].push({after:e.toDate}),cf(e)?a[ss]=a[ss].concat(t.modifiers[ss]):uf(e)&&(a[ss]=a[ss].concat(r.modifiers[ss]),a[Cp]=r.modifiers[Cp],a[Np]=r.modifiers[Np],a[Tp]=r.modifiers[Tp]),a}var _E=_.createContext(void 0);function kF(e){var t=vt(),r=ov(),n=cv(),a=SF(t,r,n),s=vF(t.modifiers),i=Ie(Ie({},a),s);return c.jsx(_E.Provider,{value:i,children:e.children})}function SE(){var e=_.useContext(_E);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function bF(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function EF(e){return!!(e&&typeof e=="object"&&"from"in e)}function TF(e){return!!(e&&typeof e=="object"&&"after"in e)}function NF(e){return!!(e&&typeof e=="object"&&"before"in e)}function CF(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function AF(e,t){var r,n=t.from,a=t.to;if(n&&a){var s=Va(a,n)<0;s&&(r=[a,n],n=r[0],a=r[1]);var i=Va(e,n)>=0&&Va(a,e)>=0;return i}return a?Lr(a,e):n?Lr(n,e):!1}function PF(e){return tv(e)}function DF(e){return Array.isArray(e)&&e.every(tv)}function jF(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(PF(r))return Lr(e,r);if(DF(r))return r.includes(e);if(EF(r))return AF(e,r);if(CF(r))return r.dayOfWeek.includes(e.getDay());if(bF(r)){var n=Va(r.before,e),a=Va(r.after,e),s=n>0,i=a<0,o=sh(r.before,r.after);return o?i&&s:s||i}return TF(r)?Va(e,r.after)>0:NF(r)?Va(r.before,e)>0:typeof r=="function"?r(e):!1})}function uv(e,t,r){var n=Object.keys(t).reduce(function(s,i){var o=t[i];return jF(e,o)&&s.push(i),s},[]),a={};return n.forEach(function(s){return a[s]=!0}),r&&!sv(e,r)&&(a.outside=!0),a}function RF(e,t){for(var r=fn(e[0]),n=rv(e[e.length-1]),a,s,i=r;i<=n;){var o=uv(i,t),l=!o.disabled&&!o.hidden;if(!l){i=Dr(i,1);continue}if(o.selected)return i;o.today&&!s&&(s=i),a||(a=i),i=Dr(i,1)}return s||a}var MF=365;function kE(e,t){var r=t.moveBy,n=t.direction,a=t.context,s=t.modifiers,i=t.retry,o=i===void 0?{count:0,lastFocused:e}:i,l=a.weekStartsOn,u=a.fromDate,f=a.toDate,d=a.locale,m={day:Dr,week:ug,month:Ta,year:_I,startOfWeek:function(y){return a.ISOWeek?uo(y):Ja(y,{locale:d,weekStartsOn:l})},endOfWeek:function(y){return a.ISOWeek?uE(y):nv(y,{locale:d,weekStartsOn:l})}},h=m[r](e,n==="after"?1:-1);n==="before"&&u?h=SI([u,h]):n==="after"&&f&&(h=kI([f,h]));var g=!0;if(s){var p=uv(h,s);g=!p.disabled&&!p.hidden}return g?h:o.count>MF?o.lastFocused:kE(h,{moveBy:r,direction:n,context:a,modifiers:s,retry:Ie(Ie({},o),{count:o.count+1})})}var bE=_.createContext(void 0);function IF(e){var t=ff(),r=SE(),n=_.useState(),a=n[0],s=n[1],i=_.useState(),o=i[0],l=i[1],u=RF(t.displayMonths,r),f=a??(o&&t.isDateDisplayed(o))?o:u,d=function(){l(a),s(void 0)},m=function(y){s(y)},h=vt(),g=function(y,v){if(a){var x=kE(a,{moveBy:y,direction:v,context:h,modifiers:r});Lr(a,x)||(t.goToDate(x,a),m(x))}},p={focusedDay:a,focusTarget:f,blur:d,focus:m,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return c.jsx(bE.Provider,{value:p,children:e.children})}function fv(){var e=_.useContext(bE);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function OF(e,t){var r=SE(),n=uv(e,r,t);return n}var dv=_.createContext(void 0);function FF(e){if(!um(e.initialProps)){var t={selected:void 0};return c.jsx(dv.Provider,{value:t,children:e.children})}return c.jsx(LF,{initialProps:e.initialProps,children:e.children})}function LF(e){var t=e.initialProps,r=e.children,n=function(s,i,o){var l,u,f;if((l=t.onDayClick)===null||l===void 0||l.call(t,s,i,o),i.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,s,i,o);return}(f=t.onSelect)===null||f===void 0||f.call(t,s,s,i,o)},a={selected:t.selected,onDayClick:n};return c.jsx(dv.Provider,{value:a,children:r})}function EE(){var e=_.useContext(dv);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function BF(e,t){var r=vt(),n=EE(),a=ov(),s=cv(),i=fv(),o=i.focusDayAfter,l=i.focusDayBefore,u=i.focusWeekAfter,f=i.focusWeekBefore,d=i.blur,m=i.focus,h=i.focusMonthBefore,g=i.focusMonthAfter,p=i.focusYearBefore,y=i.focusYearAfter,v=i.focusStartOfWeek,x=i.focusEndOfWeek,w=function(X){var F,P,Z,le;um(r)?(F=n.onDayClick)===null||F===void 0||F.call(n,e,t,X):cf(r)?(P=a.onDayClick)===null||P===void 0||P.call(a,e,t,X):uf(r)?(Z=s.onDayClick)===null||Z===void 0||Z.call(s,e,t,X):(le=r.onDayClick)===null||le===void 0||le.call(r,e,t,X)},S=function(X){var F;m(e),(F=r.onDayFocus)===null||F===void 0||F.call(r,e,t,X)},b=function(X){var F;d(),(F=r.onDayBlur)===null||F===void 0||F.call(r,e,t,X)},E=function(X){var F;(F=r.onDayMouseEnter)===null||F===void 0||F.call(r,e,t,X)},k=function(X){var F;(F=r.onDayMouseLeave)===null||F===void 0||F.call(r,e,t,X)},T=function(X){var F;(F=r.onDayPointerEnter)===null||F===void 0||F.call(r,e,t,X)},N=function(X){var F;(F=r.onDayPointerLeave)===null||F===void 0||F.call(r,e,t,X)},I=function(X){var F;(F=r.onDayTouchCancel)===null||F===void 0||F.call(r,e,t,X)},H=function(X){var F;(F=r.onDayTouchEnd)===null||F===void 0||F.call(r,e,t,X)},j=function(X){var F;(F=r.onDayTouchMove)===null||F===void 0||F.call(r,e,t,X)},z=function(X){var F;(F=r.onDayTouchStart)===null||F===void 0||F.call(r,e,t,X)},K=function(X){var F;(F=r.onDayKeyUp)===null||F===void 0||F.call(r,e,t,X)},q=function(X){var F;switch(X.key){case"ArrowLeft":X.preventDefault(),X.stopPropagation(),r.dir==="rtl"?o():l();break;case"ArrowRight":X.preventDefault(),X.stopPropagation(),r.dir==="rtl"?l():o();break;case"ArrowDown":X.preventDefault(),X.stopPropagation(),u();break;case"ArrowUp":X.preventDefault(),X.stopPropagation(),f();break;case"PageUp":X.preventDefault(),X.stopPropagation(),X.shiftKey?p():h();break;case"PageDown":X.preventDefault(),X.stopPropagation(),X.shiftKey?y():g();break;case"Home":X.preventDefault(),X.stopPropagation(),v();break;case"End":X.preventDefault(),X.stopPropagation(),x();break}(F=r.onDayKeyDown)===null||F===void 0||F.call(r,e,t,X)},Q={onClick:w,onFocus:S,onBlur:b,onKeyDown:q,onKeyUp:K,onMouseEnter:E,onMouseLeave:k,onPointerEnter:T,onPointerLeave:N,onTouchCancel:I,onTouchEnd:H,onTouchMove:j,onTouchStart:z};return Q}function UF(){var e=vt(),t=EE(),r=ov(),n=cv(),a=um(e)?t.selected:cf(e)?r.selected:uf(e)?n.selected:void 0;return a}function $F(e){return Object.values(Na).includes(e)}function WF(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if($F(n)){var s=e.classNames["day_".concat(n)];s&&r.push(s)}}),r}function HF(e,t){var r=Ie({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=Ie(Ie({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function VF(e,t,r){var n,a,s,i=vt(),o=fv(),l=OF(e,t),u=BF(e,l),f=UF(),d=!!(i.onDayClick||i.mode!=="default");_.useEffect(function(){var E;l.outside||o.focusedDay&&d&&Lr(o.focusedDay,e)&&((E=r.current)===null||E===void 0||E.focus())},[o.focusedDay,e,r,d,l.outside]);var m=WF(i,l).join(" "),h=HF(i,l),g=!!(l.outside&&!i.showOutsideDays||l.hidden),p=(s=(a=i.components)===null||a===void 0?void 0:a.DayContent)!==null&&s!==void 0?s:fF,y=c.jsx(p,{date:e,displayMonth:t,activeModifiers:l}),v={style:h,className:m,children:y,role:"gridcell"},x=o.focusTarget&&Lr(o.focusTarget,e)&&!l.outside,w=o.focusedDay&&Lr(o.focusedDay,e),S=Ie(Ie(Ie({},v),(n={disabled:l.disabled,role:"gridcell"},n["aria-selected"]=l.selected,n.tabIndex=w||x?0:-1,n)),u),b={isButton:d,isHidden:g,activeModifiers:l,selectedDays:f,buttonProps:S,divProps:v};return b}function zF(e){var t=_.useRef(null),r=VF(e.date,e.displayMonth,t);return r.isHidden?c.jsx("div",{role:"gridcell"}):r.isButton?c.jsx(ih,Ie({name:"day",ref:t},r.buttonProps)):c.jsx("div",Ie({},r.divProps))}function GF(e){var t=e.number,r=e.dates,n=vt(),a=n.onWeekNumberClick,s=n.styles,i=n.classNames,o=n.locale,l=n.labels.labelWeekNumber,u=n.formatters.formatWeekNumber,f=u(Number(t),{locale:o});if(!a)return c.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:f});var d=l(Number(t),{locale:o}),m=function(h){a(t,r,h)};return c.jsx(ih,{name:"week-number","aria-label":d,className:i.weeknumber,style:s.weeknumber,onClick:m,children:f})}function YF(e){var t,r,n=vt(),a=n.styles,s=n.classNames,i=n.showWeekNumber,o=n.components,l=(t=o==null?void 0:o.Day)!==null&&t!==void 0?t:zF,u=(r=o==null?void 0:o.WeekNumber)!==null&&r!==void 0?r:GF,f;return i&&(f=c.jsx("td",{className:s.cell,style:a.cell,children:c.jsx(u,{number:e.weekNumber,dates:e.dates})})),c.jsxs("tr",{className:s.row,style:a.row,children:[f,e.dates.map(function(d){return c.jsx("td",{className:s.cell,style:a.cell,role:"presentation",children:c.jsx(l,{displayMonth:e.displayMonth,date:d})},SO(d))})]})}function Pw(e,t,r){for(var n=r!=null&&r.ISOWeek?uE(t):nv(t,r),a=r!=null&&r.ISOWeek?uo(e):Ja(e,r),s=Va(n,a),i=[],o=0;o<=s;o++)i.push(Dr(a,o));var l=i.reduce(function(u,f){var d=r!=null&&r.ISOWeek?dE(f):mE(f,r),m=u.find(function(h){return h.weekNumber===d});return m?(m.dates.push(f),u):(u.push({weekNumber:d,dates:[f]}),u)},[]);return l}function XF(e,t){var r=Pw(fn(e),rv(e),t);if(t!=null&&t.useFixedWeeks){var n=bO(e,t);if(n<6){var a=r[r.length-1],s=a.dates[a.dates.length-1],i=ug(s,6-n),o=Pw(ug(s,1),i,t);r.push.apply(r,o)}}return r}function KF(e){var t,r,n,a=vt(),s=a.locale,i=a.classNames,o=a.styles,l=a.hideHead,u=a.fixedWeeks,f=a.components,d=a.weekStartsOn,m=a.firstWeekContainsDate,h=a.ISOWeek,g=XF(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:h,locale:s,weekStartsOn:d,firstWeekContainsDate:m}),p=(t=f==null?void 0:f.Head)!==null&&t!==void 0?t:uF,y=(r=f==null?void 0:f.Row)!==null&&r!==void 0?r:YF,v=(n=f==null?void 0:f.Footer)!==null&&n!==void 0?n:oF;return c.jsxs("table",{id:e.id,className:i.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&c.jsx(p,{}),c.jsx("tbody",{className:i.tbody,style:o.tbody,children:g.map(function(x){return c.jsx(y,{displayMonth:e.displayMonth,dates:x.dates,weekNumber:x.weekNumber},x.weekNumber)})}),c.jsx(v,{displayMonth:e.displayMonth})]})}function qF(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var QF=qF()?_.useLayoutEffect:_.useEffect,Ap=!1,JF=0;function Dw(){return"react-day-picker-".concat(++JF)}function ZF(e){var t,r=e??(Ap?Dw():null),n=_.useState(r),a=n[0],s=n[1];return QF(function(){a===null&&s(Dw())},[]),_.useEffect(function(){Ap===!1&&(Ap=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function eL(e){var t,r,n=vt(),a=n.dir,s=n.classNames,i=n.styles,o=n.components,l=ff().displayMonths,u=ZF(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),f=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,d=[s.month],m=i.month,h=e.displayIndex===0,g=e.displayIndex===l.length-1,p=!h&&!g;a==="rtl"&&(t=[h,g],g=t[0],h=t[1]),h&&(d.push(s.caption_start),m=Ie(Ie({},m),i.caption_start)),g&&(d.push(s.caption_end),m=Ie(Ie({},m),i.caption_end)),p&&(d.push(s.caption_between),m=Ie(Ie({},m),i.caption_between));var y=(r=o==null?void 0:o.Caption)!==null&&r!==void 0?r:iF;return c.jsxs("div",{className:d.join(" "),style:m,children:[c.jsx(y,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),c.jsx(KF,{id:f,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function tL(e){var t=vt(),r=t.classNames,n=t.styles;return c.jsx("div",{className:r.months,style:n.months,children:e.children})}function rL(e){var t,r,n=e.initialProps,a=vt(),s=fv(),i=ff(),o=_.useState(!1),l=o[0],u=o[1];_.useEffect(function(){a.initialFocus&&s.focusTarget&&(l||(s.focus(s.focusTarget),u(!0)))},[a.initialFocus,l,s.focus,s.focusTarget,s]);var f=[a.classNames.root,a.className];a.numberOfMonths>1&&f.push(a.classNames.multiple_months),a.showWeekNumber&&f.push(a.classNames.with_weeknumber);var d=Ie(Ie({},a.styles.root),a.style),m=Object.keys(n).filter(function(g){return g.startsWith("data-")}).reduce(function(g,p){var y;return Ie(Ie({},g),(y={},y[p]=n[p],y))},{}),h=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:tL;return c.jsx("div",Ie({className:f.join(" "),style:d,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},m,{children:c.jsx(h,{children:i.displayMonths.map(function(g,p){return c.jsx(eL,{displayIndex:p,displayMonth:g},p)})})}))}function nL(e){var t=e.children,r=NO(e,["children"]);return c.jsx(GO,{initialProps:r,children:c.jsx(rF,{children:c.jsx(FF,{initialProps:r,children:c.jsx(dF,{initialProps:r,children:c.jsx(pF,{initialProps:r,children:c.jsx(kF,{children:c.jsx(IF,{children:t})})})})})})})}function aL(e){return c.jsx(nL,Ie({},e,{children:c.jsx(rL,{initialProps:e})}))}function TE({className:e,classNames:t,showOutsideDays:r=!0,...n}){return c.jsx(aL,{showOutsideDays:r,className:Ce("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ce(og({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ce(og({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>c.jsx(N1,{className:"h-4 w-4"}),IconRight:({...a})=>c.jsx($h,{className:"h-4 w-4"})},...n})}TE.displayName="Calendar";var fm="Popover",[NE,aQ]=Mn(fm,[Xl]),df=Xl(),[sL,bi]=NE(fm),CE=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!1}=e,o=df(t),l=_.useRef(null),[u,f]=_.useState(!1),[d,m]=qa({prop:n,defaultProp:a??!1,onChange:s,caller:fm});return c.jsx(Ab,{...o,children:c.jsx(sL,{scope:t,contentId:Xa(),triggerRef:l,open:d,onOpenChange:m,onOpenToggle:_.useCallback(()=>m(h=>!h),[m]),hasCustomAnchor:u,onCustomAnchorAdd:_.useCallback(()=>f(!0),[]),onCustomAnchorRemove:_.useCallback(()=>f(!1),[]),modal:i,children:r})})};CE.displayName=fm;var AE="PopoverAnchor",iL=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=bi(AE,r),s=df(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=a;return _.useEffect(()=>(i(),()=>o()),[i,o]),c.jsx(Xh,{...s,...n,ref:t})});iL.displayName=AE;var PE="PopoverTrigger",DE=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=bi(PE,r),s=df(r),i=Je(t,a.triggerRef),o=c.jsx(De.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":OE(a.open),...n,ref:i,onClick:Ne(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:c.jsx(Xh,{asChild:!0,...s,children:o})});DE.displayName=PE;var hv="PopoverPortal",[oL,lL]=NE(hv,{forceMount:void 0}),jE=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,s=bi(hv,t);return c.jsx(oL,{scope:t,forceMount:r,children:c.jsx(Ca,{present:r||s.open,children:c.jsx(Ju,{asChild:!0,container:a,children:n})})})};jE.displayName=hv;var Rl="PopoverContent",RE=_.forwardRef((e,t)=>{const r=lL(Rl,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,s=bi(Rl,e.__scopePopover);return c.jsx(Ca,{present:n||s.open,children:s.modal?c.jsx(uL,{...a,ref:t}):c.jsx(fL,{...a,ref:t})})});RE.displayName=Rl;var cL=io("PopoverContent.RemoveScroll"),uL=_.forwardRef((e,t)=>{const r=bi(Rl,e.__scopePopover),n=_.useRef(null),a=Je(t,n),s=_.useRef(!1);return _.useEffect(()=>{const i=n.current;if(i)return X1(i)},[]),c.jsx(am,{as:cL,allowPinchZoom:!0,children:c.jsx(ME,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ne(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),s.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ne(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,u=o.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Ne(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),fL=_.forwardRef((e,t)=>{const r=bi(Rl,e.__scopePopover),n=_.useRef(!1),a=_.useRef(!1);return c.jsx(ME,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),ME=_.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:f,...d}=e,m=bi(Rl,r),h=df(r);return Y1(),c.jsx(rm,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:c.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:f,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>m.onOpenChange(!1),children:c.jsx($1,{"data-state":OE(m.open),role:"dialog",id:m.contentId,...h,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),IE="PopoverClose",dL=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=bi(IE,r);return c.jsx(De.button,{type:"button",...n,ref:t,onClick:Ne(e.onClick,()=>a.onOpenChange(!1))})});dL.displayName=IE;var hL="PopoverArrow",mL=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=df(r);return c.jsx(W1,{...a,...n,ref:t})});mL.displayName=hL;function OE(e){return e?"open":"closed"}var pL=CE,gL=DE,vL=jE,FE=RE;const LE=pL,BE=gL,mv=_.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>c.jsx(vL,{children:c.jsx(FE,{ref:a,align:t,sideOffset:r,className:Ce("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));mv.displayName=FE.displayName;const yL=({selectedDateTime:e,onDateTimeChange:t})=>{const[r,n]=_.useState(!1),[a,s]=_.useState(e||void 0),[i,o]=_.useState(e?Ft(e,"HH:mm"):"10:30"),l=f=>{if(s(f),f){const[d,m]=i.split(":").map(Number),h=new Date(f);h.setHours(d,m,0,0),t(h)}else t(null)},u=f=>{if(o(f),a){const[d,m]=f.split(":").map(Number),h=new Date(a);h.setHours(d,m,0,0),t(h)}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:[c.jsx("p",{className:"font-medium mb-2",children:"Plan vs Achievement Report"}),c.jsx("p",{children:"Select the planned date and time to compare against current data. This will show applications that had PTP dates set for the selected date as of the planned time, and compare their status and PTP changes until now."})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Planned Date"}),c.jsxs(LE,{open:r,onOpenChange:n,children:[c.jsx(BE,{asChild:!0,children:c.jsxs(Te,{variant:"outline",className:Ce("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[c.jsx(Li,{className:"mr-2 h-4 w-4"}),a?Ft(a,"PPP"):"Pick a date"]})}),c.jsx(mv,{className:"w-auto p-0",align:"start",children:c.jsx(TE,{mode:"single",selected:a,onSelect:l,initialFocus:!0})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Planned Time"}),c.jsxs("div",{className:"relative",children:[c.jsx(Yc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"time",value:i,onChange:f=>u(f.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e&&c.jsxs("div",{className:"p-3 bg-blue-50 rounded-md",children:[c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Selected:"})," ",Ft(e,"PPP 'at' HH:mm")]}),c.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"This will compare data as of this time vs current state"})]})]})]})},xL=({onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r})=>{const[n,a]=_.useState("ptp-comments"),[s,i]=_.useState(!1),[o,l]=_.useState(null),u=()=>{n==="full"?(e(),i(!1)):n==="ptp-comments"?(t(),i(!1)):n==="plan-vs-achievement"&&o&&(r(o),i(!1))},f=n!=="plan-vs-achievement"||o!==null;return c.jsxs(Ql,{open:s,onOpenChange:i,children:[c.jsx(af,{asChild:!0,children:c.jsxs(Te,{variant:"outline",size:"sm",className:"h-8 text-xs",children:[c.jsx(bs,{className:"h-3 w-3 mr-1"}),"Export"]})}),c.jsxs(To,{className:"sm:max-w-[500px] max-h-[80vh] overflow-y-auto",children:[c.jsx(No,{children:c.jsx(Jl,{children:"Export Report"})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs(cm,{value:n,onValueChange:d=>a(d),children:[c.jsxs(Qe,{className:`cursor-pointer transition-colors ${n==="ptp-comments"?"ring-2 ring-blue-500":""}`,children:[c.jsx(_t,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"ptp-comments",id:"ptp-comments"}),c.jsx(Xe,{htmlFor:"ptp-comments",className:"cursor-pointer",children:c.jsx(St,{className:"text-sm",children:"PTP + Comments Report"})})]})}),c.jsx(at,{className:"pt-0",children:c.jsx(qi,{className:"text-xs",children:"Simplified report with: Applicant ID, Branch Name, RM Name, Dealer Name, Applicant Name, PTP Date, and Comment Trail"})})]}),c.jsxs(Qe,{className:`cursor-pointer transition-colors ${n==="plan-vs-achievement"?"ring-2 ring-blue-500":""}`,children:[c.jsx(_t,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"plan-vs-achievement",id:"plan-vs-achievement"}),c.jsx(Xe,{htmlFor:"plan-vs-achievement",className:"cursor-pointer",children:c.jsx(St,{className:"text-sm",children:"Plan vs Achievement Report"})})]})}),c.jsx(at,{className:"pt-0",children:c.jsx(qi,{className:"text-xs",children:"Compare planned follow-ups (PTP dates set for a specific date/time) vs actual achievements including status and comment changes"})})]}),c.jsxs(Qe,{className:`cursor-pointer transition-colors ${n==="full"?"ring-2 ring-blue-500":""}`,children:[c.jsx(_t,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"full",id:"full"}),c.jsx(Xe,{htmlFor:"full",className:"cursor-pointer",children:c.jsx(St,{className:"text-sm",children:"Full Report"})})]})}),c.jsx(at,{className:"pt-0",children:c.jsx(qi,{className:"text-xs",children:"Complete report with all available fields including contact details, financial information, and status"})})]})]}),n==="plan-vs-achievement"&&c.jsx(yL,{selectedDateTime:o,onDateTimeChange:l}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[c.jsx(Te,{variant:"outline",onClick:()=>i(!1),size:"sm",children:"Cancel"}),c.jsxs(Te,{onClick:u,size:"sm",disabled:!f,children:[c.jsx(bs,{className:"h-3 w-3 mr-1"}),"Export"]})]})]})]})]})},wL=({onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r,onLogout:n,user:a})=>{const s=ql(),{isAuthenticated:i}=Bt(),o=_.useMemo(()=>a?a.user_name||a.name||"User":"",[a]),l=_.useMemo(()=>a?a.role||Vn.getCurrentUserRole()||"User":"",[a]),u=Vn.isAdmin();return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("img",{src:"/uploads/logo.png",alt:"Prosparity Logo",className:"h-7 w-auto"}),c.jsx("div",{children:c.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Collection Dashboard"})})]}),c.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>s("/analytics"),className:"h-8 text-xs",children:[c.jsx(XP,{className:"h-3 w-3 mr-1"}),"Analytics"]}),c.jsx(xL,{onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r}),u&&c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>s("/admin-settings"),className:"h-8 text-xs",children:[c.jsx(xu,{className:"h-3 w-3 mr-1"}),"Admin Settings"]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(oo,{className:"h-4 w-4 text-gray-500"}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"font-medium truncate max-w-[120px]",children:o}),c.jsx("div",{className:"text-xs text-gray-500 capitalize",children:l})]})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:n,className:"text-gray-600 hover:text-gray-900 h-8 text-xs",children:[c.jsx(n6,{className:"h-3 w-3 mr-1"}),"Sign Out"]})]})]}),c.jsxs("div",{className:"sm:hidden flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(oo,{className:"h-4 w-4 text-gray-500"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium truncate max-w-[150px]",children:o}),c.jsx("div",{className:"text-xs text-gray-500 capitalize",children:l})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[u&&c.jsx(Te,{variant:"outline",size:"sm",onClick:()=>s("/admin-settings"),className:"h-8",children:c.jsx(xu,{className:"h-4 w-4"})}),c.jsx(Te,{variant:"outline",size:"sm",onClick:n,className:"text-gray-600 hover:text-gray-900 h-8",children:"Log Out"})]})]})]})})},Pp=768;function UE(){const[e,t]=_.useState(void 0);return _.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Pp-1}px)`),n=()=>{t(window.innerWidth<Pp)};return r.addEventListener("change",n),t(window.innerWidth<Pp),()=>r.removeEventListener("change",n)},[]),!!e}var dm="Collapsible",[_L,sQ]=Mn(dm),[SL,pv]=_L(dm),$E=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:s,onOpenChange:i,...o}=e,[l,u]=qa({prop:n,defaultProp:a??!1,onChange:i,caller:dm});return c.jsx(SL,{scope:r,disabled:s,contentId:Xa(),open:l,onOpenToggle:_.useCallback(()=>u(f=>!f),[u]),children:c.jsx(De.div,{"data-state":vv(l),"data-disabled":s?"":void 0,...o,ref:t})})});$E.displayName=dm;var WE="CollapsibleTrigger",HE=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=pv(WE,r);return c.jsx(De.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":vv(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:Ne(e.onClick,a.onOpenToggle)})});HE.displayName=WE;var gv="CollapsibleContent",VE=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=pv(gv,e.__scopeCollapsible);return c.jsx(Ca,{present:r||a.open,children:({present:s})=>c.jsx(kL,{...n,ref:t,present:s})})});VE.displayName=gv;var kL=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...s}=e,i=pv(gv,r),[o,l]=_.useState(n),u=_.useRef(null),f=Je(t,u),d=_.useRef(0),m=d.current,h=_.useRef(0),g=h.current,p=i.open||o,y=_.useRef(p),v=_.useRef(void 0);return _.useEffect(()=>{const x=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(x)},[]),gr(()=>{const x=u.current;if(x){v.current=v.current||{transitionDuration:x.style.transitionDuration,animationName:x.style.animationName},x.style.transitionDuration="0s",x.style.animationName="none";const w=x.getBoundingClientRect();d.current=w.height,h.current=w.width,y.current||(x.style.transitionDuration=v.current.transitionDuration,x.style.animationName=v.current.animationName),l(n)}},[i.open,n]),c.jsx(De.div,{"data-state":vv(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!p,...s,ref:f,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:p&&a})});function vv(e){return e?"open":"closed"}var bL=$E;const yv=bL,xv=HE,wv=VE,EL=ef("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function wa({className:e,variant:t,...r}){return c.jsx("div",{className:Ce(EL({variant:t}),e),...r})}const TL=({count:e})=>e===0?null:c.jsx(wa,{variant:"secondary",className:"ml-1",children:e}),NL=({isOpen:e,activeFilterCount:t,selectedEmiMonth:r,onEmiMonthChange:n,emiMonthOptions:a=[],onClearAllFilters:s})=>c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(xv,{asChild:!0,children:c.jsxs(Te,{variant:"ghost",size:"sm",className:"gap-2",children:[e?c.jsx(Wh,{className:"h-4 w-4"}):c.jsx(bo,{className:"h-4 w-4"}),c.jsx("span",{className:"font-medium",children:"Filters"}),c.jsx(TL,{count:t})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"EMI Month:"}),c.jsxs("div",{className:"relative",children:[c.jsx("select",{value:r||"",onChange:i=>n==null?void 0:n(i.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:a.map(i=>c.jsx("option",{value:i,children:ma(i)},i))}),r===fi()&&c.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full",title:"Current month"})]})]})]}),t>0&&c.jsxs(Te,{variant:"outline",size:"sm",onClick:s,className:"gap-2",children:[c.jsx(s6,{className:"h-4 w-4"}),"Clear All"]})]})}),jr=({label:e,options:t=[],selected:r=[],onSelectionChange:n,placeholder:a="Select options...",formatDisplay:s})=>{const[i,o]=_.useState(!1),[l,u]=_.useState(""),f=_.useRef(null);_.useEffect(()=>{console.log(`🔍 CustomMultiSelectFilter [${e}]: Received options:`,t),console.log(`🔍 CustomMultiSelectFilter [${e}]: Options length:`,t==null?void 0:t.length),console.log(`🔍 CustomMultiSelectFilter [${e}]: Selected values:`,r)},[t,r,e]);const d=t.filter(x=>x&&typeof x=="string"&&x.trim().length>0),m=r.filter(x=>x&&typeof x=="string"&&x.trim().length>0),h=d.filter(x=>(s?s(x):x).toLowerCase().includes(l.toLowerCase())),g=x=>{if(!x)return;console.log("=== TOGGLE OPTION ==="),console.log("Option:",x),console.log("Current selected:",m);const w=m.includes(x)?m.filter(S=>S!==x):[...m,x];console.log("New selected:",w),n(w)},p=()=>{console.log("=== CLEAR ALL FILTERS ==="),console.log("Label:",e),n([])},y=()=>{console.log("=== SELECT ALL FILTERS ==="),console.log("Label:",e),console.log("All options:",h),n(h)},v=(x,w)=>{w.stopPropagation(),w.preventDefault(),console.log("=== REMOVE ITEM ==="),console.log("Item:",x),console.log("Label:",e),console.log("Current selected prop:",r),console.log("Current safeSelected:",m);const S=r.filter(b=>b!==x);console.log("New selected after removal:",S),n(S)};return _.useEffect(()=>{i&&f.current&&f.current.focus()},[i]),_.useEffect(()=>{i||u("")},[i]),c.jsx("div",{className:"w-full",children:c.jsxs(LE,{open:i,onOpenChange:o,children:[c.jsx(BE,{asChild:!0,children:c.jsxs(Te,{variant:"outline",className:"w-full justify-between h-auto min-h-[40px] text-left font-normal p-3 relative hover:bg-blue-50 transition-colors",children:[c.jsx("div",{className:"flex flex-wrap gap-1 items-center min-h-[20px] flex-1",children:m.length===0?c.jsx("span",{className:"text-muted-foreground",children:e}):c.jsxs(c.Fragment,{children:[m.slice(0,2).map(x=>c.jsxs(wa,{variant:"secondary",className:"text-xs h-6 px-2 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:[s?s(x):x,c.jsx("button",{type:"button",className:"ml-1 h-3 w-3 cursor-pointer hover:text-red-500 transition-colors flex items-center justify-center",onClick:w=>{console.log("X button clicked for item:",x),v(x,w)},onMouseDown:w=>{console.log("X button mousedown for item:",x),w.stopPropagation()},"aria-label":`Remove ${x}`,children:c.jsx(Vl,{className:"h-3 w-3"})})]},x)),m.length>2&&c.jsxs(wa,{variant:"secondary",className:"text-xs h-6 px-2 bg-blue-100 text-blue-800",children:["+",m.length-2," more"]})]})}),c.jsx(bo,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),c.jsxs(mv,{className:"w-full min-w-[280px] p-0",align:"start",children:[c.jsx("div",{className:"p-3 border-b",children:c.jsx("input",{ref:f,type:"text",placeholder:`Search ${e.toLowerCase()}...`,value:l,onChange:x=>u(x.target.value),className:"w-full px-3 py-2 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),c.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[c.jsxs("div",{className:"p-2 border-b space-y-1 bg-gray-50",children:[h.length>1&&c.jsxs(Te,{variant:"ghost",size:"sm",onClick:y,className:"w-full text-blue-600 hover:text-blue-700 hover:bg-blue-50 justify-start",children:["Select All (",h.length,")"]}),m.length>0&&c.jsxs(Te,{variant:"ghost",size:"sm",onClick:p,className:"w-full text-red-600 hover:text-red-700 hover:bg-red-50 justify-start",children:["Clear All (",m.length,")"]})]}),h.length>0?c.jsx("div",{className:"p-1",children:h.map(x=>{const w=s?s(x):x;return c.jsxs("div",{onClick:()=>g(x),className:"flex items-center space-x-2 px-3 py-2 cursor-pointer hover:bg-blue-50 rounded-md transition-colors",children:[c.jsx("div",{className:`w-4 h-4 border rounded flex items-center justify-center transition-colors ${m.includes(x)?"bg-blue-600 border-blue-600":"border-gray-300 hover:border-blue-400"}`,children:m.includes(x)&&c.jsx(zk,{className:"w-3 h-3 text-white"})}),c.jsx("span",{className:"flex-1 text-sm",children:w}),m.includes(x)&&c.jsx(wa,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-800",children:"Selected"})]},x)})}):c.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:l?"No matching options":"No options available"})]}),m.length>0&&c.jsx("div",{className:"p-2 border-t bg-blue-50",children:c.jsxs("div",{className:"text-xs text-blue-700 text-center font-medium",children:[m.length," item",m.length!==1?"s":""," selected"]})})]})]})})},CL=({selectedValues:e,onValueChange:t,availableOptions:r})=>{_.useEffect(()=>{console.log("🔍 PtpDateFilter: Received availableOptions:",r),console.log("🔍 PtpDateFilter: Options length:",r==null?void 0:r.length),console.log("🔍 PtpDateFilter: Selected values:",e)},[r,e]);const n=r||[],a=s=>{t(s)};return c.jsx(jr,{label:"PTP Date",options:n,selected:e,onSelectionChange:a,placeholder:"Select PTP dates"})},AL=({filters:e,availableOptions:t,onFilterChange:r,onClose:n,onCancel:a})=>(_.useEffect(()=>{var s,i,o;console.log("🔍 FilterContent received availableOptions:",t),console.log("🔍 Repayments options:",t.repayments),console.log("🔍 PTP Date options:",t.ptpDateOptions),console.log("🔍 Last Month Bounce options:",t.lastMonthBounce),console.log("🔍 Repayments options length:",(s=t.repayments)==null?void 0:s.length),console.log("🔍 PTP Date options length:",(i=t.ptpDateOptions)==null?void 0:i.length),console.log("🔍 Last Month Bounce options length:",(o=t.lastMonthBounce)==null?void 0:o.length),console.log("🔍 All available options keys:",Object.keys(t||{})),console.log("🔍 Full availableOptions object:",t)},[t]),c.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[c.jsx(jr,{label:"Branch",options:t.branches||[],selected:e.branch||[],onSelectionChange:s=>{console.log("🔧 Branch filter onSelectionChange called with:",s),r("branch",s)},placeholder:"Select branches"}),c.jsx(jr,{label:"Team Lead",options:t.team_leads||[],selected:e.teamLead||[],onSelectionChange:s=>r("teamLead",s),placeholder:"Select team leads"}),c.jsx(jr,{label:"RM",options:t.rms||[],selected:e.rm||[],onSelectionChange:s=>r("rm",s),placeholder:"Select RMs"}),c.jsx(jr,{label:"Dealer",options:t.dealers||[],selected:e.dealer||[],onSelectionChange:s=>r("dealer",s),placeholder:"Select dealers"}),c.jsx(jr,{label:"Lender",options:t.lenders||[],selected:e.lender||[],onSelectionChange:s=>r("lender",s),placeholder:"Select lenders"}),c.jsx(jr,{label:"Status",options:t.statuses||[],selected:e.status||[],onSelectionChange:s=>r("status",s),placeholder:"Select status"}),c.jsx(jr,{label:"Repayment",options:t.repayments||[],selected:e.repayment||[],onSelectionChange:s=>r("repayment",s),placeholder:"Select repayment"}),c.jsx(CL,{selectedValues:e.ptpDate||[],onValueChange:s=>r("ptpDate",s),availableOptions:t.ptpDateOptions||[]})]}),(n||a)&&c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[a&&c.jsx(Te,{variant:"outline",className:"px-6 py-2",onClick:a,children:"Cancel"}),n&&c.jsx(Te,{variant:"default",className:"px-8 py-2 text-base font-semibold",onClick:n,children:"Done"})]})]})),PL=e=>Object.values(e).reduce((t,r)=>Array.isArray(r)?t+r.length:t,0),DL=({filters:e,availableOptions:t={},onFilterChange:r,selectedEmiMonth:n,onEmiMonthChange:a,emiMonthOptions:s=[]})=>{var p,y,v,x,w;const[i,o]=_.useState(!1),[l,u]=_.useState(e);_.useEffect(()=>{u(e)},[e]);const f=PL(e),d=(S,b)=>{u(E=>({...E,[S]:b}))},m=()=>{Object.keys(l).forEach(S=>{const b=e[S]||[],E=l[S]||[];JSON.stringify(b.sort())!==JSON.stringify(E.sort())&&r(S,E)}),o(!1)},h=()=>{const S=Object.keys(e).reduce((b,E)=>(b[E]=[],b),{});u(S),Object.keys(S).forEach(b=>{r(b,[])})},g=()=>{u(e),o(!1)};return console.log("FilterBar render - available options:",{statuses:((p=t==null?void 0:t.statuses)==null?void 0:p.length)||0,ptpDateOptions:((y=t==null?void 0:t.ptpDateOptions)==null?void 0:y.length)||0,branches:((v=t==null?void 0:t.branches)==null?void 0:v.length)||0,repayments:((x=t==null?void 0:t.repayments)==null?void 0:x.length)||0,lastMonthBounce:((w=t==null?void 0:t.lastMonthBounce)==null?void 0:w.length)||0}),c.jsxs(yv,{open:i,onOpenChange:o,className:"w-full",children:[c.jsx(NL,{isOpen:i,activeFilterCount:f,selectedEmiMonth:n,onEmiMonthChange:a,emiMonthOptions:s,onClearAllFilters:h}),c.jsx(wv,{children:c.jsx(AL,{filters:l,availableOptions:t||{},onFilterChange:d,onClose:m,onCancel:g})})]})},jL=({filters:e,onFilterChange:t,availableOptions:r,emiMonthOptions:n,selectedEmiMonth:a,onEmiMonthChange:s})=>{const[i,o]=_.useState(!1),[l,u]=_.useState(e);_.useEffect(()=>{u(e)},[e]);const f={branches:(r==null?void 0:r.branches)||[],teamLeads:(r==null?void 0:r.team_leads)||[],rms:(r==null?void 0:r.rms)||[],dealers:(r==null?void 0:r.dealers)||[],lenders:(r==null?void 0:r.lenders)||[],statuses:(r==null?void 0:r.statuses)||[],repayments:(r==null?void 0:r.repayments)||[],lastMonthBounce:(r==null?void 0:r.lastMonthBounce)||[],ptpDateOptions:(r==null?void 0:r.ptpDateOptions)||[]};_.useEffect(()=>{console.log("🔍 MobileFilterBar: Received availableOptions:",r),console.log("🔍 MobileFilterBar: Safe filter options:",f),console.log("🔍 MobileFilterBar: Repayments options:",f.repayments),console.log("🔍 MobileFilterBar: PTP Date options:",f.ptpDateOptions),console.log("🔍 MobileFilterBar: Last Month Bounce options:",f.lastMonthBounce)},[r,f]);const d=n||(r==null?void 0:r.emiMonths)||[],m={branch:(l==null?void 0:l.branch)||[],teamLead:(l==null?void 0:l.teamLead)||[],rm:(l==null?void 0:l.rm)||[],dealer:(l==null?void 0:l.dealer)||[],lender:(l==null?void 0:l.lender)||[],status:(l==null?void 0:l.status)||[],repayment:(l==null?void 0:l.repayment)||[],lastMonthBounce:(l==null?void 0:l.lastMonthBounce)||[],ptpDate:(l==null?void 0:l.ptpDate)||[]},h=Object.values(e).reduce((v,x)=>v+((x==null?void 0:x.length)||0),0),g=(v,x)=>{u(w=>({...w,[v]:x}))},p=()=>{Object.keys(l).forEach(v=>{const x=e[v]||[],w=l[v]||[];JSON.stringify(x.sort())!==JSON.stringify(w.sort())&&t(v,w)}),o(!1)},y=()=>{u(e),o(!1)};return c.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:c.jsxs(yv,{open:i,onOpenChange:o,children:[c.jsx(xv,{asChild:!0,children:c.jsxs(Te,{variant:"outline",className:"w-full flex items-center justify-between p-4 hover:bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Kk,{className:"h-4 w-4"}),c.jsx("span",{children:"Filters"}),h>0&&c.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:h})]}),i?c.jsx(Wh,{className:"h-4 w-4"}):c.jsx(bo,{className:"h-4 w-4"})]})}),c.jsx(wv,{children:c.jsxs("div",{className:"p-4 space-y-6 border-t",children:[c.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:"Filter Applications"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"PTP Date"}),c.jsx(jr,{label:"PTP Date",options:f.ptpDateOptions,selected:m.ptpDate,onSelectionChange:v=>g("ptpDate",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"EMI Month"}),c.jsxs("select",{value:a||"",onChange:v=>s==null?void 0:s(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select EMI Month"}),d.map(v=>c.jsx("option",{value:v,children:v},v))]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Branches"}),c.jsx(jr,{label:"Branches",options:f.branches,selected:m.branch,onSelectionChange:v=>g("branch",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Team Leads"}),c.jsx(jr,{label:"Team Leads",options:f.teamLeads,selected:m.teamLead,onSelectionChange:v=>g("teamLead",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"RMs"}),c.jsx(jr,{label:"RMs",options:f.rms,selected:m.rm,onSelectionChange:v=>g("rm",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Dealers"}),c.jsx(jr,{label:"Dealers",options:f.dealers,selected:m.dealer,onSelectionChange:v=>g("dealer",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Lenders"}),c.jsx(jr,{label:"Lenders",options:f.lenders,selected:m.lender,onSelectionChange:v=>g("lender",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Status"}),c.jsx(jr,{label:"Status",options:f.statuses,selected:m.status,onSelectionChange:v=>g("status",v)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Repayment"}),c.jsx(jr,{label:"Repayment",options:f.repayments,selected:m.repayment,onSelectionChange:v=>g("repayment",v)})]})]}),c.jsxs("div",{className:"mt-6 flex gap-3",children:[c.jsx(Te,{variant:"outline",className:"flex-1 px-6 py-2",onClick:y,children:"Cancel"}),c.jsx("div",{className:"border border-blue-500 rounded-lg p-2 bg-blue-50 flex-1",children:c.jsx(Te,{variant:"default",className:"w-full px-8 py-2 text-base font-semibold",onClick:p,children:"Done"})})]})]})})]})})},RL=({value:e,onChange:t,placeholder:r="Search by application name or ID...",loading:n=!1,resultCount:a})=>{const[s,i]=_.useState(e);_.useEffect(()=>{i(e)},[e]);const o=()=>{t(s)},l=()=>{i(""),t("")},u=f=>{f.key==="Enter"&&o()};return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex w-full items-center space-x-2",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(A1,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),c.jsx(Sr,{type:"text",placeholder:r,value:s,onChange:f=>i(f.target.value),onKeyDown:u,className:"pl-10 pr-10 h-10 text-sm w-full",disabled:n}),s&&!n&&c.jsx(Te,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0 text-gray-500 hover:text-gray-900",onClick:l,children:c.jsx(Vl,{className:"h-4 w-4"})}),n&&c.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:c.jsx(Bi,{className:"h-4 w-4 animate-spin text-gray-400"})})]}),c.jsxs(Te,{onClick:o,className:"h-10",disabled:n,children:[n?c.jsx(Bi,{className:"h-4 w-4 animate-spin mr-2"}):null,"Search"]})]}),e&&a!==void 0&&!n&&c.jsx("div",{className:"text-xs text-gray-500 px-1",children:a===0?`No results found for "${e}"`:a===1?`1 result found for "${e}"`:`${a.toLocaleString()} results found for "${e}"`})]})},ML=({filters:e,availableOptions:t,onFilterChange:r,searchTerm:n,onSearchChange:a,selectedEmiMonth:s,onEmiMonthChange:i,emiMonthOptions:o=[],loading:l=!1,searchLoading:u=!1,totalCount:f})=>{const d=UE();return _.useEffect(()=>{console.log("🔍 FiltersSection: Received availableOptions:",t),console.log("🔍 FiltersSection: Repayments options:",t==null?void 0:t.repayments),console.log("🔍 FiltersSection: PTP Date options:",t==null?void 0:t.ptpDateOptions),console.log("🔍 FiltersSection: Last Month Bounce options:",t==null?void 0:t.lastMonthBounce)},[t]),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:d?c.jsx(jL,{filters:e,availableOptions:t,onFilterChange:r,emiMonthOptions:o,selectedEmiMonth:s,onEmiMonthChange:i}):c.jsx(DL,{filters:e,availableOptions:t,onFilterChange:r,selectedEmiMonth:s,onEmiMonthChange:i,emiMonthOptions:o})}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:c.jsx(RL,{value:n,onChange:a,placeholder:"Search by application name or ID...",loading:u,resultCount:n?f:void 0})})]})},Zl=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:r,className:Ce("w-full caption-bottom text-sm",e),...t})}));Zl.displayName="Table";const hf=_.forwardRef(({className:e,...t},r)=>c.jsx("thead",{ref:r,className:Ce("[&_tr]:border-b",e),...t}));hf.displayName="TableHeader";const ec=_.forwardRef(({className:e,...t},r)=>c.jsx("tbody",{ref:r,className:Ce("[&_tr:last-child]:border-0",e),...t}));ec.displayName="TableBody";const IL=_.forwardRef(({className:e,...t},r)=>c.jsx("tfoot",{ref:r,className:Ce("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));IL.displayName="TableFooter";const pa=_.forwardRef(({className:e,...t},r)=>c.jsx("tr",{ref:r,className:Ce("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));pa.displayName="TableRow";const it=_.forwardRef(({className:e,...t},r)=>c.jsx("th",{ref:r,className:Ce("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));it.displayName="TableHead";const ut=_.forwardRef(({className:e,...t},r)=>c.jsx("td",{ref:r,className:Ce("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));ut.displayName="TableCell";const OL=_.forwardRef(({className:e,...t},r)=>c.jsx("caption",{ref:r,className:Ce("mt-4 text-sm text-muted-foreground",e),...t}));OL.displayName="TableCaption";const FL=()=>c.jsx(hf,{children:c.jsxs(pa,{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-slate-200",children:[c.jsx(it,{className:"font-bold text-slate-800 py-4 px-6",children:"Application Details"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"EMI Amount"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Status"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"PTP Date"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Pre-EMI"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Repayment Number"}),c.jsx(it,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Amount Collected"}),c.jsx(it,{className:"font-bold text-slate-800 py-4 px-4 whitespace-nowrap",children:"Recent Comments"})]})}),zE=()=>c.jsx(FL,{}),LL={1:"Future",2:"Partially Paid",3:"Paid",4:"Overdue",5:"Foreclose",6:"Paid (Pending Approval)",7:"Paid Rejected"},_v=e=>e?isNaN(Number(e))?e:LL[e]||e:"Unknown",BL=e=>{const t=_v(e);return{Future:"bg-gray-100 text-gray-800 border-gray-200",Unpaid:"bg-red-100 text-red-800 border-red-200","Partially Paid":"bg-yellow-100 text-yellow-800 border-yellow-200",Overdue:"bg-red-100 text-red-800 border-red-200",Foreclose:"bg-purple-100 text-purple-800 border-purple-200","Paid (Pending Approval)":"bg-blue-100 text-blue-800 border-blue-200",Paid:"bg-green-100 text-green-800 border-green-200","Paid Rejected":"bg-red-100 text-red-800 border-red-200","Cash Collected from Customer":"bg-orange-100 text-orange-800 border-orange-200","Customer Deposited to Bank":"bg-indigo-100 text-indigo-800 border-indigo-200"}[t]||"bg-gray-100 text-gray-800 border-gray-200"},GE=_.memo(({status:e})=>{const t=_v(e),r=BL(e);return c.jsx(wa,{className:`${r} border`,children:t})});GE.displayName="StatusBadge";const YE=_.memo(({comments:e,hasComments:t,loading:r})=>r?c.jsx("div",{className:"bg-gray-50 p-3 rounded",children:c.jsx("div",{className:"text-xs text-gray-400 italic",children:"Loading comments..."})}):e&&e.length>0?c.jsx("div",{className:"bg-gray-50 p-3 rounded",children:c.jsxs("div",{className:"space-y-2",children:[e.slice(0,3).map((n,a)=>c.jsxs("div",{className:"relative pl-4",children:[c.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 bg-blue-200"}),c.jsx("div",{className:"font-medium text-blue-600 text-sm mb-1",children:n.user_name||"Unknown User"}),c.jsx("div",{className:"text-xs text-gray-700 break-words",children:n.content})]},a)),e.length>3&&c.jsxs("div",{className:"text-xs text-blue-600 italic mt-2",children:["+",e.length-3," more comments"]})]})}):c.jsx("div",{className:"text-xs text-gray-400 italic",children:t?"Has comments - click to view":"Click to add comments"}));YE.displayName="CommentsDisplay";const Ml={APPLICATION_DETAILS:1,PAID_PENDING:2};class Il{static async createComment(t){const r=await fetch(`${Rt}/comments/`,{method:"POST",headers:{"Content-Type":"application/json",...dr()},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Failed to create comment: ${r.status}`);return await r.json()}static async getCommentsByRepayment(t,r=0,n=100){const a=new URLSearchParams({skip:r.toString(),limit:n.toString()}),s=await fetch(`${Rt}/comments/repayment/${t}?${a.toString()}`,{headers:dr()});if(!s.ok)throw new Error(`Failed to fetch comments: ${s.status}`);return await s.json()}static async getCommentsByRepaymentAndType(t,r,n=0,a=100){const s=new URLSearchParams({skip:n.toString(),limit:a.toString()}),i=await fetch(`${Rt}/comments/repayment/${t}/type/${r}?${s.toString()}`,{headers:dr()});if(!i.ok)throw new Error(`Failed to fetch comments by type: ${i.status}`);return await i.json()}static async getRepaymentCommentsCount(t){const r=await fetch(`${Rt}/comments/repayment/${t}/count`,{headers:dr()});if(!r.ok)throw new Error(`Failed to fetch comment count: ${r.status}`);return await r.json()}static async getRepaymentCommentsCountByType(t,r){const n=await fetch(`${Rt}/comments/repayment/${t}/type/${r}/count`,{headers:dr()});if(!n.ok)throw new Error(`Failed to fetch comment count by type: ${n.status}`);return await n.json()}}const UL={"deposited in bank":"Deposited in Bank","cash collected":"Cash Collected","ptp taken":"PTP Taken","no response":"No Response",no_response:"No Response",noresponse:"No Response",deposited_in_bank:"Deposited in Bank",cash_collected:"Cash Collected",ptp_taken:"PTP Taken",1:"Deposited in Bank",2:"Cash Collected",3:"PTP Taken",4:"No Response"},$L=e=>e?UL[e.toLowerCase()]||e:"Not Set",Sv=_.memo(({application:e,selectedApplicationId:t,onRowClick:r,selectedEmiMonth:n,batchedStatus:a,batchedPtpDate:s,batchedContactStatus:i,batchedComments:o,isLoading:l})=>{const[u,f]=_.useState([]),[d,m]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!e.payment_id){console.log("⚠️ No payment_id for application:",e.applicant_id);return}console.log("🔍 Fetching comments for application:",e.applicant_id,"payment_id:",e.payment_id),m(!0);try{const p=await Il.getCommentsByRepaymentAndType(e.payment_id.toString(),Ml.APPLICATION_DETAILS,0,3);if(console.log("📝 Comments response for",e.applicant_id,":",p),p.results&&p.results.length>0){const y=p.results.map(v=>({id:v.id.toString(),content:v.comment,created_at:v.commented_at,user_id:v.user_id.toString(),user_name:v.user_name||`User ${v.user_id}`,application_id:e.applicant_id}));console.log("✅ Mapped comments for",e.applicant_id,":",y),f(y)}else console.log("ℹ️ No comments found for application:",e.applicant_id),f([])}catch(p){console.error("❌ Error fetching comments for application:",e.applicant_id,p),f([])}finally{m(!1)}})()},[e.payment_id,e.applicant_id]);const h=g=>{r(e)};return c.jsxs(pa,{className:`cursor-pointer transition-colors align-top ${t===e.id?"bg-blue-50 border-l-4 border-l-blue-500 hover:bg-blue-100":"hover:bg-gray-50"}`,onClick:h,children:[c.jsx(ut,{className:"py-4 align-top w-[24%]",children:c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("span",{className:"font-bold text-blue-800",children:e.applicant_name}),c.jsxs("span",{className:"text-xs text-gray-700",children:["ID: ",e.applicant_id]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["EMI Month: ",ma(n||e.emi_month)]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Branch: ",e.branch_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["TL: ",e.team_lead]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["RM: ",e.rm_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Dealer: ",e.dealer_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Lender: ",e.lender_name]})]})}),c.jsx(ut,{className:"py-4 align-top text-blue-600 font-semibold text-base w-[10%]",children:Nu(e.emi_amount)}),c.jsx(ut,{className:"py-4 align-top w-[10%]",children:c.jsx(GE,{status:e.status})}),c.jsx(ut,{className:"py-4 align-top w-[10%]",children:s?ig(s):e.ptp_date?ig(e.ptp_date):"Not Set"}),c.jsx(ut,{className:"py-4 align-top text-center w-[10%]",children:c.jsx("div",{className:"text-blue-600 font-medium text-sm",children:$L(e.demand_calling_status)})}),c.jsx(ut,{className:"py-4 align-top text-center w-[10%]",children:c.jsx("div",{className:"text-gray-800 font-medium text-sm",children:e.demand_num||"N/A"})}),c.jsx(ut,{className:"py-4 align-top text-center w-[10%]",children:c.jsx("div",{className:"text-black font-semibold text-base",children:e.amount_collected?Nu(e.amount_collected):"NA"})}),c.jsx(ut,{className:"py-4 align-top w-[20%]",children:c.jsx(YE,{comments:u,hasComments:u.length>0,loading:d})})]})});Sv.displayName="ApplicationRow";const WL=(e,t)=>{const r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r},HL=10*1e3,jw=25,Ec={},qf=new Map,Ls=new Map,kv=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1);_.useRef(null);const n=_.useCallback(l=>{const u=[...l.applicationIds].sort(),f=u.length<=5?u.join(","):`${u.length}-${u[0]}-${u[u.length-1]}`;return`fs-${l.selectedMonth||"all"}-${f}`},[]),a=_.useCallback(l=>typeof l=="string"&&l.trim().length>0,[]),s=_.useCallback(async(l,u,f=0)=>{if(l.length===0)return{};const d=2;try{console.log(`📤 Fetching field status chunk: ${l.length} applications (attempt ${f+1})`);let m=Pe.from("field_status").select("application_id, status, created_at, demand_date").in("application_id",l);if(u.selectedMonth&&!u.includeAllMonths){let w;if(console.log(`🔍 Processing month: "${u.selectedMonth}"`),u.selectedMonth.includes("-")){const H=u.selectedMonth.split("-");if(H.length>=2&&H[0].length===4&&!isNaN(Number(H[0]))&&!isNaN(Number(H[1])))w=`${H[0]}-${H[1].padStart(2,"0")}`,console.log(`✅ Already in YYYY-MM format: ${w}`);else{const[j,z]=H,q={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"}[j],Q=z.length===2?`20${z}`:z;if(!q||!Q)throw console.error(`❌ Invalid month-year format: ${u.selectedMonth}. MonthAbbr: ${j}, Year: ${z}, MonthNum: ${q}, FullYear: ${Q}`),new Error(`Invalid month-year format: ${u.selectedMonth}`);w=`${Q}-${q}`,console.log(`🔄 Month-Year conversion: ${u.selectedMonth} → ${w}`)}}else w=u.selectedMonth;const[S,b]=w.split("-");if(!S||!b||isNaN(Number(S))||isNaN(Number(b)))throw console.error(`❌ Invalid database format month: ${w}`),new Error(`Invalid database format month: ${w}`);const E=Number(S),k=Number(b),T=new Date(E,k,0).getDate(),N=`${w}-01`,I=`${w}-${String(T).padStart(2,"0")}`;console.log(`📅 Field status month filter: ${N} to ${I}`),m=m.gte("demand_date",N).lte("demand_date",I)}m=m.order("created_at",{ascending:!1});const{data:h,error:g}=await m;if(g)throw new Error(`Field status query failed: ${g.message}`);const p={},y=new Set;h&&h.forEach(w=>{if(w&&w.application_id&&w.status){const S=w.application_id;y.has(S)||(p[S]=w.status||"Unpaid",y.add(S))}});const v=Object.keys(p).length,x=l.length;return v<x*.8&&f<d?(console.warn(`⚠️ Low data completeness: ${v}/${x}. Retrying...`),await new Promise(w=>setTimeout(w,1e3*(f+1))),s(l,u,f+1)):(console.log(`✅ Chunk processed: ${v}/${x} statuses loaded`),p)}catch(m){return f<d?(console.warn(`⚠️ Chunk fetch failed, retrying (${f+1}/${d}):`,m),await new Promise(h=>setTimeout(h,1e3*(f+1))),s(l,u,f+1)):(console.error("❌ Chunk fetch error after retries:",m),{})}},[]),i=_.useCallback(async(l,u,f=!1)=>{if(!e||l.length===0)return console.log("❌ No user or empty application IDs"),{};const d=l.filter(a);if(d.length===0)return console.warn("❌ No valid application IDs provided"),{};console.log("=== FIELD STATUS MANAGER FETCH ==="),console.log("Valid Application IDs:",d.length),console.log("Selected Month:",u);const m={applicationIds:d,selectedMonth:u,includeAllMonths:f},h=n(m),g=Ec[h];if(g&&Date.now()<g.expiresAt){const y=Object.keys(g.data).length,v=d.length;if(y>=v*.8)return console.log(`✅ Using cached field status data (${y}/${v})`),g.data;console.warn(`⚠️ Cache data incomplete (${y}/${v}), refreshing`),delete Ec[h]}if(qf.has(h))return console.log("⏳ Waiting for pending field status request"),new Promise((y,v)=>{Ls.has(h)||Ls.set(h,[]),Ls.get(h).push({resolve:y,reject:v})});const p=(async()=>{try{r(!0),console.log(`🚀 Starting fresh field status fetch for ${d.length} applications`);const y=WL(d,jw);console.log(`📦 Splitting into ${y.length} chunks of max ${jw} IDs each`);const v={};let x=0;for(let b=0;b<y.length;b++)try{const E=await s(y[b],m);Object.assign(v,E),x++,b<y.length-1&&await new Promise(k=>setTimeout(k,100))}catch(E){console.error(`❌ Chunk ${b+1} failed:`,E)}d.forEach(b=>{v[b]||(v[b]="Unpaid")});const w=Object.keys(v).length;return console.log(`✅ Field status loaded: ${w} applications (${x}/${y.length} chunks successful)`),w>=d.length*.8?(Ec[h]={data:v,timestamp:Date.now(),expiresAt:Date.now()+HL},console.log(`💾 Cached field status data (${w} applications)`)):console.warn(`⚠️ Not caching incomplete data (${w}/${d.length})`),(Ls.get(h)||[]).forEach(({resolve:b})=>b(v)),Ls.delete(h),v}catch(y){return console.error("❌ Error in fetchFieldStatus:",y),(Ls.get(h)||[]).forEach(({reject:x})=>x(y)),Ls.delete(h),{}}finally{r(!1)}})();qf.set(h,p);try{return await p}finally{qf.delete(h)}},[e,a,n,s]),o=_.useCallback(()=>{Object.keys(Ec).forEach(l=>delete Ec[l]),qf.clear(),Ls.clear(),console.log("🧹 Field status cache, pending requests, and queue cleared")},[]);return{fetchFieldStatus:i,loading:t,clearCache:o}},Rw=e=>{if(!e||!e.includes("@"))return e||"Unknown User";const t=e.split("@")[0];return t.includes(".")?t.split(".").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.includes("_")?t.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.includes("-")?t.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},hm=()=>{const{user:e}=Bt(),[t,r]=_.useState(new Map),[n,a]=_.useState(!1),s=_.useRef(new Set),i=_.useCallback(async u=>{if(!e||u.length===0)return console.log("No user or empty userIds, returning empty array"),[];const f=u.filter(d=>!t.has(d)&&!s.current.has(d));if(f.length===0){const d=u.map(m=>t.get(m)).filter(Boolean);return console.log("All profiles already cached, returning:",d.length),d}f.forEach(d=>s.current.add(d)),a(!0);try{console.log("=== FETCHING USER PROFILES ==="),console.log("Fetching profiles for user IDs:",f);const{data:d,error:m}=await Pe.from("profiles").select("id, full_name, email").in("id",f);if(m)return console.error("Error fetching user profiles:",m),[];console.log("Fetched profiles from DB:",d),d&&d.length>0&&r(g=>{const p=new Map(g);return d.forEach(y=>{p.set(y.id,y),console.log(`✓ Cached profile: ${y.id} -> name: "${y.full_name}", email: "${y.email}"`)}),p});const h=u.map(g=>{const p=d==null?void 0:d.find(y=>y.id===g);return p||t.get(g)}).filter(Boolean);return console.log("Returning total profiles:",h.length),h}catch(d){return console.error("Exception in fetchProfiles:",d),[]}finally{f.forEach(d=>s.current.delete(d)),a(!1)}},[e,t]),o=_.useCallback((u,f)=>{const d=t.get(u);return console.log("=== GET USER NAME ==="),console.log(`User ID: ${u}`),console.log("Profile from cache:",d),console.log(`Fallback email: ${f}`),d!=null&&d.full_name&&d.full_name.trim()!==""&&d.full_name!=="null"&&d.full_name.toLowerCase()!=="unknown user"?d.full_name.trim():d!=null&&d.email&&d.email.trim()!==""&&d.email!=="null"?Rw(d.email.trim()):f&&f.trim()!==""?Rw(f.trim()):(console.log(`✗ Returning Unknown User for ${u}`),"Unknown User")},[t]),l=_.useCallback(()=>{console.log("Clearing user profiles cache"),r(new Map),s.current.clear()},[]);return{fetchProfiles:i,getUserName:o,profilesCache:t,loading:n,clearCache:l}},VL=e=>{const{user:t}=Bt();hm();const[r,n]=_.useState({}),[a,s]=_.useState(!1),i=_.useCallback(async o=>{if(!t||!o.length)return{};s(!0);try{return console.log("=== BATCH FETCHING COMMENTS ==="),console.log("Application IDs:",o.slice(0,5),"... and",Math.max(0,o.length-5),"more"),console.log("Selected Month:",e),console.log("⚠️ Comments fetching temporarily disabled - needs applications data for payment_id mapping"),n({}),{}}catch(l){return console.error("Exception in batch fetchComments:",l),{}}finally{s(!1)}},[t,e]);return _.useEffect(()=>{n({})},[e]),{comments:r,loading:a,fetchBatchComments:i}},Au=e=>{if(!e)return console.warn("Empty emiMonth provided to convertEmiMonthToDatabase"),"";if(e.match(/^\d{4}-\d{2}$/))return e;if(e.match(/^[A-Za-z]{3}-\d{2}$/)){const[t,r]=e.split("-");if(!t||!r)return console.warn("Invalid emiMonth format:",e),e;const n=parseInt(r);if(isNaN(n))return console.warn("Invalid year in emiMonth:",r),e;const a=n<50?`20${r}`:`19${r}`,i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].findIndex(u=>u.toLowerCase()===t.toLowerCase());if(i===-1)return console.warn("Invalid month name:",t),e;const o=(i+1).toString().padStart(2,"0"),l=`${a}-${o}`;return console.log("Converted EMI month:",e,"->",l),l}return console.warn("Unrecognized emiMonth format:",e),e},oh=e=>!e||!e.match(/^\d{4}-\d{2}$/)?e:`${e}-05`,gi=e=>{if(!e||!e.match(/^\d{4}-\d{2}$/))return console.warn("Invalid yearMonth format for getMonthDateRange:",e),{start:e,end:e};try{const[t,r]=e.split("-").map(Number),n=new Date(t,r-1,1),a=new Date(t,r,0),s=n.toISOString().split("T")[0],i=a.toISOString().split("T")[0];return console.log("Month date range for",e,":",{start:s,end:i}),{start:s,end:i}}catch(t){return console.error("Error calculating month date range for:",e,t),{start:e,end:e}}},zL=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1),n=_.useCallback(async(s,i)=>{if(!e||s.length===0)return console.log("❌ No user or empty application IDs for batch PTP dates"),{};r(!0);try{console.log("=== BATCH PTP DATES FETCH ==="),console.log("Application IDs:",s.length),console.log("Selected Month:",i);let o=Pe.from("ptp_dates").select("application_id, ptp_date, created_at").in("application_id",s);if(i){const d=Au(i),{start:m,end:h}=gi(d);console.log("Date range for PTP dates:",{start:m,end:h}),o=o.gte("demand_date",m).lte("demand_date",h)}o=o.order("created_at",{ascending:!1});const{data:l,error:u}=await o;if(u)return console.error("❌ Error fetching batch PTP dates:",u),{};const f={};return l&&l.forEach(d=>{f.hasOwnProperty(d.application_id)||(f[d.application_id]=d.ptp_date)}),console.log("✅ Batch PTP dates loaded:",Object.keys(f).length,"applications"),f}catch(o){return console.error("❌ Error in fetchBatchPtpDates:",o),{}}finally{r(!1)}},[e]),a=_.useCallback(async(s,i)=>{if(!e||s.length===0)return console.log("❌ No user or empty application IDs for batch PTP dates (audit log)"),{};r(!0);try{console.log("=== BATCH PTP DATES FROM AUDIT LOG FETCH ==="),console.log("Application IDs:",s.length),console.log("Selected Month:",i);let o=Pe.from("audit_logs").select("application_id, field, new_value, created_at, demand_date").in("application_id",s).eq("field","PTP Date");if(i){const d=Au(i),{start:m,end:h}=gi(d);o=o.gte("demand_date",m).lte("demand_date",h)}o=o.order("created_at",{ascending:!1});const{data:l,error:u}=await o;if(u)return console.error("❌ Error fetching batch PTP dates from audit log:",u),{};const f={};return l&&l.forEach(d=>{f.hasOwnProperty(d.application_id)||(f[d.application_id]=d.new_value)}),console.log("✅ Batch PTP dates from audit log loaded:",Object.keys(f).length,"applications"),f}catch(o){return console.error("❌ Error in fetchBatchPtpDatesFromAuditLog:",o),{}}finally{r(!1)}},[e]);return{fetchBatchPtpDates:n,fetchBatchPtpDatesFromAuditLog:a,loading:t}},GL=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1);return{fetchBatchContactStatus:_.useCallback(async(a,s)=>{if(!e||a.length===0)return{};r(!0);try{console.log("=== BATCH CONTACT STATUS FETCH ==="),console.log("Application IDs:",a.length),console.log("Selected Month:",s);let i=Pe.from("contact_calling_status").select("application_id, contact_type, status, created_at").in("application_id",a);if(s){const{start:f,end:d}=gi(s);console.log("Date range for contact status:",{start:f,end:d}),i=i.gte("demand_date",f).lte("demand_date",d)}i=i.order("created_at",{ascending:!1});const{data:o,error:l}=await i;if(l)return console.error("Error fetching batch contact status:",l),{};const u={};return o&&(o.forEach(f=>{u[f.application_id]||(u[f.application_id]={});const d=f.contact_type.toLowerCase();u[f.application_id][d]||(u[f.application_id][d]=f.status)}),Object.keys(u).forEach(f=>{const d=Object.values(u[f]);if(d.length>0){const m=d.filter(h=>h!=="Not Called");u[f].latest=m.length>0?m[0]:"No Calls"}else u[f].latest="No Calls"})),console.log("✅ Batch contact status loaded:",Object.keys(u).length,"applications"),u}catch(i){return console.error("Error in fetchBatchContactStatus:",i),{}}finally{r(!1)}},[e]),loading:t}},bv=e=>{const{fetchFieldStatus:t,loading:r}=kv(),{fetchBatchComments:n,loading:a}=VL(e),{fetchBatchPtpDates:s,fetchBatchPtpDatesFromAuditLog:i,loading:o}=zL(),{fetchBatchContactStatus:l,loading:u}=GL(),[f,d]=_.useState({statuses:{},comments:{},ptpDates:{},contactStatuses:{}}),[m,h]=_.useState(!1),[g,p]=_.useState(null),y=_.useRef(null),v=_.useRef(""),x=_.useCallback(async(E,k={})=>{var N,I,H,j;if(E.length===0){const z={statuses:{},comments:{},ptpDates:{},contactStatuses:{}};return d(z),z}y.current&&y.current.abort(),y.current=new AbortController;const T=`${E.join(",")}-${k.selectedEmiMonth||"none"}`;if(v.current===T)return console.log("⏭️ Skipping duplicate centralized data request"),f;v.current=T,h(!0),p(null);try{console.log("=== CENTRALIZED DATA MANAGER ==="),console.log("Application IDs:",E.length),console.log("Selected EMI Month:",k.selectedEmiMonth),console.log("Priority:",k.priority||"medium");const z=E.length<500&&k.priority!=="low";let K;if(z){console.log("📊 Fetching all data in parallel...");const[q,Q,X,F]=await Promise.all([t(E,k.selectedEmiMonth),i(E,k.selectedEmiMonth),l(E,k.selectedEmiMonth),n(E)]);K={statuses:q,ptpDates:Q,contactStatuses:X,comments:F}}else{console.log("📊 Fetching data sequentially...");const q=await t(E,k.selectedEmiMonth);if((N=y.current)!=null&&N.signal.aborted)return f;const Q=await i(E,k.selectedEmiMonth);if((I=y.current)!=null&&I.signal.aborted)return f;const X=await l(E,k.selectedEmiMonth);if((H=y.current)!=null&&H.signal.aborted)return f;const F=await n(E);K={statuses:q,ptpDates:Q,contactStatuses:X,comments:F}}return(j=y.current)!=null&&j.signal.aborted?f:(console.log("✅ Centralized data fetch complete:",{statuses:Object.keys(K.statuses).length,ptpDates:Object.keys(K.ptpDates).length,contactStatuses:Object.keys(K.contactStatuses).length,comments:Object.keys(K.comments).length}),d(K),K)}catch(z){return z instanceof Error&&z.name==="AbortError"?(console.log("🛑 Centralized data fetch was cancelled"),f):(console.error("❌ Error in centralized data fetch:",z),p(z instanceof Error?z:new Error("Unknown error")),f)}finally{h(!1)}},[t,n,s,i,l]),w=_.useCallback(()=>{d({statuses:{},comments:{},ptpDates:{},contactStatuses:{}}),p(null)},[]),S=_.useCallback(()=>{y.current&&y.current.abort(),h(!1)},[]);return _.useEffect(()=>()=>{y.current&&y.current.abort()},[]),{data:f,loading:m||r||a||o||u,error:g,fetchAllData:x,clearData:w,cancelRequests:S}},XE=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n})=>{const{data:a,loading:s,fetchAllData:i,clearData:o}=bv(n),l=e.map(u=>u.applicant_id);return _.useEffect(()=>{o(),l.length>0&&i(l,{selectedEmiMonth:n})},[l.join(","),n]),c.jsx("div",{className:"rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:e.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(Zl,{children:[c.jsx(zE,{}),c.jsx(ec,{children:e.map(u=>c.jsx(Sv,{application:u,selectedApplicationId:r,onRowClick:t,batchedStatus:a.statuses[u.applicant_id]||"Unpaid",batchedPtpDate:a.ptpDates[u.applicant_id]||null,batchedContactStatus:a.contactStatuses[u.applicant_id],batchedComments:a.comments[u.applicant_id]||[],isLoading:s},u.id))})]})}):c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No applications found"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters or search terms"})]})})});XE.displayName="SimpleApplicationsTable";const KE=_.memo(({currentPage:e,totalPages:t,onPageChange:r,totalCount:n,pageSize:a})=>{const{startRecord:s,endRecord:i,pageNumbers:o}=_.useMemo(()=>{const l=(e-1)*a+1,u=Math.min(e*a,n),f=[];if(t<=5)for(let d=1;d<=t;d++)f.push(d);else if(e<=3)for(let d=1;d<=5;d++)f.push(d);else if(e>=t-2)for(let d=t-4;d<=t;d++)f.push(d);else for(let d=e-2;d<=e+2;d++)f.push(d);return{startRecord:l,endRecord:u,pageNumbers:f}},[e,t,a,n]);return c.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-2 sm:px-4 py-3 bg-white border-t gap-3 sm:gap-0",children:[c.jsx("div",{className:"flex items-center text-xs sm:text-sm text-gray-700",children:c.jsxs("span",{children:["Showing ",s," to ",i," of ",n," applications"]})}),c.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>r(e-1),disabled:e===1,className:"text-xs sm:text-sm px-2 sm:px-3",children:[c.jsx(N1,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),"Previous"]}),c.jsx("div",{className:"flex items-center space-x-1",children:o.map(l=>c.jsx(Te,{variant:e===l?"default":"outline",size:"sm",onClick:()=>r(l),className:"w-7 h-7 sm:w-8 sm:h-8 p-0 text-xs sm:text-sm",children:l},l))}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>r(e+1),disabled:e===t,className:"text-xs sm:text-sm px-2 sm:px-3",children:["Next",c.jsx($h,{className:"h-3 w-3 sm:h-4 sm:w-4 ml-1"})]})]})]})});KE.displayName="PaginationControls";const qE=({name:e,phone:t,variant:r="ghost",size:n="sm",className:a=""})=>{if(!t)return null;const s=P8(t);if(!s)return null;const i=o=>{o.stopPropagation(),window.location.href=s};return c.jsxs(Te,{variant:r,size:n,className:`gap-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 ${a}`,onClick:i,children:[c.jsx(Hh,{className:"h-3 w-3"}),c.jsx("span",{className:"text-xs",children:e})]})},YL={"deposited in bank":"Deposited in Bank","cash collected":"Cash Collected","ptp taken":"PTP Taken","no response":"No Response",no_response:"No Response",noresponse:"No Response",deposited_in_bank:"Deposited in Bank",cash_collected:"Cash Collected",ptp_taken:"PTP Taken",1:"Deposited in Bank",2:"Cash Collected",3:"PTP Taken",4:"No Response"},XL=e=>e?YL[e.toLowerCase()]||e:"Not Set",QE=_.memo(({application:e,onRowClick:t,selectedApplicationId:r,selectedMonth:n})=>{const a=e.status||"Unpaid",s=e.ptp_date,[i,o]=_.useState([]),[l,u]=_.useState(!1);return _.useEffect(()=>{(async()=>{if(!e.payment_id){console.log("⚠️ No payment_id for application:",e.applicant_id);return}console.log("🔍 Fetching comments for mobile application:",e.applicant_id,"payment_id:",e.payment_id),u(!0);try{const d=await Il.getCommentsByRepaymentAndType(e.payment_id.toString(),Ml.APPLICATION_DETAILS,0,3);d.results&&d.results.length>0?(console.log("✅ Found comments for mobile application:",e.applicant_id,"count:",d.results.length),o(d.results.map(m=>({...m,user_name:m.user_name||`User ${m.user_id}`,content:m.comment,application_id:e.applicant_id||""})))):(console.log("ℹ️ No comments found for mobile application:",e.applicant_id),o([]))}catch(d){console.error("❌ Error fetching comments for mobile application:",d),o([])}finally{u(!1)}})()},[e.payment_id,e.applicant_id]),console.log("MobileApplicationCard Debug:",{applicant_name:e.applicant_name,applicant_mobile:e.applicant_mobile,hasMobile:!!e.applicant_mobile}),c.jsx(Qe,{className:`cursor-pointer transition-all duration-200 hover:shadow-md active:scale-[0.98] bg-white border border-gray-200 ${r===e.id?"ring-2 ring-blue-500 shadow-md":"hover:shadow-lg"}`,onClick:()=>t(e),children:c.jsxs(at,{className:"p-4",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:e.applicant_name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",e.applicant_id]})]}),c.jsxs("div",{className:"flex flex-col items-end gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(wa,{className:`px-3 py-1 text-sm font-medium ${a==="Unpaid"?"bg-red-100 text-red-800 border-red-200":a==="Paid"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"} border rounded-full`,children:a}),c.jsx(Te,{variant:"ghost",size:"sm",className:"p-2 hover:bg-gray-100 rounded-full",onClick:f=>{f.stopPropagation(),t(e)},children:c.jsx(Xk,{className:"h-4 w-4 text-gray-600"})})]}),e.applicant_mobile?c.jsx(qE,{name:"Call",phone:e.applicant_mobile,variant:"outline",size:"sm",className:"flex-shrink-0"}):c.jsxs(Te,{variant:"outline",size:"sm",className:"flex-shrink-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50",onClick:f=>{f.stopPropagation(),console.log("No mobile number available for:",e.applicant_name)},children:[c.jsx(Hh,{className:"h-3 w-3 mr-1"}),c.jsx("span",{className:"text-xs",children:"No Number"})]})]})]}),c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"border-2 border-blue-200 bg-blue-50 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"EMI Amount"}),c.jsx("p",{className:"text-xl font-bold text-blue-800",children:Nu(e.emi_amount)})]})}),c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(lp,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Lender:"}),c.jsx("span",{className:"text-sm font-medium",children:e.lender_name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(lp,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Dealer:"}),c.jsx("span",{className:"text-sm font-medium",children:e.dealer_name})]})]}),c.jsxs("div",{className:"flex-1 text-right",children:[c.jsxs("div",{className:"flex items-center justify-end gap-2 mb-1",children:[c.jsx(oo,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-600",children:"RM:"}),c.jsx("span",{className:"text-sm font-medium",children:e.rm_name})]}),c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(lp,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Branch:"}),c.jsx("span",{className:"text-sm font-medium",children:e.branch_name})]})]})]})}),c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"border-2 border-yellow-200 bg-yellow-50 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"PTP Date:"}),c.jsx("p",{className:"text-lg font-bold text-yellow-800",children:s?ig(s):"Not Set"})]})}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pre-EMI:"}),c.jsx("p",{className:"text-sm font-medium text-blue-600",children:XL(e.demand_calling_status)})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Repayment Number:"}),c.jsx("p",{className:"text-sm font-medium text-gray-800",children:e.demand_num||"N/A"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Amount Collected:"}),c.jsx("p",{className:"text-sm font-semibold text-black",children:e.amount_collected?Nu(e.amount_collected):"NA"})]}),c.jsxs("div",{className:"border-t pt-3",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Comments:"}),l?c.jsx("div",{className:"text-xs text-gray-400 italic",children:"Loading comments..."}):i&&i.length>0?c.jsx("div",{className:"space-y-2",children:i.slice(0,2).map((f,d)=>c.jsxs("div",{className:"relative pl-4",children:[c.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 bg-blue-200"}),c.jsx("div",{className:"font-medium text-blue-600 text-sm mb-1",children:f.user_name||"Unknown User"}),c.jsx("div",{className:"text-xs text-gray-700 break-words",children:f.content})]},d))}):c.jsx("p",{className:"text-xs text-gray-400 italic",children:"No comments yet"})]})]})})});QE.displayName="MobileApplicationCard";const JE=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n})=>e.length===0?c.jsx("div",{className:"rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No applications found"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters or search terms"})]})}):c.jsx("div",{className:"space-y-3",children:e.map(a=>c.jsx(QE,{application:a,onRowClick:t,selectedApplicationId:r,selectedMonth:n||""},a.id))}));JE.displayName="OptimizedMobileTable";const KL=({applications:e,onRowClick:t,selectedApplicationId:r,currentPage:n,totalPages:a,onPageChange:s,totalCount:i,pageSize:o,selectedEmiMonth:l})=>{const u=UE();return c.jsxs("div",{className:"space-y-4",children:[e.length>0&&c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center text-xs sm:text-sm text-gray-600 gap-2 sm:gap-0",children:c.jsxs("span",{children:["Showing ",(n-1)*o+1," to ",Math.min(n*o,i)," of ",i," applications"]})}),u?c.jsx(JE,{applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:l}):c.jsx(XE,{applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:l}),e.length>0&&a>1&&c.jsx(KE,{currentPage:n,totalPages:a,onPageChange:s,totalCount:i,pageSize:o})]})},qL=()=>{const[e,t]=_.useState(null),[r,n]=_.useState(!1),[a,s]=_.useState(!1);_.useEffect(()=>{const l=window.navigator.userAgent.toLowerCase(),u=/iphone|ipad|ipod/.test(l);if(s(u),window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)return;const d=m=>{m.preventDefault(),t(m),setTimeout(()=>{localStorage.getItem("pwa-install-dismissed")||n(!0)},5e3)};return window.addEventListener("beforeinstallprompt",d),()=>{window.removeEventListener("beforeinstallprompt",d)}},[]);const i=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&console.log("User accepted the install prompt"),t(null),n(!1)}},o=()=>{n(!1),localStorage.setItem("pwa-install-dismissed","true")};return r?c.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 sm:left-auto sm:right-4 sm:w-80",children:c.jsx(Qe,{className:"shadow-lg border border-blue-200 bg-blue-50",children:c.jsxs(at,{className:"p-4",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(bs,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"font-semibold text-gray-900",children:"Install App"})]}),c.jsx(Te,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:c.jsx(Vl,{className:"h-4 w-4"})})]}),a?c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Install this app for a better experience"}),c.jsx("p",{className:"text-xs text-gray-500",children:'Tap the share button and select "Add to Home Screen"'})]}):c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Install ProsParity for quick access and offline support"}),c.jsxs(Te,{onClick:i,className:"w-full bg-blue-600 hover:bg-blue-700",size:"sm",children:[c.jsx(bs,{className:"h-4 w-4 mr-2"}),"Install Now"]})]})]})})}):null},QL=({statusCounts:e})=>{if(!e)return c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-1 sm:gap-2 md:gap-3",children:Array.from({length:8}).map((n,a)=>c.jsxs(Qe,{className:"bg-gray-50 border-gray-200 border shadow-sm",children:[c.jsx(_t,{className:"pb-1 pt-1 px-1 sm:pb-2 sm:pt-2 sm:px-2",children:c.jsx(St,{className:"text-xs sm:text-sm font-medium text-gray-400 text-center leading-tight",children:"Loading..."})}),c.jsx(at,{className:"pt-0 pb-1 px-1 sm:pb-2 sm:px-2",children:c.jsx("div",{className:"text-sm sm:text-lg md:text-xl font-semibold text-gray-300 text-center",children:"-"})})]},a))});const t=(n,a)=>a===0?"0%":`${Math.round(n/a*100)}%`,r=[{title:"Total",value:e.total,percentage:null,className:"bg-blue-50 border-blue-200"},{title:"Future",value:e.future||0,percentage:t(e.future||0,e.total),className:"bg-green-50 border-green-200"},{title:"Overdue",value:e.overdue||0,percentage:t(e.overdue||0,e.total),className:"bg-red-50 border-red-200"},{title:"Partially Paid",value:e.partially_paid||0,percentage:t(e.partially_paid||0,e.total),className:"bg-yellow-50 border-yellow-200"},{title:"Paid",value:e.paid||0,percentage:t(e.paid||0,e.total),className:"bg-emerald-50 border-emerald-200"},{title:"Foreclose",value:e.foreclose||0,percentage:t(e.foreclose||0,e.total),className:"bg-gray-50 border-gray-200"},{title:"Paid (Pending Approval)",value:e.paid_pending_approval||0,percentage:t(e.paid_pending_approval||0,e.total),className:"bg-purple-50 border-purple-200"},{title:"Paid Rejected",value:e.paid_rejected||0,percentage:t(e.paid_rejected||0,e.total),className:"bg-pink-50 border-pink-200"}];return c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-1 sm:gap-2 md:gap-3",children:r.map((n,a)=>c.jsxs(Qe,{className:`${n.className} border shadow-sm`,children:[c.jsx(_t,{className:"pb-1 pt-1 px-1 sm:pb-2 sm:pt-2 sm:px-2",children:c.jsx(St,{className:"text-xs sm:text-sm font-medium text-gray-600 text-center leading-tight",children:n.title})}),c.jsxs(at,{className:"pt-0 pb-1 px-1 sm:pb-2 sm:px-2",children:[c.jsx("div",{className:"text-sm sm:text-lg md:text-xl font-semibold text-gray-800 text-center",children:n.value}),n.percentage&&c.jsx("div",{className:"text-xs text-gray-500 text-center mt-1",children:n.percentage})]})]},a))})};function Mw({className:e,...t}){return c.jsx("div",{className:Ce("animate-pulse rounded-md bg-muted",e),...t})}const JL=()=>c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-8 gap-1 sm:gap-2 md:gap-3",children:Array.from({length:8}).map((e,t)=>c.jsx(Qe,{children:c.jsx(at,{className:"p-6",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx(Mw,{className:"h-4 w-[100px]"}),c.jsx(Mw,{className:"h-8 w-[60px]"})]})})},t))}),ZL=`
  @media (max-width: 480px) {
    .xs\\:hidden { display: none !important; }
    .xs\\:inline { display: inline !important; }
    .xs\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
  }
`,e7=({onUpdate:e})=>{const{user:t}=Bt(),[r,n]=_.useState([]),[a,s]=_.useState(!1),[i,o]=_.useState(new Set),[l,u]=_.useState(()=>{const g=localStorage.getItem("pendingApprovalsOpen");return g!==null?JSON.parse(g):!0});_.useEffect(()=>{localStorage.setItem("pendingApprovalsOpen",JSON.stringify(l))},[l]);const f=async()=>{if(t){s(!0);try{const g=await I8();console.log("Fetched pending applications:",g),n(g.applications||[])}catch(g){console.error("Error fetching pending applications:",g),Se.error("Failed to fetch pending applications")}finally{s(!1)}}};_.useEffect(()=>{f()},[t]);const d=async g=>{if(!t)return;const p=`${g.applicant_id}-approve`;o(y=>new Set(y).add(p));try{const y={loan_id:g.loan_id.toString(),repayment_id:g.repayment_id,action:"accept",user_id:t.id,comments:""};console.log("Sending approve payload:",y);const v=await fetch(`${Rt}/paidpending-approval/approve`,{method:"POST",headers:{"Content-Type":"application/json",...dr()},body:JSON.stringify(y)});if(!v.ok)throw new Error(`Failed to approve application: ${v.status}`);Se.success(`Application ${g.applicant_id} approved successfully`),await f(),e()}catch(y){console.error("Error approving application:",y),Se.error("Failed to approve application")}finally{o(y=>{const v=new Set(y);return v.delete(p),v})}},m=async g=>{if(!t)return;const p=`${g.applicant_id}-reject`;o(y=>new Set(y).add(p));try{const y={loan_id:g.loan_id.toString(),repayment_id:g.repayment_id,action:"reject",user_id:t.id,comments:""};console.log("Sending reject payload:",y);const v=await fetch(`${Rt}/paidpending-approval/approve`,{method:"POST",headers:{"Content-Type":"application/json",...dr()},body:JSON.stringify(y)});if(!v.ok)throw new Error(`Failed to reject application: ${v.status}`);Se.success(`Application ${g.applicant_id} rejected successfully`),await f(),e()}catch(y){console.error("Error rejecting application:",y),Se.error("Failed to reject application")}finally{o(y=>{const v=new Set(y);return v.delete(p),v})}},h=g=>{try{return new Date(g).toLocaleDateString("en-GB")}catch{return g}};return a?c.jsxs(Qe,{children:[c.jsx(_t,{className:"p-3 sm:p-6",children:c.jsxs(St,{className:"flex items-center gap-2",children:[c.jsx(Yc,{className:"h-5 w-5 flex-shrink-0"}),c.jsx("span",{className:"text-base sm:text-lg font-semibold",children:"Pending Status Approvals"})]})}),c.jsx(at,{className:"p-3 sm:p-6",children:c.jsx("div",{className:"text-center py-4 text-sm sm:text-base",children:"Loading pending applications..."})})]}):c.jsxs(c.Fragment,{children:[c.jsx("style",{children:ZL}),c.jsx(Qe,{className:"overflow-hidden",children:c.jsxs(yv,{open:l,onOpenChange:u,children:[c.jsx(xv,{asChild:!0,children:c.jsx(_t,{className:"cursor-pointer hover:bg-gray-50 transition-colors p-3 sm:p-6",children:c.jsxs(St,{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c.jsx(Yc,{className:"h-5 w-5 flex-shrink-0"}),c.jsx("span",{className:"text-base sm:text-lg font-semibold",children:"Pending Status Approvals"}),r.length>0&&c.jsx(wa,{variant:"secondary",className:"ml-2 flex-shrink-0",children:r.length})]}),c.jsx("div",{className:"flex-shrink-0",children:l?c.jsx(Wh,{className:"h-5 w-5"}):c.jsx(bo,{className:"h-5 w-5"})})]})})}),c.jsx(wv,{children:c.jsx(at,{children:r.length===0?c.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[c.jsx(Yc,{className:"h-8 w-8 sm:h-12 sm:w-12 mx-auto mb-3 sm:mb-4 text-gray-300"}),c.jsx("p",{className:"text-base sm:text-lg font-medium",children:"No pending requests"}),c.jsx("p",{className:"text-xs sm:text-sm",children:"All applications have been reviewed"})]}):c.jsx("div",{className:"space-y-3 sm:space-y-4",children:r.map(g=>c.jsx("div",{className:"border rounded-lg p-3 sm:p-4 bg-gray-50",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c.jsx(oo,{className:"h-4 w-4 text-gray-600 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-base sm:text-lg truncate",children:g.applicant_name}),c.jsx(wa,{variant:"outline",className:"text-xs flex-shrink-0",children:g.applicant_id})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[c.jsx(Te,{size:"sm",onClick:()=>d(g),disabled:i.has(`${g.applicant_id}-approve`)||i.has(`${g.applicant_id}-reject`),className:"flex items-center justify-center gap-1 bg-green-600 hover:bg-green-700 w-full sm:w-auto min-h-[32px] sm:min-h-[36px]",children:i.has(`${g.applicant_id}-approve`)?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),c.jsx("span",{className:"hidden xs:inline",children:"Processing..."}),c.jsx("span",{className:"xs:hidden",children:"..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(KP,{className:"h-4 w-4 sm:h-5 sm:w-5"}),c.jsx("span",{className:"hidden xs:inline",children:"Approve"}),c.jsx("span",{className:"xs:hidden",children:"Approve"})]})}),c.jsx(Te,{size:"sm",variant:"destructive",onClick:()=>m(g),disabled:i.has(`${g.applicant_id}-approve`)||i.has(`${g.applicant_id}-reject`),className:"flex items-center justify-center gap-1 w-full sm:w-auto min-h-[32px] sm:min-h-[36px]",children:i.has(`${g.applicant_id}-reject`)?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),c.jsx("span",{className:"hidden xs:inline",children:"Processing..."}),c.jsx("span",{className:"xs:hidden",children:"..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(QP,{className:"h-4 w-4 sm:h-5 sm:w-5"}),c.jsx("span",{className:"hidden xs:inline",children:"Reject"}),c.jsx("span",{className:"xs:hidden",children:"Reject"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-3 text-xs sm:text-sm",children:[c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(ZP,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Amount:"}),c.jsxs("span",{className:"text-green-600 font-semibold text-xs sm:text-sm truncate",children:["₹",g.amount_collected.toLocaleString()]})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Li,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"PTP:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:g.ptp_date||"Not set"})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(C1,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Demand:"}),c.jsxs("span",{className:"text-xs sm:text-sm truncate",children:["₹",g.demand_amount.toLocaleString()]})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Li,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Demand Date:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(g.demand_date)})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Li,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Payment:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(g.payment_date)})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Li,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Updated:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(g.updated_at)})]})]})]})},g.applicant_id))})})})]})})]})};var mm="Tabs",[t7,iQ]=Mn(mm,[om]),ZE=om(),[r7,Ev]=t7(mm),eT=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:s,orientation:i="horizontal",dir:o,activationMode:l="automatic",...u}=e,f=im(o),[d,m]=qa({prop:n,onChange:a,defaultProp:s??"",caller:mm});return c.jsx(r7,{scope:r,baseId:Xa(),value:d,onValueChange:m,orientation:i,dir:f,activationMode:l,children:c.jsx(De.div,{dir:f,"data-orientation":i,...u,ref:t})})});eT.displayName=mm;var tT="TabsList",rT=_.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,s=Ev(tT,r),i=ZE(r);return c.jsx(z4,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:n,children:c.jsx(De.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:t})})});rT.displayName=tT;var nT="TabsTrigger",aT=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...s}=e,i=Ev(nT,r),o=ZE(r),l=oT(i.baseId,n),u=lT(i.baseId,n),f=n===i.value;return c.jsx(G4,{asChild:!0,...o,focusable:!a,active:f,children:c.jsx(De.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...s,ref:t,onMouseDown:Ne(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(n):d.preventDefault()}),onKeyDown:Ne(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(n)}),onFocus:Ne(e.onFocus,()=>{const d=i.activationMode!=="manual";!f&&!a&&d&&i.onValueChange(n)})})})});aT.displayName=nT;var sT="TabsContent",iT=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:s,...i}=e,o=Ev(sT,r),l=oT(o.baseId,n),u=lT(o.baseId,n),f=n===o.value,d=_.useRef(f);return _.useEffect(()=>{const m=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(m)},[]),c.jsx(Ca,{present:a||f,children:({present:m})=>c.jsx(De.div,{"data-state":f?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!m,id:u,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:m&&s})})});iT.displayName=sT;function oT(e,t){return`${e}-trigger-${t}`}function lT(e,t){return`${e}-content-${t}`}var n7=eT,cT=rT,uT=aT,fT=iT;const dT=n7,Tv=_.forwardRef(({className:e,...t},r)=>c.jsx(cT,{ref:r,className:Ce("inline-flex h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Tv.displayName=cT.displayName;const ds=_.forwardRef(({className:e,...t},r)=>c.jsx(uT,{ref:r,className:Ce("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-4 py-2 text-base font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ds.displayName=uT.displayName;const hs=_.forwardRef(({className:e,...t},r)=>c.jsx(fT,{ref:r,className:Ce("mt-4 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));hs.displayName=fT.displayName;const hT=e=>{const{user:t}=Bt(),{getUserName:r,fetchProfiles:n}=hm(),[a,s]=_.useState([]),[i,o]=_.useState(!1),[l,u]=_.useState(null),[f,d]=_.useState(null),m=_.useRef(!1);_.useEffect(()=>{e!==f&&(console.log("Comments: Clearing due to month change",{from:f,to:e}),s([]),u(null),d(null))},[e,f]);const h=_.useCallback(async v=>{if(!t||!v)return[];if(m.current)return console.log("Comments: Fetch already in progress, skipping"),a;m.current=!0,o(!0);try{console.log("=== FETCHING COMMENTS ==="),console.log("Application ID:",v),console.log("Selected Month:",e);const x=await Il.getCommentsByRepaymentAndType(v,Ml.APPLICATION_DETAILS,0,100);if(!x.results||x.results.length===0)return console.log("No comments found for application:",v,"month:",e),s([]),u(v),d(e),[];console.log("Raw comments data from API:",x.results);const w=[...new Set(x.results.map(b=>b.user_id.toString()))];console.log("Fetching profiles for user IDs:",w),await n(w);const S=x.results.map(b=>{const E=r(b.user_id.toString(),null);return console.log(`✓ Comment ${b.id}: user_id=${b.user_id} -> resolved_name="${E}"`),{...b,user_name:E,content:b.comment,application_id:v}});return console.log("Final mapped comments with resolved names:",S),s(S),u(v),d(e),S}catch(x){return console.error("Exception in fetchComments:",x),[]}finally{o(!1),m.current=!1}},[t,n,r,e]),g=_.useCallback(async(v,x,w)=>(console.warn("fetchCommentsByApplications is deprecated. Use individual fetchComments instead."),{}),[]),p=_.useCallback(async(v,x,w,S,b)=>{if(!(t!=null&&t.id)||!v||!x.trim()){console.error("Cannot add comment: user not authenticated or missing application ID");return}try{console.log("=== ADDING COMMENT ==="),console.log("Application ID:",v),console.log("Content:",x),console.log("User ID (frontend):",t.id),console.log("User ID (sending to API):",t.id),console.log("User email:",t.email),console.log("Demand Date:",w),console.log("Loan ID:",S),console.log("EMI Month:",b);let E=v;if(S&&b)try{console.log("🔍 Fetching repayment_id for loan_id:",S,"emi_month:",b);const N={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},[I,H]=b.split("-"),j=N[I],z=parseInt(`20${H}`);if(!j||!z)throw new Error(`Invalid emi_month format: ${b}. Expected format: "Aug-25"`);console.log("🔍 Parsed month/year:",{month:j,year:z}),console.log("🔍 Querying payment_details table for loan_id:",S,"month:",j,"year:",z);const{data:K,error:q}=await Pe.from("payment_details").select("id, loan_application_id, demand_month, demand_year").eq("loan_application_id",S).eq("demand_month",j).eq("demand_year",z).maybeSingle();if(q){console.error("❌ Database query error:",q),console.log("🔍 Checking available tables...");try{const{data:Q,error:X}=await Pe.from("information_schema.tables").select("table_name").eq("table_schema","public");X?console.log("⚠️ Could not check tables:",X):console.log("📋 Available tables:",Q==null?void 0:Q.map(F=>F.table_name))}catch(Q){console.log("⚠️ Table check failed:",Q)}throw q}if(K)E=K.id.toString(),console.log("✅ Found repayment_id:",E,"for loan_id:",S,"emi_month:",b),console.log("✅ Payment details:",K);else{console.log("⚠️ No payment details found in database for loan_id:",S,"month:",j,"year:",z),console.log("⚠️ Using applicationId as repayment_id:",v);const{data:Q,error:X}=await Pe.from("payment_details").select("id, loan_application_id, demand_month, demand_year").eq("loan_application_id",S);X?console.error("❌ Error listing payment details:",X):console.log("🔍 All payment details for loan_id:",S,":",Q)}}catch(N){console.error("❌ Error fetching payment details, using fallback:",N),console.log("⚠️ Using applicationId as repayment_id:",v)}else console.log("⚠️ No loan_id or emi_month provided, using applicationId as repayment_id:",v);console.log("🔍 Final repayment_id being used:",E),console.log("🔍 Is repayment_id different from applicationId?",E!==v);const k={repayment_id:E,comment:x.trim(),user_id:t==null?void 0:t.id,comment_type:Ml.APPLICATION_DETAILS};console.log("🚀 Creating comment with data:",k),E===v?console.warn("⚠️ WARNING: repayment_id is the same as applicationId. Payment details lookup may have failed."):console.log("✅ SUCCESS: repayment_id is different from applicationId - payment details lookup worked!");const T=await Il.createComment(k);console.log("✓ Comment added successfully via API:",T),u(null),d(null)}catch(E){throw console.error("Exception in addComment:",E),E}},[t]),y=_.useCallback(()=>{console.log("Comments: Clearing all cached data"),s([]),u(null),d(null)},[]);return{comments:a,loading:i,fetchComments:h,fetchCommentsByApplications:g,addComment:p,clearComments:y}},a7=(e,t)=>{const{user:r}=Bt(),{getUserName:n,fetchProfiles:a}=hm(),[s,i]=_.useState([]),[o,l]=_.useState(!1),u=_.useCallback(async()=>{if(!(!r||!e)){l(!0);try{console.log("=== FETCHING AUDIT LOGS ==="),console.log("Application ID:",e),console.log("Selected Month:",t);let m=Pe.from("audit_logs").select("*").eq("application_id",e);if(t){const v=oh(t);console.log("Filtering audit logs by demand_date:",v),m=m.eq("demand_date",v)}m=m.order("created_at",{ascending:!1});const{data:h,error:g}=await m;if(g){console.error("Error fetching audit logs:",g);return}if(!h||h.length===0){console.log("No audit logs found for application:",e,"month:",t),i([]);return}console.log("Raw audit logs data:",h);const p=[...new Set(h.map(v=>v.user_id))];console.log("Fetching profiles for user IDs:",p),await a(p),await new Promise(v=>setTimeout(v,100));const y=h.map(v=>{const x=n(v.user_id,v.user_email);return console.log(`✓ Audit log ${v.id}: user_id=${v.user_id} -> resolved_name="${x}"`),{...v,user_name:x}});console.log("Final mapped audit logs with resolved names:",y),i(y)}catch(m){console.error("Exception in fetchAuditLogs:",m)}finally{l(!1)}}},[r,e,t,a,n]),f=_.useCallback(async(m,h,g,p,y)=>{if(r)try{console.log("=== ADDING AUDIT LOG ==="),console.log("Application ID:",m),console.log("Field:",h),console.log("Previous Value:",g),console.log("New Value:",p),console.log("User ID:",r.id),console.log("User email:",r.email),console.log("Demand Date:",y);const v={application_id:m,field:h,previous_value:g,new_value:p,user_id:r.id,user_email:r.email};y&&(v.demand_date=y);const{error:x}=await Pe.from("audit_logs").insert(v);if(x)throw console.error("Error adding audit log:",x),x;console.log("✓ Audit log added successfully"),await u()}catch(v){throw console.error("Exception in addAuditLog:",v),v}},[r,u]);_.useEffect(()=>{u()},[u]);const d=_.useCallback(async()=>{await u()},[u]);return{auditLogs:s,loading:o,addAuditLog:f,refetch:d}},s7=(e,t)=>{const{user:r}=Bt(),{getUserName:n,fetchProfiles:a}=hm(),[s,i]=_.useState([]),[o,l]=_.useState(!1),u=_.useCallback(async()=>{if(!(!r||!e)){l(!0);try{console.log("=== FETCHING CALLING LOGS ==="),console.log("Application ID:",e),console.log("Selected Month:",t);let m=Pe.from("calling_logs").select("*").eq("application_id",e);if(t){const v=oh(t);console.log("Filtering calling logs by demand_date:",v),m=m.eq("demand_date",v)}m=m.order("created_at",{ascending:!1});const{data:h,error:g}=await m;if(g){console.error("Error fetching calling logs:",g);return}if(!h||h.length===0){console.log("No calling logs found for application:",e,"month:",t),i([]);return}console.log("Raw calling logs data:",h);const p=[...new Set(h.map(v=>v.user_id))];console.log("Fetching profiles for user IDs:",p),await a(p),await new Promise(v=>setTimeout(v,100));const y=h.map(v=>{const x=n(v.user_id,v.user_email);return console.log(`✓ Calling log ${v.id}: user_id=${v.user_id} -> resolved_name="${x}"`),{...v,user_name:x}});console.log("Final mapped calling logs with resolved names:",y),i(y)}catch(m){console.error("Exception in fetchCallingLogs:",m)}finally{l(!1)}}},[r,e,t,a,n]),f=_.useCallback(async(m,h,g)=>{if(!(!r||!e))try{console.log("=== ADDING CALLING LOG ==="),console.log("Application ID:",e),console.log("Contact Type:",m),console.log("Previous Status:",h),console.log("New Status:",g),console.log("User ID:",r.id),console.log("User email:",r.email),console.log("Selected Month:",t);const p={application_id:e,contact_type:m,previous_status:h,new_status:g,user_id:r.id,user_email:r.email,user_name:n(r.id,r.email)};t&&(p.demand_date=oh(t));const{error:y}=await Pe.from("calling_logs").insert(p);if(y)throw console.error("Error adding calling log:",y),y;console.log("✓ Calling log added successfully"),await u()}catch(p){throw console.error("Exception in addCallingLog:",p),p}},[r,e,t,n,u]);_.useEffect(()=>{u()},[u]);const d=_.useCallback(async()=>{await u()},[u]);return{callingLogs:s,loading:o,addCallingLog:f,refetch:d}},i7={Risky:"bg-yellow-500 text-white",Repossessed:"bg-red-600 text-white","Might Need to Repossess":"bg-orange-500 text-white"},o7=({application:e})=>{const t=e.vehicle_status?i7[e.vehicle_status]||"bg-gray-400 text-white":"";return c.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[c.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-full",children:c.jsx(qP,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate",children:e.applicant_name}),e.vehicle_status&&c.jsx(wa,{className:t,children:e.vehicle_status})]}),c.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-gray-600",children:[e.demand_date&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"EMI Month:"})," ",ma(e.demand_date)]}),e.emi_amount!=null&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"EMI Due:"})," ",Nu(e.emi_amount)]})]})]})]})};function Iw(e,[t,r]){return Math.min(r,Math.max(t,e))}var l7=[" ","Enter","ArrowUp","ArrowDown"],c7=[" ","Enter"],ho="Select",[pm,gm,u7]=k1(ho),[tc,oQ]=Mn(ho,[u7,Xl]),vm=Xl(),[f7,Ei]=tc(ho),[d7,h7]=tc(ho),mT=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:s,value:i,defaultValue:o,onValueChange:l,dir:u,name:f,autoComplete:d,disabled:m,required:h,form:g}=e,p=vm(t),[y,v]=_.useState(null),[x,w]=_.useState(null),[S,b]=_.useState(!1),E=im(u),[k,T]=qa({prop:n,defaultProp:a??!1,onChange:s,caller:ho}),[N,I]=qa({prop:i,defaultProp:o,onChange:l,caller:ho}),H=_.useRef(null),j=y?g||!!y.closest("form"):!0,[z,K]=_.useState(new Set),q=Array.from(z).map(Q=>Q.props.value).join(";");return c.jsx(Ab,{...p,children:c.jsxs(f7,{required:h,scope:t,trigger:y,onTriggerChange:v,valueNode:x,onValueNodeChange:w,valueNodeHasChildren:S,onValueNodeHasChildrenChange:b,contentId:Xa(),value:N,onValueChange:I,open:k,onOpenChange:T,dir:E,triggerPointerDownPosRef:H,disabled:m,children:[c.jsx(pm.Provider,{scope:t,children:c.jsx(d7,{scope:e.__scopeSelect,onNativeOptionAdd:_.useCallback(Q=>{K(X=>new Set(X).add(Q))},[]),onNativeOptionRemove:_.useCallback(Q=>{K(X=>{const F=new Set(X);return F.delete(Q),F})},[]),children:r})}),j?c.jsxs(LT,{"aria-hidden":!0,required:h,tabIndex:-1,name:f,autoComplete:d,value:N,onChange:Q=>I(Q.target.value),disabled:m,form:g,children:[N===void 0?c.jsx("option",{value:""}):null,Array.from(z)]},q):null]})})};mT.displayName=ho;var pT="SelectTrigger",gT=_.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,s=vm(r),i=Ei(pT,r),o=i.disabled||n,l=Je(t,i.onTriggerChange),u=gm(r),f=_.useRef("touch"),[d,m,h]=UT(p=>{const y=u().filter(w=>!w.disabled),v=y.find(w=>w.value===i.value),x=$T(y,p,v);x!==void 0&&i.onValueChange(x.value)}),g=p=>{o||(i.onOpenChange(!0),h()),p&&(i.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return c.jsx(Xh,{asChild:!0,...s,children:c.jsx(De.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":BT(i.value)?"":void 0,...a,ref:l,onClick:Ne(a.onClick,p=>{p.currentTarget.focus(),f.current!=="mouse"&&g(p)}),onPointerDown:Ne(a.onPointerDown,p=>{f.current=p.pointerType;const y=p.target;y.hasPointerCapture(p.pointerId)&&y.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(g(p),p.preventDefault())}),onKeyDown:Ne(a.onKeyDown,p=>{const y=d.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&m(p.key),!(y&&p.key===" ")&&l7.includes(p.key)&&(g(),p.preventDefault())})})})});gT.displayName=pT;var vT="SelectValue",yT=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:s,placeholder:i="",...o}=e,l=Ei(vT,r),{onValueNodeHasChildrenChange:u}=l,f=s!==void 0,d=Je(t,l.onValueNodeChange);return gr(()=>{u(f)},[u,f]),c.jsx(De.span,{...o,ref:d,style:{pointerEvents:"none"},children:BT(l.value)?c.jsx(c.Fragment,{children:i}):s})});yT.displayName=vT;var m7="SelectIcon",xT=_.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return c.jsx(De.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});xT.displayName=m7;var p7="SelectPortal",wT=e=>c.jsx(Ju,{asChild:!0,...e});wT.displayName=p7;var mo="SelectContent",_T=_.forwardRef((e,t)=>{const r=Ei(mo,e.__scopeSelect),[n,a]=_.useState();if(gr(()=>{a(new DocumentFragment)},[]),!r.open){const s=n;return s?ko.createPortal(c.jsx(ST,{scope:e.__scopeSelect,children:c.jsx(pm.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),s):null}return c.jsx(kT,{...e,ref:t})});_T.displayName=mo;var oa=10,[ST,Ti]=tc(mo),g7="SelectContentImpl",v7=io("SelectContent.RemoveScroll"),kT=_.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:s,onPointerDownOutside:i,side:o,sideOffset:l,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:m,collisionPadding:h,sticky:g,hideWhenDetached:p,avoidCollisions:y,...v}=e,x=Ei(mo,r),[w,S]=_.useState(null),[b,E]=_.useState(null),k=Je(t,G=>S(G)),[T,N]=_.useState(null),[I,H]=_.useState(null),j=gm(r),[z,K]=_.useState(!1),q=_.useRef(!1);_.useEffect(()=>{if(w)return X1(w)},[w]),Y1();const Q=_.useCallback(G=>{const[ie,...se]=j().map(A=>A.ref.current),[ae]=se.slice(-1),J=document.activeElement;for(const A of G)if(A===J||(A==null||A.scrollIntoView({block:"nearest"}),A===ie&&b&&(b.scrollTop=0),A===ae&&b&&(b.scrollTop=b.scrollHeight),A==null||A.focus(),document.activeElement!==J))return},[j,b]),X=_.useCallback(()=>Q([T,w]),[Q,T,w]);_.useEffect(()=>{z&&X()},[z,X]);const{onOpenChange:F,triggerPointerDownPosRef:P}=x;_.useEffect(()=>{if(w){let G={x:0,y:0};const ie=ae=>{var J,A;G={x:Math.abs(Math.round(ae.pageX)-(((J=P.current)==null?void 0:J.x)??0)),y:Math.abs(Math.round(ae.pageY)-(((A=P.current)==null?void 0:A.y)??0))}},se=ae=>{G.x<=10&&G.y<=10?ae.preventDefault():w.contains(ae.target)||F(!1),document.removeEventListener("pointermove",ie),P.current=null};return P.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",se,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",se,{capture:!0})}}},[w,F,P]),_.useEffect(()=>{const G=()=>F(!1);return window.addEventListener("blur",G),window.addEventListener("resize",G),()=>{window.removeEventListener("blur",G),window.removeEventListener("resize",G)}},[F]);const[Z,le]=UT(G=>{const ie=j().filter(J=>!J.disabled),se=ie.find(J=>J.ref.current===document.activeElement),ae=$T(ie,G,se);ae&&setTimeout(()=>ae.ref.current.focus())}),D=_.useCallback((G,ie,se)=>{const ae=!q.current&&!se;(x.value!==void 0&&x.value===ie||ae)&&(N(G),ae&&(q.current=!0))},[x.value]),V=_.useCallback(()=>w==null?void 0:w.focus(),[w]),O=_.useCallback((G,ie,se)=>{const ae=!q.current&&!se;(x.value!==void 0&&x.value===ie||ae)&&H(G)},[x.value]),L=n==="popper"?fg:bT,Y=L===fg?{side:o,sideOffset:l,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:m,collisionPadding:h,sticky:g,hideWhenDetached:p,avoidCollisions:y}:{};return c.jsx(ST,{scope:r,content:w,viewport:b,onViewportChange:E,itemRefCallback:D,selectedItem:T,onItemLeave:V,itemTextRefCallback:O,focusSelectedItem:X,selectedItemText:I,position:n,isPositioned:z,searchRef:Z,children:c.jsx(am,{as:v7,allowPinchZoom:!0,children:c.jsx(rm,{asChild:!0,trapped:x.open,onMountAutoFocus:G=>{G.preventDefault()},onUnmountAutoFocus:Ne(a,G=>{var ie;(ie=x.trigger)==null||ie.focus({preventScroll:!0}),G.preventDefault()}),children:c.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:G=>G.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:c.jsx(L,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:G=>G.preventDefault(),...v,...Y,onPlaced:()=>K(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:Ne(v.onKeyDown,G=>{const ie=G.ctrlKey||G.altKey||G.metaKey;if(G.key==="Tab"&&G.preventDefault(),!ie&&G.key.length===1&&le(G.key),["ArrowUp","ArrowDown","Home","End"].includes(G.key)){let ae=j().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(G.key)&&(ae=ae.slice().reverse()),["ArrowUp","ArrowDown"].includes(G.key)){const J=G.target,A=ae.indexOf(J);ae=ae.slice(A+1)}setTimeout(()=>Q(ae)),G.preventDefault()}})})})})})})});kT.displayName=g7;var y7="SelectItemAlignedPosition",bT=_.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,s=Ei(mo,r),i=Ti(mo,r),[o,l]=_.useState(null),[u,f]=_.useState(null),d=Je(t,k=>f(k)),m=gm(r),h=_.useRef(!1),g=_.useRef(!0),{viewport:p,selectedItem:y,selectedItemText:v,focusSelectedItem:x}=i,w=_.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&u&&p&&y&&v){const k=s.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),I=v.getBoundingClientRect();if(s.dir!=="rtl"){const J=I.left-T.left,A=N.left-J,me=k.left-A,ke=k.width+me,We=Math.max(ke,T.width),Me=window.innerWidth-oa,xe=Iw(A,[oa,Math.max(oa,Me-We)]);o.style.minWidth=ke+"px",o.style.left=xe+"px"}else{const J=T.right-I.right,A=window.innerWidth-N.right-J,me=window.innerWidth-k.right-A,ke=k.width+me,We=Math.max(ke,T.width),Me=window.innerWidth-oa,xe=Iw(A,[oa,Math.max(oa,Me-We)]);o.style.minWidth=ke+"px",o.style.right=xe+"px"}const H=m(),j=window.innerHeight-oa*2,z=p.scrollHeight,K=window.getComputedStyle(u),q=parseInt(K.borderTopWidth,10),Q=parseInt(K.paddingTop,10),X=parseInt(K.borderBottomWidth,10),F=parseInt(K.paddingBottom,10),P=q+Q+z+F+X,Z=Math.min(y.offsetHeight*5,P),le=window.getComputedStyle(p),D=parseInt(le.paddingTop,10),V=parseInt(le.paddingBottom,10),O=k.top+k.height/2-oa,L=j-O,Y=y.offsetHeight/2,G=y.offsetTop+Y,ie=q+Q+G,se=P-ie;if(ie<=O){const J=H.length>0&&y===H[H.length-1].ref.current;o.style.bottom="0px";const A=u.clientHeight-p.offsetTop-p.offsetHeight,me=Math.max(L,Y+(J?V:0)+A+X),ke=ie+me;o.style.height=ke+"px"}else{const J=H.length>0&&y===H[0].ref.current;o.style.top="0px";const me=Math.max(O,q+p.offsetTop+(J?D:0)+Y)+se;o.style.height=me+"px",p.scrollTop=ie-O+p.offsetTop}o.style.margin=`${oa}px 0`,o.style.minHeight=Z+"px",o.style.maxHeight=j+"px",n==null||n(),requestAnimationFrame(()=>h.current=!0)}},[m,s.trigger,s.valueNode,o,u,p,y,v,s.dir,n]);gr(()=>w(),[w]);const[S,b]=_.useState();gr(()=>{u&&b(window.getComputedStyle(u).zIndex)},[u]);const E=_.useCallback(k=>{k&&g.current===!0&&(w(),x==null||x(),g.current=!1)},[w,x]);return c.jsx(w7,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:h,onScrollButtonChange:E,children:c.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:c.jsx(De.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});bT.displayName=y7;var x7="SelectPopperPosition",fg=_.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=oa,...s}=e,i=vm(r);return c.jsx($1,{...i,...s,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fg.displayName=x7;var[w7,Nv]=tc(mo,{}),dg="SelectViewport",ET=_.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,s=Ti(dg,r),i=Nv(dg,r),o=Je(t,s.onViewportChange),l=_.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),c.jsx(pm.Slot,{scope:r,children:c.jsx(De.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Ne(a.onScroll,u=>{const f=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:m}=i;if(m!=null&&m.current&&d){const h=Math.abs(l.current-f.scrollTop);if(h>0){const g=window.innerHeight-oa*2,p=parseFloat(d.style.minHeight),y=parseFloat(d.style.height),v=Math.max(p,y);if(v<g){const x=v+h,w=Math.min(g,x),S=x-w;d.style.height=w+"px",d.style.bottom==="0px"&&(f.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=f.scrollTop})})})]})});ET.displayName=dg;var TT="SelectGroup",[_7,S7]=tc(TT),k7=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Xa();return c.jsx(_7,{scope:r,id:a,children:c.jsx(De.div,{role:"group","aria-labelledby":a,...n,ref:t})})});k7.displayName=TT;var NT="SelectLabel",CT=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=S7(NT,r);return c.jsx(De.div,{id:a.id,...n,ref:t})});CT.displayName=NT;var lh="SelectItem",[b7,AT]=tc(lh),PT=_.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:s,...i}=e,o=Ei(lh,r),l=Ti(lh,r),u=o.value===n,[f,d]=_.useState(s??""),[m,h]=_.useState(!1),g=Je(t,x=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,x,n,a)}),p=Xa(),y=_.useRef("touch"),v=()=>{a||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(b7,{scope:r,value:n,disabled:a,textId:p,isSelected:u,onItemTextChange:_.useCallback(x=>{d(w=>w||((x==null?void 0:x.textContent)??"").trim())},[]),children:c.jsx(pm.ItemSlot,{scope:r,value:n,disabled:a,textValue:f,children:c.jsx(De.div,{role:"option","aria-labelledby":p,"data-highlighted":m?"":void 0,"aria-selected":u&&m,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:g,onFocus:Ne(i.onFocus,()=>h(!0)),onBlur:Ne(i.onBlur,()=>h(!1)),onClick:Ne(i.onClick,()=>{y.current!=="mouse"&&v()}),onPointerUp:Ne(i.onPointerUp,()=>{y.current==="mouse"&&v()}),onPointerDown:Ne(i.onPointerDown,x=>{y.current=x.pointerType}),onPointerMove:Ne(i.onPointerMove,x=>{var w;y.current=x.pointerType,a?(w=l.onItemLeave)==null||w.call(l):y.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ne(i.onPointerLeave,x=>{var w;x.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:Ne(i.onKeyDown,x=>{var S;((S=l.searchRef)==null?void 0:S.current)!==""&&x.key===" "||(c7.includes(x.key)&&v(),x.key===" "&&x.preventDefault())})})})})});PT.displayName=lh;var jc="SelectItemText",DT=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...s}=e,i=Ei(jc,r),o=Ti(jc,r),l=AT(jc,r),u=h7(jc,r),[f,d]=_.useState(null),m=Je(t,v=>d(v),l.onItemTextChange,v=>{var x;return(x=o.itemTextRefCallback)==null?void 0:x.call(o,v,l.value,l.disabled)}),h=f==null?void 0:f.textContent,g=_.useMemo(()=>c.jsx("option",{value:l.value,disabled:l.disabled,children:h},l.value),[l.disabled,l.value,h]),{onNativeOptionAdd:p,onNativeOptionRemove:y}=u;return gr(()=>(p(g),()=>y(g)),[p,y,g]),c.jsxs(c.Fragment,{children:[c.jsx(De.span,{id:l.textId,...s,ref:m}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?ko.createPortal(s.children,i.valueNode):null]})});DT.displayName=jc;var jT="SelectItemIndicator",RT=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return AT(jT,r).isSelected?c.jsx(De.span,{"aria-hidden":!0,...n,ref:t}):null});RT.displayName=jT;var hg="SelectScrollUpButton",MT=_.forwardRef((e,t)=>{const r=Ti(hg,e.__scopeSelect),n=Nv(hg,e.__scopeSelect),[a,s]=_.useState(!1),i=Je(t,n.onScrollButtonChange);return gr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollTop>0;s(u)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?c.jsx(OT,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});MT.displayName=hg;var mg="SelectScrollDownButton",IT=_.forwardRef((e,t)=>{const r=Ti(mg,e.__scopeSelect),n=Nv(mg,e.__scopeSelect),[a,s]=_.useState(!1),i=Je(t,n.onScrollButtonChange);return gr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollHeight-l.clientHeight,f=Math.ceil(l.scrollTop)<u;s(f)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?c.jsx(OT,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});IT.displayName=mg;var OT=_.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,s=Ti("SelectScrollButton",r),i=_.useRef(null),o=gm(r),l=_.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return _.useEffect(()=>()=>l(),[l]),gr(()=>{var f;const u=o().find(d=>d.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[o]),c.jsx(De.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Ne(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:Ne(a.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:Ne(a.onPointerLeave,()=>{l()})})}),E7="SelectSeparator",FT=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return c.jsx(De.div,{"aria-hidden":!0,...n,ref:t})});FT.displayName=E7;var pg="SelectArrow",T7=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=vm(r),s=Ei(pg,r),i=Ti(pg,r);return s.open&&i.position==="popper"?c.jsx(W1,{...a,...n,ref:t}):null});T7.displayName=pg;var N7="SelectBubbleInput",LT=_.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=_.useRef(null),s=Je(n,a),i=J1(t);return _.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&f){const d=new Event("change",{bubbles:!0});f.call(o,t),o.dispatchEvent(d)}},[i,t]),c.jsx(De.select,{...r,style:{...Sk,...r.style},ref:s,defaultValue:t})});LT.displayName=N7;function BT(e){return e===""||e===void 0}function UT(e){const t=Jn(e),r=_.useRef(""),n=_.useRef(0),a=_.useCallback(i=>{const o=r.current+i;t(o),function l(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=_.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,s]}function $T(e,t,r){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=C7(e,Math.max(s,0));a.length===1&&(i=i.filter(u=>u!==r));const l=i.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}function C7(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var A7=mT,WT=gT,P7=yT,D7=xT,j7=wT,HT=_T,R7=ET,VT=CT,zT=PT,M7=DT,I7=RT,GT=MT,YT=IT,XT=FT;const Zn=A7,ea=P7,An=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(WT,{ref:n,className:Ce("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,c.jsx(D7,{asChild:!0,children:c.jsx(bo,{className:"h-4 w-4 opacity-50"})})]}));An.displayName=WT.displayName;const KT=_.forwardRef(({className:e,...t},r)=>c.jsx(GT,{ref:r,className:Ce("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(Wh,{className:"h-4 w-4"})}));KT.displayName=GT.displayName;const qT=_.forwardRef(({className:e,...t},r)=>c.jsx(YT,{ref:r,className:Ce("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(bo,{className:"h-4 w-4"})}));qT.displayName=YT.displayName;const Pn=_.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>c.jsx(j7,{children:c.jsxs(HT,{ref:a,className:Ce("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[c.jsx(KT,{}),c.jsx(R7,{className:Ce("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),c.jsx(qT,{})]})}));Pn.displayName=HT.displayName;const O7=_.forwardRef(({className:e,...t},r)=>c.jsx(VT,{ref:r,className:Ce("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));O7.displayName=VT.displayName;const Tt=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(zT,{ref:n,className:Ce("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(I7,{children:c.jsx(zk,{className:"h-4 w-4"})})}),c.jsx(M7,{children:t})]}));Tt.displayName=zT.displayName;const F7=_.forwardRef(({className:e,...t},r)=>c.jsx(XT,{ref:r,className:Ce("-mx-1 my-1 h-px bg-muted",e),...t}));F7.displayName=XT.displayName;const Dp=[{value:"3",display:"Not Called",color:"text-gray-600"},{value:"2",display:"Not Answered",color:"text-red-600"},{value:"1",display:"Answered",color:"text-green-600"}],L7=({currentStatus:e,onStatusChange:t,disabled:r})=>{console.log("🔄 CallStatusSelector: Rendering with currentStatus:",e);const n=i=>{if(!i)return"3";if(["1","2","3"].includes(i))return i;const l={answered:"1","not answered":"2","not called":"3"}[i.toLowerCase()]||"3";return console.log("🔄 CallStatusSelector: Converting status:",i,"to display value:",l),l},a=Dp.find(i=>i.value===n(e))||Dp[0],s=i=>{console.log("🔄 CallStatusSelector: Status changed from",e,"to",i),console.log("🔄 CallStatusSelector: Calling onStatusChange with value:",i),t(i)};return c.jsxs(Zn,{value:n(e),onValueChange:s,disabled:r,children:[c.jsx(An,{className:`w-40 h-8 text-xs ${a.color}`,children:c.jsx(ea,{})}),c.jsx(Pn,{children:Dp.map(i=>c.jsx(Tt,{value:i.value,className:`text-xs ${i.color}`,children:i.display},i.value))})]})},B7=({title:e,name:t,mobile:r,email:n,currentStatus:a,onStatusChange:s,showCallingStatus:i=!1})=>(console.log(`🔄 ContactCard (${e}): Rendering with currentStatus:`,a),c.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow-sm hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(oo,{className:"h-4 w-4 text-blue-600"}),c.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:e})]}),c.jsx("p",{className:"text-sm font-medium text-gray-800 break-words mb-2",children:t}),c.jsxs("div",{className:"space-y-1",children:[r&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx(Hh,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"break-all",children:r})]}),n&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx(a6,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"break-all",children:n})]})]})]}),r&&c.jsx(qE,{name:"Call",phone:r,variant:"outline",size:"sm",className:"flex-shrink-0"})]}),i&&c.jsxs("div",{className:"flex items-center gap-2 flex-wrap pt-2 border-t border-gray-100",children:[c.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Calling Status:"}),c.jsx(L7,{currentStatus:a,onStatusChange:s})]})]}));class U7{static async getApplicationContacts(t){const r=await fetch(`${Rt}/contacts/${t}`,{headers:dr()});if(!r.ok)throw new Error(`Failed to fetch contacts: ${r.status}`);return await r.json()}static async getApplicantContact(t){return(await this.getApplicationContacts(t)).applicant}static async getCoApplicants(t){return(await this.getApplicationContacts(t)).co_applicants}static async getGuarantors(t){return(await this.getApplicationContacts(t)).guarantors}static async getReferences(t){return(await this.getApplicationContacts(t)).references}static async getContactsByType(t,r){const n=await this.getApplicationContacts(t);switch(r.toLowerCase()){case"applicant":return[n.applicant];case"co_applicant":case"co-applicant":return n.co_applicants;case"guarantor":return n.guarantors;case"reference":return n.references;default:throw new Error(`Invalid contact type: ${r}`)}}}const $7=e=>{const[t,r]=_.useState(null),[n,a]=_.useState(!1),[s,i]=_.useState(null),o=_.useCallback(async()=>{if(e){a(!0),i(null);try{console.log("🔄 Fetching contacts for application:",e);const u=await U7.getApplicationContacts(e);console.log("✅ Contacts loaded:",u),r(u)}catch(u){console.error("❌ Error fetching contacts:",u),i(u instanceof Error?u.message:"Failed to fetch contacts")}finally{a(!1)}}},[e]);_.useEffect(()=>{o()},[o]);const l=_.useCallback(()=>{o()},[o]);return{contacts:t,loading:n,error:s,refreshContacts:l}},W7=({fiLocation:e})=>{const r=(s=>{if(!s||s.trim()==="")return null;const o=s.replace(/^FI_PENDING_/i,"").match(/(-?\d+\.?\d*)[,\s]+(-?\d+\.?\d*)/);if(o){const l=parseFloat(o[1]),u=parseFloat(o[2]);if(!isNaN(l)&&!isNaN(u)&&l>=-90&&l<=90&&u>=-180&&u<=180)return{lat:l,lng:u}}return null})(e);if(!r)return null;const n=(s,i)=>`${s.toFixed(6)}, ${i.toFixed(6)}`,a=()=>{const s=`https://www.google.com/maps?q=${r.lat},${r.lng}`;window.open(s,"_blank")};return c.jsxs(Qe,{className:"mb-4",children:[c.jsx(_t,{className:"pb-3",children:c.jsxs(St,{className:"text-sm flex items-center gap-2",children:[c.jsx(Qk,{className:"h-4 w-4 text-blue-600"}),"Field Investigation Location"]})}),c.jsx(at,{className:"pt-0",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Coordinates"}),c.jsx("p",{className:"text-xs text-gray-600 font-mono",children:n(r.lat,r.lng)})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-1",children:[c.jsx(e6,{className:"h-3 w-3"}),"View on Map"]})]})})})]})},H7=e=>({"No response":0,"Customer funded the account":1,"Customer will fund the account on a future date":2,"Cash collected":3,"Cash will be collected on a future date":4,"Spoken – no commitment":5,"Refused / unable to fund":6})[e]??0,V7=e=>isNaN(Number(e))?{answered:1,"not answered":2,"not called":3}[e.toLowerCase()]??3:parseInt(e,10),z7=e=>isNaN(Number(e))?{applicant:1,co_applicant:2,guarantor:3,reference:4}[e.toLowerCase()]??1:parseInt(e,10),G7=e=>({Unpaid:0,"Partially Paid":1,"Cash Collected from Customer":2,"Customer Deposited to Bank":3,Paid:4,"Paid (Pending Approval)":5})[e]??0;class Cv{static async updateApplicationStatus(t,r){const n={loan_id:t,...r};console.log("🚀 Final API Request Body:",n),console.log("🌐 API Endpoint:",`${Rt}/status-management/${t}`);const a=await fetch(`${Rt}/status-management/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",...dr()},body:JSON.stringify(n)});if(!a.ok){const i=await a.json().catch(()=>({}));throw console.error("❌ Status update failed:",a.status,i),new Error(`Failed to update status: ${a.status} - ${JSON.stringify(i)}`)}const s=await a.json();return console.log("📥 Backend response:",s),typeof s=="string"?{success:!0,message:s,loan_id:parseInt(t,10),updated_fields:[],new_status:{}}:s&&typeof s=="object"&&"success"in s?s:a.ok?{success:!0,message:(s==null?void 0:s.message)||"Status updated successfully",loan_id:parseInt(t,10),updated_fields:(s==null?void 0:s.updated_fields)||[],new_status:(s==null?void 0:s.new_status)||{}}:{success:!0,message:"Status updated successfully",loan_id:parseInt(t,10),updated_fields:[],new_status:{}}}static async getApplicationStatus(t,r){const n=new URLSearchParams({demand_date:r}),a=await fetch(`${Rt}/status-management/${t}?${n.toString()}`,{headers:dr()});if(!a.ok)throw new Error(`Failed to get application status: ${a.status}`);return await a.json()}static async updateDemandCallingStatus(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,demand_calling_status:H7(r),contact_calling_status:0,contact_type:1})}static async updateContactCallingStatus(t,r,n,a,s){const i={calling_type:1,contact_calling_status:V7(n),contact_type:z7(r)};return s&&(i.repayment_id=s),a&&(i.demand_date=a),console.log("📤 Contact Calling Status Update Payload:",{loan_id:t,...i}),await this.updateApplicationStatus(t,i)}static async updateRepaymentStatus(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,repayment_status:G7(r),contact_calling_status:0,contact_type:1})}static async updatePTPDate(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,ptp_date:r,contact_calling_status:0,contact_type:1})}static async updateAmountCollected(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,amount_collected:r,contact_calling_status:0,contact_type:1})}static async updateMultipleStatusFields(t,r,n=""){const a={repayment_id:n,calling_type:2,contact_calling_status:0,contact_type:1,...r};return await this.updateApplicationStatus(t,a)}}const Y7=[{value:"1",label:"Deposited in Bank"},{value:"2",label:"Cash Collected"},{value:"3",label:"PTP Taken"},{value:"4",label:"No Response"}],X7=e=>({1:1,2:2,3:3,4:4})[e]||4,Ow=e=>{if(!e)return"";const t=e.toLowerCase().trim();return{"deposited in bank":"1","cash collected":"2","ptp taken":"3","no response":"4",no_response:"4",noresponse:"4",deposited_in_bank:"1",cash_collected:"2",ptp_taken:"3"}[t]||""},K7=({application:e,callingLogs:t,onCallingStatusChange:r,selectedMonth:n,onReloadApplication:a})=>{const[s,i]=_.useState(!1),[o,l]=_.useState(""),{notifyPreEmiStatusUpdate:u,notifyContactStatusUpdate:f}=tm(),d=_.useRef(!1),m=e.loan_id?e.loan_id.toString():e.applicant_id,{contacts:h,loading:g,error:p,refreshContacts:y}=$7(m),v=_.useRef({}),[x,w]=_.useState(()=>{const T=N=>N?["1","2","3"].includes(N.toString())?N.toString():{answered:"1","not answered":"2","not called":"3"}[N.toString().toLowerCase()]||"3":"3";return e.calling_statuses?{applicant:T(e.calling_statuses.applicant),co_applicant:T(e.calling_statuses.co_applicant),guarantor:T(e.calling_statuses.guarantor),reference:T(e.calling_statuses.reference)}:{applicant:"3",co_applicant:"3",guarantor:"3",reference:"3"}});_.useEffect(()=>{if(e.calling_statuses){const T=`${n}-${e.payment_id}`,N=Object.values(x).some(H=>H!=="3"&&H!=="1"&&H!=="2"),I=Object.values(e.calling_statuses).some(H=>H&&H!=="3");if(N&&!I){console.log("🔄 ContactsTab: Preserving local status changes during month change");return}if(I)console.log("🔄 ContactsTab: Updating local statuses from application data:",e.calling_statuses),w(e.calling_statuses),v.current[T]={...e.calling_statuses};else{const H=v.current[T];H&&N&&(console.log("🔄 ContactsTab: Restoring last known state for month:",T,H),w(H))}}},[e.calling_statuses,x,n,e.payment_id]),_.useEffect(()=>{console.log("🔄 ContactsTab: Using contact ID:",m,"for application:",e.applicant_id),console.log("🔄 ContactsTab: Application has loan_id:",e.loan_id),console.log("🔄 ContactsTab: Application calling statuses:",e.calling_statuses),console.log("🔄 ContactsTab: Local calling statuses:",x),console.log("🔄 ContactsTab: Selected month:",n),console.log("🔄 ContactsTab: Application payment_id:",e.payment_id)},[m,e.applicant_id,e.loan_id,e.calling_statuses,x,n,e.payment_id]),_.useEffect(()=>{d.current=!1},[e.applicant_id,n]),_.useEffect(()=>{const T=Ow(e.demand_calling_status);console.log("🔄 ContactsTab: Pre-EMI status useEffect triggered:",{applicationDemandCallingStatus:e.demand_calling_status,dropdownValue:T,currentPreEmiCallingStatus:o,userHasSelected:d.current}),d.current?console.log("🔄 ContactsTab: Skipping Pre-EMI status update - user has made selection"):(console.log("🔄 ContactsTab: Setting Pre-EMI status from application data:",T),l(T))},[e.demand_calling_status,n]);const S=async T=>{var N;try{if(console.log("🔄 Updating Pre-EMI Calling Status:",{from:o,to:T,loanId:e.loan_id,paymentId:e.payment_id}),d.current=!0,console.log("🔄 ContactsTab: User made selection, setting flag to true"),l(T),console.log("🔄 ContactsTab: Updated Pre-EMI status to:",T),!e.loan_id)throw new Error("Loan ID is required to update Pre-EMI Calling Status");const I=await Cv.updateApplicationStatus(e.loan_id.toString(),{repayment_id:((N=e.payment_id)==null?void 0:N.toString())||"",calling_type:2,demand_calling_status:X7(T),contact_calling_status:0,contact_type:1});console.log("✅ Pre-EMI Calling Status updated successfully:",I),Se.success("Pre-EMI Calling Status updated successfully"),u(e.applicant_id,T),a&&a()}catch(I){console.error("❌ Error updating Pre-EMI Calling Status:",I),Se.error("Failed to update Pre-EMI Calling Status");const H=Ow(e.demand_calling_status);l(H)}};t.slice(0,2);const b=()=>{var N,I,H,j,z,K;return h?[{type:"applicant",displayType:"Applicant",name:((N=h.applicant)==null?void 0:N.name)||e.applicant_name,mobile:((I=h.applicant)==null?void 0:I.phone)||e.applicant_mobile,email:(H=h.applicant)==null?void 0:H.email,callingStatus:x.applicant||"3",contactTypeId:1},...((j=h.co_applicants)==null?void 0:j.map((q,Q)=>({type:"co_applicant",displayType:`Co-Applicant ${h.co_applicants.length>1?Q+1:""}`,name:q.name,mobile:q.phone,email:q.email,callingStatus:x.co_applicant||"3",contactTypeId:2})))||[],...((z=h.guarantors)==null?void 0:z.map((q,Q)=>({type:"guarantor",displayType:`Guarantor ${h.guarantors.length>1?Q+1:""}`,name:q.name,mobile:q.phone,email:q.email,callingStatus:x.guarantor||"3",contactTypeId:3})))||[],...((K=h.references)==null?void 0:K.map((q,Q)=>({type:"reference",displayType:`Reference ${h.references.length>1?Q+1:""}`,name:q.name,mobile:q.phone,email:q.email,callingStatus:x.reference||"3",contactTypeId:4})))||[]]:[]},E=()=>[{type:"applicant",displayType:"Applicant",name:e.applicant_name,mobile:e.applicant_mobile,email:void 0,callingStatus:x.applicant||"3",contactTypeId:1},...e.co_applicant_name?[{type:"co_applicant",displayType:"Co-Applicant",name:e.co_applicant_name,mobile:e.co_applicant_mobile,email:void 0,callingStatus:x.co_applicant||"3",contactTypeId:2}]:[],...e.guarantor_name?[{type:"guarantor",displayType:"Guarantor",name:e.guarantor_name,mobile:e.guarantor_mobile,email:void 0,callingStatus:x.guarantor||"3",contactTypeId:3}]:[],...e.reference_name?[{type:"reference",displayType:"Reference",name:e.reference_name,mobile:e.reference_mobile,email:void 0,callingStatus:x.reference||"3",contactTypeId:4}]:[]],k=_.useMemo(()=>{console.log("🔄 ContactsTab: Rebuilding contacts array with statuses:",x);const T=h?b():E();return console.log("🔄 ContactsTab: Built contacts array:",T.map(N=>({type:N.type,callingStatus:N.callingStatus}))),console.log("🔄 ContactsTab: Contacts array dependencies changed - apiContacts:",!!h,"localContactStatuses:",x,"selectedMonth:",n),T},[h,x,e,n]);return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Hh,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pre-EMI Calling Status"})]}),c.jsx(Qe,{children:c.jsx(at,{className:"p-4",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"preEmiCallingStatus",className:"text-sm font-medium text-gray-700",children:"Select new pre-EMI Calling Status"}),c.jsxs(Zn,{value:o||"",onValueChange:S,children:[c.jsx(An,{className:"mt-1",children:c.jsx(ea,{placeholder:"Select pre-EMI calling status..."})}),c.jsx(Pn,{children:Y7.map(T=>c.jsx(Tt,{value:T.value,children:T.label},T.value))})]})]})})}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(wu,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Application Contacts"})]})}),p&&c.jsx(Qe,{className:"border-red-200 bg-red-50",children:c.jsx(at,{className:"pt-4",children:c.jsxs("div",{className:"text-sm text-red-600",children:[c.jsx("p",{className:"font-medium",children:"Error loading contacts:"}),c.jsx("p",{children:p}),c.jsx(Te,{variant:"outline",size:"sm",onClick:y,className:"mt-2",children:"Retry"})]})})}),g&&c.jsx(Qe,{children:c.jsx(at,{className:"pt-4",children:c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(z0,{className:"h-4 w-4 animate-spin"}),"Loading contacts..."]})})}),!g&&!p&&c.jsx("div",{className:"space-y-4",children:k.map((T,N)=>c.jsx(B7,{title:T.displayType,name:T.name,mobile:T.mobile,email:T.email,currentStatus:T.callingStatus,onStatusChange:()=>{},contactTypeId:T.contactTypeId,showCallingStatus:!1},`${T.type}-${T.callingStatus}-${n}`))}),c.jsx(W7,{fiLocation:e.fi_location})]})},q7=e=>_.useMemo(()=>{console.log("=== FILTERING AUDIT LOGS ==="),console.log("Total audit logs received:",e.length);const t=e.filter(r=>{const n=r.field==="Status",a=r.field==="PTP Date",s=r.field==="Amount Collected",i=r.field==="Calling Status";return console.log(`Log ${r.id}: field="${r.field}" -> include=${n||a||s||i}`),n||a||s||i});return console.log("Filtered status-related logs:",t.length),console.log("Status-related logs:",t.map(r=>({id:r.id,field:r.field,previous:r.previous_value,new:r.new_value,created_at:r.created_at}))),t},[e]),QT=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1),n=_.useCallback(async(s,i)=>{if(s.length===0)return{};if(console.log("🔍 fetchFieldStatus called with:",{applicationIdsCount:s.length,selectedMonth:i,sampleIds:s.slice(0,3)}),i){const{start:o,end:l}=gi(i);console.log("🔍 Fetching field status for month range:",o,"to",l);const{data:u,error:f}=await Pe.from("field_status").select("*").in("application_id",s).gte("demand_date",o).lte("demand_date",l).order("created_at",{ascending:!1});if(f)return console.error("❌ Error fetching field status:",f),{};console.log("📋 Raw field status data:",(u==null?void 0:u.length)||0,"records"),console.log("📋 Sample field status records:",u==null?void 0:u.slice(0,3));const d={},m=new Set;return u==null||u.forEach(h=>{m.has(h.application_id)||(d[h.application_id]=h.status,m.add(h.application_id))}),console.log(`✅ Fetched field status for ${Object.keys(d).length} applications (month: ${i})`),console.log("📊 Status distribution from field_status table:",Object.values(d).reduce((h,g)=>(h[g]=(h[g]||0)+1,h),{})),d}else{console.log("🔍 Fetching latest field status for all applications (analytics mode)");const{data:o,error:l}=await Pe.from("field_status").select("*").in("application_id",s).order("created_at",{ascending:!1});if(l)return console.error("❌ Error fetching field status:",l),{};console.log("📋 Raw field status data (analytics mode):",(o==null?void 0:o.length)||0,"records");const u={},f=new Set;return o==null||o.forEach(d=>{f.has(d.application_id)||(u[d.application_id]=d.status,f.add(d.application_id))}),console.log(`✅ Fetched latest field status for ${Object.keys(u).length} applications (analytics mode)`),console.log("📊 Status distribution from field_status table (analytics):",Object.values(u).reduce((d,m)=>(d[m]=(d[m]||0)+1,d),{})),u}},[]),a=_.useCallback(async(s,i,o)=>{if(!e||!o)return null;r(!0);try{const l=o.match(/^\d{4}-\d{2}$/)?`${o}-05`:o;console.log("Updating field status:",{applicationId:s,newStatus:i,emiDate:l});const u={application_id:s,status:i,demand_date:l,user_id:e.id,user_email:e.email,updated_at:new Date().toISOString()},{data:f,error:d}=await Pe.from("field_status").upsert(u,{onConflict:"application_id,demand_date",ignoreDuplicates:!1}).select().single();if(d)throw console.error("Error updating field status:",d),d;return f}catch(l){throw console.error("Error updating field status:",l),l}finally{r(!1)}},[e]);return{fetchFieldStatus:n,updateFieldStatus:a,loading:t}},Q7=({activities:e,loading:t,error:r,onRefresh:n,title:a="Recent Activity",showHeader:s=!0,maxItems:i=10})=>{const o=m=>{try{const h=new Date(m);return`${Ft(h,"dd-MMM-yy")} at ${Ft(h,"HH:mm")}`}catch{return m}},l=(m,h)=>{if(!m)return"None";switch(h){case"Amount Collected":const g=parseFloat(m);return isNaN(g)?m:`₹${g.toLocaleString("en-IN")}`;case"PTP Date":try{const p=new Date(m);if(!isNaN(p.getTime()))return Ft(p,"dd-MMM-yyyy")}catch{}return m;default:return m}},u=m=>{switch(m){case"Status":return"🔄";case"Calling Status":return"📞";case"PTP Date":return"📅";case"Amount Collected":return"💰";default:return"📝"}},f=m=>{switch(m){case"Status":return"text-blue-600";case"Calling Status":return"text-green-600";case"PTP Date":return"text-orange-600";case"Amount Collected":return"text-purple-600";default:return"text-gray-600"}},d=e.slice(0,i);return c.jsxs(Qe,{children:[s&&c.jsx(_t,{className:"pb-3",children:c.jsxs(St,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(GP,{className:"h-4 w-4"}),a]}),c.jsx(Te,{variant:"outline",size:"sm",onClick:n,disabled:t,className:"text-xs h-7",children:c.jsx(z0,{className:`h-3 w-3 ${t?"animate-spin":""}`})})]})}),c.jsxs(at,{className:"pt-0",children:[t&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 py-3",children:[c.jsx(z0,{className:"h-4 w-4 animate-spin"}),"Loading recent activity..."]}),r&&c.jsxs("div",{className:"text-sm text-red-600 py-3",children:[c.jsx("p",{className:"font-medium",children:"Error loading activity:"}),c.jsx("p",{children:r}),c.jsx(Te,{variant:"outline",size:"sm",onClick:n,className:"mt-2",children:"Retry"})]}),!t&&!r&&d.length===0&&c.jsx("div",{className:"text-sm text-gray-500 text-center py-3",children:"No recent activity recorded yet"}),!t&&!r&&d.length>0&&c.jsx("div",{className:"space-y-2",children:d.map((m,h)=>c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg text-sm hover:bg-gray-100 transition-colors",children:[c.jsx("div",{className:"text-lg flex-shrink-0 mt-0.5",children:u(m.activity_type)}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:`font-medium ${f(m.activity_type)}`,children:m.activity_type}),c.jsx("span",{className:"text-gray-400",children:"•"}),c.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[c.jsx(oo,{className:"h-3 w-3"}),m.changed_by]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 mb-1",children:[c.jsx("span",{className:"text-red-600 font-medium",children:l(m.from_value,m.activity_type)}),c.jsx(YP,{className:"h-3 w-3 text-gray-400"}),c.jsx("span",{className:"text-green-600 font-medium",children:l(m.to_value,m.activity_type)})]}),c.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[c.jsx(Yc,{className:"h-3 w-3"}),o(m.timestamp)]})]})]},`${m.id}-${m.timestamp}-${h}`))})]})]})};class J7{static async getRecentActivity(t={}){const r=new URLSearchParams;t.loan_id&&r.append("loan_id",t.loan_id.toString()),t.repayment_id&&r.append("repayment_id",t.repayment_id.toString()),t.limit&&r.append("limit",t.limit.toString()),t.days_back&&r.append("days_back",t.days_back.toString());const n=`${Rt}/recent-activity/?${r.toString()}`,a=await fetch(n,{method:"GET",headers:dr()});if(!a.ok){const i=await a.json().catch(()=>({}));throw console.error("❌ Failed to fetch recent activity:",a.status,i),new Error(`Failed to fetch recent activity: ${a.status} - ${JSON.stringify(i)}`)}const s=await a.json();return console.log("📥 Recent activity response:",s),s}static async getLoanRecentActivity(t,r={}){var o;const n=new URLSearchParams;n.append("loan_id",t.toString()),r.repayment_id&&n.append("repayment_id",r.repayment_id.toString()),r.limit&&n.append("limit",r.limit.toString()),r.days_back&&n.append("days_back",r.days_back.toString());const a=`${Rt}/recent-activity/?${n.toString()}`;console.log("🌐 RecentActivityService: Making API call to:",a),console.log("🌐 RecentActivityService: Query parameters:",Object.fromEntries(n.entries()));const s=await fetch(a,{method:"GET",headers:dr()});if(!s.ok){const l=await s.json().catch(()=>({}));throw console.error("❌ RecentActivityService: Failed to fetch loan recent activity:",s.status,l),new Error(`Failed to fetch loan recent activity: ${s.status} - ${JSON.stringify(l)}`)}const i=await s.json();return console.log("📥 RecentActivityService: Loan recent activity response:",i),console.log("📥 RecentActivityService: Activities count:",((o=i.activities)==null?void 0:o.length)||0),i}}const Z7=(e,t={})=>{const[r,n]=_.useState([]),[a,s]=_.useState(!1),[i,o]=_.useState(null),[l,u]=_.useState(0),f=_.useCallback(async()=>{var m;if(!e){console.log("🔄 useLoanRecentActivity: No loan ID, clearing activities"),n([]),u(0);return}try{s(!0),o(null),console.log("🔄 useLoanRecentActivity: Fetching loan recent activity for loan ID:",e,"with params:",t),console.log("🔄 useLoanRecentActivity: Repayment ID:",t.repayment_id);const h=await J7.getLoanRecentActivity(e,t);console.log("📥 useLoanRecentActivity: Loan recent activity data received:",h),console.log("📥 useLoanRecentActivity: Activities count:",((m=h.activities)==null?void 0:m.length)||0),n(h.activities||[]),u(h.total_count||0)}catch(h){console.error("❌ useLoanRecentActivity: Error fetching loan recent activity:",h),o(h instanceof Error?h.message:"Failed to fetch loan recent activity"),n([]),u(0)}finally{s(!1)}},[e,t.repayment_id,t.limit,t.days_back]),d=_.useCallback(async()=>{await f()},[f]);return _.useEffect(()=>{f()},[f]),{activities:r,loading:a,error:i,totalCount:l,refreshActivities:d}},Qf=[{value:"1",label:"Future",disabled:!0},{value:"4",label:"Overdue"},{value:"2",label:"Partially Paid"},{value:"5",label:"Foreclose"},{value:"6",label:"Paid (Pending Approval)"},{value:"3",label:"Paid"},{value:"7",label:"Paid Rejected"}],jp=e=>{if(!e)return"";const t=e.toLowerCase().trim();return{future:"1",overdue:"4","partially paid":"2",foreclose:"5","paid (pending approval)":"6",paid:"3","paid rejected":"7",1:"1",4:"4",2:"2",5:"5",6:"6",3:"3",7:"7"}[t]||""},e9=({application:e,auditLogs:t,onStatusChange:r,onPtpDateChange:n,addAuditLog:a,selectedMonth:s,refetchStatusCounts:i,monthlyData:o})=>{var X;console.log("🔍 StatusTab: Application data received:",{applicant_id:e.applicant_id,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date,amount_collected:e.amount_collected});const[l,u]=_.useState(""),[f,d]=_.useState(!1),{user:m}=Bt(),[h,g]=_.useState(((X=e.amount_collected)==null?void 0:X.toString())??"");QT();const[p,y]=_.useState("Not Set"),{notifyStatusUpdate:v,notifyPtpDateUpdate:x,notifyAmountCollectedUpdate:w}=tm(),[S,b]=_.useState({repaymentStatus:"",ptpDate:"",amountCollected:""}),[E,k]=_.useState(!1),T=_.useMemo(()=>p==="3"||p==="Paid"||p==="7"||p==="Paid Rejected",[p]);_.useEffect(()=>{if(console.log("🔄 StatusTab: Setting form data based on current status:",p),p&&p!=="Not Set"){const F=jp(p);console.log("🔄 StatusTab: Mapped status to dropdown value:",{currentStatus:p,mappedValue:F}),b(P=>({...P,repaymentStatus:F}))}},[p]);const N=_.useMemo(()=>(console.log("🔄 StatusTab: Updating recent activity params with repayment_id:",e.payment_id),{repayment_id:e.payment_id||void 0,limit:50,days_back:30}),[e.payment_id]),{activities:I,loading:H,error:j,refreshActivities:z}=Z7(e.loan_id||null,N);_.useEffect(()=>{if(console.log("📅 StatusTab: Synchronizing PTP date for month:",s),console.log("Application PTP date:",e.ptp_date),console.log("Type of PTP date:",typeof e.ptp_date),e.ptp_date)try{let F="";if(typeof e.ptp_date=="string"){let P;if(e.ptp_date.includes("T")||e.ptp_date.includes("Z"))P=new Date(e.ptp_date);else if(e.ptp_date.match(/^\d{4}-\d{2}-\d{2}$/))P=new Date(e.ptp_date+"T00:00:00.000Z");else if(e.ptp_date.match(/^\d{2}-\d{2}-\d{2}$/)){const[Z,le,D]=e.ptp_date.split("-"),V=parseInt(Z)<50?2e3+parseInt(Z):1900+parseInt(Z);P=new Date(Date.UTC(V,parseInt(le)-1,parseInt(D))),console.log("🔄 Parsing YY-MM-DD format:",{original:e.ptp_date,year:V,month:le,day:D,parsed:P})}else P=new Date(e.ptp_date);isNaN(P.getTime())?console.warn("⚠️ Could not parse date:",e.ptp_date):(F=P.toISOString().split("T")[0],console.log("✅ Parsed date for input:",F))}}catch(F){console.error("❌ Error parsing PTP date:",F)}},[e.ptp_date,s]),_.useEffect(()=>{console.log("🚀 StatusTab: Component mounted, synchronizing form data with API:",{amount_collected:e.amount_collected,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date});const F={};if(e.status&&e.status!=="Unknown"){const P=jp(e.status);console.log("🔄 StatusTab: Setting dropdown value from application status:",{status:e.status,dropdownValue:P}),F.repaymentStatus=P,y(e.status)}if(e.ptp_date)try{let P="";if(typeof e.ptp_date=="string"){let Z;if(e.ptp_date.includes("T")||e.ptp_date.includes("Z"))Z=new Date(e.ptp_date);else if(e.ptp_date.match(/^\d{4}-\d{2}-\d{2}$/))Z=new Date(e.ptp_date+"T00:00:00.000Z");else if(e.ptp_date.match(/^\d{2}-\d{2}-\d{2}$/)){const[le,D,V]=e.ptp_date.split("-"),O=parseInt(le)<50?2e3+parseInt(le):1900+parseInt(le);Z=new Date(Date.UTC(O,parseInt(D)-1,parseInt(V))),console.log("🔄 Parsing YY-MM-DD format:",{original:e.ptp_date,year:O,month:D,day:V,parsed:Z})}else Z=new Date(e.ptp_date);isNaN(Z.getTime())?console.warn("⚠️ Could not parse PTP date:",e.ptp_date):(P=Z.toISOString().split("T")[0],console.log("✅ Parsed PTP date for input:",P),F.ptpDate=P)}}catch(P){console.error("❌ Error parsing PTP date:",P)}if(e.amount_collected!==void 0&&e.amount_collected!==null){const P=e.amount_collected.toString();P!=="0"&&(console.log("✅ Setting amount collected from API:",P),F.amountCollected=P)}Object.keys(F).length>0&&b(P=>({...P,...F}))},[]),_.useEffect(()=>{const F={};if(e.status&&e.status!=="Unknown"){const P=jp(e.status);console.log("🔄 StatusTab: Updating dropdown value from application status change:",{status:e.status,dropdownValue:P,selectedMonth:s}),F.repaymentStatus=P,y(e.status)}if(e.ptp_date)try{let P="";if(typeof e.ptp_date=="string"){let Z;if(e.ptp_date.includes("T")||e.ptp_date.includes("Z"))Z=new Date(e.ptp_date);else if(e.ptp_date.match(/^\d{4}-\d{2}-\d{2}$/))Z=new Date(e.ptp_date+"T00:00:00.000Z");else if(e.ptp_date.match(/^\d{2}-\d{2}-\d{2}$/)){const[le,D,V]=e.ptp_date.split("-"),O=parseInt(le)<50?2e3+parseInt(le):1900+parseInt(le);Z=new Date(Date.UTC(O,parseInt(D)-1,parseInt(V))),console.log("🔄 Parsing YY-MM-DD format:",{original:e.ptp_date,year:O,month:D,day:V,parsed:Z})}else Z=new Date(e.ptp_date);isNaN(Z.getTime())||(P=Z.toISOString().split("T")[0],console.log("✅ Updating PTP date from application change:",P),F.ptpDate=P)}}catch(P){console.error("❌ Error parsing PTP date on application change:",P)}else F.ptpDate="";if(e.amount_collected!==void 0&&e.amount_collected!==null){const P=e.amount_collected.toString();P!=="0"?(console.log("✅ Updating amount collected from application change:",P),F.amountCollected=P):F.amountCollected=""}else F.amountCollected="";Object.keys(F).length>0&&b(P=>({...P,...F}))},[e.status,e.ptp_date,e.amount_collected,s]),_.useEffect(()=>{(async()=>{try{if(console.log("🔄 Fetching current status for application:",e.applicant_id),o&&o.length>0){console.log("🔍 StatusTab: Available monthlyData:",o.map(O=>({demand_date:O.demand_date,demand_month:O.demand_month,demand_year:O.demand_year,lms_status:O.lms_status,id:O.id})));const V=o.find(O=>{if(O.demand_date)return O.demand_date===s;if(O.demand_month&&O.demand_year){const Y=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][O.demand_month],G=O.demand_year.toString().slice(-2);return`${Y}-${G}`===s}return!1});if(V)if(console.log("✅ StatusTab: Found matching month data:",V),V.lms_status){console.log("✅ StatusTab: Found lms_status in monthlyData:",V.lms_status),y(V.lms_status);return}else console.log("⚠️ StatusTab: No lms_status found in monthlyData for month:",s);else console.log("⚠️ StatusTab: No month data found for selectedMonth:",s)}else console.log("⚠️ StatusTab: No monthlyData available");e.status&&e.status!=="Unknown"&&(console.log("✅ StatusTab: Using application status from API:",e.status),y(e.status)),e.demand_calling_status&&console.log("✅ StatusTab: Using demand_calling_status from API:",e.demand_calling_status);const{data:P,error:Z}=await Pe.from("field_status").select("status, calling_status").eq("application_id",e.applicant_id).order("created_at",{ascending:!1}).maybeSingle();if(Z){console.error("❌ Error fetching status:",Z);return}const le=(P==null?void 0:P.status)||"Not Set",D=(P==null?void 0:P.calling_status)||"";console.log("📋 Fetched status from field_status:",{status:le}),(!e.status||e.status==="Unknown")&&y(le),e.demand_calling_status?console.log("✅ Keeping API demand_calling_status, not overriding with database value"):console.log("⚠️ No API demand_calling_status, using database fallback:",D)}catch(P){console.error("❌ Error fetching status:",P)}})()},[e.applicant_id,s,o]),_.useEffect(()=>{if(console.log("💰 StatusTab: Initializing amount collected from API:",{apiValue:e.amount_collected,type:typeof e.amount_collected,currentFormValue:S.amountCollected}),e.amount_collected!==void 0&&e.amount_collected!==null){const F=e.amount_collected.toString();F!=="0"?(console.log("✅ StatusTab: Setting amount collected display from API:",F),g(F)):(console.log("⚠️ StatusTab: API amount is 0 or empty, setting display to empty"),g(""))}else console.log("⚠️ StatusTab: No amount collected in API, setting display to empty"),g("")},[e.amount_collected,s]),_.useEffect(()=>{console.log("🔍 StatusTab: Application data changed:",{applicant_id:e.applicant_id,amount_collected:e.amount_collected,amount_collected_type:typeof e.amount_collected,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date})},[e]),_.useEffect(()=>{console.log("💰 StatusTab: Amount collected debug:",{apiValue:e.amount_collected,apiValueType:typeof e.amount_collected,formValue:S.amountCollected,formValueType:typeof S.amountCollected,stateValue:h,stateValueType:typeof h})},[e.amount_collected,S.amountCollected,h]),_.useEffect(()=>{console.log("🔍 Selected month changed:",s)},[s]);const K=q7(t),q=(F,P)=>{console.log(`🔄 Form field change: ${F} =`,P,"Type:",typeof P),b(Z=>{const le={...Z,[F]:P};return console.log("📝 Updated form data:",le),le})};_.useEffect(()=>{var F;console.log("📊 Form data changed:",{repaymentStatus:{value:S.repaymentStatus,type:typeof S.repaymentStatus,label:((F=Qf.find(P=>P.value===S.repaymentStatus))==null?void 0:F.label)||"Not found"},ptpDate:S.ptpDate,amountCollected:S.amountCollected})},[S.repaymentStatus,S.ptpDate,S.amountCollected]),_.useEffect(()=>{console.log("🔍 Current form data:",S),console.log("🔍 Current validation state:",{user:!!m,selectedMonth:s,applicantId:e==null?void 0:e.applicant_id,hasFormData:!!(S.repaymentStatus||S.ptpDate||S.amountCollected!==void 0&&S.amountCollected!==""&&S.amountCollected!=="0")})},[S,m,s,e==null?void 0:e.applicant_id]);const Q=async()=>{var P,Z,le,D,V,O;if(console.log("🔍 Submit validation check:",{user:!!m,selectedMonth:s,applicantId:e==null?void 0:e.applicant_id,formData:S,currentFormData:S}),!m){Se.error("User not authenticated. Please log in again.");return}if(!(S.repaymentStatus||S.ptpDate||S.amountCollected!==void 0&&S.amountCollected!==""&&S.amountCollected!=="0")){Se.error("Please fill in at least one field before submitting.");return}if(T&&(S.repaymentStatus||S.ptpDate||S.amountCollected!=="")){Se.error('Cannot change any fields when current status is "Paid". All fields are locked for paid applications.');return}console.log("✅ All validation passed, proceeding with submission"),k(!0);try{console.log("🚀 Submitting status update with form data:",S);const L=((P=e.loan_id)==null?void 0:P.toString())||e.applicant_id,Y=((Z=e.payment_id)==null?void 0:Z.toString())||"";console.log("🔍 StatusTab: Using payment_id:",Y,"for month:",s,"application:",e.applicant_id);const G={repayment_id:Y,calling_type:2,repayment_status:S.repaymentStatus?parseInt(S.repaymentStatus,10):void 0,ptp_date:S.ptpDate||void 0,amount_collected:S.amountCollected?parseFloat(S.amountCollected):void 0,contact_calling_status:0,contact_type:1};Object.keys(G).forEach(se=>{G[se]===void 0&&delete G[se]}),console.log("📤 Submitting to StatusManagementService:",G);const ie=await Cv.updateApplicationStatus(L,G);if(console.log("✅ Status update successful:",ie),S.repaymentStatus){y(S.repaymentStatus),r(S.repaymentStatus);const se=_v(S.repaymentStatus);v(e.applicant_id,se)}if(S.ptpDate&&(u(S.ptpDate),n(S.ptpDate),x(e.applicant_id,S.ptpDate)),S.amountCollected!==void 0&&(g(S.amountCollected),w(e.applicant_id,parseFloat(S.amountCollected))),S.repaymentStatus&&S.repaymentStatus!==p){const se=((le=Qf.find(J=>J.value===p))==null?void 0:le.label)||p,ae=((D=Qf.find(J=>J.value===S.repaymentStatus))==null?void 0:D.label)||S.repaymentStatus;await a(e.applicant_id,"Repayment Status",se,ae,"")}S.ptpDate&&S.ptpDate!==l&&await a(e.applicant_id,"PTP Date",l||null,S.ptpDate,""),S.amountCollected!==void 0&&S.amountCollected!==(((V=e.amount_collected)==null?void 0:V.toString())||"0")&&await a(e.applicant_id,"Amount Collected",((O=e.amount_collected)==null?void 0:O.toString())||"0",S.amountCollected.toString(),""),i&&i(),Se.success("Status updated successfully!")}catch(L){console.error("❌ Failed to submit status update:",L),Se.error(`Failed to update status: ${L instanceof Error?L.message:"Unknown error"}`)}finally{k(!1)}};return _.useMemo(()=>F=>{try{const P=new Date(F);return`${Ft(P,"dd-MMM-yyyy")} at ${Ft(P,"HH:mm")}`}catch{return F}},[]),_.useMemo(()=>{if(!Array.isArray(K))return[];const F=new Set;return K.filter(Z=>{const le=`${Z.field}-${Z.created_at}-${Z.new_value}`;return F.has(le)?!1:(F.add(le),!0)}).slice(0,2)},[K]),c.jsxs("div",{className:"space-y-4",children:[c.jsxs(Qe,{children:[c.jsx(_t,{className:"pb-3",children:c.jsx(St,{className:"text-sm",children:"Status Management"})}),c.jsxs(at,{className:"pt-0",children:[T&&c.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[c.jsx(Gk,{className:"h-4 w-4"}),c.jsx("span",{className:"font-medium",children:"Status Locked"})]}),c.jsx("p",{className:"text-sm text-amber-700 mt-1",children:'This application has a "Paid" status. All fields are locked and cannot be modified.'})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Xe,{htmlFor:"status",children:"Repayment Status"}),c.jsxs(Zn,{value:S.repaymentStatus||"",onValueChange:F=>q("repaymentStatus",F),disabled:T,children:[c.jsx(An,{className:"mt-1",children:c.jsx(ea,{placeholder:"Select repayment status..."})}),c.jsx(Pn,{children:Qf.map(F=>c.jsx(Tt,{value:F.value,disabled:F.disabled,children:F.label},F.value))})]},`repayment-${S.repaymentStatus}`),T&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'Repayment status cannot be changed when current status is "Paid" or "Paid Rejected"'})]}),c.jsxs("div",{children:[c.jsx(Xe,{htmlFor:"ptpDate",children:"PTP Date"}),c.jsx(Sr,{id:"ptpDate",type:"date",value:S.ptpDate||"",onChange:F=>q("ptpDate",F.target.value),className:"mt-1",placeholder:e.ptp_date?"Select PTP date":"No PTP date set - select a date",disabled:T},`ptp-${S.ptpDate}`),!e.ptp_date&&!T&&c.jsx("div",{className:"text-xs text-gray-500",children:"No PTP date set - enter a date above"}),T&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'PTP date cannot be changed when current status is "Paid"'})]}),c.jsxs("div",{children:[c.jsx(Xe,{htmlFor:"amount-collected",children:"Amount Collected"}),c.jsx(Sr,{id:"amount-collected",type:"text",value:S.amountCollected||"",onChange:F=>q("amountCollected",F.target.value),placeholder:e.amount_collected?"Enter amount collected":"No amount collected - enter amount above",className:"mt-1",disabled:T}),!e.amount_collected&&!T&&c.jsx("div",{className:"text-xs text-gray-500",children:"No amount collected - enter amount above"}),T&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'Amount collected cannot be changed when current status is "Paid"'})]}),c.jsx("div",{className:"pt-4",children:c.jsx(Te,{onClick:Q,disabled:E||T,className:"w-full",size:"lg",children:E?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating Status..."]}):T?c.jsxs(c.Fragment,{children:[c.jsx(G0,{className:"h-4 w-4 mr-2"}),"No Changes Allowed"]}):c.jsxs(c.Fragment,{children:[c.jsx(G0,{className:"h-4 w-4 mr-2"}),"Submit Status Update"]})})})]})]})]}),e.loan_id&&c.jsx(Q7,{activities:I,loading:H,error:j,onRefresh:z,title:"Recent Activity",showHeader:!0,maxItems:50})]})},ch=_.forwardRef(({className:e,...t},r)=>c.jsx("textarea",{className:Ce("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));ch.displayName="Textarea";const t9=({comments:e,onAddComment:t,paymentId:r,applicationId:n})=>{const[a,s]=_.useState(""),{notifyCommentAdded:i}=tm(),o=f=>{try{const d=new Date(f);return`${Ft(d,"dd-MMM-yy")} at ${Ft(d,"HH:mm")}`}catch{return f}},l=async()=>{a.trim()&&(console.log("🔍 CommentsTab: Adding comment with paymentId:",r),await t(a,r),n&&i(n,{content:a.trim(),paymentId:r,timestamp:Date.now()}),s(""))},u=f=>!f||f.trim()===""||f==="Unknown User"?"Unknown User":(f.includes("@"),f);return c.jsxs(Qe,{children:[c.jsx(_t,{className:"pb-3",children:c.jsx(St,{className:"text-sm",children:"Comments"})}),c.jsx(at,{className:"pt-0",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Xe,{htmlFor:"newComment",children:"Add Comment"}),c.jsx(ch,{id:"newComment",value:a,onChange:f=>s(f.target.value),placeholder:"Add your comment here...",className:"min-h-[80px] resize-none text-sm"}),c.jsx(Te,{onClick:l,className:"mt-3 w-full",size:"sm",disabled:!a.trim(),children:"Add Comment"})]}),e.length>0&&c.jsxs("div",{className:"border-t pt-4",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-3",children:["All Comments (",e.length,"):"]}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:e.map(f=>c.jsx("div",{className:"border rounded-lg p-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(oo,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 mb-2",children:[c.jsxs("span",{className:"font-medium text-xs sm:text-sm text-blue-700 flex items-center gap-1",children:[u(f.user_name),f.user_name==="Unknown User"&&c.jsx(Gk,{className:"h-3 w-3 text-orange-500"})]}),c.jsx("span",{className:"text-xs text-gray-500",children:o(f.commented_at||f.created_at||"")})]}),c.jsx("div",{className:"text-xs sm:text-sm text-gray-800 leading-relaxed break-words",children:f.content})]})]})},f.id))})]}),e.length===0&&c.jsx("div",{className:"text-sm text-gray-400 italic text-center py-8",children:"No comments added yet"})]})})]})},Qt=({label:e,value:t})=>c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:e}),c.jsx("p",{className:"text-sm font-semibold text-gray-800 break-words",children:t||"N/A"})]}),r9=({application:e,repaymentHistory:t,auditLogs:r,onVehicleStatusChange:n,monthlyData:a,selectedMonth:s})=>{const[i,o]=_.useState(!1);if(console.log("🔍 DetailsTab: Component rendered with props:",{selectedMonth:s,hasMonthlyData:!!a,monthlyDataLength:(a==null?void 0:a.length)||0,applicationId:e==null?void 0:e.applicant_id,paymentId:e==null?void 0:e.payment_id,timestamp:new Date().toISOString()}),!e)return c.jsx("div",{children:"Loading..."});const l=_.useMemo(()=>{if(console.log("🔍 DetailsTab: Calculating month-specific data for month:",s),console.log("🔍 DetailsTab: Available monthlyData:",a),!s||!a||a.length===0)return console.log("🔍 DetailsTab: No monthlyData or selectedMonth, returning null"),null;const h=a.find(g=>{if(console.log("🔍 DetailsTab: Checking item:",g),g.demand_date){const p=g.demand_date===s;return console.log("🔍 DetailsTab: Checking demand_date:",g.demand_date,"against selectedMonth:",s,"matches:",p),p}if(g.demand_month&&g.demand_year){const y=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][g.demand_month],v=g.demand_year.toString().slice(-2),x=`${y}-${v}`,w=x===s;return console.log("🔍 DetailsTab: Checking constructed month:",x,"against selectedMonth:",s,"matches:",w),w}return!1});return console.log("🔍 DetailsTab: Found month data:",h),h},[s,a]);_.useEffect(()=>{console.log("🔍 DetailsTab: Data updated:",{selectedMonth:s,hasMonthlyData:!!a,monthlyDataLength:(a==null?void 0:a.length)||0,hasMonthSpecificData:!!l,applicationData:{emi_amount:e.emi_amount,lms_status:e.lms_status,field_status:e.field_status,ptp_date:e.ptp_date,amount_collected:e.amount_collected,demand_num:e.demand_num}})},[s,a,l,e]);const u=()=>{var h;return l?((h=l.repayment_status)==null?void 0:h.repayment_status)||l.lms_status||l.field_status||e.lms_status||e.field_status:e.lms_status||e.field_status},f=(h,g)=>l&&l[h]!==void 0&&l[h]!==null?l[h]:g&&l&&l[g]!==void 0&&l[g]!==null?l[g]:e[h];_.useMemo(()=>r?r.filter(h=>h.field==="Vehicle Status").sort((h,g)=>new Date(g.created_at).getTime()-new Date(h.created_at).getTime()):[],[r]);const d=t.sort((h,g)=>h.repayment_number-g.repayment_number).map(h=>h.delay_in_days).join(" | "),m=a==null?void 0:a.filter(h=>h.demand_date).sort((h,g)=>{const p=h.demand_date||"",y=g.demand_date||"";return p.localeCompare(y)}).map(h=>{var x;const g=h.demand_amount||0,p=((x=h.repayment_status)==null?void 0:x.repayment_status)||"Unknown",y=h.demand_date?ma(h.demand_date):"Unknown Month",v=g?parseFloat(g.toString()).toLocaleString():"0";return`${y}: ₹${v} (${p})`}).join(" → ");return c.jsxs("div",{className:"space-y-4",children:[c.jsxs(Qe,{className:"overflow-hidden",children:[c.jsx(_t,{children:c.jsx(St,{children:"Application Information"})}),c.jsx(at,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(Qt,{label:"Application ID",value:e.applicant_id}),c.jsx(Qt,{label:"Applicant Name",value:e.applicant_name}),c.jsx(Qt,{label:"EMI Month",value:s||e.emi_month}),c.jsx(Qt,{label:"Current Status",value:u()})]})})]}),c.jsxs(Qe,{className:"overflow-hidden",children:[c.jsx(_t,{children:c.jsx(St,{children:"Loan & Repayment Details"})}),c.jsx(at,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(Qt,{label:"Loan Amount",value:e.loan_amount?`₹${e.loan_amount.toLocaleString()}`:"N/A"}),c.jsx(Qt,{label:"Disbursement Date",value:e.disbursement_date}),c.jsx(Qt,{label:"EMI Amount",value:f("emi_amount","demand_amount")?`₹${parseFloat(f("emi_amount","demand_amount").toString()).toLocaleString()}`:"N/A"}),c.jsx(Qt,{label:"Repayment Number",value:f("demand_num")||"N/A"}),c.jsx(Qt,{label:"House Ownership",value:e.house_ownership}),c.jsx(Qt,{label:"Payment Mode",value:e.payment_mode}),c.jsx("div",{className:"col-span-2 md:grid-cols-3",children:c.jsx(Qt,{label:"Repayment History (Delay in Days)",value:d||"No history"})}),a&&a.length>1&&c.jsx("div",{className:"col-span-2 md:col-span-3",children:c.jsx(Qt,{label:"Monthly Progression (EMI & Status)",value:m||"No progression data"})})]})})]}),c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsx(St,{children:"Assignment & Status"})}),c.jsx(at,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(Qt,{label:"RM Name",value:e.rm_name}),c.jsx(Qt,{label:"Team Lead",value:e.team_lead}),c.jsx(Qt,{label:"Branch",value:e.branch_name}),c.jsx(Qt,{label:"Dealer",value:e.dealer_name}),c.jsx(Qt,{label:"Lender",value:e.lender_name})]})})]}),c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsx(St,{children:"PTP & Payment Information"})}),c.jsx(at,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(Qt,{label:"PTP Date",value:f("ptp_date")}),c.jsx(Qt,{label:"Amount Collected",value:f("amount_collected")?`₹${parseFloat(f("amount_collected").toString()).toLocaleString()}`:"N/A"}),c.jsx(Qt,{label:"Payment Mode",value:f("payment_mode","mode")})]})})]}),e.recent_comments&&e.recent_comments.length>0&&c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsx(St,{children:"Recent Comments"})}),c.jsx(at,{children:c.jsx("div",{className:"space-y-3",children:e.recent_comments.map((h,g)=>c.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-800",children:h.content}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",h.user_name]})]},g))})})]})]})},n9=(e,t,r,n,a,s)=>{const i=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e,m=d.lms_status,h={...e,lms_status:f};a(h);try{const{error:g}=await Pe.from("applications").update({lms_status:f}).eq("applicant_id",d.applicant_id);if(g)throw console.error("Database error updating status:",g),g;await r(d.applicant_id,"Status",m,f,oh(s)),Se.success("Status updated successfully")}catch(g){console.error("Failed to update status:",g),Se.error("Failed to update status. Reverting change."),a(d)}},[e,t,r,a,s]),o=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e,m=d.ptp_date||null,h={...e,ptp_date:f};a(h);try{const g=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,{error:p}=await Pe.from("ptp_dates").upsert({application_id:e.applicant_id,ptp_date:f,demand_date:g,user_id:t.id,user_email:t.email,updated_at:new Date().toISOString()},{onConflict:"application_id,demand_date",ignoreDuplicates:!1});if(p)throw console.error("Database error updating PTP date:",p),p;await r(d.applicant_id,"PTP Date",m||"None",f||"None",g),Se.success("PTP Date updated successfully")}catch(g){console.error("Failed to update PTP Date:",g),Se.error("Failed to update PTP Date. Reverting change."),a(d)}},[e,t,r,a,s]),l=_.useCallback(async(f,d,m)=>{var h,g;if(!(!e||!t||!s))try{console.log("=== UPDATING CALLING STATUS ==="),console.log("Application ID:",e.applicant_id),console.log("Contact Type:",f),console.log("New Status:",d),console.log("Selected Month:",s);const p=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,y={...e,[`${f}_calling_status`]:d};a(y),await n(f,m||"not called",d);const v=e.loan_id?e.loan_id.toString():e.applicant_id.toString();console.log("🔑 ApplicationHandlers: Using contact ID for API call:",v,"(loan_id available:",!!e.loan_id,")"),console.log("🔑 ApplicationHandlers: Using repayment ID for API call:",(h=e.payment_id)==null?void 0:h.toString(),"(payment_id available:",!!e.payment_id,")");const x=await Cv.updateContactCallingStatus(v,f,d,p,(g=e.payment_id)==null?void 0:g.toString());if(x.success)console.log("✅ Contact calling status updated successfully via API:",x),Se.success(`Calling status updated for ${f}`);else throw new Error(x.message||"Failed to update calling status")}catch(p){console.error("Failed to update calling status:",p),Se.error("Failed to update calling status"),a(e)}},[e,t,n,a,s]),u=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e.amount_collected||0;try{console.log("=== UPDATING AMOUNT COLLECTED ==="),console.log("Application ID:",e.applicant_id),console.log("New Amount:",f),console.log("Selected Month:",s);const m=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,h={application_id:e.applicant_id,demand_date:m,amount_collected:f,team_lead:e.team_lead,rm_name:e.rm_name,repayment:e.repayment,emi_amount:e.emi_amount,last_month_bounce:e.last_month_bounce,lms_status:e.lms_status,collection_rm:e.collection_rm,updated_at:new Date().toISOString()},{error:g}=await Pe.from("collection").upsert(h,{onConflict:"application_id,demand_date",ignoreDuplicates:!1});if(g)throw console.error("Error updating amount collected:",g),g;await r(e.applicant_id,"Amount Collected",(d==null?void 0:d.toString())||"0",(f==null?void 0:f.toString())||"0",m);const p={...e,amount_collected:f};a(p),console.log("✅ Amount collected updated successfully")}catch(m){throw console.error("Error in handleAmountCollectedChange:",m),m}},[e,t,r,a,s]);return{handleStatusChange:i,handlePtpDateChange:o,handleCallingStatusChange:l,handleAmountCollectedChange:u}},a9=e=>{const[t,r]=_.useState([]),[n,a]=_.useState(!1);return _.useEffect(()=>{(async()=>{if(!e){r([]);return}a(!0);try{const{data:i,error:o}=await Pe.from("repayment_history").select("*").eq("application_id",e).order("repayment_number",{ascending:!0});if(o)throw o;r(i||[])}catch(i){console.error("Error fetching repayment history:",i),r([])}finally{a(!1)}})()},[e]),{repaymentHistory:t,loading:n}},s9=e=>{const[t,r]=_.useState([]),[n,a]=_.useState(!1),[s,i]=_.useState([]),[o,l]=_.useState([]),u=_.useCallback(async()=>{if(!e){r([]),i([]),l([]);return}a(!0);try{console.log("📅 Fetching loan-specific months for applicant:",e);const{data:d,error:m}=await Pe.from("loan_details").select("loan_application_id").eq("applicant_id",e).maybeSingle();if(m){console.error("Error fetching loan details:",m);return}if(!d){console.warn("No loan found for applicant:",e),i([]),l([]),r([]);return}const h=d.loan_application_id;console.log("📅 Found loan_application_id:",h,"for applicant:",e);const{data:g,error:p}=await Pe.from("payment_details").select(`
          id, 
          demand_month, 
          demand_year, 
          demand_date, 
          demand_amount, 
          amount_collected, 
          ptp_date, 
          demand_num, 
          fees, 
          fees_status, 
          payment_date, 
          mode, 
          payment_information,
          repayment_status_id,
          repayment_status(repayment_status)
        `).eq("loan_application_id",h).order("demand_year",{ascending:!0}).order("demand_month",{ascending:!0});if(p){console.error("Error fetching payment details:",p);return}if(!g||g.length===0){console.warn("No payment details found for loan_application_id:",h),i([]),l([]),r([]);return}console.log("📅 Found payment details:",g);const y=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let v=[];g[0].demand_date?(v=g.map(S=>S.demand_date),console.log("📅 Using demand_date from payment_details:",v)):(v=g.map(S=>{const b=y[S.demand_month],E=S.demand_year.toString().slice(-2);return`${b}-${E}`}),console.log("📅 Constructed months from demand_month/demand_year:",v));const x=[...new Set(v)].sort();i(x);const w=x.map(S=>S.includes("-")&&S.length===6?S:ma(S));l(w),r(g),console.log("✅ Loan-specific monthly data updated:",{applicantId:e,loanApplicationId:h,uniqueMonths:x,monthsFormatted:w,paymentDetailsCount:g.length})}catch(d){console.error("Error in fetchMonthlyData:",d)}finally{a(!1)}},[e]),f=_.useCallback(d=>{const m=t.find(h=>h.demand_date===d);return m?{...m,amount_collected:m.amount_collected||null}:null},[t]);return _.useEffect(()=>{u()},[u]),{monthlyData:t,availableMonths:s,availableMonthsFormatted:o,loading:n,getApplicationForMonth:f,refetch:u}};class i9{static async getMonthDropdownOptions(t){try{console.log("📅 Fetching month dropdown options for loan_id:",t);const r=await fetch(`${Rt}/month-dropdown/${t}/months`,{headers:dr()});if(!r.ok)return console.error("❌ Failed to fetch month dropdown options:",r.status,r.statusText),null;const n=await r.json();return console.log("✅ Month dropdown options fetched:",n),n}catch(r){return console.error("❌ Error fetching month dropdown options:",r),null}}}class o9{static async getFilteredApplications(t){const r=new URLSearchParams;t.emi_month&&r.append("emi_month",t.emi_month),t.search&&r.append("search",t.search),t.branch&&r.append("branch",t.branch),t.dealer&&r.append("dealer",t.dealer),t.lender&&r.append("lender",t.lender),t.status&&r.append("status",t.status),t.rm_name&&r.append("rm_name",t.rm_name),t.tl_name&&r.append("tl_name",t.tl_name),t.ptp_date_filter&&r.append("ptp_date_filter",t.ptp_date_filter),t.offset!==void 0&&r.append("offset",t.offset.toString()),t.limit!==void 0&&r.append("limit",t.limit.toString());const n=await fetch(`${Rt}/applications/?${r.toString()}`,{headers:dr()});if(!n.ok)throw new Error(`Failed to fetch filtered applications: ${n.status}`);return await n.json()}static async getApplications(t=fi(),r="",n=0,a=20){const s={emi_month:t,search:r,offset:n,limit:a},i=await this.getFilteredApplications(s);return{total:i.total,applications:i.results}}static async getAllApplications(t=fi()){const r={emi_month:t,offset:0,limit:1e3};return(await this.getFilteredApplications(r)).results}static async getApplicationDetails(t,r=fi()){const n={emi_month:r,search:t,offset:0,limit:1},a=await this.getFilteredApplications(n);if(a.results&&a.results.length>0)return a.results[0];throw new Error("Application not found")}static async getApplicationByLoanAndMonth(t,r){try{const n={emi_month:r,offset:0,limit:1e3},s=(await this.getFilteredApplications(n)).results.find(i=>i.loan_id===t);return s?(console.log("✅ Found application for loan_id:",t,"and month:",r),s):(console.log("⚠️ No application found for loan_id:",t,"and month:",r),null)}catch(n){return console.error("❌ Error fetching application by loan_id and month:",n),null}}}const l9=(e,t)=>{const[r,n]=_.useState({months:[],currentMonth:"",totalMonths:0,loading:!1,error:null}),[a,s]=_.useState(""),[i,o]=_.useState(null),l=_.useCallback(async()=>{if(!e){n(d=>({...d,months:[],currentMonth:"",totalMonths:0}));return}n(d=>({...d,loading:!0,error:null}));try{const d=await i9.getMonthDropdownOptions(e);if(d)if(n({months:d.months,currentMonth:d.current_month,totalMonths:d.total_months,loading:!1,error:null}),d.months.length>0&&t){console.log("🔄 useMonthDropdown: Months populated, looking for repayment_id match:",t);const m=d.months.find(h=>h.repayment_id===t.toString());m?(console.log("✅ useMonthDropdown: Found matching month for repayment_id:",t,"->",m.month),s(m.month)):(console.log("⚠️ useMonthDropdown: No matching month found for repayment_id:",t,"Available months:",d.months.map(h=>({month:h.month,repayment_id:h.repayment_id}))),s(d.months[0].month))}else d.months.length>0&&s(d.months[0].month);else n(m=>({...m,loading:!1,error:"Failed to fetch month options"}))}catch(d){console.error("Error fetching month options:",d),n(m=>({...m,loading:!1,error:"Error fetching month options"}))}},[e,t]),u=_.useCallback(async d=>{if(!e||!d)return null;try{const m=r.months.find(g=>g.month===d);if(!m)return console.error("useMonthDropdown: Month option not found for:",d),null;const h=await o9.getApplicationByLoanAndMonth(e,d);return h?{monthOption:m,application:h}:(console.log("useMonthDropdown: No application found for month:",d),null)}catch(m){return console.error("useMonthDropdown: Error fetching application for month:",m),null}},[e,r.months]),f=_.useCallback(async d=>{if(console.log("useMonthDropdown: Month changed to:",d),s(d),(!r.months||r.months.length===0)&&(console.log("useMonthDropdown: Fetching month options first"),await l(),await new Promise(h=>setTimeout(h,100)),!r.months||r.months.length===0))return console.log("useMonthDropdown: ❌ No month data available after fetch"),null;const m=await u(d);return m?(console.log("useMonthDropdown: ✅ Fetched result for month:",d,"with repayment_id:",m.monthOption.repayment_id),o(m.application),m):(console.log("useMonthDropdown: ⚠️ No result returned for month:",d),null)},[u,r.months,l]);return _.useEffect(()=>{e&&l()},[e,l]),_.useEffect(()=>{if(t&&r.months.length>0){console.log("🔄 useMonthDropdown: currentApplicationPaymentId changed, looking for matching month:",t);const d=r.months.find(m=>m.repayment_id===t.toString());d?(console.log("✅ useMonthDropdown: Auto-selecting month for repayment_id:",t,"->",d.month),s(d.month)):console.log("⚠️ useMonthDropdown: No matching month found for repayment_id:",t,"Available months:",r.months.map(m=>({month:m.month,repayment_id:m.repayment_id})))}},[t,r.months]),{...r,selectedMonth:a,currentApplication:i,handleMonthChange:f,fetchApplicationForMonth:u,refreshMonthOptions:l}},c9=({availableMonths:e,availableMonthsFormatted:t,selectedMonth:r,onMonthChange:n,loading:a=!1,loanId:s,currentApplicationPaymentId:i})=>{var k;const[o,l]=_.useState(0),[u,f]=_.useState(!1),{months:d,selectedMonth:m,handleMonthChange:h,loading:g,error:p}=l9(e.length===0?s:void 0,i),y=t||e;_.useEffect(()=>{console.log("MonthSelector: Updating current month index"),console.log("Available months:",e),console.log("Selected month:",r);const T=e.findIndex(N=>N===r);if(console.log("Found index:",T),T>=0)l(T);else if(e.length>0){const N=e.length-1;console.log("Setting default index:",N),l(N),n(e[N])}},[r,e,n]);const v=async()=>{if(o>0&&!u){f(!0);const T=o-1;console.log("Previous month: index",T,"month",e[T]),l(T),await n(e[T]),f(!1)}},x=async()=>{if(o<e.length-1&&!u){f(!0);const T=o+1;console.log("Next month: index",T,"month",e[T]),l(T),await n(e[T]),f(!1)}},w=async T=>{console.log("Select change: value",T);const N=y.findIndex(I=>I===T);if(console.log("Display index:",N),N>=0){const I=e[N];console.log("Setting raw month:",I),l(N),await n(I)}},S=async T=>{console.log("MonthSelector: Month changed to:",T);const N=await h(T);await n(T,N)},b=T=>{T.key==="ArrowLeft"&&o>0?(T.preventDefault(),v()):T.key==="ArrowRight"&&o<e.length-1&&(T.preventDefault(),x())};if(e.length===0)return c.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 border-b bg-gradient-to-r from-gray-50 to-gray-100 space-y-3 sm:space-y-0",role:"region","aria-label":"Demand month selector",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm border border-gray-200",children:c.jsx(Li,{className:"h-5 w-5 text-blue-600"})}),c.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Demand Month:"})]}),c.jsx("div",{className:"flex items-center space-x-3 w-full sm:w-auto justify-center",children:g?c.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[c.jsx(Bi,{className:"h-4 w-4 animate-spin text-blue-600"}),c.jsx("span",{className:"text-sm text-gray-500",children:"Loading months..."})]}):p?c.jsx("div",{className:"flex items-center space-x-2 px-4 py-2 bg-red-50 rounded-lg border border-red-200 shadow-sm",children:c.jsxs("span",{className:"text-sm text-red-500",children:["Error: ",p]})}):d.length>0?c.jsxs(Zn,{value:m||((k=d[0])==null?void 0:k.month)||"",onValueChange:S,disabled:g,children:[c.jsx(An,{className:"w-28 sm:w-36 h-8 sm:h-9 rounded-lg border-gray-300 bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all duration-200",children:c.jsx(ea,{placeholder:"Select month",className:"text-sm font-semibold text-gray-900"})}),c.jsx(Pn,{className:"bg-white border border-gray-200 rounded-lg shadow-xl max-h-60",children:d.map(T=>c.jsx(Tt,{value:T.month,className:"text-sm hover:bg-blue-50 focus:bg-blue-50 cursor-pointer data-[state=checked]:bg-blue-100 data-[state=checked]:text-blue-900",children:T.month},T.month))})]}):c.jsx("div",{className:"flex items-center space-x-2 px-4 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:c.jsx("span",{className:"text-sm text-gray-500",children:"No months available"})})}),c.jsx("div",{className:"w-full sm:w-20"})]});const E=y[o]||r;return console.log("MonthSelector render:",{availableMonths:e,selectedMonth:r,currentMonthIndex:o,selectedMonthDisplay:E,displayMonths:y}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 border-b bg-gradient-to-r from-gray-50 to-gray-100 space-y-3 sm:space-y-0",onKeyDown:b,tabIndex:0,role:"region","aria-label":"Month selector",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm border border-gray-200",children:c.jsx(Li,{className:"h-5 w-5 text-blue-600"})}),c.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Month:"})]}),c.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 w-full sm:w-auto justify-center",children:[c.jsx(Te,{variant:"outline",size:"sm",onClick:v,disabled:o===0||a||u,className:Ce("h-8 w-8 sm:h-9 sm:w-9 p-0 rounded-lg border-gray-300 hover:bg-white hover:border-blue-400 hover:shadow-md transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed","focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),"aria-label":"Previous month",children:u?c.jsx(Bi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600 animate-spin"}):c.jsx(N1,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600"})}),c.jsxs(Zn,{value:E,onValueChange:w,disabled:a||u,children:[c.jsx(An,{className:"w-28 sm:w-36 h-8 sm:h-9 rounded-lg border-gray-300 bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all duration-200",children:c.jsx(ea,{className:"text-sm font-semibold text-gray-900",children:a?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Bi,{className:"h-3 w-3 animate-spin"}),c.jsx("span",{className:"hidden sm:inline",children:"Loading..."})]}):E})}),c.jsx(Pn,{className:"bg-white border border-gray-200 rounded-lg shadow-xl max-h-60",children:y.map((T,N)=>c.jsx(Tt,{value:T,className:"text-sm hover:bg-blue-50 focus:bg-blue-50 cursor-pointer data-[state=checked]:bg-blue-100 data-[state=checked]:text-blue-900",children:T},T))})]}),c.jsx(Te,{variant:"outline",size:"sm",onClick:x,disabled:o===e.length-1||a||u,className:Ce("h-8 w-8 sm:h-9 sm:w-9 p-0 rounded-lg border-gray-300 hover:bg-white hover:border-blue-400 hover:shadow-md transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed","focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),"aria-label":"Next month",children:u?c.jsx(Bi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600 animate-spin"}):c.jsx($h,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600"})})]}),c.jsx("div",{className:"flex items-center space-x-2 w-full sm:w-auto justify-center sm:justify-end",children:c.jsx("div",{className:"px-3 py-1 bg-white rounded-lg border border-gray-200 shadow-sm",children:c.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[o+1," of ",e.length]})})})]})},JT=({application:e,onClose:t,onSave:r,onDataChanged:n,selectedEmiMonth:a,refetchStatusCounts:s})=>{const{user:i}=Bt(),[o,l]=_.useState(e),[u,f]=_.useState(""),[d,m]=_.useState(null),[h,g]=_.useState("contacts"),p=_.useRef(!1),y=_.useRef(!1),v=_.useRef(!1),{monthlyData:x,availableMonths:w,availableMonthsFormatted:S,loading:b,getApplicationForMonth:E,refetch:k}=s9(o==null?void 0:o.applicant_id);_.useEffect(()=>{console.log("ApplicationDetailsPanel: Monthly data state changed:",{hasMonthlyData:!!x,monthlyDataLength:(x==null?void 0:x.length)||0,monthlyLoading:b,currentPaymentId:o==null?void 0:o.payment_id,selectedMonth:u}),x&&x.length>0&&console.log("ApplicationDetailsPanel: Monthly data available:",x.map(J=>({id:J.id,demand_date:J.demand_date,demand_month:J.demand_month,demand_year:J.demand_year})))},[x,b,o==null?void 0:o.payment_id,u]),_.useEffect(()=>{console.log("ApplicationDetailsPanel: Application changed",{applicantId:e==null?void 0:e.applicant_id,paymentId:e==null?void 0:e.payment_id,emiMonth:e==null?void 0:e.emi_month}),l(e),v.current=!1,p.current=!1,f(""),e!=null&&e.payment_id&&console.log("ApplicationDetailsPanel: Expecting to initialize month for payment_id:",e.payment_id)},[e]),_.useEffect(()=>{(async()=>{if(o!=null&&o.applicant_id&&(o!=null&&o.emi_month))try{console.log("ApplicationDetailsPanel: Fetching full application details from API for:",o.applicant_id);const A=await hp(o.applicant_id,o.emi_month);if(A){console.log("ApplicationDetailsPanel: Received API application data:",A);const me={...o,...A,field_status:o.field_status,applicant_calling_status:o.applicant_calling_status,co_applicant_calling_status:o.co_applicant_calling_status,guarantor_calling_status:o.guarantor_calling_status,reference_calling_status:o.reference_calling_status};console.log("ApplicationDetailsPanel: Enhanced application with API data:",me),l(me)}}catch(A){console.error("ApplicationDetailsPanel: Failed to fetch full application details:",A)}})()},[o==null?void 0:o.applicant_id,o==null?void 0:o.emi_month]);const{repaymentHistory:T}=a9(o==null?void 0:o.applicant_id),{fetchComments:N,addComment:I,clearComments:H}=hT(u),j=_.useCallback(async J=>{if(J)try{console.log("🔍 Fetching comments for payment_id:",J);const A=await Il.getCommentsByRepaymentAndType(J.toString(),Ml.APPLICATION_DETAILS,0,100);A.results&&A.results.length>0?(console.log("✅ Found comments for payment_id:",J,"count:",A.results.length),K(A.results.map(me=>({...me,user_name:me.user_name||`User ${me.user_id}`,content:me.comment,application_id:(o==null?void 0:o.applicant_id)||""})))):(console.log("ℹ️ No comments found for payment_id:",J),K([]))}catch(A){console.error("❌ Error fetching comments by payment_id:",A),K([])}},[o==null?void 0:o.applicant_id]),[z,K]=_.useState([]),{auditLogs:q,addAuditLog:Q}=a7(o==null?void 0:o.applicant_id,u),{callingLogs:X,addCallingLog:F}=s7(o==null?void 0:o.applicant_id,u);_.useEffect(()=>{m(null)},[o==null?void 0:o.applicant_id,u]),_.useEffect(()=>{console.log("ApplicationDetailsPanel: Clearing comments for application",o==null?void 0:o.applicant_id),H(),K([])},[o==null?void 0:o.applicant_id,H]),_.useEffect(()=>{o!=null&&o.payment_id&&(console.log("🔍 ApplicationDetailsPanel: Fetching comments for payment_id:",o.payment_id),j(o.payment_id))},[o==null?void 0:o.payment_id,j]),_.useEffect(()=>{if(console.log("ApplicationDetailsPanel: Month initialization check",{selectedEmiMonth:a,availableMonths:w,currentApplicationId:o==null?void 0:o.applicant_id,selectedMonth:u,applicationEmiMonth:o==null?void 0:o.emi_month,applicationDemandDate:o==null?void 0:o.demand_date,applicationPaymentId:o==null?void 0:o.payment_id,userSelectedMonth:p.current,isUpdatingStatus:y.current,initialized:v.current,monthlyLoading:b,monthlyDataAvailable:!!x&&x.length>0}),!(v.current&&(p.current||u)||y.current||!(o!=null&&o.applicant_id)||p.current&&u)&&!u){let J="";if(a){const A=w.find(me=>ma(me)===a);A?(J=A,console.log("ApplicationDetailsPanel: ✅ Using selectedEmiMonth from dashboard:",a,"->",J)):console.log("ApplicationDetailsPanel: ⚠️ selectedEmiMonth",a,"not available for this loan. Available months:",w.map(me=>ma(me)))}if(!J&&(o!=null&&o.payment_id)&&x&&x.length>0){console.log("ApplicationDetailsPanel: Checking payment_id match:",{paymentId:o.payment_id,monthlyDataCount:x.length,monthlyData:x.map(me=>({id:me.id,demand_date:me.demand_date,demand_month:me.demand_month,demand_year:me.demand_year}))});const A=x.find(me=>me.id===o.payment_id);if(A)if(console.log("ApplicationDetailsPanel: Found matching payment in main logic:",A),A.demand_date)J=A.demand_date,console.log("ApplicationDetailsPanel: ✅ Found month for payment_id using demand_date:",o.payment_id,"->",J);else if(A.demand_month&&A.demand_year){const ke=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][A.demand_month],We=A.demand_year.toString().slice(-2);J=`${ke}-${We}`,console.log("ApplicationDetailsPanel: ✅ Found month for payment_id using demand_month/demand_year:",o.payment_id,"->",J)}else console.log("ApplicationDetailsPanel: ❌ No month information available for payment_id:",o.payment_id);else console.log("ApplicationDetailsPanel: ❌ No matching payment found for payment_id:",o.payment_id,"in monthlyData")}else console.log("ApplicationDetailsPanel: ⚠️ Cannot check payment_id match:",{hasPaymentId:!!(o!=null&&o.payment_id),hasMonthlyData:!!x,monthlyDataLength:(x==null?void 0:x.length)||0});if(!J&&(o!=null&&o.emi_month||o!=null&&o.demand_date)){const A=(o==null?void 0:o.emi_month)||(o==null?void 0:o.demand_date),me=w.find(ke=>ke===A);if(me)J=me,console.log("ApplicationDetailsPanel: Found exact match for application emi_month/demand_date",A,"->",J);else{const ke=ma(A),We=w.find(Me=>ma(Me)===ke);We&&(J=We,console.log("ApplicationDetailsPanel: Found formatted match for application emi_month/demand_date",ke,"->",J))}}if(!J&&w.length>0&&(J=w[w.length-1],console.log("ApplicationDetailsPanel: Using most recent month for this loan:",J)),!J){console.warn("ApplicationDetailsPanel: No month found through normal channels, trying emergency fallback");return}console.log("ApplicationDetailsPanel: Setting initial month to",J,"based on selectedEmiMonth:",a,"payment_id:",o==null?void 0:o.payment_id,"and application EMI month:",o==null?void 0:o.emi_month),f(J),v.current=!0,p.current=!1}},[w,u,o==null?void 0:o.applicant_id,o==null?void 0:o.demand_date,o==null?void 0:o.payment_id,a,x,b]),_.useEffect(()=>{if(x&&x.length>0&&!u&&(o!=null&&o.payment_id)&&!v.current){console.log("ApplicationDetailsPanel: Monthly data became available, attempting to initialize month"),console.log("ApplicationDetailsPanel: Monthly data structure:",x.map(A=>({id:A.id,demand_date:A.demand_date,demand_month:A.demand_month,demand_year:A.demand_year})));let J="";if(a){const A=w.find(me=>ma(me)===a);A?(J=A,console.log("ApplicationDetailsPanel: ✅ Using selectedEmiMonth from dashboard:",a,"->",J)):console.log("ApplicationDetailsPanel: ⚠️ selectedEmiMonth",a,"not available for this loan. Available months:",w.map(me=>ma(me)))}if(!J){const A=x.find(me=>me.id===o.payment_id);if(A){if(console.log("ApplicationDetailsPanel: Found matching payment:",A),A.demand_date)J=A.demand_date,console.log("ApplicationDetailsPanel: Using demand_date:",J);else if(A.demand_month&&A.demand_year){const ke=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][A.demand_month],We=A.demand_year.toString().slice(-2);J=`${ke}-${We}`,console.log("ApplicationDetailsPanel: Constructed month from demand_month/demand_year:",J)}}else console.log("ApplicationDetailsPanel: ❌ Still no matching payment found after data load for payment_id:",o.payment_id)}J?(console.log("ApplicationDetailsPanel: ✅ Setting month to:",J,"for payment_id:",o.payment_id),f(J),v.current=!0,p.current=!1):console.log("ApplicationDetailsPanel: ❌ Could not determine month for payment_id:",o.payment_id)}},[x,u,o==null?void 0:o.payment_id,a,w]),_.useEffect(()=>{!u&&w.length>0&&!b&&(console.log("ApplicationDetailsPanel: Emergency fallback - setting month to first available:",w[0]),f(w[0]),v.current=!0)},[u,w,b]);const P=_.useCallback(async(J,A)=>{if(console.log("ApplicationDetailsPanel: Month changed to",J),f(J),p.current=!0,A&&A.monthOption&&A.monthOption.repayment_id){const me={...A.application,payment_id:parseInt(A.monthOption.repayment_id,10),emi_month:J,demand_date:A.monthOption.demand_date};console.log("ApplicationDetailsPanel: ✅ Updated payment_id to",me.payment_id,"for month:",J),l(me),g(h)}else console.log("ApplicationDetailsPanel: ⚠️ No monthOption data found, using application as-is"),A&&A.application&&l(A.application);if(x&&x.length>0&&(console.log("ApplicationDetailsPanel: 🔄 Refreshing monthly data for new month:",J),setTimeout(()=>{k()},100)),o!=null&&o.applicant_id)try{console.log("ApplicationDetailsPanel: 🔄 Fetching application data for new month:",J);const me=await hp(o.applicant_id,J);if(me){console.log("ApplicationDetailsPanel: ✅ Received API application data for month:",J,me);const ke={...o,...me,emi_month:J,field_status:o.field_status,applicant_calling_status:o.applicant_calling_status,co_applicant_calling_status:o.co_applicant_calling_status,guarantor_calling_status:o.guarantor_calling_status,reference_calling_status:o.reference_calling_status};console.log("ApplicationDetailsPanel: ✅ Enhanced application with new month data:",ke),l(ke)}}catch(me){console.error("ApplicationDetailsPanel: ❌ Failed to fetch application data for month:",J,me)}},[h,x,k,o]),Z=_.useCallback(async()=>{if(o!=null&&o.applicant_id&&u){console.log("ApplicationDetailsPanel: Fetching comments for active tab",{applicationId:o.applicant_id,selectedMonth:u});try{await N(o.applicant_id)}catch(J){console.error("Error fetching comments:",J)}}},[o==null?void 0:o.applicant_id,u,N]),le=_.useCallback(J=>{g(J),J==="comments"&&Z()},[Z]),D=u?E(u):null,{handleStatusChange:V,handlePtpDateChange:O,handleCallingStatusChange:L}=n9(o,i,Q,F,J=>{l(J),r(J),n==null||n()},u);_.useCallback(async J=>{y.current=!0;try{await V(J)}finally{setTimeout(()=>{y.current=!1},1e3)}},[V]);const Y=_.useCallback(async J=>{y.current=!0,p.current=!0;try{await O(J)}finally{setTimeout(()=>{y.current=!1},1e3)}},[O]),G=o?D?{...o,team_lead:D.team_lead||o.team_lead,rm_name:D.rm_name||o.rm_name,repayment:D.repayment||o.repayment,emi_amount:D.emi_amount||o.emi_amount,last_month_bounce:D.last_month_bounce||o.last_month_bounce,lms_status:D.lms_status||o.lms_status,collection_rm:D.collection_rm||o.collection_rm,demand_date:D.demand_date||o.demand_date,amount_collected:D.amount_collected||o.amount_collected,ptp_date:d||o.ptp_date,vehicle_status:o.vehicle_status}:{...o,ptp_date:d||o.ptp_date,vehicle_status:o.vehicle_status}:null;if(!o)return null;const ie=async(J,A)=>{if(!(i!=null&&i.id)){Se.error("You must be logged in to add comments");return}if(o!=null&&o.applicant_id)try{if(console.log("🔍 handleAddComment called with:",{content:J,paymentId:A,currentApplicationPaymentId:o.payment_id,userId:i.id}),A){const me={repayment_id:A.toString(),comment:J.trim(),user_id:i.id,comment_type:Ml.APPLICATION_DETAILS};console.log("🚀 Creating comment with payment_id directly:",me),await Il.createComment(me),await j(A)}else await I(o.applicant_id,J,u,o.loan_id,u);Se.success("Comment added"),A||await N(o.applicant_id),await(n==null?void 0:n())}catch(me){console.error("Error adding comment:",me),Se.error("Failed to add comment")}},se=async J=>{Se.error("Vehicle status update not available in this mode.")},ae=_.useCallback(async()=>{if(o!=null&&o.applicant_id&&u)try{console.log("🔄 ApplicationDetailsPanel: Reloading application details after contact status update..."),console.log("🔄 ApplicationDetailsPanel: Calling getApplicationDetails with:",{applicantId:o.applicant_id,selectedMonth:u}),console.log("🔄 ApplicationDetailsPanel: Waiting 500ms for backend transaction to commit..."),await new Promise(A=>setTimeout(A,500));const J=await hp(o.applicant_id,u);if(J){console.log("🔄 ApplicationDetailsPanel: Received updated API application data:",J),console.log("🔄 ApplicationDetailsPanel: Current calling statuses:",{applicant:o.applicant_calling_status,co_applicant:o.co_applicant_calling_status,guarantor:o.guarantor_calling_status,reference:o.reference_calling_status}),console.log("🔄 ApplicationDetailsPanel: API calling statuses:",{applicant:J.applicant_calling_status,co_applicant:J.co_applicant_calling_status,guarantor:J.guarantor_calling_status,reference:J.reference_calling_status});const A={...o,...J,field_status:o.field_status,applicant_calling_status:J.applicant_calling_status||o.applicant_calling_status,co_applicant_calling_status:J.co_applicant_calling_status||o.co_applicant_calling_status,guarantor_calling_status:J.guarantor_calling_status||o.guarantor_calling_status,reference_calling_status:J.reference_calling_status||o.reference_calling_status};console.log("🔄 ApplicationDetailsPanel: Enhanced application with updated API data:",A),console.log("🔄 ApplicationDetailsPanel: Final calling statuses after merge:",{applicant:A.applicant_calling_status,co_applicant:A.co_applicant_calling_status,guarantor:A.guarantor_calling_status,reference:A.reference_calling_status}),l(A),n==null||n(),console.log("✅ Application details reloaded successfully")}}catch(J){console.error("❌ ApplicationDetailsPanel: Failed to reload application details:",J)}else console.warn("⚠️ ApplicationDetailsPanel: Cannot reload application details - missing applicant_id or selectedMonth")},[o==null?void 0:o.applicant_id,u,n]);return c.jsxs("div",{className:"application-details-panel bg-white flex flex-col",children:[c.jsxs("div",{className:"flex-shrink-0 p-4 sm:p-6 border-b bg-white",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-6",children:[c.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Application Details"}),c.jsx(Te,{variant:"ghost",size:"sm",onClick:t,className:"hover:bg-gray-100 rounded-full h-8 w-8 p-0",children:c.jsx(Vl,{className:"h-4 w-4"})})]}),c.jsx(o7,{application:G})]}),c.jsx(c9,{availableMonths:w,availableMonthsFormatted:S,selectedMonth:u,onMonthChange:P,loading:b,loanId:o==null?void 0:o.loan_id,currentApplicationPaymentId:o==null?void 0:o.payment_id}),c.jsx("div",{className:"flex-1 flex-col-min-h-0",children:c.jsxs(dT,{value:h,onValueChange:le,className:"h-full flex flex-col",children:[c.jsx("div",{className:"flex-shrink-0 pt-3 sm:pt-4 border-b",children:c.jsxs(Tv,{className:"grid w-full grid-cols-4 text-xs sm:text-sm h-auto",children:[c.jsx(ds,{value:"contacts",className:"py-2",children:"Contacts"}),c.jsx(ds,{value:"status",className:"py-2",children:"Status"}),c.jsx(ds,{value:"comments",className:"py-2",children:"Comments"}),c.jsx(ds,{value:"details",className:"py-2",children:"Details"})]})}),c.jsxs("div",{className:"application-details-content flex-1 overflow-y-auto p-4 sm:p-4",children:[c.jsx(hs,{value:"contacts",className:"m-0",children:c.jsx(K7,{application:o,callingLogs:X,onCallingStatusChange:L,selectedMonth:u,onReloadApplication:ae},`contacts-${o==null?void 0:o.payment_id}-${u}`)}),c.jsx(hs,{value:"status",className:"m-0",children:c.jsx(e9,{application:o,auditLogs:q,onStatusChange:()=>{},onPtpDateChange:Y,addAuditLog:Q,selectedMonth:u,refetchStatusCounts:s,monthlyData:x},`status-${o==null?void 0:o.payment_id}-${u}`)}),c.jsx(hs,{value:"comments",className:"m-0",children:c.jsx(t9,{comments:z,onAddComment:ie,paymentId:o.payment_id,applicationId:o.applicant_id})}),c.jsx(hs,{value:"details",className:"m-0",children:c.jsx(r9,{application:o,repaymentHistory:T,auditLogs:q,onVehicleStatusChange:se,monthlyData:x,selectedMonth:u},`details-${o==null?void 0:o.payment_id}-${u}`)})]})]})})]})},u9=({applications:e,setApplications:t,onApplicationUpdate:r})=>{const{subscribe:n}=tm(),a=_.useRef(e);_.useEffect(()=>{a.current=e},[e]);const s=_.useCallback((i,o)=>{console.log("🔄 RealtimeApplicationUpdates: Updating application:",{applicationId:i,updates:o}),t(l=>l.map(u=>{if(u.applicant_id===i){const f={...u,...o};return console.log("🔄 RealtimeApplicationUpdates: Updated application:",f),f}return u})),r&&r(i,o)},[t,r]);return _.useEffect(()=>n(o=>{console.log("🔄 RealtimeApplicationUpdates: Received update:",o);const{type:l,applicationId:u,...f}=o;switch(l){case"STATUS_UPDATE":s(u,{status:f.status,field_status:f.status});break;case"PRE_EMI_STATUS_UPDATE":s(u,{demand_calling_status:f.preEmiStatus});break;case"PTP_DATE_UPDATE":s(u,{ptp_date:f.ptpDate});break;case"AMOUNT_COLLECTED_UPDATE":s(u,{amount_collected:f.amount});break;case"COMMENT_ADDED":console.log("🔄 RealtimeApplicationUpdates: Comment added for application:",u);break;case"CONTACT_STATUS_UPDATE":const d=f.contactType,m=f.status;s(u,{[`${d}_calling_status`]:m});break;case"APPLICATION_UPDATE":s(u,f.updates);break;default:console.log("🔄 RealtimeApplicationUpdates: Unknown update type:",l)}}),[n,s]),{updateApplication:s}},Tc=20,f9=()=>{const e=ql(),{user:t,isAuthenticated:r,logout:n}=Bt(),[a,s]=_.useState(1),[i,o]=_.useState(""),[l,u]=_.useState(null),[f,d]=_.useState([]),[m,h]=_.useState(!0),[g,p]=_.useState(0),[y,v]=_.useState(null),[x,w]=_.useState({branch:[],teamLead:[],rm:[],dealer:[],lender:[],status:[],repayment:[],lastMonthBounce:[],ptpDate:[],vehicleStatus:[]}),[S,b]=_.useState(fi()),[E,k]=_.useState(null),[T,N]=_.useState(!1),I=S||fi();_.useEffect(()=>{console.log("📅 EMI Month changed - selectedEmiMonthRaw:",S),console.log("📅 EMI Month changed - selectedEmiMonth:",I)},[S,I]);const H=Vn.canViewPendingApprovals();u9({applications:f,setApplications:d,onApplicationUpdate:(L,Y)=>{console.log("🔄 Index: Application updated via realtime:",{applicationId:L,updates:Y}),l&&l.applicant_id===L&&u(G=>({...G,...Y}))}});const j=async()=>{try{await n(),e("/login")}catch(L){console.error("Logout failed:",L)}};_.useEffect(()=>{console.log("🔍 Index.tsx: Fetching filter options..."),R8().then(L=>{console.log("🔍 Index.tsx: Filter options received from API:",L),console.log("🔍 Index.tsx: demand_num from API:",L.demand_num),console.log("🔍 Index.tsx: ptpDateOptions from API:",L.ptpDateOptions),v(L)}).catch(L=>{console.error("❌ Index.tsx: Error fetching filter options:",L)})},[]),_.useEffect(()=>{if(console.log("🔄 useEffect triggered - selectedEmiMonth:",I),console.log("🔄 useEffect triggered - selectedEmiMonthRaw:",S),console.log("🔄 useEffect triggered - filters changed:",x),console.log("🔄 useEffect triggered - currentPage:",a),console.log("🔄 useEffect triggered - searchTerm:",i),!I){d([]),h(!1);return}h(!0);const L=(a-1)*Tc,Y={search:i,branch:x.branch,teamLead:x.teamLead,rm:x.rm,dealer:x.dealer,lender:x.lender,status:x.status,repayment:x.repayment,lastMonthBounce:x.lastMonthBounce,ptpDate:x.ptpDate,vehicleStatus:x.vehicleStatus};console.log("📡 Sending filter params to API:",Y),console.log("📡 Current filters state:",x),console.log("📡 Fetching for EMI month:",I),console.log("📡 PTP Date filter:",x.ptpDate),console.log("📡 Repayment filter:",x.repayment),console.log("📡 Pagination - Current page:",a,"Page size:",Tc,"Offset:",L),console.log("🚀 Making API call to getApplicationsFromBackend..."),M8(I,L,Tc,Y).then(G=>{var se,ae,J,A,me;console.log("✅ API response received:",G),console.log("✅ Results count:",((se=G.results)==null?void 0:se.length)||0),console.log("✅ First few results:",(ae=G.results)==null?void 0:ae.slice(0,3)),console.log("✅ EMI months in results:",(J=G.results)==null?void 0:J.map(ke=>ke.emi_month)),console.log("✅ Demand numbers in results:",(A=G.results)==null?void 0:A.map(ke=>ke.demand_num)),console.log("✅ PTP dates in results:",(me=G.results)==null?void 0:me.map(ke=>ke.ptp_date));const ie=(G.results||[]).map(n4);console.log("✅ Mapped applications demand_num values:",ie.map(ke=>ke.demand_num)),console.log("✅ Mapped applications PTP dates:",ie.map(ke=>ke.ptp_date)),d(ie),p(G.total||0)}).catch(G=>{console.error("❌ API error:",G),d([])}).finally(()=>h(!1))},[I,a,i,x.branch,x.teamLead,x.rm,x.dealer,x.lender,x.status,x.repayment,x.lastMonthBounce,x.ptpDate,x.vehicleStatus]),_.useEffect(()=>{I&&(N(!0),j8(I,x).then(k).catch(()=>k(null)).finally(()=>N(!1)))},[I,x]),_.useEffect(()=>{const Y=setInterval(()=>{y&&v({...y})},864e5);return()=>clearInterval(Y)},[y]),_.useCallback((L,Y)=>L.filter(G=>{var ie,se,ae;return!(Y.branch&&Y.branch.length>0&&!Y.branch.includes(G.branch_name)||Y.teamLead&&Y.teamLead.length>0&&!Y.teamLead.includes(G.tl_name)||Y.rm&&Y.rm.length>0&&!Y.rm.includes(G.rm_name)||Y.dealer&&Y.dealer.length>0&&!Y.dealer.includes(G.dealer_name)||Y.lender&&Y.lender.length>0&&!Y.lender.includes(G.lender_name)||Y.status&&Y.status.length>0&&!Y.status.includes(G.status)||Y.repayment&&Y.repayment.length>0&&(console.log("🔍 Comparing repayment filter:",{filterValues:Y.repayment,appDemandNum:G.demand_num,appDemandNumType:typeof G.demand_num,appDemandNumString:(ie=G.demand_num)==null?void 0:ie.toString(),includes:Y.repayment.includes((se=G.demand_num)==null?void 0:se.toString())}),!Y.repayment.includes((ae=G.demand_num)==null?void 0:ae.toString()))||Y.vehicleStatus&&Y.vehicleStatus.length>0&&!Y.vehicleStatus.includes(G.vehicle_status))}),[]),_.useEffect(()=>{Object.values(x).some(L=>L.length>0)&&(console.log("🔍 Filters changed, resetting to page 1"),s(1))},[x]);const z=f,K=L=>{console.log("EMI Month changed to:",L),console.log("Previous selectedEmiMonthRaw:",S),b(L),s(1),d([]),p(0)},q=(L,Y)=>{console.log("🔧 handleFilterChange called with:",L,Y),console.log("Filter change - key type:",typeof L),console.log("Filter change - values type:",typeof Y),console.log("Filter change - values content:",Y),["ptpDate","repayment","status","branch","dealer","lender","rm","teamLead"].includes(L)&&(console.log("🔄 Filter change requires fresh data fetch:",L),d([]),p(0)),L==="repayment"&&(console.log("🔍 Repayment filter change - values:",Y),console.log("🔍 Repayment filter change - first value type:",typeof Y[0]),console.log("🔍 Repayment filter change - first value:",Y[0])),L==="ptpDate"&&(console.log("🔍 PTP Date filter change - values:",Y),console.log("🔍 PTP Date filter change - will trigger fresh data fetch")),w(ie=>{const se={...ie,[L]:Y};return console.log("🔧 Updated filters state:",se),se}),s(1)},Q=L=>u(L),X=()=>u(null),F=()=>{u(null),s(1)},P=L=>{u(L)},Z=L=>{o(L),s(1)},le=()=>{console.log("Export full requested")},D=()=>{console.log("Export PTP comments requested")},V=L=>{console.log("Export plan vs achievement requested for:",L)},O=y&&{emiMonthOptions:D8(),branches:y.branches,dealers:y.dealers,lenders:y.lenders,statuses:y.statuses,ptpDateOptions:y.ptpDateOptions,vehicle_statuses:y.vehicle_statuses,team_leads:y.team_leads,rms:y.rms,repayments:y.demand_num,lastMonthBounce:["Not paid","Paid on time","1-5 days late","6-15 days late","15+ days late"]};return _.useEffect(()=>{y&&(console.log("🔍 Index.tsx: Filter options from API:",y),console.log("🔍 Index.tsx: Mapped options for frontend:",O),console.log("🔍 Index.tsx: Repayments (demand_num):",y.demand_num),console.log("🔍 Index.tsx: PTP Date options:",y.ptpDateOptions),console.log("🔍 Index.tsx: Mapped repayments:",O==null?void 0:O.repayments),console.log("🔍 Index.tsx: Mapped ptpDateOptions:",O==null?void 0:O.ptpDateOptions))},[y,O]),r?c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"w-full max-w-7xl mx-auto px-2 sm:px-4 md:px-6 lg:px-8 py-2 sm:py-4 md:py-6 lg:py-8",children:c.jsxs("div",{className:"space-y-2 sm:space-y-4 md:space-y-6",children:[c.jsx(wL,{onExportFull:le,onExportPtpComments:D,onExportPlanVsAchievement:V,onLogout:j,user:t}),c.jsx(ML,{filters:x,availableOptions:O,onFilterChange:q,searchTerm:i,onSearchChange:Z,selectedEmiMonth:I,onEmiMonthChange:K,emiMonthOptions:O==null?void 0:O.emiMonthOptions,loading:!y,searchLoading:m,totalCount:g}),T?c.jsx(JL,{}):c.jsx(QL,{statusCounts:E}),H&&c.jsx(e7,{onUpdate:()=>{}}),c.jsx(KL,{applications:z,onRowClick:Q,onApplicationDeleted:F,selectedApplicationId:l==null?void 0:l.id,currentPage:a,totalPages:Math.ceil((g||1)/Tc),onPageChange:s,totalCount:g,pageSize:Tc,selectedEmiMonth:I})]})}),c.jsx(qL,{}),l&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:X}),c.jsx("div",{className:"fixed inset-y-0 right-0 w-full sm:w-[95%] md:w-96 lg:w-[500px] z-50",children:c.jsx(JT,{application:l,onClose:X,onSave:P,onDataChanged:()=>{console.log("🔄 Index: Data changed in ApplicationDetailsPanel")},selectedEmiMonth:I})})]})]}):c.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},d9=()=>{const{user:e}=Bt(),[t,r]=_.useState([]),[n,a]=_.useState(!1),[s,i]=_.useState(!0),o=async f=>!!f,l=async()=>{e&&r([{id:"role-1",user_id:e.id,role:"admin",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}])},u=async(f,d)=>{r(m=>{const h=new Date().toISOString();return[...m.filter(p=>p.user_id!==f),{id:`role-${f}`,user_id:f,role:d,created_at:h,updated_at:h}]})};return _.useEffect(()=>{(async()=>{i(!0),e&&(a(!0),await l()),i(!1)})()},[e]),{userRoles:t,isAdmin:n,loading:s,checkIsAdmin:o,assignRole:u,fetchUserRoles:l}},h9=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!0),[a,s]=_.useState(""),[i,o]=_.useState(!1),[l,u]=_.useState(""),[f,d]=_.useState(""),[m,h]=_.useState(""),[g,p]=_.useState("user"),[y,v]=_.useState(!1),x=async()=>{try{const{data:k,error:T}=await Pe.from("profiles").select("id, email, full_name").order("email");if(T){console.error("Error fetching profiles:",T),Se.error("Failed to fetch users");return}if(!k){t([]);return}const{data:N,error:I}=await Pe.from("user_roles").select("user_id, role, created_at");if(I){console.error("Error fetching user roles:",I),Se.error("Failed to fetch user roles");return}const H=k.map(j=>{const z=N==null?void 0:N.find(K=>K.user_id===j.id);return{id:j.id,email:j.email||"",full_name:j.full_name,role:(z==null?void 0:z.role)||"user",role_created_at:z==null?void 0:z.created_at}});t(H)}catch(k){console.error("Error fetching users:",k),Se.error("Failed to fetch users")}finally{n(!1)}};_.useEffect(()=>{x()},[]);const w=async k=>{k.preventDefault(),v(!0);try{console.log("Creating user with role assignment:",{email:l,fullName:m,role:g});const{data:T,error:N}=await Pe.functions.invoke("create-bulk-users",{body:{users:[{email:l.trim(),fullName:m.trim(),password:f,role:g}]}});if(N){console.error("Edge Function error:",N),Se.error("Failed to create user. Please try again.");return}const I=T;I.successful>0?(Se.success(`User created successfully with ${g} role!`),u(""),d(""),h(""),p("user"),o(!1),await x()):Se.error(`Failed to create user: ${I.errors[0]||"Unknown error"}`)}catch(T){console.error("Unexpected error creating user:",T),Se.error("An error occurred while creating the user")}finally{v(!1)}},S=async(k,T)=>{try{const{error:N}=await Pe.from("user_roles").upsert({user_id:k,role:T});if(N){console.error("Error updating role:",N),Se.error("Failed to update user role");return}Se.success(`User role updated to ${T}`),await x()}catch(N){console.error("Error updating role:",N),Se.error("Failed to update user role")}},b=async k=>{try{const{error:T}=await Pe.from("user_roles").delete().eq("user_id",k);if(T){console.error("Error removing role:",T),Se.error("Failed to remove user role");return}Se.success("User role removed"),await x()}catch(T){console.error("Error removing role:",T),Se.error("Failed to remove user role")}},E=e.filter(k=>k.email.toLowerCase().includes(a.toLowerCase())||k.full_name&&k.full_name.toLowerCase().includes(a.toLowerCase()));return r?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading users..."})]}):c.jsx("div",{className:"space-y-6",children:c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(St,{className:"flex items-center gap-2",children:[c.jsx(Y0,{className:"h-5 w-5"}),"User Management"]}),c.jsxs(Ql,{open:i,onOpenChange:o,children:[c.jsx(af,{asChild:!0,children:c.jsxs(Te,{children:[c.jsx(Y0,{className:"h-4 w-4 mr-2"}),"Create User"]})}),c.jsxs(To,{className:"sm:max-w-md",children:[c.jsxs(No,{children:[c.jsx(Jl,{children:"Create New User"}),c.jsx(sf,{children:"Add a new user to the system with assigned role"})]}),c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"fullName",children:"Full Name"}),c.jsx(Sr,{id:"fullName",type:"text",placeholder:"Enter full name",value:m,onChange:k=>h(k.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"email",children:"Email"}),c.jsx(Sr,{id:"email",type:"email",placeholder:"Enter email address",value:l,onChange:k=>u(k.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"password",children:"Password"}),c.jsx(Sr,{id:"password",type:"password",placeholder:"Enter password",value:f,onChange:k=>d(k.target.value),required:!0,minLength:6})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"role",children:"Role"}),c.jsxs(Zn,{value:g,onValueChange:k=>p(k),children:[c.jsx(An,{children:c.jsx(ea,{placeholder:"Select role"})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"user",children:"User"}),c.jsx(Tt,{value:"admin",children:"Admin"})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Te,{type:"button",variant:"outline",onClick:()=>o(!1),disabled:y,children:"Cancel"}),c.jsx(Te,{type:"submit",disabled:y,children:y?"Creating...":"Create User"})]})]})]})]})]})}),c.jsxs(at,{children:[c.jsx("div",{className:"flex items-center gap-4 mb-6",children:c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(A1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx(Sr,{placeholder:"Search by email or name...",value:a,onChange:k=>s(k.target.value),className:"pl-10"})]})}),c.jsx("div",{className:"border rounded-lg",children:c.jsxs(Zl,{children:[c.jsx(hf,{children:c.jsxs(pa,{children:[c.jsx(it,{children:"User"}),c.jsx(it,{children:"Email"}),c.jsx(it,{children:"Current Role"}),c.jsx(it,{children:"Role Assigned"}),c.jsx(it,{children:"Actions"})]})}),c.jsx(ec,{children:E.map(k=>c.jsxs(pa,{children:[c.jsx(ut,{children:c.jsx("div",{className:"font-medium",children:k.full_name||"No name set"})}),c.jsx(ut,{children:k.email}),c.jsx(ut,{children:c.jsx(wa,{variant:k.role==="admin"?"default":"secondary",children:k.role})}),c.jsx(ut,{children:k.role_created_at?c.jsx("span",{className:"text-sm text-gray-600",children:Ft(new Date(k.role_created_at),"dd-MMM-yyyy")}):c.jsx("span",{className:"text-sm text-gray-400",children:"Default"})}),c.jsx(ut,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(Zn,{value:k.role,onValueChange:T=>S(k.id,T),children:[c.jsx(An,{className:"w-24",children:c.jsx(ea,{})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"user",children:"User"}),c.jsx(Tt,{value:"admin",children:"Admin"})]})]}),k.role_created_at&&c.jsx(Te,{variant:"outline",size:"sm",onClick:()=>b(k.id),className:"text-red-600 hover:text-red-700",children:c.jsx(i6,{className:"h-4 w-4"})})]})})]},k.id))})]})}),E.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:"No users found matching your search criteria"})]})]})})},m9=({uploadType:e,onTypeChange:t})=>c.jsxs("div",{className:"space-y-3",children:[c.jsx(Xe,{className:"text-sm font-medium",children:"Upload Type"}),c.jsxs(cm,{value:e,onValueChange:r=>t(r),children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"applications",id:"applications"}),c.jsxs(Xe,{htmlFor:"applications",className:"text-sm",children:[c.jsx("strong",{children:"Applications"})," - Upload application data with all fields"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"repayment_history",id:"repayment_history"}),c.jsxs(Xe,{htmlFor:"repayment_history",className:"text-sm",children:[c.jsx("strong",{children:"Repayment History"})," - Upload repayment history data only"]})]})]})]}),p9=({uploadMode:e,onModeChange:t})=>c.jsxs("div",{className:"space-y-3",children:[c.jsx(Xe,{className:"text-sm font-medium",children:"Upload Mode"}),c.jsxs(cm,{value:e,onValueChange:r=>t(r),children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"mixed",id:"mixed"}),c.jsxs(Xe,{htmlFor:"mixed",className:"text-sm",children:[c.jsx("strong",{children:"Smart Mode"})," - Automatically add new or update existing (Recommended)"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"add",id:"add"}),c.jsxs(Xe,{htmlFor:"add",className:"text-sm",children:[c.jsx("strong",{children:"Add Only"})," - Only create new applications"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{value:"update",id:"update"}),c.jsxs(Xe,{htmlFor:"update",className:"text-sm",children:[c.jsx("strong",{children:"Update Only"})," - Only update existing applications"]})]})]})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var uh={};uh.version="0.18.5";var ZT=1252,g9=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Av={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Pv=function(e){g9.indexOf(e)!=-1&&(ZT=Av[0]=e)};function v9(){Pv(1252)}var ga=function(e){Pv(e)};function Dv(){ga(1200),v9()}function Fw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function y9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function eN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Rc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?y9(e.slice(2)):t==254&&r==255?eN(e.slice(2)):t==65279?e.slice(1):e},Jf=function(t){return String.fromCharCode(t)},Lw=function(t){return String.fromCharCode(t)},Pu,ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Du(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=ti.charAt(s)+ti.charAt(i)+ti.charAt(o)+ti.charAt(l);return t}function Dn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=ti.indexOf(e.charAt(u++)),i=ti.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=ti.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=ti.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),As=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function vi(e){return Ge?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Bw(e){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var kn=function(t){return Ge?As(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ym(e){if(typeof ArrayBuffer>"u")return kn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ni(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function x9(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function jv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return jv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var hr=Ge?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:As(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function w9(e){for(var t=[],r=0,n=e.length+250,a=vi(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=vi(65535),n=65530)}return t.push(a.slice(0,r)),hr(t)}var Zr=/\u0000/g,Mc=/[\u0001-\u0006]/g;function dl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function va(e,t){var r=""+e;return r.length>=t?r:Wt("0",t-r.length)+r}function Rv(e,t){var r=""+e;return r.length>=t?r:Wt(" ",t-r.length)+r}function fh(e,t){var r=""+e;return r.length>=t?r:r+Wt(" ",t-r.length)}function _9(e,t){var r=""+Math.round(e);return r.length>=t?r:Wt("0",t-r.length)+r}function S9(e,t){var r=""+e;return r.length>=t?r:Wt("0",t-r.length)+r}var Uw=Math.pow(2,32);function Bo(e,t){if(e>Uw||e<-Uw)return _9(e,t);var r=Math.round(e);return S9(r,t)}function dh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $w=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function k9(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ww={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},b9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function hh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*i+s,f=d*u+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=s):(f=u,o=i)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Ui(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=P9(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var tN=new Date(1899,11,31,0,0,0),E9=tN.getTime(),T9=new Date(1900,2,1,0,0,0);function rN(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=T9&&(r+=24*60*60*1e3),(r-(E9+(e.getTimezoneOffset()-tN.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Mv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function N9(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function C9(e){var t=e<0?12:11,r=Mv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function A9(e){var t=Mv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ju(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=C9(e):t===10?r=e.toFixed(10).substr(0,12):r=A9(e),Mv(N9(r.toUpperCase()))}function po(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ju(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ta(14,rN(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function P9(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function D9(e,t,r,n){var a="",s=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return Rp[r.m-1][1];case 5:return Rp[r.m-1][0];default:return Rp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return $w[r.q][0];default:return $w[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?va(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=va(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?va(l,u):"";return f}function ri(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var nN=/%/g;function j9(e,t,r){var n=t.replace(nN,""),a=t.length-n.length;return vs(e,n,r*Math.pow(10,2*a))+Wt("%",a)}function R9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+aN(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sN=/# (\?+)( ?)\/( ?)(\d+)/;function M9(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Wt(" ",e[1].length+1+e[4].length):Rv(i,e[1].length)+e[2]+"/"+e[3]+va(o,e[4].length))}function I9(e,t,r){return r+(t===0?"":""+t)+Wt(" ",e[1].length+2+e[4].length)}var iN=/^#*0*\.([0#]+)/,oN=/\).*[0#]/,lN=/\(###\) ###\\?-####/;function Kr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Hw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Vw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function O9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function F9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oN)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ln("n",n,r):"("+Ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return R9(e,t,r);if(t.indexOf("%")!==-1)return j9(e,t,r);if(t.indexOf("E")!==-1)return aN(t,r);if(t.charCodeAt(0)===36)return"$"+Ln(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Bo(l,t.length);if(t.match(/^[#?]+$/))return a=Bo(r,0),a==="0"&&(a=""),a.length>t.length?a:Kr(t.substr(0,t.length-a.length))+a;if(s=t.match(sN))return M9(s,l,u);if(t.match(/^#+0+$/))return u+Bo(l,t.length-t.indexOf("0"));if(s=t.match(iN))return a=Hw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Kr(s[1])).replace(/\.$/,"."+Kr(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Wt("0",Kr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Hw(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ri(Bo(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):ri(""+(Math.floor(r)+O9(r,s[1].length)))+"."+va(Vw(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(Ln(e,t.replace(/[\\-]/g,""),r)),i=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(lN))return a=Ln(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=hh(l,Math.pow(10,i)-1,!1),a=""+u,f=vs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=fh(o[2],i),f.length<s[4].length&&(f=Kr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=hh(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rv(o[1],i)+s[2]+"/"+s[3]+fh(o[2],i):Wt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Bo(r,0),t.length<=a.length?a:Kr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,m=t.length-a.length-d;return Kr(t.substr(0,d)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Vw(r,s[1].length),r<0?"-"+Ln(e,t,-r):ri(F9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?va(0,3-g.length):"")+g})+"."+va(i,s[1].length);switch(t){case"###,##0.00":return Ln(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ri(Bo(l,0));return h!=="0"?u+h:"";case"###,###.00":return Ln(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ln(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function L9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function B9(e,t,r){var n=t.replace(nN,""),a=t.length-n.length;return vs(e,n,r*Math.pow(10,2*a))+Wt("%",a)}function cN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cN(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oN)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",n,r):"("+Ia("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return L9(e,t,r);if(t.indexOf("%")!==-1)return B9(e,t,r);if(t.indexOf("E")!==-1)return cN(t,r);if(t.charCodeAt(0)===36)return"$"+Ia(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+va(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Kr(t.substr(0,t.length-a.length))+a;if(s=t.match(sN))return I9(s,l,u);if(t.match(/^#+0+$/))return u+va(l,t.length-t.indexOf("0"));if(s=t.match(iN))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kr(s[1])).replace(/\.$/,"."+Kr(s[1])),a=a.replace(/\.(\d*)$/,function(g,p){return"."+p+Wt("0",Kr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ri(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):ri(""+r)+"."+Wt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ia(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(Ia(e,t.replace(/[\\-]/g,""),r)),i=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(lN))return a=Ia(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=hh(l,Math.pow(10,i)-1,!1),a=""+u,f=vs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=fh(o[2],i),f.length<s[4].length&&(f=Kr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=hh(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rv(o[1],i)+s[2]+"/"+s[3]+fh(o[2],i):Wt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Kr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,m=t.length-a.length-d;return Kr(t.substr(0,d)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):ri(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?va(0,3-g.length):"")+g})+"."+va(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ri(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Ia(e,t.slice(0,t.lastIndexOf(".")),r)+Kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function vs(e,t,r){return(r|0)===r?Ia(e,t,r):Ln(e,t,r)}function U9(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var uN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":dh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(uN))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function $9(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",u,f,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!dh(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),g=h==="("||h===")"?h:"t";a[a.length]={t:g,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ui(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ui(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(u==null&&(u=Ui(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",i+=5,m="h"):(p.t="t",++i),u==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(uN)){if(u==null&&(u=Ui(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",rc(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var y=0,v=0,x;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=m,l="h",y<1&&(y=1);break;case"s":(x=a[i].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[i].v.match(/[Hh]/)&&(y=1),y<2&&a[i].v.match(/[Mm]/)&&(y=2),y<3&&a[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=D9(a[i].t.charCodeAt(0),a[i].v,u,v),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;w+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=po(t,r);break}var b="",E,k;if(w.length>0){w.charCodeAt(0)==40?(E=t<0&&w.charCodeAt(0)===45?-t:t,k=vs("n",w,E)):(E=t<0&&n>1?-t:t,k=vs("n",w,E),E<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),S=k.length-1;var T=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){T=i;break}var N=a.length;if(T===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=k.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=k.substr(0,S+1),S=-1),a[i].t="t",N=i);S>=0&&N<a.length&&(a[N].v=k.substr(0,S+1)+a[N].v)}else if(T!==a.length&&k.indexOf("E")===-1){for(S=k.indexOf(".")-1,i=T;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")-1:a[i].v.length-1,b=a[i].v.substr(f+1);f>=0;--f)S>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(b=k.charAt(S--)+b);a[i].v=b,a[i].t="t",N=i}for(S>=0&&N<a.length&&(a[N].v=k.substr(0,S+1)+a[N].v),S=k.indexOf(".")+1,i=T;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==T)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")+1:0,b=a[i].v.substr(0,f);f<a[i].v.length;++f)S<k.length&&(b+=k.charAt(S++));a[i].v=b,a[i].t="t",N=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(E=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=vs(a[i].t,a[i].v,E),a[i].t="t");var I="";for(i=0;i!==a.length;++i)a[i]!=null&&(I+=a[i].v);return I}var zw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function W9(e,t){var r=U9(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(zw),o=r[1].match(zw);return Gw(t,i)?[n,r[0]]:Gw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function ta(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:je)[e],n==null&&(n=r.table&&r.table[Ww[e]]||je[Ww[e]]),n==null&&(n=b9[e]||"General");break}if(dh(n,0))return po(t,r);t instanceof Date&&(t=rN(t,r.date1904));var a=W9(n,t);if(dh(a[1]))return po(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $9(a[1],t,r,a[0])}function ys(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(je[r]==null){t<0&&(t=r);continue}if(je[r]==e){t=r;break}}t<0&&(t=391)}return je[t]=e,t}function xm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ys(e[t],t)}function nc(){je=k9()}var H9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function V9(e){var t=typeof e=="number"?je[e]:e;return t=t.replace(fN,"(\\d+)"),new RegExp("^"+t+"$")}function z9(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(fN)||[]).forEach(function(d,m){var h=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":l=h;break;case"m":i>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&s==-1?f:u+"T"+f}var G9=function(){var e={};e.version="1.2.0";function t(){for(var k=0,T=new Array(256),N=0;N!=256;++N)k=N,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,T[N]=k;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(k){var T=0,N=0,I=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)H[I]=k[I];for(I=0;I!=256;++I)for(N=k[I],T=256+I;T<4096;T+=256)N=H[T]=N>>>8^k[N&255];var j=[];for(I=1;I!=16;++I)j[I-1]=typeof Int32Array<"u"?H.subarray(I*256,I*256+256):H.slice(I*256,I*256+256);return j}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],u=a[4],f=a[5],d=a[6],m=a[7],h=a[8],g=a[9],p=a[10],y=a[11],v=a[12],x=a[13],w=a[14];function S(k,T){for(var N=T^-1,I=0,H=k.length;I<H;)N=N>>>8^r[(N^k.charCodeAt(I++))&255];return~N}function b(k,T){for(var N=T^-1,I=k.length-15,H=0;H<I;)N=w[k[H++]^N&255]^x[k[H++]^N>>8&255]^v[k[H++]^N>>16&255]^y[k[H++]^N>>>24]^p[k[H++]]^g[k[H++]]^h[k[H++]]^m[k[H++]]^d[k[H++]]^f[k[H++]]^u[k[H++]]^l[k[H++]]^o[k[H++]]^i[k[H++]]^s[k[H++]]^r[k[H++]];for(I+=15;H<I;)N=N>>>8^r[(N^k[H++])&255];return~N}function E(k,T){for(var N=T^-1,I=0,H=k.length,j=0,z=0;I<H;)j=k.charCodeAt(I++),j<128?N=N>>>8^r[(N^j)&255]:j<2048?(N=N>>>8^r[(N^(192|j>>6&31))&255],N=N>>>8^r[(N^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,z=k.charCodeAt(I++)&1023,N=N>>>8^r[(N^(240|j>>8&7))&255],N=N>>>8^r[(N^(128|j>>2&63))&255],N=N>>>8^r[(N^(128|z>>6&15|(j&3)<<4))&255],N=N>>>8^r[(N^(128|z&63))&255]):(N=N>>>8^r[(N^(224|j>>12&15))&255],N=N>>>8^r[(N^(128|j>>6&63))&255],N=N>>>8^r[(N^(128|j&63))&255]);return~N}return e.table=r,e.bstr=S,e.buf=b,e.str=E,e}(),Ae=function(){var t={};t.version="1.2.1";function r(C,B){for(var R=C.split("/"),M=B.split("/"),U=0,W=0,te=Math.min(R.length,M.length);U<te;++U){if(W=R[U].length-M[U].length)return W;if(R[U]!=M[U])return R[U]<M[U]?-1:1}return R.length-M.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var B=C.lastIndexOf("/");return B===-1?C:C.slice(0,B+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var B=C.lastIndexOf("/");return B===-1?C:C.slice(B+1)}function s(C,B){typeof B=="string"&&(B=new Date(B));var R=B.getHours();R=R<<6|B.getMinutes(),R=R<<5|B.getSeconds()>>>1,C.write_shift(2,R);var M=B.getFullYear()-1980;M=M<<4|B.getMonth()+1,M=M<<5|B.getDate(),C.write_shift(2,M)}function i(C){var B=C.read_shift(2)&65535,R=C.read_shift(2)&65535,M=new Date,U=R&31;R>>>=5;var W=R&15;R>>>=4,M.setMilliseconds(0),M.setFullYear(R+1980),M.setMonth(W-1),M.setDate(U);var te=B&31;B>>>=5;var ce=B&63;return B>>>=6,M.setHours(B),M.setMinutes(ce),M.setSeconds(te<<1),M}function o(C){wr(C,0);for(var B={},R=0;C.l<=C.length-4;){var M=C.read_shift(2),U=C.read_shift(2),W=C.l+U,te={};switch(M){case 21589:R=C.read_shift(1),R&1&&(te.mtime=C.read_shift(4)),U>5&&(R&2&&(te.atime=C.read_shift(4)),R&4&&(te.ctime=C.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}C.l=W,B[M]=te}return B}var l;function u(){return l||(l={})}function f(C,B){if(C[0]==80&&C[1]==75)return lc(C,B);if((C[0]|32)==109&&(C[1]|32)==105)return yn(C,B);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var R=3,M=512,U=0,W=0,te=0,ce=0,ee=0,re=[],ne=C.slice(0,512);wr(ne,0);var de=d(ne);switch(R=de[0],R){case 3:M=512;break;case 4:M=4096;break;case 0:if(de[1]==0)return lc(C,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}M!==512&&(ne=C.slice(0,M),wr(ne,28));var we=C.slice(0,M);m(ne,R);var be=ne.read_shift(4,"i");if(R===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),U=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),W=ne.read_shift(4,"i");for(var pe=-1,_e=0;_e<109&&(pe=ne.read_shift(4,"i"),!(pe<0));++_e)re[_e]=pe;var Ue=h(C,M);y(ee,W,Ue,M,re);var Pt=x(Ue,te,re,M);Pt[te].name="!Directory",U>0&&ce!==z&&(Pt[ce].name="!MiniFAT"),Pt[re[0]].name="!FAT",Pt.fat_addrs=re,Pt.ssz=M;var Dt={},Tr=[],uc=[],fc=[];w(te,Pt,Ue,Tr,U,Dt,uc,ce),g(uc,fc,Tr),Tr.shift();var dc={FileIndex:uc,FullPaths:fc};return B&&B.raw&&(dc.raw={header:we,sectors:Ue}),dc}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(K,"Header Signature: "),C.l+=16;var B=C.read_shift(2,"u");return[C.read_shift(2,"u"),B]}function m(C,B){var R=9;switch(C.l+=2,R=C.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function h(C,B){for(var R=Math.ceil(C.length/B)-1,M=[],U=1;U<R;++U)M[U-1]=C.slice(U*B,(U+1)*B);return M[R-1]=C.slice(R*B),M}function g(C,B,R){for(var M=0,U=0,W=0,te=0,ce=0,ee=R.length,re=[],ne=[];M<ee;++M)re[M]=ne[M]=M,B[M]=R[M];for(;ce<ne.length;++ce)M=ne[ce],U=C[M].L,W=C[M].R,te=C[M].C,re[M]===M&&(U!==-1&&re[U]!==U&&(re[M]=re[U]),W!==-1&&re[W]!==W&&(re[M]=re[W])),te!==-1&&(re[te]=M),U!==-1&&M!=re[M]&&(re[U]=re[M],ne.lastIndexOf(U)<ce&&ne.push(U)),W!==-1&&M!=re[M]&&(re[W]=re[M],ne.lastIndexOf(W)<ce&&ne.push(W));for(M=1;M<ee;++M)re[M]===M&&(W!==-1&&re[W]!==W?re[M]=re[W]:U!==-1&&re[U]!==U&&(re[M]=re[U]));for(M=1;M<ee;++M)if(C[M].type!==0){if(ce=M,ce!=re[ce])do ce=re[ce],B[M]=B[ce]+"/"+B[M];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[M]=-1}for(B[0]+="/",M=1;M<ee;++M)C[M].type!==2&&(B[M]+="/")}function p(C,B,R){for(var M=C.start,U=C.size,W=[],te=M;R&&U>0&&te>=0;)W.push(B.slice(te*j,te*j+j)),U-=j,te=Mi(R,te*4);return W.length===0?oe(0):hr(W).slice(0,C.size)}function y(C,B,R,M,U){var W=z;if(C===z){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var te=R[C],ce=(M>>>2)-1;if(!te)return;for(var ee=0;ee<ce&&(W=Mi(te,ee*4))!==z;++ee)U.push(W);y(Mi(te,M-4),B-1,R,M,U)}}function v(C,B,R,M,U){var W=[],te=[];U||(U=[]);var ce=M-1,ee=0,re=0;for(ee=B;ee>=0;){U[ee]=!0,W[W.length]=ee,te.push(C[ee]);var ne=R[Math.floor(ee*4/M)];if(re=ee*4&ce,M<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+M);if(!C[ne])break;ee=Mi(C[ne],re)}return{nodes:W,data:a2([te])}}function x(C,B,R,M){var U=C.length,W=[],te=[],ce=[],ee=[],re=M-1,ne=0,de=0,we=0,be=0;for(ne=0;ne<U;++ne)if(ce=[],we=ne+B,we>=U&&(we-=U),!te[we]){ee=[];var pe=[];for(de=we;de>=0;){pe[de]=!0,te[de]=!0,ce[ce.length]=de,ee.push(C[de]);var _e=R[Math.floor(de*4/M)];if(be=de*4&re,M<4+be)throw new Error("FAT boundary crossed: "+de+" 4 "+M);if(!C[_e]||(de=Mi(C[_e],be),pe[de]))break}W[we]={nodes:ce,data:a2([ee])}}return W}function w(C,B,R,M,U,W,te,ce){for(var ee=0,re=M.length?2:0,ne=B[C].data,de=0,we=0,be;de<ne.length;de+=128){var pe=ne.slice(de,de+128);wr(pe,64),we=pe.read_shift(2),be=$v(pe,0,we-re),M.push(be);var _e={name:be,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Ue=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Ue!==0&&(_e.ct=S(pe,pe.l-8));var Pt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Pt!==0&&(_e.mt=S(pe,pe.l-8)),_e.start=pe.read_shift(4,"i"),_e.size=pe.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=z,_e.name=""),_e.type===5?(ee=_e.start,U>0&&ee!==z&&(B[ee].name="!StreamData")):_e.size>=4096?(_e.storage="fat",B[_e.start]===void 0&&(B[_e.start]=v(R,_e.start,B.fat_addrs,B.ssz)),B[_e.start].name=_e.name,_e.content=B[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:ee!==z&&_e.start!==z&&B[ee]&&(_e.content=p(_e,B[ee].data,(B[ce]||{}).data))),_e.content&&wr(_e.content,0),W[be]=_e,te.push(_e)}}function S(C,B){return new Date((Sn(C,B+4)/1e7*Math.pow(2,32)+Sn(C,B)/1e7-11644473600)*1e3)}function b(C,B){return u(),f(l.readFileSync(C),B)}function E(C,B){var R=B&&B.type;switch(R||Ge&&Buffer.isBuffer(C)&&(R="buffer"),R||"base64"){case"file":return b(C,B);case"base64":return f(kn(Dn(C)),B);case"binary":return f(kn(C),B)}return f(C,B)}function k(C,B){var R=B||{},M=R.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=M+"/",C.FileIndex[0]={name:M,type:5}),R.CLSID&&(C.FileIndex[0].clsid=R.CLSID),T(C)}function T(C){var B="Sh33tJ5";if(!Ae.find(C,"/"+B)){var R=oe(4);R[0]=55,R[1]=R[3]=50,R[2]=54,C.FileIndex.push({name:B,type:2,content:R,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+B),N(C)}}function N(C,B){k(C);for(var R=!1,M=!1,U=C.FullPaths.length-1;U>=0;--U){var W=C.FileIndex[U];switch(W.type){case 0:M?R=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(W.R*W.L*W.C)&&(R=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!B)){var te=new Date(1987,1,19),ce=0,ee=Object.create?Object.create(null):{},re=[];for(U=0;U<C.FullPaths.length;++U)ee[C.FullPaths[U]]=!0,C.FileIndex[U].type!==0&&re.push([C.FullPaths[U],C.FileIndex[U]]);for(U=0;U<re.length;++U){var ne=n(re[U][0]);M=ee[ne],M||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:Q,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(be,pe){return r(be[0],pe[0])}),C.FullPaths=[],C.FileIndex=[],U=0;U<re.length;++U)C.FullPaths[U]=re[U][0],C.FileIndex[U]=re[U][1];for(U=0;U<re.length;++U){var de=C.FileIndex[U],we=C.FullPaths[U];if(de.name=a(we).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||Q,U===0)de.C=re.length>1?1:-1,de.size=0,de.type=5;else if(we.slice(-1)=="/"){for(ce=U+1;ce<re.length&&n(C.FullPaths[ce])!=we;++ce);for(de.C=ce>=re.length?-1:ce,ce=U+1;ce<re.length&&n(C.FullPaths[ce])!=n(we);++ce);de.R=ce>=re.length?-1:ce,de.type=1}else n(C.FullPaths[U+1]||"")==n(we)&&(de.R=U+1),de.type=2}}}function I(C,B){var R=B||{};if(R.fileType=="mad")return Pa(C,R);switch(N(C),R.fileType){case"zip":return cc(C,R)}var M=function(be){for(var pe=0,_e=0,Ue=0;Ue<be.FileIndex.length;++Ue){var Pt=be.FileIndex[Ue];if(Pt.content){var Dt=Pt.content.length;Dt>0&&(Dt<4096?pe+=Dt+63>>6:_e+=Dt+511>>9)}}for(var Tr=be.FullPaths.length+3>>2,uc=pe+7>>3,fc=pe+127>>7,dc=uc+_e+Tr+fc,Pi=dc+127>>7,Dm=Pi<=109?0:Math.ceil((Pi-109)/127);dc+Pi+Dm+127>>7>Pi;)Dm=++Pi<=109?0:Math.ceil((Pi-109)/127);var ns=[1,Dm,Pi,fc,Tr,_e,pe,0];return be.FileIndex[0].size=pe<<6,ns[7]=(be.FileIndex[0].start=ns[0]+ns[1]+ns[2]+ns[3]+ns[4]+ns[5])+(ns[6]+7>>3),ns}(C),U=oe(M[7]<<9),W=0,te=0;{for(W=0;W<8;++W)U.write_shift(1,q[W]);for(W=0;W<8;++W)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),W=0;W<3;++W)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,M[2]),U.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:z),U.write_shift(4,M[3]),U.write_shift(-4,M[1]?M[0]-1:z),U.write_shift(4,M[1]),W=0;W<109;++W)U.write_shift(-4,W<M[2]?M[1]+W:-1)}if(M[1])for(te=0;te<M[1];++te){for(;W<236+te*127;++W)U.write_shift(-4,W<M[2]?M[1]+W:-1);U.write_shift(-4,te===M[1]-1?z:te+1)}var ce=function(be){for(te+=be;W<te-1;++W)U.write_shift(-4,W+1);be&&(++W,U.write_shift(-4,z))};for(te=W=0,te+=M[1];W<te;++W)U.write_shift(-4,X.DIFSECT);for(te+=M[2];W<te;++W)U.write_shift(-4,X.FATSECT);ce(M[3]),ce(M[4]);for(var ee=0,re=0,ne=C.FileIndex[0];ee<C.FileIndex.length;++ee)ne=C.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,ce(re+511>>9)));for(ce(M[6]+7>>3);U.l&511;)U.write_shift(-4,X.ENDOFCHAIN);for(te=W=0,ee=0;ee<C.FileIndex.length;++ee)ne=C.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,ce(re+63>>6)));for(;U.l&511;)U.write_shift(-4,X.ENDOFCHAIN);for(W=0;W<M[4]<<2;++W){var de=C.FullPaths[W];if(!de||de.length===0){for(ee=0;ee<17;++ee)U.write_shift(4,0);for(ee=0;ee<3;++ee)U.write_shift(4,-1);for(ee=0;ee<12;++ee)U.write_shift(4,0);continue}ne=C.FileIndex[W],W===0&&(ne.start=ne.size?ne.start-1:z);var we=W===0&&R.root||ne.name;if(re=2*(we.length+1),U.write_shift(64,we,"utf16le"),U.write_shift(2,re),U.write_shift(1,ne.type),U.write_shift(1,ne.color),U.write_shift(-4,ne.L),U.write_shift(-4,ne.R),U.write_shift(-4,ne.C),ne.clsid)U.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)U.write_shift(4,0);U.write_shift(4,ne.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ne.start),U.write_shift(4,ne.size),U.write_shift(4,0)}for(W=1;W<C.FileIndex.length;++W)if(ne=C.FileIndex[W],ne.size>=4096)if(U.l=ne.start+1<<9,Ge&&Buffer.isBuffer(ne.content))ne.content.copy(U,U.l,0,ne.size),U.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)U.write_shift(1,ne.content[ee]);for(;ee&511;++ee)U.write_shift(1,0)}for(W=1;W<C.FileIndex.length;++W)if(ne=C.FileIndex[W],ne.size>0&&ne.size<4096)if(Ge&&Buffer.isBuffer(ne.content))ne.content.copy(U,U.l,0,ne.size),U.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)U.write_shift(1,ne.content[ee]);for(;ee&63;++ee)U.write_shift(1,0)}if(Ge)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function H(C,B){var R=C.FullPaths.map(function(ee){return ee.toUpperCase()}),M=R.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),U=!1;B.charCodeAt(0)===47?(U=!0,B=R[0].slice(0,-1)+B):U=B.indexOf("/")!==-1;var W=B.toUpperCase(),te=U===!0?R.indexOf(W):M.indexOf(W);if(te!==-1)return C.FileIndex[te];var ce=!W.match(Mc);for(W=W.replace(Zr,""),ce&&(W=W.replace(Mc,"!")),te=0;te<R.length;++te)if((ce?R[te].replace(Mc,"!"):R[te]).replace(Zr,"")==W||(ce?M[te].replace(Mc,"!"):M[te]).replace(Zr,"")==W)return C.FileIndex[te];return null}var j=64,z=-2,K="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function F(C,B,R){u();var M=I(C,R);l.writeFileSync(B,M)}function P(C){for(var B=new Array(C.length),R=0;R<C.length;++R)B[R]=String.fromCharCode(C[R]);return B.join("")}function Z(C,B){var R=I(C,B);switch(B&&B.type||"buffer"){case"file":return u(),l.writeFileSync(B.filename,R),R;case"binary":return typeof R=="string"?R:P(R);case"base64":return Du(typeof R=="string"?R:P(R));case"buffer":if(Ge)return Buffer.isBuffer(R)?R:As(R);case"array":return typeof R=="string"?kn(R):R}return R}var le;function D(C){try{var B=C.InflateRaw,R=new B;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)le=C;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function V(C,B){if(!le)return Sf(C,B);var R=le.InflateRaw,M=new R,U=M._processChunk(C.slice(C.l),M._finishFlushFlag);return C.l+=M.bytesRead,U}function O(C){return le?le.deflateRawSync(C):Be(C)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(C){var B=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(B>>16|B>>8|B)&255}for(var se=typeof Uint8Array<"u",ae=se?new Uint8Array(256):[],J=0;J<256;++J)ae[J]=ie(J);function A(C,B){var R=ae[C&255];return B<=8?R>>>8-B:(R=R<<8|ae[C>>8&255],B<=16?R>>>16-B:(R=R<<8|ae[C>>16&255],R>>>24-B))}function me(C,B){var R=B&7,M=B>>>3;return(C[M]|(R<=6?0:C[M+1]<<8))>>>R&3}function ke(C,B){var R=B&7,M=B>>>3;return(C[M]|(R<=5?0:C[M+1]<<8))>>>R&7}function We(C,B){var R=B&7,M=B>>>3;return(C[M]|(R<=4?0:C[M+1]<<8))>>>R&15}function Me(C,B){var R=B&7,M=B>>>3;return(C[M]|(R<=3?0:C[M+1]<<8))>>>R&31}function xe(C,B){var R=B&7,M=B>>>3;return(C[M]|(R<=1?0:C[M+1]<<8))>>>R&127}function mt(C,B,R){var M=B&7,U=B>>>3,W=(1<<R)-1,te=C[U]>>>M;return R<8-M||(te|=C[U+1]<<8-M,R<16-M)||(te|=C[U+2]<<16-M,R<24-M)||(te|=C[U+3]<<24-M),te&W}function nr(C,B,R){var M=B&7,U=B>>>3;return M<=5?C[U]|=(R&7)<<M:(C[U]|=R<<M&255,C[U+1]=(R&7)>>8-M),B+3}function pn(C,B,R){var M=B&7,U=B>>>3;return R=(R&1)<<M,C[U]|=R,B+1}function Hr(C,B,R){var M=B&7,U=B>>>3;return R<<=M,C[U]|=R&255,R>>>=8,C[U+1]=R,B+8}function js(C,B,R){var M=B&7,U=B>>>3;return R<<=M,C[U]|=R&255,R>>>=8,C[U+1]=R&255,C[U+2]=R>>>8,B+16}function Er(C,B){var R=C.length,M=2*R>B?2*R:B+5,U=0;if(R>=B)return C;if(Ge){var W=Bw(M);if(C.copy)C.copy(W);else for(;U<C.length;++U)W[U]=C[U];return W}else if(se){var te=new Uint8Array(M);if(te.set)te.set(C);else for(;U<R;++U)te[U]=C[U];return te}return C.length=M,C}function Vr(C){for(var B=new Array(C),R=0;R<C;++R)B[R]=0;return B}function na(C,B,R){var M=1,U=0,W=0,te=0,ce=0,ee=C.length,re=se?new Uint16Array(32):Vr(32);for(W=0;W<32;++W)re[W]=0;for(W=ee;W<R;++W)C[W]=0;ee=C.length;var ne=se?new Uint16Array(ee):Vr(ee);for(W=0;W<ee;++W)re[U=C[W]]++,M<U&&(M=U),ne[W]=0;for(re[0]=0,W=1;W<=M;++W)re[W+16]=ce=ce+re[W-1]<<1;for(W=0;W<ee;++W)ce=C[W],ce!=0&&(ne[W]=re[ce+16]++);var de=0;for(W=0;W<ee;++W)if(de=C[W],de!=0)for(ce=A(ne[W],M)>>M-de,te=(1<<M+4-de)-1;te>=0;--te)B[ce|te<<de]=de&15|W<<4;return M}var zt=se?new Uint16Array(512):Vr(512),In=se?new Uint16Array(32):Vr(32);if(!se){for(var vr=0;vr<512;++vr)zt[vr]=0;for(vr=0;vr<32;++vr)In[vr]=0}(function(){for(var C=[],B=0;B<32;B++)C.push(5);na(C,In,32);var R=[];for(B=0;B<=143;B++)R.push(8);for(;B<=255;B++)R.push(9);for(;B<=279;B++)R.push(7);for(;B<=287;B++)R.push(8);na(R,zt,288)})();var On=function(){for(var B=se?new Uint8Array(32768):[],R=0,M=0;R<G.length-1;++R)for(;M<G[R+1];++M)B[M]=R;for(;M<32768;++M)B[M]=29;var U=se?new Uint8Array(259):[];for(R=0,M=0;R<Y.length-1;++R)for(;M<Y[R+1];++M)U[M]=R;function W(ce,ee){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),de=re+ne==ce.length;for(ee.write_shift(1,+de),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=ce[re++]}return ee.l}function te(ce,ee){for(var re=0,ne=0,de=se?new Uint16Array(32768):[];ne<ce.length;){var we=Math.min(65535,ce.length-ne);if(we<10){for(re=nr(ee,re,+(ne+we==ce.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,we),ee.write_shift(2,~we&65535);we-- >0;)ee[ee.l++]=ce[ne++];re=ee.l*8;continue}re=nr(ee,re,+(ne+we==ce.length)+2);for(var be=0;we-- >0;){var pe=ce[ne];be=(be<<5^pe)&32767;var _e=-1,Ue=0;if((_e=de[be])&&(_e|=ne&-32768,_e>ne&&(_e-=32768),_e<ne))for(;ce[_e+Ue]==ce[ne+Ue]&&Ue<250;)++Ue;if(Ue>2){pe=U[Ue],pe<=22?re=Hr(ee,re,ae[pe+1]>>1)-1:(Hr(ee,re,3),re+=5,Hr(ee,re,ae[pe-23]>>5),re+=3);var Pt=pe<8?0:pe-4>>2;Pt>0&&(js(ee,re,Ue-Y[pe]),re+=Pt),pe=B[ne-_e],re=Hr(ee,re,ae[pe]>>3),re-=3;var Dt=pe<4?0:pe-2>>1;Dt>0&&(js(ee,re,ne-_e-G[pe]),re+=Dt);for(var Tr=0;Tr<Ue;++Tr)de[be]=ne&32767,be=(be<<5^ce[ne])&32767,++ne;we-=Ue-1}else pe<=143?pe=pe+48:re=pn(ee,re,1),re=Hr(ee,re,ae[pe]),de[be]=ne&32767,++ne}re=Hr(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?W(ee,re):te(ee,re)}}();function Be(C){var B=oe(50+Math.floor(C.length*1.1)),R=On(C,B);return B.slice(0,R)}var Ct=se?new Uint16Array(32768):Vr(32768),zr=se?new Uint16Array(32768):Vr(32768),At=se?new Uint16Array(128):Vr(128),rn=1,ic=1;function Rs(C,B){var R=Me(C,B)+257;B+=5;var M=Me(C,B)+1;B+=5;var U=We(C,B)+4;B+=4;for(var W=0,te=se?new Uint8Array(19):Vr(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=se?new Uint8Array(8):Vr(8),ne=se?new Uint8Array(8):Vr(8),de=te.length,we=0;we<U;++we)te[L[we]]=W=ke(C,B),ee<W&&(ee=W),re[W]++,B+=3;var be=0;for(re[0]=0,we=1;we<=ee;++we)ne[we]=be=be+re[we-1]<<1;for(we=0;we<de;++we)(be=te[we])!=0&&(ce[we]=ne[be]++);var pe=0;for(we=0;we<de;++we)if(pe=te[we],pe!=0){be=ae[ce[we]]>>8-pe;for(var _e=(1<<7-pe)-1;_e>=0;--_e)At[be|_e<<pe]=pe&7|we<<3}var Ue=[];for(ee=1;Ue.length<R+M;)switch(be=At[xe(C,B)],B+=be&7,be>>>=3){case 16:for(W=3+me(C,B),B+=2,be=Ue[Ue.length-1];W-- >0;)Ue.push(be);break;case 17:for(W=3+ke(C,B),B+=3;W-- >0;)Ue.push(0);break;case 18:for(W=11+xe(C,B),B+=7;W-- >0;)Ue.push(0);break;default:Ue.push(be),ee<be&&(ee=be);break}var Pt=Ue.slice(0,R),Dt=Ue.slice(R);for(we=R;we<286;++we)Pt[we]=0;for(we=M;we<30;++we)Dt[we]=0;return rn=na(Pt,Ct,286),ic=na(Dt,zr,30),B}function Cm(C,B){if(C[0]==3&&!(C[1]&3))return[vi(B),2];for(var R=0,M=0,U=Bw(B||1<<18),W=0,te=U.length>>>0,ce=0,ee=0;!(M&1);){if(M=ke(C,R),R+=3,M>>>1)M>>1==1?(ce=9,ee=5):(R=Rs(C,R),ce=rn,ee=ic);else{R&7&&(R+=8-(R&7));var re=C[R>>>3]|C[(R>>>3)+1]<<8;if(R+=32,re>0)for(!B&&te<W+re&&(U=Er(U,W+re),te=U.length);re-- >0;)U[W++]=C[R>>>3],R+=8;continue}for(;;){!B&&te<W+32767&&(U=Er(U,W+32767),te=U.length);var ne=mt(C,R,ce),de=M>>>1==1?zt[ne]:Ct[ne];if(R+=de&15,de>>>=4,!(de>>>8&255))U[W++]=de;else{if(de==256)break;de-=257;var we=de<8?0:de-4>>2;we>5&&(we=0);var be=W+Y[de];we>0&&(be+=mt(C,R,we),R+=we),ne=mt(C,R,ee),de=M>>>1==1?In[ne]:zr[ne],R+=de&15,de>>>=4;var pe=de<4?0:de-2>>1,_e=G[de];for(pe>0&&(_e+=mt(C,R,pe),R+=pe),!B&&te<be&&(U=Er(U,be+100),te=U.length);W<be;)U[W]=U[W-_e],++W}}}return B?[U,R+7>>>3]:[U.slice(0,W),R+7>>>3]}function Sf(C,B){var R=C.slice(C.l||0),M=Cm(R,B);return C.l+=M[1],M[0]}function oc(C,B){if(C)typeof console<"u"&&console.error(B);else throw new Error(B)}function lc(C,B){var R=C;wr(R,0);var M=[],U=[],W={FileIndex:M,FullPaths:U};k(W,{root:B.root});for(var te=R.length-4;(R[te]!=80||R[te+1]!=75||R[te+2]!=5||R[te+3]!=6)&&te>=0;)--te;R.l=te+4,R.l+=4;var ce=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,te=0;te<ce;++te){R.l+=20;var re=R.read_shift(4),ne=R.read_shift(4),de=R.read_shift(2),we=R.read_shift(2),be=R.read_shift(2);R.l+=8;var pe=R.read_shift(4),_e=o(R.slice(R.l+de,R.l+de+we));R.l+=de+we+be;var Ue=R.l;R.l=pe+4,Am(R,re,ne,W,_e),R.l=Ue}return W}function Am(C,B,R,M,U){C.l+=2;var W=C.read_shift(2),te=C.read_shift(2),ce=i(C);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ee=C.read_shift(4),re=C.read_shift(4),ne=C.read_shift(4),de=C.read_shift(2),we=C.read_shift(2),be="",pe=0;pe<de;++pe)be+=String.fromCharCode(C[C.l++]);if(we){var _e=o(C.slice(C.l,C.l+we));(_e[21589]||{}).mt&&(ce=_e[21589].mt),((U||{})[21589]||{}).mt&&(ce=U[21589].mt)}C.l+=we;var Ue=C.slice(C.l,C.l+re);switch(te){case 8:Ue=V(C,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var Pt=!1;W&8&&(ee=C.read_shift(4),ee==134695760&&(ee=C.read_shift(4),Pt=!0),re=C.read_shift(4),ne=C.read_shift(4)),re!=B&&oc(Pt,"Bad compressed size: "+B+" != "+re),ne!=R&&oc(Pt,"Bad uncompressed size: "+R+" != "+ne),Gr(M,be,Ue,{unsafe:!0,mt:ce})}function cc(C,B){var R=B||{},M=[],U=[],W=oe(1),te=R.compression?8:0,ce=0,ee=0,re=0,ne=0,de=0,we=C.FullPaths[0],be=we,pe=C.FileIndex[0],_e=[],Ue=0;for(ee=1;ee<C.FullPaths.length;++ee)if(be=C.FullPaths[ee].slice(we.length),pe=C.FileIndex[ee],!(!pe.size||!pe.content||be=="Sh33tJ5")){var Pt=ne,Dt=oe(be.length);for(re=0;re<be.length;++re)Dt.write_shift(1,be.charCodeAt(re)&127);Dt=Dt.slice(0,Dt.l),_e[de]=G9.buf(pe.content,0);var Tr=pe.content;te==8&&(Tr=O(Tr)),W=oe(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ce),W.write_shift(2,te),pe.mt?s(W,pe.mt):W.write_shift(4,0),W.write_shift(-4,_e[de]),W.write_shift(4,Tr.length),W.write_shift(4,pe.content.length),W.write_shift(2,Dt.length),W.write_shift(2,0),ne+=W.length,M.push(W),ne+=Dt.length,M.push(Dt),ne+=Tr.length,M.push(Tr),W=oe(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ce),W.write_shift(2,te),W.write_shift(4,0),W.write_shift(-4,_e[de]),W.write_shift(4,Tr.length),W.write_shift(4,pe.content.length),W.write_shift(2,Dt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Pt),Ue+=W.l,U.push(W),Ue+=Dt.length,U.push(Dt),++de}return W=oe(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,de),W.write_shift(2,de),W.write_shift(4,Ue),W.write_shift(4,ne),W.write_shift(2,0),hr([hr(M),hr(U),W])}var gn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pm(C,B){if(C.ctype)return C.ctype;var R=C.name||"",M=R.match(/\.([^\.]+)$/);return M&&gn[M[1]]||B&&(M=(R=B).match(/[\.\\]([^\.\\])+$/),M&&gn[M[1]])?gn[M[1]]:"application/octet-stream"}function Fe(C){for(var B=Du(C),R=[],M=0;M<B.length;M+=76)R.push(B.slice(M,M+76));return R.join(`\r
`)+`\r
`}function st(C){var B=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],M=B.split(`\r
`),U=0;U<M.length;++U){var W=M[U];if(W.length==0){R.push("");continue}for(var te=0;te<W.length;){var ce=76,ee=W.slice(te,te+ce);ee.charAt(ce-1)=="="?ce--:ee.charAt(ce-2)=="="?ce-=2:ee.charAt(ce-3)=="="&&(ce-=3),ee=W.slice(te,te+ce),te+=ce,te<W.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function pt(C){for(var B=[],R=0;R<C.length;++R){for(var M=C[R];R<=C.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+C[++R];B.push(M)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return kn(B.join(`\r
`))}function vn(C,B,R){for(var M="",U="",W="",te,ce=0;ce<10;++ce){var ee=B[ce];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":M=re[2].trim();break;case"content-type":W=re[2].trim();break;case"content-transfer-encoding":U=re[2].trim();break}}switch(++ce,U.toLowerCase()){case"base64":te=kn(Dn(B.slice(ce).join("")));break;case"quoted-printable":te=pt(B.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ne=Gr(C,M.slice(R.length),te,{unsafe:!0});W&&(ne.ctype=W)}function yn(C,B){if(P(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=B&&B.root||"",M=(Ge&&Buffer.isBuffer(C)?C.toString("binary"):P(C)).split(`\r
`),U=0,W="";for(U=0;U<M.length;++U)if(W=M[U],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),R||(R=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),W.slice(0,R.length)!=R););var te=(M[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var ce="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};k(ne);var de,we=0;for(U=0;U<M.length;++U){var be=M[U];be!==ce&&be!==ce+"--"||(we++&&vn(ne,M.slice(de,U),R),de=U)}return ne}function Pa(C,B){var R=B||{},M=R.boundary||"SheetJS";M="------="+M;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],W=C.FullPaths[0],te=W,ce=C.FileIndex[0],ee=1;ee<C.FullPaths.length;++ee)if(te=C.FullPaths[ee].slice(W.length),ce=C.FileIndex[ee],!(!ce.size||!ce.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=Ge&&Buffer.isBuffer(re)?re.toString("binary"):P(re),de=0,we=Math.min(1024,ne.length),be=0,pe=0;pe<=we;++pe)(be=ne.charCodeAt(pe))>=32&&be<128&&++de;var _e=de>=we*4/5;U.push(M),U.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+te),U.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),U.push("Content-Type: "+Pm(ce,te)),U.push(""),U.push(_e?st(ne):Fe(ne))}return U.push(M+`--\r
`),U.join(`\r
`)}function rs(C){var B={};return k(B,C),B}function Gr(C,B,R,M){var U=M&&M.unsafe;U||k(C);var W=!U&&Ae.find(C,B);if(!W){var te=C.FullPaths[0];B.slice(0,te.length)==te?te=B:(te.slice(-1)!="/"&&(te+="/"),te=(te+B).replace("//","/")),W={name:a(B),type:2},C.FileIndex.push(W),C.FullPaths.push(te),U||Ae.utils.cfb_gc(C)}return W.content=R,W.size=R?R.length:0,M&&(M.CLSID&&(W.clsid=M.CLSID),M.mt&&(W.mt=M.mt),M.ct&&(W.ct=M.ct)),W}function Da(C,B){k(C);var R=Ae.find(C,B);if(R){for(var M=0;M<C.FileIndex.length;++M)if(C.FileIndex[M]==R)return C.FileIndex.splice(M,1),C.FullPaths.splice(M,1),!0}return!1}function g3(C,B,R){k(C);var M=Ae.find(C,B);if(M){for(var U=0;U<C.FileIndex.length;++U)if(C.FileIndex[U]==M)return C.FileIndex[U].name=a(R),C.FullPaths[U]=R,!0}return!1}function v3(C){N(C,!0)}return t.find=H,t.read=E,t.parse=f,t.write=Z,t.writeFile=F,t.utils={cfb_new:rs,cfb_add:Gr,cfb_del:Da,cfb_mov:g3,cfb_gc:v3,ReadShift:Xc,CheckField:RN,prep_blob:wr,bconcat:hr,use_zlib:D,_deflateRaw:Be,_inflateRaw:Sf,consts:X},t}();function Y9(e){return typeof e=="string"?ym(e):Array.isArray(e)?x9(e):e}function mf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ym(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?za(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Y9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ni(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function X9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Vt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yw(e,t){for(var r=[],n=Vt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function wm(e){for(var t=[],r=Vt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function _m(e){for(var t=[],r=Vt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function K9(e){for(var t=[],r=Vt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var mh=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=mh.getTime()+(e.getTimezoneOffset()-mh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var dN=new Date,q9=mh.getTime()+(dN.getTimezoneOffset()-mh.getTimezoneOffset())*6e4,Xw=dN.getTimezoneOffset();function Sm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+q9),t.getTimezoneOffset()!==Xw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Xw)*6e4),t}function Q9(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Kw=new Date("2017-02-19T19:06:09.000Z"),hN=isNaN(Kw.getFullYear())?new Date("2/19/17"):Kw,J9=hN.getFullYear()==2017;function bt(e,t){var r=new Date(e);if(J9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(hN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function go(e,t){if(Ge&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return za(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return za(eN(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return za(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return za(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Et(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Et(e[r]));return t}function Wt(e,t){for(var r="";r.length<t;)r+=e;return r}function _a(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Z9=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ol(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Z9.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var eB=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function mN(e){return e?e.content&&e.type?go(e.content,!0):e.data?Rc(e.data):e.asNodeBuffer&&Ge?Rc(e.asNodeBuffer().toString("binary")):e.asBinary?Rc(e.asBinary()):e._data&&e._data.getContent?Rc(go(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function pN(e){if(!e)return null;if(e.data)return Fw(e.data);if(e.asNodeBuffer&&Ge)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Fw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function tB(e){return e&&e.name.slice(-4)===".bin"?pN(e):mN(e)}function $n(e,t){for(var r=e.FullPaths||Vt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Iv(e,t){var r=$n(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Zt(e,t,r){if(!r)return tB(Iv(e,t));if(!t)return null;try{return Zt(e,t)}catch{return null}}function bn(e,t,r){if(!r)return mN(Iv(e,t));if(!t)return null;try{return bn(e,t)}catch{return null}}function rB(e,t,r){return pN(Iv(e,t))}function qw(e){for(var t=e.FullPaths||Vt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ge?n=As(r):n=w9(r),Ae.utils.cfb_add(e,t,n)}Ae.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ov(){return Ae.utils.cfb_new()}function gN(e,t){switch(t.type){case"base64":return Ae.read(e,{type:"base64"});case"binary":return Ae.read(e,{type:"binary"});case"buffer":case"array":return Ae.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ic(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,nB=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Qw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,aB=/<[^>]*>/g,Wr=qt.match(Qw)?Qw:aB,sB=/<\w*:/,iB=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(nB),o=0,l="",u=0,f="",d="",m=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(m=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+m,d.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[h]&&f.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function es(e){return e.replace(iB,"<$1")}var vN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fv=wm(vN),et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return vN[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Lv=/[&<>'"]/g,oB=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(Lv,function(r){return Fv[r]}).replace(oB,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Jw(e){return ft(e).replace(/ /g,"_x0020_")}var yN=/[\u0000-\u001f]/g;function Bv(e){var t=e+"";return t.replace(Lv,function(r){return Fv[r]}).replace(/\n/g,"<br/>").replace(yN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function lB(e){var t=e+"";return t.replace(Lv,function(r){return Fv[r]}).replace(yN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Zw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function cB(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mp(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function e2(e){var t=vi(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function t2(e){return As(e,"binary").toString("utf8")}var Zf="foo bar bazâð£",ht=Ge&&(t2(Zf)==Mp(Zf)&&t2||e2(Zf)==Mp(Zf)&&e2)||Mp,za=Ge?function(e){return As(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ru=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),xN=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),uB=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),fB=/<\/?(?:vt:)?variant>/g,dB=/<(?:vt:)([^>]*)>([\s\S]*)</;function r2(e,t){var r=Oe(e),n=e.match(uB(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(fB,"").match(dB);i&&a.push({v:ht(i[2]),t:i[1]})}),a}var wN=/(^\s|\s$|\n)/;function _r(e,t){return"<"+e+(t.match(wN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Mu(e){return Vt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ve(e,t,r){return"<"+e+(r!=null?Mu(r):"")+(t!=null?(t.match(wN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function gg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function hB(e,t){switch(typeof e){case"string":var r=ve("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ve((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return ve("vt:bool",e?"true":"false")}if(e instanceof Date)return ve("vt:filetime",gg(e));throw new Error("Unable to serialize "+e)}function Uv(e){if(Ge&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ht(Ni(jv(e)));throw new Error("Bad input format: expected Buffer or string")}var Iu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Co=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function mB(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function pB(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var n2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},a2=Ge?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:As(t)})):n2(e)}:n2,s2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ms(e,a)));return n.join("").replace(Zr,"")},$v=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):s2(e,t,r)}:s2,i2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},_N=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):i2(e,t,r)}:i2,o2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ho(e,a)));return n.join("")},pf=Ge?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):o2(t,r,n)}:o2,SN=function(e,t){var r=Sn(e,t);return r>0?pf(e,t+4,t+4+r-1):""},kN=SN,bN=function(e,t){var r=Sn(e,t);return r>0?pf(e,t+4,t+4+r-1):""},EN=bN,TN=function(e,t){var r=2*Sn(e,t);return r>0?pf(e,t+4,t+4+r-1):""},NN=TN,CN=function(t,r){var n=Sn(t,r);return n>0?$v(t,r+4,r+4+n):""},AN=CN,PN=function(e,t){var r=Sn(e,t);return r>0?pf(e,t+4,t+4+r):""},DN=PN,jN=function(e,t){return mB(e,t)},ph=jN,Wv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ge&&(kN=function(t,r){if(!Buffer.isBuffer(t))return SN(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},EN=function(t,r){if(!Buffer.isBuffer(t))return bN(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NN=function(t,r){if(!Buffer.isBuffer(t))return TN(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},AN=function(t,r){if(!Buffer.isBuffer(t))return CN(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},DN=function(t,r){if(!Buffer.isBuffer(t))return PN(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ph=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):jN(t,r)},Wv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ho=function(e,t){return e[t]},ms=function(e,t){return e[t+1]*256+e[t]},gB=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Sn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},vB=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xc(e,t){var r="",n,a,s=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ms(this,u)),u+=2;e*=2;break;case"utf8":r=pf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$v(this,this.l,this.l+e);break;case"wstr":return Xc.call(this,e,"dbcs");case"lpstr-ansi":r=kN(this,this.l),e=4+Sn(this,this.l);break;case"lpstr-cp":r=EN(this,this.l),e=4+Sn(this,this.l);break;case"lpwstr":r=NN(this,this.l),e=4+2*Sn(this,this.l);break;case"lpp4":e=4+Sn(this,this.l),r=AN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Sn(this,this.l),r=DN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ho(this,this.l+e++))!==0;)s.push(Jf(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=ms(this,this.l+e))!==0;)s.push(Jf(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ho(this,u),this.l=u+1,o=Xc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Jf(ms(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ho(this,u),this.l=u+1,o=Xc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Jf(Ho(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Ho(this,this.l),this.l++,n;case 2:return n=(t==="i"?gB:ms)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Mi:vB)(this,this.l),this.l+=4,n):(a=Sn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ph(this,this.l):a=ph([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=_N(this,this.l,e);break}}return this.l+=e,r}var yB=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},xB=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},wB=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function _B(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)wB(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yB(this,t,this.l);break;case 8:if(n=8,r==="f"){pB(this,t,this.l);break}case 16:break;case-4:n=4,xB(this,t,this.l);break}return this.l+=n,this}function RN(e,t){var r=_N(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=Xc,e.chk=RN,e.write_shift=_B}function $r(e,t){e.l+=t}function oe(e){var t=vi(e);return wr(t,0),t}function Ps(e,t,r){if(e){var n,a,s;wr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=$u[o]||$u[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=u.f&&u.f(e,s,r);if(e.l=l,t(f,u,o))return}}}function dn(){var e=[],t=Ge?256:2048,r=function(u){var f=oe(u);return wr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),hr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function fe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=$u[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Wv(r)&&e.push(r)}}function Kc(e,t,r){var n=Et(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function l2(e,t,r){var n=Et(e);return n.s=Kc(n.s,t.s,r),n.e=Kc(n.e,t.s,r),n}function qc(e,t){if(e.cRel&&e.c<0)for(e=Et(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Et(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Re(e);return!e.cRel&&e.cRel!=null&&(r=bB(r)),!e.rRel&&e.rRel!=null&&(r=SB(r)),r}function Ip(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mt(e.s.c)+":"+(e.e.cRel?"":"$")+Mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Kt(e.s.r)+":"+(e.e.rRel?"":"$")+Kt(e.e.r):qc(e.s,t.biff)+":"+qc(e.e,t.biff)}function Hv(e){return parseInt(kB(e),10)-1}function Kt(e){return""+(e+1)}function SB(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function kB(e){return e.replace(/\$(\d+)$/,"$1")}function Vv(e){for(var t=EB(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bB(e){return e.replace(/^([A-Z])/,"$$$1")}function EB(e){return e.replace(/^\$([A-Z])/,"$1")}function TB(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function It(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Re(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function mn(e){var t=e.indexOf(":");return t==-1?{s:It(e),e:It(e)}:{s:It(e.slice(0,t)),e:It(e.slice(t+1))}}function He(e,t){return typeof t>"u"||typeof t=="number"?He(e.s,e.e):(typeof e!="string"&&(e=Re(e)),typeof t!="string"&&(t=Re(t)),e==t?e:e+":"+t)}function rt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function c2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ta(e.z,r?or(t):t)}catch{}try{return e.w=ta((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function Ns(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ds[e.v]||e.v:t==null?c2(e,e.v):c2(e,t))}function Ci(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function MN(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?It(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=rt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var h={v:t[d][m]},g=i+d,p=o+m;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))h=t[d][m];else if(Array.isArray(h.v)&&(h.f=t[d][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||je[14],n.cellDates?(h.t="d",h.w=ta(h.z,or(h.v))):(h.t="n",h.v=or(h.v),h.w=ta(h.z,h.v))):h.t="s";if(a)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(h.z=s[g][p].z),s[g][p]=h;else{var y=Re({c:p,r:g});s[y]&&s[y].z&&(h.z=s[y].z),s[y]=h}}}return u.s.c<1e7&&(s["!ref"]=He(u)),s}function ac(e,t){return MN(null,e,t)}function NB(e){return e.read_shift(4,"i")}function Sa(e,t){return t||(t=oe(4)),t.write_shift(4,e),t}function Br(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function mr(e,t){var r=!1;return t==null&&(r=!0,t=oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function CB(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function AB(e,t){return t||(t=oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function zv(e,t){var r=e.l,n=e.read_shift(1),a=Br(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(CB(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function PB(e,t){var r=!1;return t==null&&(r=!0,t=oe(15+4*e.t.length)),t.write_shift(1,0),mr(e.t,t),r?t.slice(0,t.l):t}var DB=zv;function jB(e,t){var r=!1;return t==null&&(r=!0,t=oe(23+4*e.t.length)),t.write_shift(1,1),mr(e.t,t),t.write_shift(4,1),AB({},t),r?t.slice(0,t.l):t}function ra(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ao(e,t){return t==null&&(t=oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Po(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Do(e,t){return t==null&&(t=oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var RB=Br,IN=mr;function Gv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function gh(e,t){var r=!1;return t==null&&(r=!0,t=oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var MB=Br,vg=Gv,Yv=gh;function Xv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ph([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Mi(t,0)>>2;return r?a/100:a}function ON(e,t){t==null&&(t=oe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function FN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function IB(e,t){return t||(t=oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var jo=FN,sc=IB;function Fr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function vo(e,t){return(t||oe(8)).write_shift(8,e,"f")}function OB(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Qi[a];u&&(t.rgb=Fu(u));break;case 2:t.rgb=Fu([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function vh(e,t){if(t||(t=oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function FB(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function LB(e,t){t||(t=oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function LN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function BB(e){return LN(e,1)}function UB(e){return LN(e,2)}var Kv=2,an=3,ed=11,u2=12,yh=19,td=64,$B=65,WB=71,HB=4108,VB=4126,ur=80,BN=81,zB=[ur,BN],yg={1:{n:"CodePage",t:Kv},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:ed},12:{n:"HeadingPairs",t:HB},13:{n:"TitlesOfParts",t:VB},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:ed},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:ed},22:{n:"HyperlinksChanged",t:ed},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:$B},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:yh},2147483651:{n:"Behavior",t:yh},1919054434:{}},xg={1:{n:"CodePage",t:Kv},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:td},11:{n:"LastPrinted",t:td},12:{n:"CreatedDate",t:td},13:{n:"ModifiedDate",t:td},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:WB},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:yh},2147483651:{n:"Behavior",t:yh},1919054434:{}},f2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},GB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function YB(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var XB=YB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qi=Et(XB),Ds={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},UN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},rd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function KB(e){var t=qv();if(!e||!e.match)return t;var r={};if((e.match(Wr)||[]).forEach(function(n){var a=Oe(n);switch(a[0].replace(sB,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[wg[a.ContentType]]!==void 0&&t[wg[a.ContentType]].push(a.PartName);break}}),t.xmlns!==sr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $N(e,t){var r=K9(wg),n=[],a;n[n.length]=qt,n[n.length]=ve("Types",null,{xmlns:sr.CT,"xmlns:xsd":sr.xsd,"xmlns:xsi":sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ve("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=ve("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:rd[l][t.bookType]||rd[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:rd[l][t.bookType]||rd[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ye={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ou(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Qc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Wr)||[]).forEach(function(a){var s=Oe(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ic(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function hl(e){var t=[qt,ve("Relationships",null,{xmlns:sr.RELS})];return Vt(e["!id"]).forEach(function(r){t[t.length]=ve("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ct(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ye.HLINK,Ye.XPATH,Ye.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var qB="application/vnd.oasis.opendocument.spreadsheet";function QB(e,t){for(var r=Uv(e),n,a;n=Iu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Oe(n[0],!1),a.path=="/"&&a.type!==qB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function JB(e){var t=[qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function d2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ZB(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function eU(e){var t=[qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(d2(e[r][0],e[r][1])),t.push(ZB("",e[r][0]));return t.push(d2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function WN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+uh.version+"</meta:generator></office:meta></office:document-meta>"}var Kn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tU=function(){for(var e=new Array(Kn.length),t=0;t<Kn.length;++t){var r=Kn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function HN(e){var t={};e=ht(e);for(var r=0;r<Kn.length;++r){var n=Kn[r],a=e.match(tU[r]);a!=null&&a.length>0&&(t[n[1]]=et(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=bt(t[n[1]]))}return t}function Op(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=ft(t),n[n.length]=r?ve(e,t,r):_r(e,t))}function VN(e,t){var r=t||{},n=[qt,ve("cp:coreProperties",null,{"xmlns:cp":sr.CORE_PROPS,"xmlns:dc":sr.dc,"xmlns:dcterms":sr.dcterms,"xmlns:dcmitype":sr.dcmitype,"xmlns:xsi":sr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Op("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:gg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Op("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:gg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Kn.length;++s){var i=Kn[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Op(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ji=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function GN(e,t,r,n){var a=[];if(typeof e=="string")a=r2(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?r2(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function rU(e,t,r){var n={};return t||(t={}),e=ht(e),Ji.forEach(function(a){var s=(e.match(Ru(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=et(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&GN(n.HeadingPairs,n.TitlesOfParts,t,r),t}function YN(e){var t=[],r=ve;return e||(e={}),e.Application="SheetJS",t[t.length]=qt,t[t.length]=ve("Properties",null,{xmlns:sr.EXT_PROPS,"xmlns:vt":sr.vt}),Ji.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=ft(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nU=/<[^>]+>[^<]*/g;function aU(e,t){var r={},n="",a=e.match(nU);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=et(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=et(f);break;case"bool":r[n]=wt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=bt(f);break;case"cy":case"error":r[n]=et(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function XN(e){var t=[qt,ve("Properties",null,{xmlns:sr.CUST_PROPS,"xmlns:vt":sr.vt})];if(!e)return t.join("");var r=1;return Vt(e).forEach(function(a){++r,t[t.length]=ve("property",hB(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _g={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fp;function sU(e,t,r){Fp||(Fp=wm(_g)),t=Fp[t]||t,e[t]=r}function iU(e,t){var r=[];return Vt(_g).map(function(n){for(var a=0;a<Kn.length;++a)if(Kn[a][1]==n)return Kn[a];for(a=0;a<Ji.length;++a)if(Ji[a][1]==n)return Ji[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(_r(_g[n[1]]||n[1],a))}}),ve("DocumentProperties",r.join(""),{xmlns:_n.o})}function oU(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Vt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Kn.length;++i)if(s==Kn[i][1])return;for(i=0;i<Ji.length;++i)if(s==Ji[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(ve(Jw(s),o,{"dt:dt":l}))}}),t&&Vt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ve(Jw(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+_n.o+'">'+a.join("")+"</"+n+">"}function Qv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function lU(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=oe(8);return i.write_shift(4,n),i.write_shift(4,a),i}function KN(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function qN(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function QN(e,t,r){return t===31?qN(e):KN(e,t,r)}function Sg(e,t,r){return QN(e,t,r===!1?0:4)}function cU(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return QN(e,t,0)}function uU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-a&2&&(e.l+=2)}return r}function fU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function dU(e){var t=e.l,r=xh(e,BN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=xh(e,an);return[r,n]}function hU(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(dU(e));return r}function h2(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zr,"").replace(Mc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function JN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function mU(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function xh(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==u2&&n!==t&&zB.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===u2?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return KN(e,n,4).replace(Zr,"");case 31:return qN(e);case 64:return Qv(e);case 65:return JN(e);case 71:return mU(e);case 80:return Sg(e,n,!s.raw).replace(Zr,"");case 81:return cU(e,n).replace(Zr,"");case 4108:return hU(e);case 4126:case 4127:return n==4127?uU(e):fU(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function m2(e,t){var r=oe(4),n=oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=lU(t);break;case 31:case 80:for(n=oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return hr([r,n])}function p2(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,u={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(x,w){return x[1]-w[1]});var m={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[s[i][0]];if(m[g.n]=xh(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ga(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(s[i][0]===1){if(o=m.CodePage=xh(e,Kv),ga(o),l!==-1){var p=e.l;e.l=s[l][1],u=h2(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}u=h2(e,o)}else{var y=u[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=JN(e);break;case 30:e.l+=4,v=Sg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Sg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Gt(e,4);break;case 64:e.l+=4,v=bt(Qv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[y]=v}}return e.l=r+n,m}var ZN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function pU(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function g2(e,t,r){var n=oe(8),a=[],s=[],i=8,o=0,l=oe(8),u=oe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),a.push(u),i+=8+l.length,!t){u=oe(8),u.write_shift(4,0),a.unshift(u);var f=[oe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=oe(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=hr(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(ZN.indexOf(e[o][0])>-1||zN.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],h=0;if(t){h=+t[e[o][0]];var g=r[h];if(g.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}l=m2(g.t,m)}else{var y=pU(m);y==-1&&(y=31,m=String(m)),l=m2(y,m)}s.push(l),u=oe(8),u.write_shift(4,t?h:2+o),a.push(u),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),hr([n].concat(a).concat(s))}function v2(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Ae.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=p2(n,t),m={SystemIdentifier:u};for(var h in d)m[h]=d[h];if(m.FMTID=s,a===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=p2(n,null)}catch{}for(h in g)m[h]=g[h];return m.FMTID=[s,i],m}function y2(e,t,r,n,a,s){var i=oe(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ae.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=g2(e,r,n);if(o.push(l),a){var u=g2(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(u)}return hr(o)}function Bs(e,t){return e.read_shift(t),null}function gU(e,t){t||(t=oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function vU(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Gt(e,t){return e.read_shift(t)===1}function qr(e,t){return t||(t=oe(2)),t.write_shift(2,+!!e),t}function er(e){return e.read_shift(2,"u")}function Hn(e,t){return t||(t=oe(2)),t.write_shift(2,e),t}function eC(e,t){return vU(e,t,er)}function yU(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tC(e,t,r){return r||(r=oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function gf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function xU(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function wU(e){var t=e.t||"",r=oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return hr(a)}function yo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function vf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yo(e,n,r)}function Ro(e,t,r){if(r.biff>5)return vf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rC(e,t,r){return r||(r=oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function _U(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function SU(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zr,"");return n&&(e.l+=24),a}function kU(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Zr,"");return r+i}function bU(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return SU(e);case"0303000000000000c000000000000046":return kU(e);default:throw new Error("Unsupported Moniker "+r)}}function nd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function x2(e,t){t||(t=oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function EU(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,u="",f,d;a&16&&(s=nd(e,r-e.l)),a&128&&(i=nd(e,r-e.l)),(a&257)===257&&(o=nd(e,r-e.l)),(a&257)===1&&(l=bU(e,r-e.l)),a&8&&(u=nd(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Qv(e)),e.l=r;var m=i||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return f&&(h.guid=f),d&&(h.time=d),s&&(h.Tooltip=s),h}function TU(e){var t=oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),x2(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&x2(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function nC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function aC(e,t){var r=nC(e);return r[3]=0,r}function ts(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function xo(e,t,r,n){return n||(n=oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function NU(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function CU(e,t,r){return t===0?"":Ro(e,t,r)}function AU(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function sC(e){var t=e.read_shift(2),r=Xv(e);return[t,r]}function PU(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=gf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function km(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function iC(e,t){return t||(t=oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function oC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var DU=oC;function lC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function jU(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function RU(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Pr(e){e.l+=2,e.l+=e.read_shift(2)}var MU={0:Pr,4:Pr,5:Pr,6:Pr,7:RU,8:Pr,9:Pr,10:Pr,11:Pr,12:Pr,13:jU,14:Pr,15:Pr,16:Pr,17:Pr,18:Pr,19:Pr,20:Pr,21:lC};function IU(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(MU[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ad(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Jv(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=oe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function OU(e,t){return t===0||e.read_shift(2),1200}function FU(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ro(e,0,r);return e.read_shift(t+n-e.l),a}function LU(e,t){var r=!t||t.biff==8,n=oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function BU(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function UU(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=gf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function $U(e,t){var r=!t||t.biff>=8?2:1,n=oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function WU(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(xU(e));return s.Count=n,s.Unique=a,s}function HU(e,t){var r=oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=wU(e[a]);var s=hr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function VU(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function zU(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function GU(e){var t=NU(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function YU(e){return e.read_shift(2),e.read_shift(4)}function w2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function XU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function KU(){var e=oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function qU(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function QU(e){var t=oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function JU(){}function ZU(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=gf(e,0,r),n}function e$(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=oe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function t$(e){var t=ts(e);return t.isst=e.read_shift(4),t}function r$(e,t,r,n){var a=oe(10);return xo(e,t,n,a),a.write_shift(4,r),a}function n$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ts(e);r.biff==2&&e.l++;var s=vf(e,n-e.l,r);return a.val=s,a}function a$(e,t,r,n,a){var s=!a||a.biff==8,i=oe(8+ +s+(1+s)*r.length);return xo(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function s$(e,t,r){var n=e.read_shift(2),a=Ro(e,0,r);return[n,a]}function i$(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var o$=Ro;function _2(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function l$(e,t){var r=t.biff==8||!t.biff?4:2,n=oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function c$(e){var t=e.read_shift(2),r=e.read_shift(2),n=sC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function u$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(sC(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function f$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function d$(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=GB[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function h$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=d$(e,t,n.fStyle,r),n}function S2(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function m$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function p$(e){var t=oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function k2(e,t,r){var n=ts(e);(r.biff==2||t==9)&&++e.l;var a=yU(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function g$(e,t,r,n,a,s){var i=oe(8);return xo(e,t,n,i),tC(r,s,i),i}function v$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ts(e),a=Fr(e);return n.val=a,n}function y$(e,t,r,n){var a=oe(14);return xo(e,t,n,a),vo(r,a),a}var b2=CU;function x$(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=yo(e,s),o=[];n>e.l;)o.push(vf(e));return[s,a,i,o]}function E2(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=PU(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var w$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function T2(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=yo(e,i,r);a&32&&(u=w$[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:Iz(e,f,r,o);return{chKey:s,Name:u,itab:l,rgce:d}}function cC(e,t,r){if(r.biff<8)return _$(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(AU(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function _$(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=gf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function S$(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=yo(e,n,r),i=yo(e,a,r);return[s,i]}function k$(e,t,r){var n=oC(e);e.l++;var a=e.read_shift(1);return t-=8,[Oz(e,t,r),a,n]}function N2(e,t,r){var n=DU(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Rz(e,t,r)]}function b$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function E$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ro(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function T$(e,t,r){return E$(e,t,r)}function N$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(km(e));return r}function C$(e){var t=oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)iC(e[r],t);return t}function A$(e,t,r){if(r&&r.biff<8)return D$(e,t,r);var n=lC(e),a=IU(e,t-22,n[1]);return{cmo:n,ft:a}}var P$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function D$(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((P$[n]||$r)(e,t,r)),{cmo:[a,n,s],ft:i}}function j$(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=_U(e,6,r);var o=e.read_shift(2);e.read_shift(2),er(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=yo(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function R$(e,t){var r=km(e);e.l+=16;var n=EU(e,t-24);return[r,n]}function M$(e){var t=oe(24),r=It(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return hr([t,TU(e[1])])}function I$(e,t){e.read_shift(2);var r=km(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function O$(e){var t=e[1].Tooltip,r=oe(10+2*(t.length+1));r.write_shift(2,2048);var n=It(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function F$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=f2[r]||r,r=e.read_shift(2),t[1]=f2[r]||r,t}function L$(e){return e||(e=oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function B$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aC(e));return r}function U$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aC(e));return r}function $$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function uC(e,t,r){if(!r.cellStyles)return $r(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function W$(e,t){var r=oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function H$(e,t){var r={};return t<32||(e.l+=16,r.header=Fr(e),r.footer=Fr(e),e.l+=2),r}function V$(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function z$(e){for(var t=oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var G$=ts,Y$=eC,X$=vf;function K$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function q$(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ts(e);++e.l;var a=Ro(e,t-7,r);return n.t="str",n.val=a,n}function Q$(e){var t=ts(e);++e.l;var r=Fr(e);return t.t="n",t.val=r,t}function J$(e,t,r){var n=oe(15);return _f(n,e,t),n.write_shift(8,r,"f"),n}function Z$(e){var t=ts(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function eW(e,t,r){var n=oe(9);return _f(n,e,t),n.write_shift(2,r),n}function tW(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function rW(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function nW(e,t,r){var n=e.l+t,a=ts(e),s=e.read_shift(2),i=yo(e,s,r);return e.l=n,a.t="str",a.val=i,a}var aW=[2,3,48,49,131,139,140,245],kg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=vi(1);switch(l.type){case"base64":f=kn(Dn(o));break;case"binary":f=kn(o);break;case"buffer":case"array":f=o;break}wr(f,0);var d=f.read_shift(1),m=!!(d&136),h=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,y=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(y=f.read_shift(2));var v=f.read_shift(2),x=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(x=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var w=[],S={},b=Math.min(f.length,d==2?521:y-10-(h?264:0)),E=g?32:11;f.l<b&&f[f.l]!=13;)switch(S={},S.name=Pu.utils.decode(x,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&w.push(S),d!=2&&(f.l+=g?13:14),S.type){case"B":(!h||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var k=0,T=0;for(u[0]=[],T=0;T!=w.length;++T)u[0][T]=w[T].name;for(;p-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,u[++k]=[],T=0,T=0;T!=w.length;++T){var N=f.slice(f.l,f.l+w[T].len);f.l+=w[T].len,wr(N,0);var I=Pu.utils.decode(x,N);switch(w[T].type){case"C":I.trim().length&&(u[k][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[k][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[k][T]=I;break;case"F":u[k][T]=parseFloat(I.trim());break;case"+":case"I":u[k][T]=g?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[k][T]=!0;break;case"N":case"F":u[k][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][T]="##MEMO##"+(g?parseInt(I.trim(),10):N.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[k][T]=+I||0);break;case"@":u[k][T]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":u[k][T]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":u[k][T]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][T]=-N.read_shift(-8,"f");break;case"B":if(h&&w[T].len==8){u[k][T]=N.read_shift(8,"f");break}case"G":case"P":N.l+=w[T].len;break;case"0":if(w[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=w,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=ac(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,l){try{return Ci(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&ga(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=dn(),d=Sh(o,{header:1,raw:!0,cellDates:!0}),m=d[0],h=d.slice(1),g=o["!cols"]||[],p=0,y=0,v=0,x=1;for(p=0;p<m.length;++p){if(((g[p]||{}).DBF||{}).name){m[p]=g[p].DBF.name,++v;continue}if(m[p]!=null){if(++v,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(y=0;y<1024;++y)if(m.indexOf(m[p]+"_"+y)==-1){m[p]+="_"+y;break}}}}var w=rt(o["!ref"]),S=[],b=[],E=[];for(p=0;p<=w.e.c-w.s.c;++p){var k="",T="",N=0,I=[];for(y=0;y<h.length;++y)h[y][p]!=null&&I.push(h[y][p]);if(I.length==0||m[p]==null){S[p]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[y]instanceof Date?"D":"C";break;default:T="C"}N=Math.max(N,String(I[y]).length),k=k&&k!=T?"C":T}N>250&&(N=250),T=((g[p]||{}).DBF||{}).type,T=="C"&&g[p].DBF.len>N&&(N=g[p].DBF.len),k=="B"&&T=="N"&&(k="N",E[p]=g[p].DBF.dec,N=g[p].DBF.len),b[p]=k=="C"||T=="N"?N:s[k]||0,x+=b[p],S[p]=k}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,h.length),H.write_shift(2,296+32*v),H.write_shift(2,x),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+t[ZT]||3)<<8),p=0,y=0;p<m.length;++p)if(m[p]!=null){var j=f.next(32),z=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,z,"sbcs"),j.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),j.write_shift(4,y),j.write_shift(1,b[p]||s[S[p]]||0),j.write_shift(1,E[p]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),y+=b[p]||s[S[p]]||0}var K=f.next(264);for(K.write_shift(4,13),p=0;p<65;++p)K.write_shift(4,0);for(p=0;p<h.length;++p){var q=f.next(x);for(q.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(S[y]){case"L":q.write_shift(1,h[p][y]==null?63:h[p][y]?84:70);break;case"B":q.write_shift(8,h[p][y]||0,"f");break;case"N":var Q="0";for(typeof h[p][y]=="number"&&(Q=h[p][y].toFixed(E[y]||0)),v=0;v<b[y]-Q.length;++v)q.write_shift(1,32);q.write_shift(1,Q,"sbcs");break;case"D":h[p][y]?(q.write_shift(4,("0000"+h[p][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(h[p][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+h[p][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var X=String(h[p][y]!=null?h[p][y]:"").slice(0,b[y]);for(q.write_shift(1,X,"sbcs"),v=0;v<b[y]-X.length;++v)q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),fC=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Vt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var g=e[h];return typeof g=="number"?Lw(g):g},n=function(m,h,g){var p=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?m:Lw(p)};e["|"]=254;function a(m,h){switch(h.type){case"base64":return s(Dn(m),h);case"binary":return s(m,h);case"buffer":return s(Ge&&Buffer.isBuffer(m)?m.toString("binary"):Ni(m),h);case"array":return s(go(m),h)}throw new Error("Unrecognized type "+h.type)}function s(m,h){var g=m.split(/[\n\r]+/),p=-1,y=-1,v=0,x=0,w=[],S=[],b=null,E={},k=[],T=[],N=[],I=0,H;for(+h.codepage>=0&&ga(+h.codepage);v!==g.length;++v){I=0;var j=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=j.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),K=z[0],q;if(j.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&S.push(j.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,X=!1,F=!1,P=!1,Z=-1,le=-1;for(x=1;x<z.length;++x)switch(z[x].charAt(0)){case"A":break;case"X":y=parseInt(z[x].slice(1))-1,X=!0;break;case"Y":for(p=parseInt(z[x].slice(1))-1,X||(y=0),H=w.length;H<=p;++H)w[H]=[];break;case"K":q=z[x].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(_a(q))?isNaN(Ol(q).getDate())||(q=bt(q)):(q=_a(q),b!==null&&rc(b)&&(q=Sm(q))),Q=!0;break;case"E":P=!0;var D=ml(z[x].slice(1),{r:p,c:y});w[p][y]=[w[p][y],D];break;case"S":F=!0,w[p][y]=[w[p][y],"S5S"];break;case"G":break;case"R":Z=parseInt(z[x].slice(1))-1;break;case"C":le=parseInt(z[x].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(Q&&(w[p][y]&&w[p][y].length==2?w[p][y][0]=q:w[p][y]=q,b=null),F){if(P)throw new Error("SYLK shared formula cannot have own formula");var V=Z>-1&&w[Z][le];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");w[p][y][1]=AC(V[1],{r:p-Z,c:y-le})}break;case"F":var O=0;for(x=1;x<z.length;++x)switch(z[x].charAt(0)){case"X":y=parseInt(z[x].slice(1))-1,++O;break;case"Y":for(p=parseInt(z[x].slice(1))-1,H=w.length;H<=p;++H)w[H]=[];break;case"M":I=parseInt(z[x].slice(1))/20;break;case"F":break;case"G":break;case"P":b=S[parseInt(z[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=z[x].slice(1).split(" "),H=parseInt(N[0],10);H<=parseInt(N[1],10);++H)I=parseInt(N[2],10),T[H-1]=I===0?{hidden:!0}:{wch:I},yi(T[H-1]);break;case"C":y=parseInt(z[x].slice(1))-1,T[y]||(T[y]={});break;case"R":p=parseInt(z[x].slice(1))-1,k[p]||(k[p]={}),I>0?(k[p].hpt=I,k[p].hpx=Ll(I)):I===0&&(k[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}O<1&&(b=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return k.length>0&&(E["!rows"]=k),T.length>0&&(E["!cols"]=T),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,E]}function i(m,h){var g=a(m,h),p=g[0],y=g[1],v=ac(p,h);return Vt(y).forEach(function(x){v[x]=y[x]}),v}function o(m,h){return Ci(i(m,h),h)}function l(m,h,g,p){var y="C;Y"+(g+1)+";X"+(p+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+ay(m.f,{r:g,c:p}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(m,h){h.forEach(function(g,p){var y="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Lu(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Bu(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function f(m,h){h.forEach(function(g,p){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*Uu(g.hpx)+";"),y.length>2&&m.push(y+"R"+(p+1))})}function d(m,h){var g=["ID;PWXL;N;E"],p=[],y=rt(m["!ref"]),v,x=Array.isArray(m),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&u(g,m["!cols"]),m["!rows"]&&f(g,m["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var b=y.s.c;b<=y.e.c;++b){var E=Re({r:S,c:b});v=x?(m[S]||[])[b]:m[E],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,m,S,b))}return g.join(w)+w+p.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),dC=function(){function e(s,i){switch(i.type){case"base64":return t(Dn(s),i);case"binary":return t(s,i);case"buffer":return t(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Ni(s),i);case"array":return t(go(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var m=o[f].trim().split(","),h=m[0],g=m[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][u]=!0:p==="FALSE"?d[l][u]=!1:isNaN(_a(g))?isNaN(Ol(g).getDate())?d[l][u]=g:d[l][u]=bt(g):d[l][u]=_a(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return ac(e(s,i),i)}function n(s,i){return Ci(r(s,i),i)}var a=function(){var s=function(l,u,f,d,m){l.push(u),l.push(f+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=rt(l["!ref"]),d,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){i(u,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var p=Re({r:h,c:g});if(d=m?(l[h]||[])[g]:l[p],!d){i(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,y,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ta(d.z||je[14],or(bt(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var v=`\r
`,x=u.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),hC=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var h=d.split(`
`),g=-1,p=-1,y=0,v=[];y!==h.length;++y){var x=h[y].trim().split(":");if(x[0]==="cell"){var w=It(x[1]);if(v.length<=w.r)for(g=v.length;g<=w.r;++g)v[g]||(v[g]=[]);switch(g=w.r,p=w.c,x[2]){case"t":v[g][p]=e(x[3]);break;case"v":v[g][p]=+x[3];break;case"vtf":var S=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[g][p]=!!+x[4];break;default:v[g][p]=+x[4];break}x[2]=="vtf"&&(v[g][p]=[v[g][p],S])}}}return m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}function n(d,m){return ac(r(d,m),m)}function a(d,m){return Ci(n(d,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var m=[],h=[],g,p="",y=mn(d["!ref"]),v=Array.isArray(d),x=y.s.r;x<=y.e.r;++x)for(var w=y.s.c;w<=y.e.c;++w)if(p=Re({r:x,c:w}),g=v?(d[x]||[])[w]:d[p],!(!g||g.v==null||g.t==="z")){switch(h=["cell",p,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var S=or(bt(g.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=g.w||ta(g.z||je[14],S);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(d){return[s,i,o,i,u(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Fl=function(){function e(f,d,m,h,g){g.raw?d[m][h]=f:f===""||(f==="TRUE"?d[m][h]=!0:f==="FALSE"?d[m][h]=!1:isNaN(_a(f))?isNaN(Ol(f).getDate())?d[m][h]=f:d[m][h]=bt(f):d[m][h]=_a(f))}function t(f,d){var m=d||{},h=[];if(!f||f.length===0)return h;for(var g=f.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var y=10,v=0,x=0;x<=p;++x)v=g[x].indexOf(" "),v==-1?v=g[x].length:v++,y=Math.max(y,v);for(x=0;x<=p;++x){h[x]=[];var w=0;for(e(g[x].slice(0,y).trim(),h,x,w,m),w=1;w<=(g[x].length-y)/10+1;++w)e(g[x].slice(y+(w-1)*10,y+w*10).trim(),h,x,w,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},m=!1,h=0,g=0;h<f.length;++h)(g=f.charCodeAt(h))==34?m=!m:!m&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);if(!g.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h])}return g.sort(function(p,y){return p[0]-y[0]||n[p[1]]-n[y[1]]}),r[g.pop()[1]]||44}function s(f,d){var m=d||{},h="",g=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):m&&m.FS?h=m.FS:h=a(f.slice(0,1024));var y=0,v=0,x=0,w=0,S=0,b=h.charCodeAt(0),E=!1,k=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var N=m.dateNF!=null?V9(m.dateNF):null;function I(){var H=f.slice(w,S),j={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)j.t="z";else if(m.raw)j.t="s",j.v=H;else if(H.trim().length===0)j.t="s",j.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(j.t="s",j.v=H.slice(2,-1).replace(/""/g,'"')):xV(H)?(j.t="n",j.f=H.slice(1)):(j.t="s",j.v=H);else if(H=="TRUE")j.t="b",j.v=!0;else if(H=="FALSE")j.t="b",j.v=!1;else if(!isNaN(x=_a(H)))j.t="n",m.cellText!==!1&&(j.w=H),j.v=x;else if(!isNaN(Ol(H).getDate())||N&&H.match(N)){j.z=m.dateNF||je[14];var z=0;N&&H.match(N)&&(H=z9(H,m.dateNF,H.match(N)||[]),z=1),m.cellDates?(j.t="d",j.v=bt(H,z)):(j.t="n",j.v=or(bt(H,z))),m.cellText!==!1&&(j.w=ta(j.z,j.v instanceof Date?or(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=H;if(j.t=="z"||(m.dense?(g[y]||(g[y]=[]),g[y][v]=j):g[Re({c:v,r:y})]=j),w=S+1,T=f.charCodeAt(w),p.e.c<v&&(p.e.c=v),p.e.r<y&&(p.e.r=y),k==b)++v;else if(v=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;S<f.length;++S)switch(k=f.charCodeAt(S)){case 34:T===34&&(E=!E);break;case b:case 10:case 13:if(!E&&I())break e;break}return S-w>0&&I(),g["!ref"]=He(p),g}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):ac(t(f,d),d)}function o(f,d){var m="",h=d.type=="string"?[0,0,0,0]:dy(f,d);switch(d.type){case"base64":m=Dn(f);break;case"binary":m=f;break;case"buffer":d.codepage==65001?m=f.toString("utf8"):d.codepage&&typeof Pu<"u"||(m=Ge&&Buffer.isBuffer(f)?f.toString("binary"):Ni(f));break;case"array":m=go(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=ht(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=ht(m):d.type=="binary"&&typeof Pu<"u",m.slice(0,19)=="socialcalc:version:"?hC.to_sheet(d.type=="string"?m:ht(m),d):i(m,d)}function l(f,d){return Ci(o(f,d),d)}function u(f){for(var d=[],m=rt(f["!ref"]),h,g=Array.isArray(f),p=m.s.r;p<=m.e.r;++p){for(var y=[],v=m.s.c;v<=m.e.c;++v){var x=Re({r:p,c:v});if(h=g?(f[p]||[])[v]:f[x],!h||h.v==null){y.push("          ");continue}for(var w=(h.w||(Ns(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(v===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function sW(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=fC.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Fl.to_workbook(e,t)}}var Zi=function(){function e(D,V,O){if(D){wr(D,D.l||0);for(var L=O.Enum||Z;D.l<D.length;){var Y=D.read_shift(2),G=L[Y]||L[65535],ie=D.read_shift(2),se=D.l+ie,ae=G.f&&G.f(D,ie,O);if(D.l=se,V(ae,G,Y))return}}}function t(D,V){switch(V.type){case"base64":return r(kn(Dn(D)),V);case"binary":return r(kn(D),V);case"buffer":case"array":return r(D,V)}throw"Unsupported type "+V.type}function r(D,V){if(!D)return D;var O=V||{},L=O.dense?[]:{},Y="Sheet1",G="",ie=0,se={},ae=[],J=[],A={s:{r:0,c:0},e:{r:0,c:0}},me=O.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)O.Enum=Z,e(D,function(xe,mt,nr){switch(nr){case 0:O.vers=xe,xe>=4096&&(O.qpro=!0);break;case 6:A=xe;break;case 204:xe&&(G=xe);break;case 222:G=xe;break;case 15:case 51:O.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:nr==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=O.dateNF||je[14],O.cellDates&&(xe[1].t="d",xe[1].v=Sm(xe[1].v))),O.qpro&&xe[3]>ie&&(L["!ref"]=He(A),se[Y]=L,ae.push(Y),L=O.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ie=xe[3],Y=G||"Sheet"+(ie+1),G="");var pn=O.dense?(L[xe[0].r]||[])[xe[0].c]:L[Re(xe[0])];if(pn){pn.t=xe[1].t,pn.v=xe[1].v,xe[1].z!=null&&(pn.z=xe[1].z),xe[1].f!=null&&(pn.f=xe[1].f);break}O.dense?(L[xe[0].r]||(L[xe[0].r]=[]),L[xe[0].r][xe[0].c]=xe[1]):L[Re(xe[0])]=xe[1];break}},O);else if(D[2]==26||D[2]==14)O.Enum=le,D[2]==14&&(O.qpro=!0,D.l=0),e(D,function(xe,mt,nr){switch(nr){case 204:Y=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>ie&&(L["!ref"]=He(A),se[Y]=L,ae.push(Y),L=O.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ie=xe[3],Y="Sheet"+(ie+1)),me>0&&xe[0].r>=me)break;O.dense?(L[xe[0].r]||(L[xe[0].r]=[]),L[xe[0].r][xe[0].c]=xe[1]):L[Re(xe[0])]=xe[1],A.e.c<xe[0].c&&(A.e.c=xe[0].c),A.e.r<xe[0].r&&(A.e.r=xe[0].r);break;case 27:xe[14e3]&&(J[xe[14e3][0]]=xe[14e3][1]);break;case 1537:J[xe[0]]=xe[1],xe[0]==ie&&(Y=xe[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(L["!ref"]=He(A),se[G||Y]=L,ae.push(G||Y),!J.length)return{SheetNames:ae,Sheets:se};for(var ke={},We=[],Me=0;Me<J.length;++Me)se[ae[Me]]?(We.push(J[Me]||ae[Me]),ke[J[Me]]=se[J[Me]]||se[ae[Me]]):(We.push(J[Me]),ke[J[Me]]={"!ref":"A1"});return{SheetNames:We,Sheets:ke}}function n(D,V){var O=V||{};if(+O.codepage>=0&&ga(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var L=dn(),Y=rt(D["!ref"]),G=Array.isArray(D),ie=[];ye(L,0,s(1030)),ye(L,6,l(Y));for(var se=Math.min(Y.e.r,8191),ae=Y.s.r;ae<=se;++ae)for(var J=Kt(ae),A=Y.s.c;A<=Y.e.c;++A){ae===Y.s.r&&(ie[A]=Mt(A));var me=ie[A]+J,ke=G?(D[ae]||[])[A]:D[me];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?ye(L,13,h(ae,A,ke.v)):ye(L,14,p(ae,A,ke.v));else{var We=Ns(ke);ye(L,15,d(ae,A,We.slice(0,239)))}}return ye(L,1),L.end()}function a(D,V){var O=V||{};if(+O.codepage>=0&&ga(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var L=dn();ye(L,0,i(D));for(var Y=0,G=0;Y<D.SheetNames.length;++Y)(D.Sheets[D.SheetNames[Y]]||{})["!ref"]&&ye(L,27,P(D.SheetNames[Y],G++));var ie=0;for(Y=0;Y<D.SheetNames.length;++Y){var se=D.Sheets[D.SheetNames[Y]];if(!(!se||!se["!ref"])){for(var ae=rt(se["!ref"]),J=Array.isArray(se),A=[],me=Math.min(ae.e.r,8191),ke=ae.s.r;ke<=me;++ke)for(var We=Kt(ke),Me=ae.s.c;Me<=ae.e.c;++Me){ke===ae.s.r&&(A[Me]=Mt(Me));var xe=A[Me]+We,mt=J?(se[ke]||[])[Me]:se[xe];if(!(!mt||mt.t=="z"))if(mt.t=="n")ye(L,23,I(ke,Me,ie,mt.v));else{var nr=Ns(mt);ye(L,22,k(ke,Me,ie,nr.slice(0,239)))}}++ie}}return ye(L,1),L.end()}function s(D){var V=oe(2);return V.write_shift(2,D),V}function i(D){var V=oe(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var O=0,L=0,Y=0,G=0;G<D.SheetNames.length;++G){var ie=D.SheetNames[G],se=D.Sheets[ie];if(!(!se||!se["!ref"])){++Y;var ae=mn(se["!ref"]);O<ae.e.r&&(O=ae.e.r),L<ae.e.c&&(L=ae.e.c)}}return O>8191&&(O=8191),V.write_shift(2,O),V.write_shift(1,Y),V.write_shift(1,L),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(D,V,O){var L={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&O.qpro?(L.s.c=D.read_shift(1),D.l++,L.s.r=D.read_shift(2),L.e.c=D.read_shift(1),D.l++,L.e.r=D.read_shift(2),L):(L.s.c=D.read_shift(2),L.s.r=D.read_shift(2),V==12&&O.qpro&&(D.l+=2),L.e.c=D.read_shift(2),L.e.r=D.read_shift(2),V==12&&O.qpro&&(D.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(D){var V=oe(8);return V.write_shift(2,D.s.c),V.write_shift(2,D.s.r),V.write_shift(2,D.e.c),V.write_shift(2,D.e.r),V}function u(D,V,O){var L=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(L[0].c=D.read_shift(1),L[3]=D.read_shift(1),L[0].r=D.read_shift(2),D.l+=2):(L[2]=D.read_shift(1),L[0].c=D.read_shift(2),L[0].r=D.read_shift(2)),L}function f(D,V,O){var L=D.l+V,Y=u(D,V,O);if(Y[1].t="s",O.vers==20768){D.l++;var G=D.read_shift(1);return Y[1].v=D.read_shift(G,"utf8"),Y}return O.qpro&&D.l++,Y[1].v=D.read_shift(L-D.l,"cstr"),Y}function d(D,V,O){var L=oe(7+O.length);L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,D),L.write_shift(1,39);for(var Y=0;Y<L.length;++Y){var G=O.charCodeAt(Y);L.write_shift(1,G>=128?95:G)}return L.write_shift(1,0),L}function m(D,V,O){var L=u(D,V,O);return L[1].v=D.read_shift(2,"i"),L}function h(D,V,O){var L=oe(7);return L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,D),L.write_shift(2,O,"i"),L}function g(D,V,O){var L=u(D,V,O);return L[1].v=D.read_shift(8,"f"),L}function p(D,V,O){var L=oe(13);return L.write_shift(1,255),L.write_shift(2,V),L.write_shift(2,D),L.write_shift(8,O,"f"),L}function y(D,V,O){var L=D.l+V,Y=u(D,V,O);if(Y[1].v=D.read_shift(8,"f"),O.qpro)D.l=L;else{var G=D.read_shift(2);S(D.slice(D.l,D.l+G),Y),D.l+=G}return Y}function v(D,V,O){var L=V&32768;return V&=-32769,V=(L?D:0)+(V>=8192?V-16384:V),(L?"":"$")+(O?Mt(V):Kt(V))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(D,V){wr(D,0);for(var O=[],L=0,Y="",G="",ie="",se="";D.l<D.length;){var ae=D[D.l++];switch(ae){case 0:O.push(D.read_shift(8,"f"));break;case 1:G=v(V[0].c,D.read_shift(2),!0),Y=v(V[0].r,D.read_shift(2),!1),O.push(G+Y);break;case 2:{var J=v(V[0].c,D.read_shift(2),!0),A=v(V[0].r,D.read_shift(2),!1);G=v(V[0].c,D.read_shift(2),!0),Y=v(V[0].r,D.read_shift(2),!1),O.push(J+A+":"+G+Y)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(D.read_shift(2));break;case 6:{for(var me="";ae=D[D.l++];)me+=String.fromCharCode(ae);O.push('"'+me.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:se=O.pop(),ie=O.pop(),O.push(["AND","OR"][ae-20]+"("+ie+","+se+")");break;default:if(ae<32&&w[ae])se=O.pop(),ie=O.pop(),O.push(ie+w[ae]+se);else if(x[ae]){if(L=x[ae][1],L==69&&(L=D[D.l++]),L>O.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+O.join("|")+"|");return}var ke=O.slice(-L);O.length-=L,O.push(x[ae][0]+"("+ke.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}O.length==1?V[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function b(D){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=D.read_shift(2),V[3]=D[D.l++],V[0].c=D[D.l++],V}function E(D,V){var O=b(D);return O[1].t="s",O[1].v=D.read_shift(V-4,"cstr"),O}function k(D,V,O,L){var Y=oe(6+L.length);Y.write_shift(2,D),Y.write_shift(1,O),Y.write_shift(1,V),Y.write_shift(1,39);for(var G=0;G<L.length;++G){var ie=L.charCodeAt(G);Y.write_shift(1,ie>=128?95:ie)}return Y.write_shift(1,0),Y}function T(D,V){var O=b(D);O[1].v=D.read_shift(2);var L=O[1].v>>1;if(O[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return O[1].v=L,O}function N(D,V){var O=b(D),L=D.read_shift(4),Y=D.read_shift(4),G=D.read_shift(2);if(G==65535)return L===0&&Y===3221225472?(O[1].t="e",O[1].v=15):L===0&&Y===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ie=G&32768;return G=(G&32767)-16446,O[1].v=(1-ie*2)*(Y*Math.pow(2,G+32)+L*Math.pow(2,G)),O}function I(D,V,O,L){var Y=oe(14);if(Y.write_shift(2,D),Y.write_shift(1,O),Y.write_shift(1,V),L==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var G=0,ie=0,se=0,ae=0;return L<0&&(G=1,L=-L),ie=Math.log2(L)|0,L/=Math.pow(2,ie-31),ae=L>>>0,ae&2147483648||(L/=2,++ie,ae=L>>>0),L-=ae,ae|=2147483648,ae>>>=0,L*=Math.pow(2,32),se=L>>>0,Y.write_shift(4,se),Y.write_shift(4,ae),ie+=16383+(G?32768:0),Y.write_shift(2,ie),Y}function H(D,V){var O=N(D);return D.l+=V-14,O}function j(D,V){var O=b(D),L=D.read_shift(4);return O[1].v=L>>6,O}function z(D,V){var O=b(D),L=D.read_shift(8,"f");return O[1].v=L,O}function K(D,V){var O=z(D);return D.l+=V-10,O}function q(D,V){return D[D.l+V-1]==0?D.read_shift(V,"cstr"):""}function Q(D,V){var O=D[D.l++];O>V-1&&(O=V-1);for(var L="";L.length<O;)L+=String.fromCharCode(D[D.l++]);return L}function X(D,V,O){if(!(!O.qpro||V<21)){var L=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var Y=D.read_shift(V-21,"cstr");return[L,Y]}}function F(D,V){for(var O={},L=D.l+V;D.l<L;){var Y=D.read_shift(2);if(Y==14e3){for(O[Y]=[0,""],O[Y][0]=D.read_shift(2);D[D.l];)O[Y][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return O}function P(D,V){var O=oe(5+D.length);O.write_shift(2,14e3),O.write_shift(2,V);for(var L=0;L<D.length;++L){var Y=D.charCodeAt(L);O[O.l++]=Y>127?95:Y}return O[O.l++]=0,O}var Z={0:{n:"BOF",f:er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:F},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function iW(e){var t={},r=e.match(Wr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Oe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Av[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var oW=function(){var e=Ru("t"),t=Ru("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:et(i[1])},l=s.match(t);return l&&(o.s=iW(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),lW=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),cW=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uW=/<(?:\w+:)?r>/,fW=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=et(ht(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ht(e),r&&(n.h=Bv(n.t))):e.match(uW)&&(n.r=ht(e),n.t=et(ht((e.replace(fW,"").match(cW)||[]).join("").replace(Wr,""))),r&&(n.h=lW(oW(n.r)))),n):{t:""}}var dW=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hW=/<(?:\w+:)?(?:si|sstItem)>/g,mW=/<\/(?:\w+:)?(?:si|sstItem)>/;function pW(e,t){var r=[],n="";if(!e)return r;var a=e.match(dW);if(a){n=a[2].replace(hW,"").split(mW);for(var s=0;s!=n.length;++s){var i=Zv(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Oe(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var gW=/^\s|\s$|[\t\n\r]/;function mC(e,t){if(!t.bookSST)return"";var r=[qt];r[r.length]=ve("sst",null,{xmlns:Co[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(gW)&&(s+=' xml:space="preserve"'),s+=">"+ft(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function vW(e){return[e.read_shift(4),e.read_shift(4)]}function yW(e,t){var r=[],n=!1;return Ps(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function xW(e,t){return t||(t=oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var wW=PB;function _W(e){var t=dn();fe(t,159,xW(e));for(var r=0;r<e.length;++r)fe(t,19,wW(e[r]));return fe(t,160),t.end()}function pC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function xs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function SW(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=xs(e,4),t.U=xs(e,4),t.W=xs(e,4),t}function kW(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function bW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(kW(e));return t}function EW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function TW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=xs(e,4),t.U=xs(e,4),t.W=xs(e,4),t}function NW(e){var t=TW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function gC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function vC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function CW(e){var t=xs(e);switch(t.Minor){case 2:return[t.Minor,AW(e)];case 3:return[t.Minor,PW()];case 4:return[t.Minor,DW(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function AW(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=gC(e,r),a=vC(e,e.length-e.l);return{t:"Std",h:n,v:a}}function PW(){throw new Error("File is password-protected: ECMA-376 Extensible")}function DW(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Wr,function(s){var i=Oe(s);switch(es(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function jW(e,t){var r={},n=r.EncryptionVersionInfo=xs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=gC(e,a),t-=a,r.EncryptionVerifier=vC(e,t),r}function RW(e){var t={},r=t.EncryptionVersionInfo=xs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ey(e){var t=0,r,n=pC(e),a=n.length+1,s,i,o,l,u;for(r=vi(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var yC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=pC(i),l=s(o),u=o.length,f=vi(16),d=0;d!=16;++d)f[d]=0;var m,h,g;for((u&1)===1&&(m=l>>8,f[u]=a(e[0],m),--u,m=l&255,h=o[o.length-1],f[u]=a(h,m));u>0;)--u,m=l>>8,f[u]=a(o[u],m),--u,m=l&255,f[u]=a(o[u],m);for(u=15,g=15-o.length;g>0;)m=l>>8,f[u]=a(e[g],m),--u,--g,m=l&255,f[u]=a(o[u],m),--u,--g;return f}}(),MW=function(e,t,r,n,a){a||(a=t),n||(n=yC(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},IW=function(e){var t=0,r=yC(e);return function(n){var a=MW("",n,t,r);return t=a[1],a[0]}};function OW(e,t,r,n){var a={key:er(e),verificationBytes:er(e)};return r.password&&(a.verifier=ey(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=IW(r.password)),a}function FW(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=RW(e):n.Data=jW(e,t),n}function LW(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?FW(e,t-2,n):OW(e,r.biff>=8?t:t-2,r,n),n}var xC=function(){function e(a,s){switch(s.type){case"base64":return t(Dn(a),s);case"binary":return t(a,s);case"buffer":return t(Ge&&Buffer.isBuffer(a)?a.toString("binary"):Ni(a),s);case"array":return t(go(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,h=0,g,p=-1;g=m.exec(f);){switch(g[0]){case"\\cell":var y=f.slice(h,m.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++p,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[d][p]=v:o[Re({r:d,c:p})]=v}break}h=m.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=He(u),o}function r(a,s){return Ci(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=rt(a["!ref"]),o,l=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Re({r:u,c:f});o=l?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ns(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function BW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Fu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function UW(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,u=a+s;switch(l=i/(u>1?2-u:u),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function $W(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function wh(e,t){if(t===0)return e;var r=UW(BW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Fu($W(r))}var wC=6,WW=15,HW=1,Or=wC;function Lu(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function Bu(e){return Math.floor((e-5)/Or*100+.5)/100}function _h(e){return Math.round((e*Or+5)/Or*256)/256}function Lp(e){return _h(Bu(Lu(e)))}function ty(e){var t=Math.abs(e-Lp(e)),r=Or;if(t>.005)for(Or=HW;Or<WW;++Or)Math.abs(e-Lp(e))<=t&&(t=Math.abs(e-Lp(e)),r=Or);Or=r}function yi(e){e.width?(e.wpx=Lu(e.width),e.wch=Bu(e.wpx),e.MDW=Or):e.wpx?(e.wch=Bu(e.wpx),e.width=_h(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=_h(e.wch),e.wpx=Lu(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var VW=96,_C=VW;function Uu(e){return e*96/_C}function Ll(e){return e*_C/96}var zW={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function GW(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(es(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=wt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=wt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function YW(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(es(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function XW(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(es(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ht(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?wt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?wt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?wt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?wt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?wt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?wt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?wt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Av[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=wt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Qi[a.color.index];a.color.index==81&&(l=Qi[1]),l||(l=Qi[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=wh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function KW(e,t,r){t.NumberFmt=[];for(var n=Vt(je),a=0;a<n.length;++a)t.NumberFmt[n[a]]=je[n[a]];var s=e[0].match(Wr);if(s)for(a=0;a<s.length;++a){var i=Oe(s[a]);switch(es(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=et(ht(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ys(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function qW(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ve("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ve("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sd=["numFmtId","fillId","fontId","borderId","xfId"],id=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function QW(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Wr)||[]).forEach(function(s){var i=Oe(s),o=0;switch(es(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<sd.length;++o)n[sd[o]]&&(n[sd[o]]=parseInt(n[sd[o]],10));for(o=0;o<id.length;++o)n[id[o]]&&(n[id[o]]=wt(n[id[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=wt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function JW(e){var t=[];return t[t.length]=ve("cellXfs",null),e.forEach(function(r){t[t.length]=ve("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ve("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ZW=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&KW(d,f,u),(d=o.match(a))&&XW(d,f,l,u),(d=o.match(n))&&YW(d,f,l,u),(d=o.match(s))&&GW(d,f,l,u),(d=o.match(r))&&QW(d,f,u),f}}();function SC(e,t){var r=[qt,ve("styleSheet",null,{xmlns:Co[0],"xmlns:vt":sr.vt})],n;return e.SSF&&(n=qW(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=JW(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function eH(e,t){var r=e.read_shift(2),n=Br(e);return[r,n]}function tH(e,t,r){r||(r=oe(6+4*t.length)),r.write_shift(2,e),mr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rH(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=FB(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=OB(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Br(e),n}function nH(e,t){t||(t=oe(25+4*32)),t.write_shift(2,e.sz*20),LB(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),vh(e.color,t);var n=0;return n=2,t.write_shift(1,n),mr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var aH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Bp,sH=$r;function C2(e,t){t||(t=oe(4*3+8*7+16*1)),Bp||(Bp=wm(aH));var r=Bp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(vh({auto:1},t),vh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function iH(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function kC(e,t,r){r||(r=oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Nc(e,t){return t||(t=oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var oH=$r;function lH(e,t){return t||(t=oe(51)),t.write_shift(1,0),Nc(null,t),Nc(null,t),Nc(null,t),Nc(null,t),Nc(null,t),t.length>t.l?t.slice(0,t.l):t}function cH(e,t){return t||(t=oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),gh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function uH(e,t,r){var n=oe(2052);return n.write_shift(4,e),gh(t,n),gh(r,n),n.length>n.l?n.slice(0,n.l):n}function fH(e,t,r){var n={};n.NumberFmt=[];for(var a in je)n.NumberFmt[a]=je[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ps(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],ys(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=wh(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function dH(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(fe(e,615,Sa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&fe(e,44,tH(a,t[a]))}),fe(e,616))}}function hH(e){var t=1;fe(e,611,Sa(t)),fe(e,43,nH({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(e,612)}function mH(e){var t=2;fe(e,603,Sa(t)),fe(e,45,C2({patternType:"none"})),fe(e,45,C2({patternType:"gray125"})),fe(e,604)}function pH(e){var t=1;fe(e,613,Sa(t)),fe(e,46,lH()),fe(e,614)}function gH(e){var t=1;fe(e,626,Sa(t)),fe(e,47,kC({numFmtId:0},65535)),fe(e,627)}function vH(e,t){fe(e,617,Sa(t.length)),t.forEach(function(r){fe(e,47,kC(r,0))}),fe(e,618)}function yH(e){var t=1;fe(e,619,Sa(t)),fe(e,48,cH({xfId:0,name:"Normal"})),fe(e,620)}function xH(e){var t=0;fe(e,505,Sa(t)),fe(e,506)}function wH(e){var t=0;fe(e,508,uH(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function _H(e,t){var r=dn();return fe(r,278),dH(r,e.SSF),hH(r),mH(r),pH(r),gH(r),vH(r,t.cellXfs),yH(r),xH(r),wH(r),fe(r,279),r.end()}var SH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function kH(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Wr)||[]).forEach(function(a){var s=Oe(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[SH.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function bH(){}function EH(){}var TH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,NH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,CH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function AH(e,t,r){t.themeElements={};var n;[["clrScheme",TH,kH],["fontScheme",NH,bH],["fmtScheme",CH,EH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var PH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function bC(e,t){(!e||e.length===0)&&(e=ry());var r,n={};if(!(r=e.match(PH)))throw new Error("themeElements not found in theme");return AH(r[0],n,t),n.raw=e,n}function ry(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function DH(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=gN(s,{type:"array"})}catch{return}var o=bn(i,"theme/theme/theme1.xml",!0);if(o)return bC(o,r)}}function jH(e){return e.read_shift(4)}function RH(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=MH(e,4);break;case 2:t.xclrValue=nC(e);break;case 3:t.xclrValue=jH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function MH(e,t){return $r(e,t)}function IH(e,t){return $r(e,t)}function OH(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=RH(e);break;case 6:n[1]=IH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function FH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(OH(e,r-e.l));return{ixfe:n,ext:s}}function LH(e,t){t.forEach(function(r){switch(r[0]){}})}function BH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Br(e)}}function UH(e){var t=oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),mr(e.name,t),t.slice(0,t.l)}function $H(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function WH(e){var t=oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function HH(e,t){var r=oe(8+2*t.length);return r.write_shift(4,e),mr(t,r),r.slice(0,r.l)}function VH(e){return e.l+=4,e.read_shift(4)!=0}function zH(e,t){var r=oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function GH(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Ps(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function YH(){var e=dn();return fe(e,332),fe(e,334,Sa(1)),fe(e,335,UH({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,HH(1,"XLDAPR")),fe(e,52),fe(e,35,Sa(514)),fe(e,4096,Sa(0)),fe(e,4097,Hn(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,zH(1)),fe(e,51,WH([[1,0]])),fe(e,338),fe(e,333),e.end()}function XH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Wr,function(o){var l=Oe(o);switch(es(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function EC(){var e=[qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function KH(e){var t=[];if(!e)return t;var r=1;return(e.match(Wr)||[]).forEach(function(n){var a=Oe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function qH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Re(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function QH(e,t,r){var n=[];return Ps(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function JH(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ps(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function ZH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var rl=1024;function TC(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ve("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];rl<e*1e3;)rl+=1e3;return t.forEach(function(s){var i=It(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ve("v:fill",l,o),f={on:"t",obscured:"t"};++rl,a=a.concat(["<v:shape"+Mu({id:"_x0000_s"+rl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ve("v:shadow",null,f),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_r("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),_r("x:AutoFill","False"),_r("x:Row",String(i.r)),_r("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function A2(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=It(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=rt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=He(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function eV(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=It(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&Zv(d[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function NC(e){var t=[qt,ve("comments",null,{xmlns:Co[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=ft(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(ft(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(_r("t",ft(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(_r("t",ft(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function tV(e,t){var r=[],n=!1,a={},s=0;return e.replace(Wr,function(o,l){var u=Oe(o);switch(es(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function rV(e,t,r){var n=[qt,ve("ThreadedComments",null,{xmlns:sr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ve("threadedComment",_r("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function nV(e,t){var r=[],n=!1;return e.replace(Wr,function(s){var i=Oe(s);switch(es(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function aV(e){var t=[qt,ve("personList",null,{xmlns:sr.TCMNT,"xmlns:x":Co[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function sV(e){var t={};t.iauthor=e.read_shift(4);var r=jo(e);return t.rfx=r.s,t.ref=Re(r.s),e.l+=16,t}function iV(e,t){return t==null&&(t=oe(36)),t.write_shift(4,e[1].iauthor),sc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var oV=Br;function lV(e){return mr(e.slice(0,54))}function cV(e,t){var r=[],n=[],a={},s=!1;return Ps(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function uV(e){var t=dn(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fe(t,632,lV(a.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:It(n[0]),e:It(n[0])};fe(t,635,iV([s,a])),a.t&&a.t.length>0&&fe(t,637,jB(a)),fe(t,636),delete a.iauthor})}),fe(t,634),fe(t,629),t.end()}var fV="application/vnd.ms-office.vbaProject";function dV(e){var t=Ae.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ae.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ae.write(t)}function hV(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ae.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var CC=["xlsb","xlsm","xlam","biff8","xla"];function mV(){return{"!type":"dialog"}}function pV(){return{"!type":"dialog"}}function gV(){return{"!type":"macro"}}function vV(){return{"!type":"macro"}}var ml=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,a+(o?"":"$")+Mt(f)+(l?"":"$")+Kt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),ny=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ay=function(){return function(t,r){return t.replace(ny,function(n,a,s,i,o,l){var u=Vv(i)-(s?0:r.c),f=Hv(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",m=u==0?"":s?u+1:"["+u+"]";return a+"R"+d+"C"+m})}}();function AC(e,t){return e.replace(ny,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Mt(Vv(s)+t.c))+(i=="$"?i+o:Kt(Hv(o)+t.r))})}function yV(e,t,r){var n=mn(t),a=n.s,s=It(r),i={r:s.r-a.r,c:s.c-a.c};return AC(e,i)}function xV(e){return e.length!=1}function P2(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function xi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function PC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return DC(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=xi(e),o=xi(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function DC(e){var t=xi(e),r=xi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function wV(e,t,r){if(r.biff<8)return DC(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=xi(e),i=xi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function jC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return _V(e);var n=e.read_shift(r&&r.biff==12?4:2),a=xi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function _V(e){var t=xi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function SV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bV(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function bV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function EV(e,t,r){var n=(e[e.l++]&96)>>5,a=PC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function TV(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=PC(e,s,r);return[n,a,i]}function NV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function CV(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function AV(e,t,r){var n=(e[e.l++]&96)>>5,a=wV(e,t-1,r);return[n,a]}function PV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function D2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function DV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function jV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function IV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function RC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function OV(e){return e.read_shift(2),RC(e)}function FV(e){return e.read_shift(2),RC(e)}function LV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=jC(e,0,r);return[n,a]}function BV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kV(e,0,r);return[n,a]}function UV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=jC(e,0,r);return[n,a,s]}function $V(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Vz[a],OC[a],n]}function WV(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HV(e);return[a,(s[0]===0?OC:Hz)[s[1]]]}function HV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function VV(e,t,r){e.l+=r&&r.biff==2?3:4}function zV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function GV(e){return e.l++,Ds[e.read_shift(1)]}function YV(e){return e.l++,e.read_shift(2)}function XV(e){return e.l++,e.read_shift(1)!==0}function KV(e){return e.l++,Fr(e)}function qV(e,t,r){return e.l++,gf(e,t-1,r)}function QV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Gt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ds[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fr(e);break;case 2:r[1]=Ro(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function JV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?jo:km)(e));return a}function ZV(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=QV(e,r.biff);return i}function ez(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function tz(e,t,r){if(r.biff==5)return rz(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function rz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function nz(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function az(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function sz(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function iz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var oz=$r,lz=$r,cz=$r;function yf(e,t,r){return e.l+=2,[SV(e)]}function sy(e){return e.l+=6,[]}var uz=yf,fz=sy,dz=sy,hz=yf;function MC(e){return e.l+=2,[er(e),e.read_shift(2)&1]}var mz=yf,pz=MC,gz=sy,vz=yf,yz=yf,xz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wz(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=xz[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function _z(e){return e.l+=2,[e.read_shift(4)]}function Sz(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function kz(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ez(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Tz(e){return e.l+=4,[0,0]}var j2={1:{n:"PtgExp",f:zV},2:{n:"PtgTbl",f:cz},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:qV},26:{n:"PtgSheet",f:Sz},27:{n:"PtgEndSheet",f:kz},28:{n:"PtgErr",f:GV},29:{n:"PtgBool",f:XV},30:{n:"PtgInt",f:YV},31:{n:"PtgNum",f:KV},32:{n:"PtgArray",f:PV},33:{n:"PtgFunc",f:$V},34:{n:"PtgFuncVar",f:WV},35:{n:"PtgName",f:ez},36:{n:"PtgRef",f:LV},37:{n:"PtgArea",f:EV},38:{n:"PtgMemArea",f:nz},39:{n:"PtgMemErr",f:oz},40:{n:"PtgMemNoMem",f:lz},41:{n:"PtgMemFunc",f:az},42:{n:"PtgRefErr",f:sz},43:{n:"PtgAreaErr",f:NV},44:{n:"PtgRefN",f:BV},45:{n:"PtgAreaN",f:AV},46:{n:"PtgMemAreaN",f:bz},47:{n:"PtgMemNoMemN",f:Ez},57:{n:"PtgNameX",f:tz},58:{n:"PtgRef3d",f:UV},59:{n:"PtgArea3d",f:TV},60:{n:"PtgRefErr3d",f:iz},61:{n:"PtgAreaErr3d",f:CV},255:{}},Nz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Cz={1:{n:"PtgElfLel",f:MC},2:{n:"PtgElfRw",f:vz},3:{n:"PtgElfCol",f:uz},6:{n:"PtgElfRwV",f:yz},7:{n:"PtgElfColV",f:hz},10:{n:"PtgElfRadical",f:mz},11:{n:"PtgElfRadicalS",f:gz},13:{n:"PtgElfColS",f:fz},15:{n:"PtgElfColSV",f:dz},16:{n:"PtgElfRadicalLel",f:pz},25:{n:"PtgList",f:wz},29:{n:"PtgSxName",f:_z},255:{}},Az={0:{n:"PtgAttrNoop",f:Tz},1:{n:"PtgAttrSemi",f:IV},2:{n:"PtgAttrIf",f:RV},4:{n:"PtgAttrChoose",f:DV},8:{n:"PtgAttrGoto",f:jV},16:{n:"PtgAttrSum",f:VV},32:{n:"PtgAttrBaxcel",f:D2},33:{n:"PtgAttrBaxcel",f:D2},64:{n:"PtgAttrSpace",f:OV},65:{n:"PtgAttrSpaceSemi",f:FV},128:{n:"PtgAttrIfError",f:MV},255:{}};function xf(e,t,r,n){if(n.biff<8)return $r(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=ZV(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=JV(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push($r(e,t)),s}function wf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=j2[s]||j2[Nz[s]],(s===24||s===25)&&(a=(s===24?Cz:Az)[e[e.l+1]]),!a||!a.f?$r(e,t):i.push([a.n,a.f(e,t,r)]);return i}function Pz(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Dz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function jz(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function IC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function R2(e,t,r){var n=IC(e,t,r);return n=="#REF"?n:jz(n,r)}function Mr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,d=0,m=0,h,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,y="",v=0,x=e[0].length;v<x;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:y=Wt(" ",e[0][p][1][1]);break;case 1:y=Wt("\r",e[0][p][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+y,p=-1}o.push(u+Dz[w[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Kc(w[1][1],i,a),o.push(qc(f,s));break;case"PtgRefN":f=r?Kc(w[1][1],r,a):w[1][1],o.push(qc(f,s));break;case"PtgRef3d":d=w[1][1],f=Kc(w[1][2],i,a),g=R2(n,d,a),o.push(g+"!"+qc(f,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],b=w[1][1];S||(S=0),S&=127;var E=S==0?[]:o.slice(-S);o.length-=S,b==="User"&&(b=E.shift()),o.push(b+"("+E.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=l2(w[1][1],r?{s:r}:i,a),o.push(Ip(h,a));break;case"PtgArea":h=l2(w[1][1],i,a),o.push(Ip(h,a));break;case"PtgArea3d":d=w[1][1],h=w[1][2],g=R2(n,d,a),o.push(g+"!"+Ip(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=w[1][2];var k=(n.names||[])[m-1]||(n[0]||[])[m],T=k?k.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var N=w[1][1];m=w[1][2];var I;if(a.biff<=5)N<0&&(N=-N),n[N]&&(I=n[N][m]);else{var H="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][m]&&n[N][m].itab>0&&(H=n.SheetNames[n[N][m].itab-1]+"!"):H=n.SheetNames[m-1]+"!"),n[N]&&n[N][m])H+=n[N][m].Name;else if(n[0]&&n[0][m])H+=n[0][m].Name;else{var j=(IC(n,N,a)||"").split(";;");j[m-1]?H=j[m-1]:H+="SH33TJSERRX"}o.push(H);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var z="(",K=")";if(p>=0){switch(y="",e[0][p][1][0]){case 2:z=Wt(" ",e[0][p][1][1])+z;break;case 3:z=Wt("\r",e[0][p][1][1])+z;break;case 4:K=Wt(" ",e[0][p][1][1])+K;break;case 5:K=Wt("\r",e[0][p][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(z+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var q={c:r.c,r:r.r};if(n.sharedf[Re(f)]){var Q=n.sharedf[Re(f)];o.push(Mr(Q,i,q,n,a))}else{var X=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(Mr(u[1],i,q,n,a)),X=!0;break}X||o.push(w[1])}break;case"PtgArray":o.push("{"+Pz(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var F=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&F.indexOf(e[0][v][0])==-1){w=e[0][p];var P=!0;switch(w[1][0]){case 4:P=!1;case 0:y=Wt(" ",w[1][1]);break;case 5:P=!1;case 1:y=Wt("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((P?y:"")+o.pop()+(P?"":y)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Rz(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],$r(e,t-2)];var o=wf(e,i,r);return t!==i+a&&(s=xf(e,t-i-a,o,r)),e.l=n,[o,s]}function Mz(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],$r(e,t-2)];var o=wf(e,i,r);return t!==i+a&&(s=xf(e,t-i-a,o,r)),e.l=n,[o,s]}function Iz(e,t,r,n){var a=e.l+t,s=wf(e,n,r),i;return a!==e.l&&(i=xf(e,a-e.l,s,r)),[s,i]}function Oz(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=wf(e,s,r);return s==65535?[[],$r(e,t-2)]:(t!==s+2&&(a=xf(e,n-s-2,i,r)),[i,a])}function Fz(e){var t;if(ms(e,e.l+6)!==65535)return[Fr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lz(e){if(e==null){var t=oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return vo(e);return vo(0)}function Up(e,t,r){var n=e.l+t,a=ts(e);r.biff==2&&++e.l;var s=Fz(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Mz(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Bz(e,t,r,n,a){var s=xo(t,r,a),i=Lz(e.v),o=oe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=oe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=hr([s,i,o,u]);return d}function bm(e,t,r){var n=e.read_shift(4),a=wf(e,n,r),s=e.read_shift(4),i=s>0?xf(e,s,a,r):null;return[a,i]}var Uz=bm,Em=bm,$z=bm,Wz=bm,Hz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},OC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Vz={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function M2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zz(e){var t="of:="+e.replace(ny,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $p(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Gz(e){return e.replace(/\./,"!")}var Jc={},pl={},Zc=typeof Map<"u";function iy(e,t,r){var n=0,a=e.length;if(r){if(Zc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Zc?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Zc?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Tm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Or=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Bu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=_h(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function eo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ai(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){ys(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function FC(e,t,r,n,a,s){try{n.cellNF&&(e.z=je[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=bt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(je[t]==null&&ys(H9[t]||"General",t),e.t==="e")e.w=e.w||Ds[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ju(e.v);else if(e.t==="d"){var i=or(e.v);(i|0)===i?e.w=i.toString(10):e.w=ju(i)}else{if(e.v===void 0)return"";e.w=po(e.v,pl)}else e.t==="d"?e.w=ta(t,or(e.v),pl):e.w=ta(t,e.v,pl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=wh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=wh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Yz(e,t,r){if(e&&e["!ref"]){var n=rt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Xz(e,t){var r=rt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=He(r))}var Kz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Qz=/<(?:\w:)?hyperlink [^>]*>/mg,Jz=/"(\w*:\w*)"/,Zz=/<(?:\w:)?col\b[^>]*[\/]?>/g,eG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,tG=/<(?:\w:)?pageMargins[^>]*\/>/g,LC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,nG=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aG(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(qz);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var m=u.match(LC);m?oy(m[0],o,a,r):(m=u.match(rG))&&iG(m[0],m[1]||"",o,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=u.slice(h,h+50).match(Jz);g&&Xz(o,g[1])}var p=u.match(nG);p&&p[1]&&xG(p[1],a);var y=[];if(t.cellStyles){var v=u.match(Zz);v&&mG(y,v)}d&&SG(d[1],o,t,l,s,i);var x=f.match(eG);x&&(o["!autofilter"]=gG(x[0]));var w=[],S=f.match(Kz);if(S)for(h=0;h!=S.length;++h)w[h]=rt(S[h].slice(S[h].indexOf('"')+1));var b=f.match(Qz);b&&fG(o,b,n);var E=f.match(tG);if(E&&(o["!margins"]=dG(Oe(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=He(l)),t.sheetRows>0&&o["!ref"]){var k=rt(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=He(k))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function sG(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+He(e[r])+'"/>';return t+"</mergeCells>"}function oy(e,t,r,n){var a=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=et(ht(a.codeName)))}function iG(e,t,r,n,a){oy(e.slice(0,e.indexOf(">")),r,n,a)}function oG(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=za(ft(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ve("outlinePr",null,u)}!s&&!o||(a[a.length]=ve("sheetPr",o,i))}var lG=["objects","scenarios","selectLockedCells","selectUnlockedCells"],cG=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function uG(e){var t={sheet:1};return lG.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),cG.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ey(e.password).toString(16).toUpperCase()),ve("sheetProtection",null,t)}function fG(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Oe(ht(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+et(s.location))):(s.Target="#"+et(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=rt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=Re({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function dG(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function hG(e){return eo(e),ve("pageMargins",null,e)}function mG(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Oe(t[n],!0);a.hidden&&(a.hidden=wt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,ty(a.width)),yi(a);s<=i;)e[s++]=Et(a)}}function pG(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ve("col",null,Tm(a,n)));return r[r.length]="</cols>",r.join("")}function gG(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function vG(e,t,r,n){var a=typeof e.ref=="string"?e.ref:He(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=mn(a);i.s.r==i.e.r&&(i.e.r=mn(t["!ref"]).e.r,a=He(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ve("autoFilter",null,{ref:a})}var yG=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xG(e,t){t.Views||(t.Views=[{}]),(e.match(yG)||[]).forEach(function(r,n){var a=Oe(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),wt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function wG(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,a),{})}function _G(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ds[e.v];break;case"d":n&&n.cellDates?a=bt(e.v,-1).toISOString():(e=Et(e),e.t="n",a=""+(e.v=or(bt(e.v)))),typeof e.z>"u"&&(e.z=je[14]);break;default:a=e.v;break}var o=_r("v",ft(a)),l={r:t},u=Ai(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=_r("v",""+iy(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ve("f",ft(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ve("c",o,l)}var SG=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Ru("v"),i=Ru("f");return function(l,u,f,d,m,h){for(var g=0,p="",y=[],v=[],x=0,w=0,S=0,b="",E,k,T=0,N=0,I,H,j=0,z=0,K=Array.isArray(h.CellXf),q,Q=[],X=[],F=Array.isArray(u),P=[],Z={},le=!1,D=!!f.sheetStubs,V=l.split(t),O=0,L=V.length;O!=L;++O){p=V[O].trim();var Y=p.length;if(Y!==0){var G=0;e:for(g=0;g<Y;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(k=Oe(p.slice(G,g),!0),T=k.r!=null?parseInt(k.r,10):T+1,N=-1,f.sheetRows&&f.sheetRows<T)continue;Z={},le=!1,k.ht&&(le=!0,Z.hpt=parseFloat(k.ht),Z.hpx=Ll(Z.hpt)),k.hidden=="1"&&(le=!0,Z.hidden=!0),k.outlineLevel!=null&&(le=!0,Z.level=+k.outlineLevel),le&&(P[T-1]=Z)}break;case"<":G=g;break}if(G>=g)break;if(k=Oe(p.slice(G,g),!0),T=k.r!=null?parseInt(k.r,10):T+1,N=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(Z={},le=!1,k.ht&&(le=!0,Z.hpt=parseFloat(k.ht),Z.hpx=Ll(Z.hpt)),k.hidden=="1"&&(le=!0,Z.hidden=!0),k.outlineLevel!=null&&(le=!0,Z.level=+k.outlineLevel),le&&(P[T-1]=Z)),y=p.slice(g).split(e);for(var ie=0;ie!=y.length&&y[ie].trim().charAt(0)=="<";++ie);for(y=y.slice(ie),g=0;g!=y.length;++g)if(p=y[g].trim(),p.length!==0){if(v=p.match(r),x=g,w=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(x=0,b=v[1],w=0;w!=b.length&&!((S=b.charCodeAt(w)-64)<1||S>26);++w)x=26*x+S;--x,N=x}else++N;for(w=0;w!=p.length&&p.charCodeAt(w)!==62;++w);if(++w,k=Oe(p.slice(0,w),!0),k.r||(k.r=Re({r:T-1,c:N})),b=p.slice(w),E={t:""},(v=b.match(s))!=null&&v[1]!==""&&(E.v=et(v[1])),f.cellFormula){if((v=b.match(i))!=null&&v[1]!==""){if(E.f=et(ht(v[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=P2(E.f)),v[0].indexOf('t="array"')>-1)E.F=(b.match(a)||[])[1],E.F.indexOf(":")>-1&&Q.push([rt(E.F),E.F]);else if(v[0].indexOf('t="shared"')>-1){H=Oe(v[0]);var se=et(ht(v[1]));f.xlfn||(se=P2(se)),X[parseInt(H.si,10)]=[H,se,k.r]}}else(v=b.match(/<f[^>]*\/>/))&&(H=Oe(v[0]),X[H.si]&&(E.f=yV(X[H.si][1],X[H.si][2],k.r)));var ae=It(k.r);for(w=0;w<Q.length;++w)ae.r>=Q[w][0].s.r&&ae.r<=Q[w][0].e.r&&ae.c>=Q[w][0].s.c&&ae.c<=Q[w][0].e.c&&(E.F=Q[w][1])}if(k.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(D)E.t="z";else continue;else E.t=k.t||"n";switch(d.s.c>N&&(d.s.c=N),d.e.c<N&&(d.e.c=N),E.t){case"n":if(E.v==""||E.v==null){if(!D)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!D)continue;E.t="z"}else I=Jc[parseInt(E.v,10)],E.v=I.t,E.r=I.r,f.cellHTML&&(E.h=I.h);break;case"str":E.t="s",E.v=E.v!=null?ht(E.v):"",f.cellHTML&&(E.h=Bv(E.v));break;case"inlineStr":v=b.match(n),E.t="s",v!=null&&(I=Zv(v[1]))?(E.v=I.t,f.cellHTML&&(E.h=I.h)):E.v="";break;case"b":E.v=wt(E.v);break;case"d":f.cellDates?E.v=bt(E.v,1):(E.v=or(bt(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=UN[E.v];break}if(j=z=0,q=null,K&&k.s!==void 0&&(q=h.CellXf[k.s],q!=null&&(q.numFmtId!=null&&(j=q.numFmtId),f.cellStyles&&q.fillId!=null&&(z=q.fillId))),FC(E,j,z,f,m,h),f.cellDates&&K&&E.t=="n"&&rc(je[j])&&(E.t="d",E.v=Sm(E.v)),k.cm&&f.xlmeta){var J=(f.xlmeta.Cell||[])[+k.cm-1];J&&J.type=="XLDAPR"&&(E.D=!0)}if(F){var A=It(k.r);u[A.r]||(u[A.r]=[]),u[A.r][A.c]=E}else u[k.r]=E}}}}P.length>0&&(u["!rows"]=P)}}();function kG(e,t,r,n){var a=[],s=[],i=rt(e["!ref"]),o="",l,u="",f=[],d=0,m=0,h=e["!rows"],g=Array.isArray(e),p={r:u},y,v=-1;for(m=i.s.c;m<=i.e.c;++m)f[m]=Mt(m);for(d=i.s.r;d<=i.e.r;++d){for(s=[],u=Kt(d),m=i.s.c;m<=i.e.c;++m){l=f[m]+u;var x=g?(e[d]||[])[m]:e[l];x!==void 0&&(o=_G(x,l,e,t))!=null&&s.push(o)}(s.length>0||h&&h[d])&&(p={r:u},h&&h[d]&&(y=h[d],y.hidden&&(p.hidden=1),v=-1,y.hpx?v=Uu(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(p.ht=v,p.customHeight=1),y.level&&(p.outlineLevel=y.level)),a[a.length]=ve("row",s.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},y=h[d],y.hidden&&(p.hidden=1),v=-1,y.hpx?v=Uu(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(p.ht=v,p.customHeight=1),y.level&&(p.outlineLevel=y.level),a[a.length]=ve("row","",p));return a.join("")}function BC(e,t,r,n){var a=[qt,ve("worksheet",null,{xmlns:Co[0],"xmlns:r":sr.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=rt(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=He(f)}n||(n={}),l["!comments"]=[];var d=[];oG(l,r,e,t,a),a[a.length]=ve("dimension",null,{ref:u}),a[a.length]=wG(l,t,e,r),t.sheetFormat&&(a[a.length]=ve("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=pG(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=kG(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=uG(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=vG(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=sG(l["!merges"]));var m=-1,h,g=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=ct(n,-1,ft(p[1].Target).replace(/#.*$/,""),Ye.HLINK),h["r:id"]="rId"+g),(m=p[1].Target.indexOf("#"))>-1&&(h.location=ft(p[1].Target.slice(m+1))),p[1].Tooltip&&(h.tooltip=ft(p[1].Tooltip)),a[a.length]=ve("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=hG(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=_r("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(g=ct(n,-1,"../drawings/drawing"+(e+1)+".xml",Ye.DRAW),a[a.length]=ve("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=ct(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ye.VML),a[a.length]=ve("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function bG(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function EG(e,t,r){var n=oe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Uu(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,m=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Re(u)];g&&(d<0&&(d=h),m=h)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,m))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function TG(e,t,r,n){var a=EG(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&fe(e,0,a)}var NG=jo,CG=sc;function AG(){}function PG(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=RB(e),r}function DG(e,t,r){r==null&&(r=oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return vh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),IN(e,r),r.slice(0,r.l)}function jG(e){var t=ra(e);return[t]}function RG(e,t,r){return r==null&&(r=oe(8)),Ao(t,r)}function MG(e){var t=Po(e);return[t]}function IG(e,t,r){return r==null&&(r=oe(4)),Do(t,r)}function OG(e){var t=ra(e),r=e.read_shift(1);return[t,r,"b"]}function FG(e,t,r){return r==null&&(r=oe(9)),Ao(t,r),r.write_shift(1,e.v?1:0),r}function LG(e){var t=Po(e),r=e.read_shift(1);return[t,r,"b"]}function BG(e,t,r){return r==null&&(r=oe(5)),Do(t,r),r.write_shift(1,e.v?1:0),r}function UG(e){var t=ra(e),r=e.read_shift(1);return[t,r,"e"]}function $G(e,t,r){return r==null&&(r=oe(9)),Ao(t,r),r.write_shift(1,e.v),r}function WG(e){var t=Po(e),r=e.read_shift(1);return[t,r,"e"]}function HG(e,t,r){return r==null&&(r=oe(8)),Do(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function VG(e){var t=ra(e),r=e.read_shift(4);return[t,r,"s"]}function zG(e,t,r){return r==null&&(r=oe(12)),Ao(t,r),r.write_shift(4,t.v),r}function GG(e){var t=Po(e),r=e.read_shift(4);return[t,r,"s"]}function YG(e,t,r){return r==null&&(r=oe(8)),Do(t,r),r.write_shift(4,t.v),r}function XG(e){var t=ra(e),r=Fr(e);return[t,r,"n"]}function KG(e,t,r){return r==null&&(r=oe(16)),Ao(t,r),vo(e.v,r),r}function UC(e){var t=Po(e),r=Fr(e);return[t,r,"n"]}function qG(e,t,r){return r==null&&(r=oe(12)),Do(t,r),vo(e.v,r),r}function QG(e){var t=ra(e),r=Xv(e);return[t,r,"n"]}function JG(e,t,r){return r==null&&(r=oe(12)),Ao(t,r),ON(e.v,r),r}function ZG(e){var t=Po(e),r=Xv(e);return[t,r,"n"]}function eY(e,t,r){return r==null&&(r=oe(8)),Do(t,r),ON(e.v,r),r}function tY(e){var t=ra(e),r=zv(e);return[t,r,"is"]}function rY(e){var t=ra(e),r=Br(e);return[t,r,"str"]}function nY(e,t,r){return r==null&&(r=oe(12+4*e.v.length)),Ao(t,r),mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aY(e){var t=Po(e),r=Br(e);return[t,r,"str"]}function sY(e,t,r){return r==null&&(r=oe(8+4*e.v.length)),Do(t,r),mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iY(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=Em(e,n-e.l,r);i[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function oY(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=Em(e,n-e.l,r);i[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function lY(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=Fr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=Em(e,n-e.l,r);i[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function cY(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=Br(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=Em(e,n-e.l,r);i[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return i}var uY=jo,fY=sc;function dY(e,t){return t==null&&(t=oe(4)),t.write_shift(4,e),t}function hY(e,t){var r=e.l+t,n=jo(e),a=Gv(e),s=Br(e),i=Br(e),o=Br(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function mY(e,t){var r=oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));sc({s:It(e[0]),e:It(e[0])},r),Yv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return mr(a||"",r),mr(e[1].Tooltip||"",r),mr("",r),r.slice(0,r.l)}function pY(){}function gY(e,t,r){var n=e.l+t,a=FN(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Uz(e,n-e.l,r);i[1]=o}else e.l=n;return i}function vY(e,t,r){var n=e.l+t,a=jo(e),s=[a];if(r.cellFormula){var i=Wz(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function yY(e,t,r){r==null&&(r=oe(18));var n=Tm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var $C=["left","right","top","bottom","header","footer"];function xY(e){var t={};return $C.forEach(function(r){t[r]=Fr(e)}),t}function wY(e,t){return t==null&&(t=oe(6*8)),eo(e),$C.forEach(function(r){vo(e[r],t)}),t}function _Y(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SY(e,t,r){r==null&&(r=oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function kY(e){var t=oe(24);return t.write_shift(4,4),t.write_shift(4,1),sc(e,t),t}function bY(e,t){return t==null&&(t=oe(16*4+2)),t.write_shift(2,e.password?ey(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function EY(){}function TY(){}function NY(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,h,g,p,y,v,x,w,S,b,E=[];o.biff=12,o["!row"]=0;var k=0,T=!1,N=[],I={},H=o.supbooks||a.supbooks||[[]];if(H.sharedf=I,H.arrayf=N,H.SheetNames=a.SheetNames||a.Sheets.map(function(F){return F.name}),!o.supbooks&&(o.supbooks=H,a.Names))for(var j=0;j<a.Names.length;++j)H[0][j+1]=a.Names[j];var z=[],K=[],q=!1;$u[16]={n:"BrtShortReal",f:UC};var Q;if(Ps(e,function(P,Z,le){if(!m)switch(le){case 148:u=P;break;case 0:h=P,o.sheetRows&&o.sheetRows<=h.r&&(m=!0),S=Kt(y=h.r),o["!row"]=h.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=Ll(P.hpt)),K[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:P[2]},P[2]){case"n":g.v=P[1];break;case"s":w=Jc[P[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!P[1];break;case"e":g.v=P[1],o.cellText!==!1&&(g.w=Ds[g.v]);break;case"str":g.t="s",g.v=P[1];break;case"is":g.t="s",g.v=P[1].t;break}if((p=i.CellXf[P[0].iStyleRef])&&FC(g,p.numFmtId,null,o,s,i),v=P[0].c==-1?v+1:P[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=g):l[Mt(v)+S]=g,o.cellFormula){for(T=!1,k=0;k<N.length;++k){var D=N[k];h.r>=D[0].s.r&&h.r<=D[0].e.r&&v>=D[0].s.c&&v<=D[0].e.c&&(g.F=He(D[0]),T=!0)}!T&&P.length>3&&(g.f=P[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>v&&(f.s.c=v),f.e.r<h.r&&(f.e.r=h.r),f.e.c<v&&(f.e.c=v),o.cellDates&&p&&g.t=="n"&&rc(je[p.numFmtId])){var V=Ui(g.v);V&&(g.t="d",g.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}Q&&(Q.type=="XLDAPR"&&(g.D=!0),Q=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},v=P[0].c==-1?v+1:P[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=g):l[Mt(v)+S]=g,f.s.r>h.r&&(f.s.r=h.r),f.s.c>v&&(f.s.c=v),f.e.r<h.r&&(f.e.r=h.r),f.e.c<v&&(f.e.c=v),Q&&(Q.type=="XLDAPR"&&(g.D=!0),Q=void 0);break;case 176:E.push(P);break;case 49:Q=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var O=n["!id"][P.relId];for(O?(P.Target=O.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=O):P.relId==""&&(P.Target="#"+P.loc),y=P.rfx.s.r;y<=P.rfx.e.r;++y)for(v=P.rfx.s.c;v<=P.rfx.e.c;++v)o.dense?(l[y]||(l[y]=[]),l[y][v]||(l[y][v]={t:"z",v:void 0}),l[y][v].l=P):(x=Re({c:v,r:y}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=P);break;case 426:if(!o.cellFormula)break;N.push(P),b=o.dense?l[y][v]:l[Mt(v)+S],b.f=Mr(P[1],f,{r:h.r,c:v},H,o),b.F=He(P[0]);break;case 427:if(!o.cellFormula)break;I[Re(P[0].s)]=P[1],b=o.dense?l[y][v]:l[Mt(v)+S],b.f=Mr(P[1],f,{r:h.r,c:v},H,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)z[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},q||(q=!0,ty(P.w/256)),yi(z[P.e+1]);break;case 161:l["!autofilter"]={ref:He(P)};break;case 476:l["!margins"]=P;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),P.name&&(a.Sheets[r].CodeName=P.name),(P.above||P.left)&&(l["!outline"]={above:P.above,left:P.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),P.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Z.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=He(u||f)),o.sheetRows&&l["!ref"]){var X=rt(l["!ref"]);o.sheetRows<=+X.e.r&&(X.e.r=o.sheetRows-1,X.e.r>f.e.r&&(X.e.r=f.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>f.e.c&&(X.e.c=f.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),l["!fullref"]=l["!ref"],l["!ref"]=He(X))}return E.length>0&&(l["!merges"]=E),z.length>0&&(l["!cols"]=z),K.length>0&&(l["!rows"]=K),l}function CY(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Et(t),t.z=t.z||je[14],t.v=or(bt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ai(a.cellXfs,t,a),t.l&&s["!links"].push([Re(l),t.l]),t.c&&s["!comments"].push([Re(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=iy(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?fe(e,18,YG(t,l)):fe(e,7,zG(t,l))):(l.t="str",i?fe(e,17,sY(t,l)):fe(e,6,nY(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?fe(e,13,eY(t,l)):fe(e,2,JG(t,l)):i?fe(e,16,qG(t,l)):fe(e,5,KG(t,l)),!0;case"b":return l.t="b",i?fe(e,15,BG(t,l)):fe(e,4,FG(t,l)),!0;case"e":return l.t="e",i?fe(e,14,HG(t,l)):fe(e,3,$G(t,l)),!0}return i?fe(e,12,IG(t,l)):fe(e,1,RG(t,l)),!0}function AY(e,t,r,n){var a=rt(t["!ref"]||"A1"),s,i="",o=[];fe(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){i=Kt(f),TG(e,t,a,f);var d=!1;if(f<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){f===a.s.r&&(o[m]=Mt(m)),s=o[m]+i;var h=l?(t[f]||[])[m]:t[s];if(!h){d=!1;continue}d=CY(e,h,f,m,n,t,d)}}fe(e,146)}function PY(e,t){!t||!t["!merges"]||(fe(e,177,dY(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,fY(r))}),fe(e,178))}function DY(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,yY(n,r))}),fe(e,391))}function jY(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,kY(rt(t["!ref"]))),fe(e,650))}function RY(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=ct(r,-1,n[1].Target.replace(/#.*$/,""),Ye.HLINK);fe(e,494,mY(n,a))}}),delete t["!links"]}function MY(e,t,r,n){if(t["!comments"].length>0){var a=ct(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ye.VML);fe(e,551,Yv("rId"+a)),t["!legacy"]=a}}function IY(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:He(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=mn(s);o.s.r==o.e.r&&(o.e.r=mn(t["!ref"]).e.r,s=He(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe(e,161,sc(rt(s))),fe(e,162)}}function OY(e,t,r){fe(e,133),fe(e,137,SY(t,r)),fe(e,138),fe(e,134)}function FY(e,t){t["!protect"]&&fe(e,535,bY(t["!protect"]))}function LY(e,t,r,n){var a=dn(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=rt(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],fe(a,129),(r.vbaraw||i["!outline"])&&fe(a,147,DG(o,i["!outline"])),fe(a,148,CG(l)),OY(a,i,r.Workbook),DY(a,i),AY(a,i,e,t),FY(a,i),IY(a,i,r,e),PY(a,i),RY(a,i,n),i["!margins"]&&fe(a,476,wY(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&jY(a,i),MY(a,i,e,n),fe(a,130),a.end()}function BY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function UY(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=BY(d);f.s.r=f.s.c=0,f.e.c=o,u=Mt(o),m[0].forEach(function(h,g){i[u+Kt(g)]={t:"n",v:h,z:m[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=He(f)),i}function $Y(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(LC);return o&&oy(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function WY(e,t){e.l+=10;var r=Br(e);return{name:r}}function HY(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ps(e,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ly=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],VY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],zY=[],GY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function I2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=wt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function O2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function WC(e){O2(e.WBProps,ly),O2(e.CalcPr,GY),I2(e.WBView,VY),I2(e.Sheets,zY),pl.date1904=wt(e.WBProps.date1904)}function YY(e){return!e.Workbook||!e.Workbook.WBProps?"false":wt(e.Workbook.WBProps.date1904)?"true":"false"}var XY="][*?/\\".split("");function HC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return XY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function KY(e,t,r){e.forEach(function(n,a){HC(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function qY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];KY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Yz(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var QY=/<\w+:workbook/;function JY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Wr,function(l,u){var f=Oe(l);switch(es(f[0])){case"<?xml":break;case"<workbook":l.match(QY)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ly.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=wt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=ht(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=et(ht(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ht(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),wt(f.hidden||"0")&&(s.Hidden=!0),i=u+l.length;break;case"</definedName>":s.Ref=et(ht(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),Co.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return WC(r),r}function VC(e){var t=[qt];t[t.length]=ve("workbook",null,{xmlns:Co[0],"xmlns:r":sr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ly.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ve("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:ft(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ve("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ve("definedName",ft(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function ZY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=vg(e),r.name=Br(e),r}function eX(e,t){return t||(t=oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Yv(e.strRelID,t),mr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tX(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Br(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rX(e,t){t||(t=oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),IN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nX(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function aX(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=MB(e),i=$z(e,0,r),o=Gv(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function sX(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],$u[16]={n:"BrtFRTArchID$",f:nX},Ps(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Mr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),WC(r),r.Names=s,r.supbooks=i,r}function iX(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,eX(a))}fe(e,144)}function oX(e,t){t||(t=oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return mr("SheetJS",t),mr(uh.version,t),mr(uh.version,t),mr("7262",t),t.length>t.l?t.slice(0,t.l):t}function lX(e,t){t||(t=oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function cX(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(fe(e,135),fe(e,158,lX(a)),fe(e,136))}}function uX(e,t){var r=dn();return fe(r,131),fe(r,128,oX()),fe(r,153,rX(e.Workbook&&e.Workbook.WBProps||null)),cX(r,e),iX(r,e),fe(r,132),r.end()}function fX(e,t,r){return t.slice(-4)===".bin"?sX(e,r):JY(e,r)}function dX(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?NY(e,n,r,a,s,i,o):aG(e,n,r,a,s,i,o)}function hX(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?HY(e,n,r,a,s):$Y(e,n,r,a,s)}function mX(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?gV():vV()}function pX(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?mV():pV()}function gX(e,t,r,n){return t.slice(-4)===".bin"?fH(e,r,n):ZW(e,r,n)}function vX(e,t,r){return bC(e,r)}function yX(e,t,r){return t.slice(-4)===".bin"?yW(e,r):pW(e,r)}function xX(e,t,r){return t.slice(-4)===".bin"?cV(e,r):eV(e,r)}function wX(e,t,r){return t.slice(-4)===".bin"?QH(e):KH(e)}function _X(e,t,r,n){return r.slice(-4)===".bin"?JH(e,t,r,n):void 0}function SX(e,t,r){return t.slice(-4)===".bin"?GH(e,t,r):XH(e,t,r)}function kX(e,t,r){return(t.slice(-4)===".bin"?uX:VC)(e)}function bX(e,t,r,n,a){return(t.slice(-4)===".bin"?LY:BC)(e,r,n,a)}function EX(e,t,r){return(t.slice(-4)===".bin"?_H:SC)(e,r)}function TX(e,t,r){return(t.slice(-4)===".bin"?_W:mC)(e,r)}function NX(e,t,r){return(t.slice(-4)===".bin"?uV:NC)(e)}function CX(e){return(e.slice(-4)===".bin"?YH:EC)()}var zC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ia(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(zC),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(GC),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function AX(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(zC),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(GC),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var eu;function PX(e,t){var r=eu[e]||et(e);return r==="General"?po(t):ta(r,t)}function DX(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=wt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=bt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[et(t)]=a}function jX(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ds[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ju(e.v):e.w=po(e.v):e.w=PX(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=eu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&rc(n)){var a=Ui(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function RX(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=zW[n.Pattern]||n.Pattern)}e[t.ID]=t}function MX(e,t,r,n,a,s,i,o,l,u){var f="General",d=n.StyleID,m={};u=u||{};var h=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&h.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wt(e);break;case"String":n.t="s",n.r=Zw(et(e)),n.v=e.indexOf("<")>-1?et(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(bt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=et(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=UN[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Zw(t||e));break}if(jX(n,f,u),u.cellFormula!==!1)if(n.Formula){var p=et(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ml(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ml("RC:RC",a):n.ArrayRange&&(n.F=ml(n.ArrayRange,a),l.push([rt(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);u.cellStyles&&(h.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function IX(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Wp(e,t){var r=t||{};nc();var n=Rc(Uv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ht(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Et(r);return i.type="string",Fl.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(mt){a.indexOf("<"+mt)>=0&&(s=!0)}),s)return wK(n,r);eu={"General Number":"General","General Date":je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":je[15],"Short Date":je[14],"Long Time":je[19],"Medium Time":je[18],"Short Time":je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:je[2],Standard:je[4],Percent:je[10],Scientific:je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},d=[],m=r.dense?[]:{},h="",g={},p={},y=ia('<Data ss:Type="String">'),v=0,x=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},E={},k="",T=0,N=[],I={},H={},j=0,z=[],K=[],q={},Q=[],X,F=!1,P=[],Z=[],le={},D=0,V=0,O={Sheets:[],WBProps:{date1904:!1}},L={};Iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=Iu.exec(n);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?MX(n.slice(v,o.index),k,y,l[l.length-1][0]=="comment"?q:g,{c:x,r:w},b,Q[x],p,P,r):(k="",y=ia(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(g.c=K),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(m[w]||(m[w]=[]),m[w][x]=g):m[Mt(x)+Kt(w)]=g),g.HRef&&(g.l={Target:et(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(D=x+(parseInt(g.MergeAcross,10)|0),V=w+(parseInt(g.MergeDown,10)|0),N.push({s:{c:x,r:w},e:{c:D,r:V}})),!r.sheetStubs)g.MergeAcross?x=D+1:++x;else if(g.MergeAcross||g.MergeDown){for(var G=x;G<=D;++G)for(var ie=w;ie<=V;++ie)(G>x||ie>w)&&(r.dense?(m[ie]||(m[ie]=[]),m[ie][G]={t:"z"}):m[Mt(G)+Kt(ie)]={t:"z"});x=D+1}else++x;else g=AX(o[0]),g.Index&&(x=+g.Index-1),x<S.s.c&&(S.s.c=x),x>S.e.c&&(S.e.c=x),o[0].slice(-2)==="/>"&&++x,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),o[0].slice(-2)==="/>"&&(p=ia(o[0]),p.Index&&(w=+p.Index-1)),x=0,++w):(p=ia(o[0]),p.Index&&(w=+p.Index-1),le={},(p.AutoFitHeight=="0"||p.Height)&&(le.hpx=parseInt(p.Height,10),le.hpt=Uu(le.hpx),Z[w]=le),p.Hidden=="1"&&(le.hidden=!0,Z[w]=le));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(m["!ref"]=He(S),r.sheetRows&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=He(S))),N.length&&(m["!merges"]=N),Q.length>0&&(m["!cols"]=Q),Z.length>0&&(m["!rows"]=Z),f[h]=m}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=x=0,l.push([o[3],!1]),u=ia(o[0]),h=et(u.Name),m=r.dense?[]:{},N=[],P=[],Z=[],L={name:h,Hidden:0},O.Sheets.push(L);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Q=[],F=!1}break;case"style":o[1]==="/"?RX(b,E,r):E=ia(o[0]);break;case"numberformat":E.nf=et(ia(o[0]).Format||"General"),eu[E.nf]&&(E.nf=eu[E.nf]);for(var se=0;se!=392&&je[se]!=E.nf;++se);if(se==392){for(se=57;se!=392;++se)if(je[se]==null){ys(E.nf,se);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(X=ia(o[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!F&&X.wpx>10){F=!0,Or=wC;for(var ae=0;ae<Q.length;++ae)Q[ae]&&yi(Q[ae])}F&&yi(X),Q[X.Index-1||Q.length]=X;for(var J=0;J<+X.Span;++J)Q[Q.length]=Et(X);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var A=Oe(o[0]),me={Name:A.Name,Ref:ml(A.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(me.Sheet=O.Sheets.length-1),O.Names.push(me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=ia(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sU(I,Y,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));IX(q),K.push(q)}else l.push([o[3],!1]),u=ia(o[0]),q={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=ia(o[0]);m["!autofilter"]={ref:ml(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return $2(n,r);var We=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else j=o.index+o[0].length;break;case"header":m["!margins"]||eo(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||eo(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var Me=Oe(o[0]);m["!margins"]||eo(m["!margins"]={},"xlml"),isNaN(+Me.Top)||(m["!margins"].top=+Me.Top),isNaN(+Me.Left)||(m["!margins"].left=+Me.Left),isNaN(+Me.Right)||(m["!margins"].right=+Me.Right),isNaN(+Me.Bottom)||(m["!margins"].bottom=+Me.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?DX(H,Y,z,n.slice(j,o.index)):(z=o,j=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=f),xe.SheetNames=d,xe.Workbook=O,xe.SSF=Et(je),xe.Props=I,xe.Custprops=H,xe}function bg(e,t){switch(uy(t=t||{}),t.type||"base64"){case"base64":return Wp(Dn(e),t);case"binary":case"buffer":case"file":return Wp(e,t);case"array":return Wp(Ni(e),t)}}function OX(e,t){var r=[];return e.Props&&r.push(iU(e.Props,t)),e.Custprops&&r.push(oU(e.Props,e.Custprops)),r.join("")}function FX(){return""}function LX(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(ve("NumberFormat",null,{"ss:Format":ft(je[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(ve("Style",s.join(""),i))}),ve("Styles",r.join(""))}function YC(e){return ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ay(e.Ref,{r:0,c:0})})}function BX(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(YC(a)))}return ve("Names",r.join(""))}function UX(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(YC(o)))}return s.join("")}function $X(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ve("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(_r("ProtectContents","True")),e["!protect"].objects&&a.push(_r("ProtectObjects","True")),e["!protect"].scenarios&&a.push(_r("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(_r("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(_r("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ve("WorksheetOptions",a.join(""),{xmlns:_n.x})}function WX(e){return e.map(function(t){var r=cB(t.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":t.a})}).join("")}function HX(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ft(ay(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=It(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",m=String(e.v);break;case"b":d="Boolean",m=e.v?"1":"0";break;case"e":d="Error",m=Ds[e.v];break;case"d":d="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||je[14]);break;case"s":d="String",m=lB(e.v||"");break}var h=Ai(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=i.c+1;var g=e.v!=null?m:"",p=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=WX(e.c)),ve("Cell",p,o)}function VX(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ll(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zX(e,t,r,n){if(!e["!ref"])return"";var a=rt(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){yi(y);var x=!!y.width,w=Tm(v,y),S={"ss:Index":v+1};x&&(S["ss:Width"]=Lu(w.width)),y.hidden&&(S["ss:Hidden"]="1"),o.push(ve("Column",null,S))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[VX(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var m=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>u)&&!(s[i].e.c<d)&&!(s[i].e.r<u)){(s[i].s.c!=d||s[i].s.r!=u)&&(m=!0);break}if(!m){var h={r:u,c:d},g=Re(h),p=l?(e[u]||[])[d]:e[g];f.push(HX(p,g,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function GX(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?UX(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?zX(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push($X(s,t,e,r)),n.join("")}function YX(e,t){t||(t={}),e.SSF||(e.SSF=Et(je)),e.SSF&&(nc(),xm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(OX(e,t)),r.push(FX()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ve("Worksheet",GX(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=LX(e,t),r[3]=BX(e),qt+ve("Workbook",r.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}function XX(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=BB(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=UB(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var KX=[60,1084,2066,2165,2175];function qX(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=ms(r,r.l),u=Eg[l],f=0;u!=null&&KX.indexOf(l)>-1;)s=ms(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,u=Eg[l=ms(r,r.l)];var d=hr(i);wr(d,0);var m=0;d.lens=[];for(var h=0;h<i.length;++h)d.lens.push(m),m+=i[h].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Ma(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=je[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ds[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ju(e.v):e.w=po(e.v):e.w=ta(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&rc(je[n]||String(n))){var a=Ui(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function od(e,t,r){return{v:e,ixfe:t,t:r}}function QX(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],u="",f={},d,m="",h,g,p,y,v={},x=[],w,S,b=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},N=function(Be){return Be<8?Qi[Be]:Be<64&&E[Be-8]||Qi[Be]},I=function(Be,Ct,zr){var At=Ct.XF.data;if(!(!At||!At.patternType||!zr||!zr.cellStyles)){Ct.s={},Ct.s.patternType=At.patternType;var rn;(rn=Fu(N(At.icvFore)))&&(Ct.s.fgColor={rgb:rn}),(rn=Fu(N(At.icvBack)))&&(Ct.s.bgColor={rgb:rn})}},H=function(Be,Ct,zr){if(!(le>1)&&!(zr.sheetRows&&Be.r>=zr.sheetRows)){if(zr.cellStyles&&Ct.XF&&Ct.XF.data&&I(Be,Ct,zr),delete Ct.ixfe,delete Ct.XF,d=Be,m=Re(Be),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<i.s.r&&(i.s.r=Be.r),Be.c<i.s.c&&(i.s.c=Be.c),Be.r+1>i.e.r&&(i.e.r=Be.r+1),Be.c+1>i.e.c&&(i.e.c=Be.c+1),zr.cellFormula&&Ct.f){for(var At=0;At<x.length;++At)if(!(x[At][0].s.c>Be.c||x[At][0].s.r>Be.r)&&!(x[At][0].e.c<Be.c||x[At][0].e.r<Be.r)){Ct.F=He(x[At][0]),(x[At][0].s.c!=Be.c||x[At][0].s.r!=Be.r)&&delete Ct.f,Ct.f&&(Ct.f=""+Mr(x[At][1],i,Be,P,j));break}}zr.dense?(a[Be.r]||(a[Be.r]=[]),a[Be.r][Be.c]=Ct):a[m]=Ct}},j={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var z,K=[],q=[],Q=[],X=[],F=!1,P=[];P.SheetNames=j.snames,P.sharedf=j.sharedf,P.arrayf=j.arrayf,P.names=[],P.XTI=[];var Z=0,le=0,D=0,V=[],O=[],L;j.codepage=1200,ga(1200);for(var Y=!1;e.l<e.length-1;){var G=e.l,ie=e.read_shift(2);if(ie===0&&Z===10)break;var se=e.l===e.length?0:e.read_shift(2),ae=Eg[ie];if(ae&&ae.f){if(t.bookSheets&&Z===133&&ie!==133)break;if(Z=ie,ae.r===2||ae.r==12){var J=e.read_shift(2);if(se-=2,!j.enc&&J!==ie&&((J&255)<<8|J>>8)!==ie)throw new Error("rt mismatch: "+J+"!="+ie);ae.r==12&&(e.l+=10,se-=10)}var A={};if(ie===10?A=ae.f(e,se,j):A=qX(ie,ae,e,se,j),le==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(ie){case 34:r.opts.Date1904=k.WBProps.date1904=A;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=A,!t.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=A;break;case 66:var me=Number(A);switch(me){case 21010:me=1200;break;case 32768:me=1e4;break;case 32769:me=1252;break}ga(j.codepage=me),Y=!0;break;case 317:j.rrtabid=A;break;case 25:j.winlocked=A;break;case 439:r.opts.RefreshAll=A;break;case 12:r.opts.CalcCount=A;break;case 16:r.opts.CalcDelta=A;break;case 17:r.opts.CalcIter=A;break;case 13:r.opts.CalcMode=A;break;case 14:r.opts.CalcPrecision=A;break;case 95:r.opts.CalcSaveRecalc=A;break;case 15:j.CalcRefMode=A;break;case 2211:r.opts.FullCalc=A;break;case 129:A.fDialog&&(a["!type"]="dialog"),A.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),A.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(A);break;case 430:P.push([A]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(A);break;case 24:case 536:L={Name:A.Name,Ref:Mr(A.rgce,i,null,P,j)},A.itab>0&&(L.Sheet=A.itab-1),P.names.push(L),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(O[A.itab-1]={ref:He(A.rgce[0][0][1][2])});break;case 22:j.ExternCount=A;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(A),P.XTI=P.XTI.concat(A);break;case 2196:if(j.biff<8)break;L!=null&&(L.Comment=A[1]);break;case 18:a["!protect"]=A;break;case 19:A!==0&&j.WTF&&console.error("Password verifier: "+A);break;case 133:s[A.pos]=A,j.snames.push(A.name);break;case 10:{if(--le)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=He(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=He(i),i.e.r=ke}i.e.r++,i.e.c++}K.length>0&&(a["!merges"]=K),q.length>0&&(a["!objects"]=q),Q.length>0&&(a["!cols"]=Q),X.length>0&&(a["!rows"]=X),k.Sheets.push(T)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),j.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(j.biff=5,Y=!0,ga(j.codepage=28591)),j.biff==8&&A.BIFFVer==0&&A.dt==16&&(j.biff=2),le++)break;if(a=t.dense?[]:{},j.biff<8&&!Y&&(Y=!0,ga(j.codepage=t.codepage||1252)),j.biff<5||A.BIFFVer==0&&A.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:e.l-se,name:u};s[We.pos]=We,j.snames.push(u)}else u=(s[G]||{name:""}).name;A.dt==32&&(a["!type"]="chart"),A.dt==64&&(a["!type"]="macro"),K=[],q=[],j.arrayf=x=[],Q=[],X=[],F=!1,T={Hidden:(s[G]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[A.r]||[])[A.c]:a[Re({c:A.c,r:A.r})])&&++A.c,w={ixfe:A.ixfe,XF:b[A.ixfe]||{},v:A.val,t:"n"},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t);break;case 5:case 517:w={ixfe:A.ixfe,XF:b[A.ixfe],v:A.val,t:A.t},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t);break;case 638:w={ixfe:A.ixfe,XF:b[A.ixfe],v:A.rknum,t:"n"},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t);break;case 189:for(var Me=A.c;Me<=A.C;++Me){var xe=A.rkrec[Me-A.c][0];w={ixfe:xe,XF:b[xe],v:A.rkrec[Me-A.c][1],t:"n"},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:Me,r:A.r},w,t)}break;case 6:case 518:case 1030:{if(A.val=="String"){o=A;break}if(w=od(A.val,A.cell.ixfe,A.tt),w.XF=b[w.ixfe],t.cellFormula){var mt=A.formula;if(mt&&mt[0]&&mt[0][0]&&mt[0][0][0]=="PtgExp"){var nr=mt[0][0][1][0],pn=mt[0][0][1][1],Hr=Re({r:nr,c:pn});v[Hr]?w.f=""+Mr(A.formula,i,A.cell,P,j):w.F=((t.dense?(a[nr]||[])[pn]:a[Hr])||{}).F}else w.f=""+Mr(A.formula,i,A.cell,P,j)}D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H(A.cell,w,t),o=A}break;case 7:case 519:if(o)o.val=A,w=od(A,o.cell.ixfe,"s"),w.XF=b[w.ixfe],t.cellFormula&&(w.f=""+Mr(o.formula,i,o.cell,P,j)),D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(A);var js=Re(A[0].s);if(h=t.dense?(a[A[0].s.r]||[])[A[0].s.c]:a[js],t.cellFormula&&h){if(!o||!js||!h)break;h.f=""+Mr(A[1],i,A[0],P,j),h.F=He(A[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;v[Re(o.cell)]=A[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Re(o.cell)],(h||{}).f=""+Mr(A[0],i,d,P,j)}}break;case 253:w=od(l[A.isst].t,A.ixfe,"s"),l[A.isst].h&&(w.h=l[A.isst].h),w.XF=b[w.ixfe],D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:A.ixfe,XF:b[A.ixfe],t:"z"},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t));break;case 190:if(t.sheetStubs)for(var Er=A.c;Er<=A.C;++Er){var Vr=A.ixfe[Er-A.c];w={ixfe:Vr,XF:b[Vr],t:"z"},D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:Er,r:A.r},w,t)}break;case 214:case 516:case 4:w=od(A.val,A.ixfe,"s"),w.XF=b[w.ixfe],D>0&&(w.z=V[w.ixfe>>8&63]),Ma(w,t,r.opts.Date1904),H({c:A.c,r:A.r},w,t);break;case 0:case 512:le===1&&(i=A);break;case 252:l=A;break;case 1054:if(j.biff==4){V[D++]=A[1];for(var na=0;na<D+163&&je[na]!=A[1];++na);na>=163&&ys(A[1],D+163)}else ys(A[1],A[0]);break;case 30:{V[D++]=A;for(var zt=0;zt<D+163&&je[zt]!=A;++zt);zt>=163&&ys(A,D+163)}break;case 229:K=K.concat(A);break;case 93:q[A.cmo[0]]=j.lastobj=A;break;case 438:j.lastobj.TxO=A;break;case 127:j.lastobj.ImData=A;break;case 440:for(y=A[0].s.r;y<=A[0].e.r;++y)for(p=A[0].s.c;p<=A[0].e.c;++p)h=t.dense?(a[y]||[])[p]:a[Re({c:p,r:y})],h&&(h.l=A[1]);break;case 2048:for(y=A[0].s.r;y<=A[0].e.r;++y)for(p=A[0].s.c;p<=A[0].e.c;++p)h=t.dense?(a[y]||[])[p]:a[Re({c:p,r:y})],h&&h.l&&(h.l.Tooltip=A[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;h=t.dense?(a[A[0].r]||[])[A[0].c]:a[Re(A[0])];var In=q[A[2]];h||(t.dense?(a[A[0].r]||(a[A[0].r]=[]),h=a[A[0].r][A[0].c]={t:"z"}):h=a[Re(A[0])]={t:"z"},i.e.r=Math.max(i.e.r,A[0].r),i.s.r=Math.min(i.s.r,A[0].r),i.e.c=Math.max(i.e.c,A[0].c),i.s.c=Math.min(i.s.c,A[0].c)),h.c||(h.c=[]),g={a:A[1],t:In.TxO.t},h.c.push(g)}break;case 2173:LH(b[A.ixfe],A.ext);break;case 125:{if(!j.cellStyles)break;for(;A.e>=A.s;)Q[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},F||(F=!0,ty(A.w/256)),yi(Q[A.e+1])}break;case 520:{var vr={};A.level!=null&&(X[A.r]=vr,vr.level=A.level),A.hidden&&(X[A.r]=vr,vr.hidden=!0),A.hpt&&(X[A.r]=vr,vr.hpt=A.hpt,vr.hpx=Ll(A.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||eo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=A;break;case 161:a["!margins"]||eo(a["!margins"]={}),a["!margins"].header=A.header,a["!margins"].footer=A.footer;break;case 574:A.RTL&&(k.Views[0].RTL=!0);break;case 146:E=A;break;case 2198:z=A;break;case 140:S=A;break;case 442:u?T.CodeName=A||T.name:k.WBProps.CodeName=A||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=se}return r.SheetNames=Vt(s).sort(function(On,Be){return Number(On)-Number(Be)}).map(function(On){return s[On].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&O.forEach(function(On,Be){r.Sheets[r.SheetNames[Be]]["!autofilter"]=On}),r.Strings=l,r.SSF=Et(je),j.enc&&(r.Encryption=j.enc),z&&(r.Themes=z),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),P.names.length>0&&(k.Names=P.names),r.Workbook=k,r}var tu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function JX(e,t,r){var n=Ae.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=v2(n,yg,tu.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=Ae.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=v2(i,xg,tu.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(GN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ZX(e,t){var r=[],n=[],a=[],s=0,i,o=Yw(yg,"n"),l=Yw(xg,"n");if(e.Props)for(i=Vt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Vt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)ZN.indexOf(a[s][0])>-1||zN.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Ae.utils.cfb_add(t,"/SummaryInformation",y2(n,tu.SI,l,xg)),(r.length||u.length)&&Ae.utils.cfb_add(t,"/DocumentSummaryInformation",y2(r,tu.DSI,o,yg,u.length?u:null,tu.UDI))}function XC(e,t){t||(t={}),uy(t),Dv(),t.codepage&&Pv(t.codepage);var r,n;if(e.FullPaths){if(Ae.find(e,"/encryption"))throw new Error("File is password-protected");r=Ae.find(e,"!CompObj"),n=Ae.find(e,"/Workbook")||Ae.find(e,"/Book")}else{switch(t.type){case"base64":e=kn(Dn(e));break;case"binary":e=kn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var a,s;if(r&&XX(r),t.bookProps&&!t.bookSheets)a={};else{var i=Ge?"buffer":"array";if(n&&n.content)a=QX(n.content,t);else if((s=Ae.find(e,"PerfectOffice_MAIN"))&&s.content)a=Zi.to_workbook(s.content,(t.type=i,t));else if((s=Ae.find(e,"NativeContent_MAIN"))&&s.content)a=Zi.to_workbook(s.content,(t.type=i,t));else throw(s=Ae.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ae.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=dV(e))}var o={};return e.FullPaths&&JX(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function eK(e,t){var r=t||{},n=Ae.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ae.utils.cfb_add(n,a,KC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&ZX(e,n),r.biff==8&&e.vbaraw&&hV(n,Ae.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var $u={0:{f:bG},1:{f:jG},2:{f:QG},3:{f:UG},4:{f:OG},5:{f:XG},6:{f:rY},7:{f:VG},8:{f:cY},9:{f:lY},10:{f:iY},11:{f:oY},12:{f:MG},13:{f:ZG},14:{f:WG},15:{f:LG},16:{f:UC},17:{f:aY},18:{f:GG},19:{f:zv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aX},40:{},42:{},43:{f:rH},44:{f:eH},45:{f:sH},46:{f:oH},47:{f:iH},48:{},49:{f:NB},50:{},51:{f:$H},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uC},62:{f:tY},63:{f:qH},64:{f:EY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_Y},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:PG},148:{f:NG,p:16},151:{f:pY},152:{},153:{f:tX},154:{},155:{},156:{f:ZY},157:{},158:{},159:{T:1,f:vW},160:{T:-1},161:{T:1,f:jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:BH},336:{T:-1},337:{f:VH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:gY},427:{f:vY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:AG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:oV},633:{T:1},634:{T:-1},635:{T:1,f:sV},636:{T:-1},637:{f:DB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:TY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Eg={6:{f:Up},10:{f:Bs},12:{f:er},13:{f:er},14:{f:Gt},15:{f:Gt},16:{f:Fr},17:{f:Gt},18:{f:Gt},19:{f:er},20:{f:b2},21:{f:b2},23:{f:cC},24:{f:T2},25:{f:Gt},26:{},27:{},28:{f:T$},29:{},34:{f:Gt},35:{f:E2},38:{f:Fr},39:{f:Fr},40:{f:Fr},41:{f:Fr},42:{f:Gt},43:{f:Gt},47:{f:LW},49:{f:ZU},51:{f:er},60:{},61:{f:XU},64:{f:Gt},65:{f:JU},66:{f:er},77:{},80:{},81:{},82:{},85:{f:er},89:{},90:{},91:{},92:{f:FU},93:{f:A$},94:{},95:{f:Gt},96:{},97:{},99:{f:Gt},125:{f:uC},128:{f:m$},129:{f:BU},130:{f:er},131:{f:Gt},132:{f:Gt},133:{f:UU},134:{},140:{f:F$},141:{f:er},144:{},146:{f:U$},151:{},152:{},153:{},154:{},155:{},156:{f:er},157:{},158:{},160:{f:Y$},161:{f:H$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:u$},190:{f:f$},193:{f:Bs},197:{},198:{},199:{},200:{},201:{},202:{f:Gt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:er},220:{},221:{f:Gt},222:{},224:{f:h$},225:{f:OU},226:{f:Bs},227:{},229:{f:N$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:WU},253:{f:t$},255:{f:VU},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:eC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Gt},353:{f:Bs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:x$},431:{f:Gt},432:{},433:{},434:{},437:{},438:{f:j$},439:{f:Gt},440:{f:R$},441:{},442:{f:vf},443:{},444:{f:er},445:{},446:{},448:{f:Bs},449:{f:YU,r:2},450:{f:Bs},512:{f:_2},513:{f:G$},515:{f:v$},516:{f:n$},517:{f:k2},519:{f:X$},520:{f:zU},523:{},545:{f:N2},549:{f:w2},566:{},574:{f:qU},638:{f:c$},659:{},1048:{},1054:{f:s$},1084:{},1212:{f:k$},2048:{f:I$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ad},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$$,r:12},2173:{f:FH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Gt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:S$,r:12},2197:{},2198:{f:DH,r:12},2199:{},2200:{},2201:{},2202:{f:b$,r:12},2203:{f:Bs},2204:{},2205:{},2206:{},2207:{},2211:{f:GU},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:V$},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:B$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_2},1:{},2:{f:Z$},3:{f:Q$},4:{f:q$},5:{f:k2},7:{f:tW},8:{},9:{f:ad},11:{},22:{f:er},30:{f:o$},31:{},32:{},33:{f:N2},36:{},37:{f:w2},50:{f:rW},62:{},52:{},67:{},68:{f:er},69:{},86:{},126:{},127:{f:K$},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nW},223:{},234:{},354:{},421:{},518:{f:Up},521:{f:ad},536:{f:T2},547:{f:E2},561:{},579:{},1030:{f:Up},1033:{f:ad},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Wv(r)&&e.push(r)}}function tK(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ye(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function _f(e,t,r){return e||(e=oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function rK(e,t,r,n){var a=oe(9);return _f(a,e,t),tC(r,n||"b",a),a}function nK(e,t,r){var n=oe(8+2*r.length);return _f(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function aK(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?or(bt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ye(e,2,eW(r,n,a)):ye(e,3,J$(r,n,a));return;case"b":case"e":ye(e,5,rK(r,n,t.v,t.t));return;case"s":case"str":ye(e,4,nK(r,n,(t.v||"").slice(0,255)));return}ye(e,1,_f(null,r,n))}function sK(e,t,r,n){var a=Array.isArray(t),s=rt(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=He(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Kt(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Mt(f)),i=l[f]+o;var d=a?(t[u]||[])[f]:t[i];d&&aK(e,d,u,f)}}}function iK(e,t){for(var r=t||{},n=dn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,Jv(e,16,r)),sK(n,e.Sheets[e.SheetNames[a]],a,r),ye(n,10),n.end()}function oK(e,t,r){ye(e,49,e$({sz:12,name:"Arial"},r))}function lK(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,1054,i$(a,t[a],r))})}function cK(e,t){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(e,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),iC(rt(t["!ref"]||"A1"),r),r.write_shift(4,4),ye(e,2152,r)}function uK(e,t){for(var r=0;r<16;++r)ye(e,224,S2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ye(e,224,S2(n,0,t))})}function fK(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ye(e,440,M$(n)),n[1].Tooltip&&ye(e,2048,O$(n))}delete t["!links"]}function dK(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ye(e,125,W$(Tm(a,n),a))})}}function hK(e,t,r,n,a){var s=16+Ai(a.cellXfs,t,a);if(t.v==null&&!t.bf){ye(e,513,xo(r,n,s));return}if(t.bf)ye(e,6,Bz(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?or(bt(t.v)):t.v;ye(e,515,y$(r,n,i,s));break;case"b":case"e":ye(e,517,g$(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=iy(a.Strings,t.v,a.revStrings);ye(e,253,r$(r,n,o,s))}else ye(e,516,a$(r,n,(t.v||"").slice(0,255),s,a));break;default:ye(e,513,xo(r,n,s))}}function mK(e,t,r){var n=dn(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,f,d="",m=[],h=rt(s["!ref"]||"A1"),g=u?65536:16384;if(h.e.c>255||h.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}ye(n,2057,Jv(r,16,t)),ye(n,13,Hn(1)),ye(n,12,Hn(100)),ye(n,15,qr(!0)),ye(n,17,qr(!1)),ye(n,16,vo(.001)),ye(n,95,qr(!0)),ye(n,42,qr(!1)),ye(n,43,qr(!1)),ye(n,130,Hn(1)),ye(n,128,p$()),ye(n,131,qr(!1)),ye(n,132,qr(!1)),u&&dK(n,s["!cols"]),ye(n,512,l$(h,t)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=Kt(p);for(var y=h.s.c;y<=h.e.c;++y){p===h.s.r&&(m[y]=Mt(y)),f=m[y]+d;var v=l?(s[p]||[])[y]:s[f];v&&(hK(n,v,p,y,t),u&&v.l&&s["!links"].push([f,v.l]))}}var x=o.CodeName||o.name||a;return u&&ye(n,574,QU((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&ye(n,229,C$(s["!merges"])),u&&fK(n,s),ye(n,442,rC(x)),u&&cK(n,s),ye(n,10),n.end()}function pK(e,t,r){var n=dn(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(ye(n,2057,Jv(e,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?Hn(1200):null),ye(n,193,gU(2)),l&&ye(n,191),l&&ye(n,192),ye(n,226),ye(n,92,LU("SheetJS",r)),ye(n,66,Hn(o?1200:1252)),o&&ye(n,353,Hn(0)),o&&ye(n,448),ye(n,317,z$(e.SheetNames.length)),o&&e.vbaraw&&ye(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";ye(n,442,rC(u))}ye(n,156,Hn(17)),ye(n,25,qr(!1)),ye(n,18,qr(!1)),ye(n,19,Hn(0)),o&&ye(n,431,qr(!1)),o&&ye(n,444,Hn(0)),ye(n,61,KU()),ye(n,64,qr(!1)),ye(n,141,Hn(0)),ye(n,34,qr(YY(e)=="true")),ye(n,14,qr(!0)),o&&ye(n,439,qr(!1)),ye(n,218,Hn(0)),oK(n,e,r),lK(n,e.SSF,r),uK(n,r),o&&ye(n,352,qr(!1));var f=n.end(),d=dn();o&&ye(d,140,L$()),o&&r.Strings&&tK(d,252,HU(r.Strings)),ye(d,10);var m=d.end(),h=dn(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var y=f.length+g+m.length;for(p=0;p<e.SheetNames.length;++p){var v=s[p]||{};ye(h,133,$U({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),y+=t[p].length}var x=h.end();if(g!=x.length)throw new Error("BS8 "+g+" != "+x.length);var w=[];return f.length&&w.push(f),x.length&&w.push(x),m.length&&w.push(m),hr(w)}function gK(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Et(je)),e&&e.SSF&&(nc(),xm(e.SSF),r.revssf=_m(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fy(r),r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=mK(a,r,e);return n.unshift(pK(e,n,r)),hr(n)}function KC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=mn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return gK(e,t);case 4:case 3:case 2:return iK(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function F2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=eB(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var p=l[i].trim(),y=p.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var v=p.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var x=v[o].trim();if(x.match(/<t[dh]/i)){for(var w=x,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var b=0;b<g.length;++b){var E=g[b];E.s.c==f&&E.s.r<u&&u<=E.e.r&&(f=E.e.c+1,b=-1)}var k=Oe(x.slice(0,x.indexOf(">")));m=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||m>1)&&g.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+m-1}});var T=k.t||k["data-t"]||"";if(!w.length){f+=m;continue}if(w=xN(w),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!w.length){f+=m;continue}var N={t:"s",v:w};r.raw||!w.trim().length||T=="s"||(w==="TRUE"?N={t:"b",v:!0}:w==="FALSE"?N={t:"b",v:!1}:isNaN(_a(w))?isNaN(Ol(w).getDate())||(N={t:"d",v:bt(w)},r.cellDates||(N={t:"n",v:or(N.v)}),N.z=r.dateNF||je[14]):N={t:"n",v:_a(w)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=N):n[Re({r:u,c:f})]=N,f+=m}}}}return n["!ref"]=He(h),g.length&&(n["!merges"]=g),n}function vK(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Re({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],m=d&&d.v!=null&&(d.h||Bv(d.w||(Ns(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(ve("td",m,h))}}var g="<tr>";return g+s.join("")+"</tr>"}var yK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xK="</body></html>";function wK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ci(F2(r[0],t),t);var n=my();return r.forEach(function(a,s){py(n,F2(a,t),"Sheet"+(s+1))}),n}function _K(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function qC(e,t){var r=t||{},n=r.header!=null?r.header:yK,a=r.footer!=null?r.footer:xK,s=[n],i=mn(e["!ref"]);r.dense=Array.isArray(e),s.push(_K(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(vK(e,i,o,r));return s.push("</table>"+a),s.join("")}function QC(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?It(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=mn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],m=0,h=e["!rows"]||(e["!rows"]=[]),g=0,p=0,y=0,v=0,x=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<l;++g){var S=o[g];if(L2(S)){if(n.display)continue;h[p]={hidden:!0}}var b=S.children;for(y=v=0;y<b.length;++y){var E=b[y];if(!(n.display&&L2(E))){var k=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):xN(E.innerHTML),T=E.getAttribute("data-z")||E.getAttribute("z");for(m=0;m<d.length;++m){var N=d[m];N.s.c==v+s&&N.s.r<p+a&&p+a<=N.e.r&&(v=N.e.c+1-s,m=-1)}w=+E.getAttribute("colspan")||1,((x=+E.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:p+a,c:v+s},e:{r:p+a+(x||1)-1,c:v+s+(w||1)-1}});var I={t:"s",v:k},H=E.getAttribute("data-t")||E.getAttribute("t")||"";k!=null&&(k.length==0?I.t=H||"z":n.raw||k.trim().length==0||H=="s"||(k==="TRUE"?I={t:"b",v:!0}:k==="FALSE"?I={t:"b",v:!1}:isNaN(_a(k))?isNaN(Ol(k).getDate())||(I={t:"d",v:bt(k)},n.cellDates||(I={t:"n",v:or(I.v)}),I.z=n.dateNF||je[14]):I={t:"n",v:_a(k)})),I.z===void 0&&T!=null&&(I.z=T);var j="",z=E.getElementsByTagName("A");if(z&&z.length)for(var K=0;K<z.length&&!(z[K].hasAttribute("href")&&(j=z[K].getAttribute("href"),j.charAt(0)!="#"));++K);j&&j.charAt(0)!="#"&&(I.l={Target:j}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][v+s]=I):e[Re({c:v+s,r:p+a})]=I,u.e.c<v+s&&(u.e.c=v+s),v+=w}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=He(u),p>=l&&(e["!fullref"]=He((u.e.r=o.length-g+p-1+a,u))),e}function JC(e,t){var r=t||{},n=r.dense?[]:{};return QC(n,e,t)}function SK(e,t){return Ci(JC(e,t),t)}function L2(e){var t="",r=kK(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function kK(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=et(t.replace(/<[^>]*>/g,""));return[r]}var B2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ZC(e,t){var r=t||{},n=Uv(e),a=[],s,i,o={name:""},l="",u=0,f,d,m={},h=[],g=r.dense?[]:{},p,y,v={value:""},x="",w=0,S=[],b=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,N={},I=[],H={},j=0,z=0,K=[],q=1,Q=1,X=[],F={Names:[]},P={},Z=["",""],le=[],D={},V="",O=0,L=!1,Y=!1,G=0;for(Iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Iu.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?g["!ref"]=He(k):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(g["!fullref"]=g["!ref"],k.e.r=r.sheetRows-1,g["!ref"]=He(k)),I.length&&(g["!merges"]=I),K.length&&(g["!rows"]=K),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),m[f.name]=g,Y=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Oe(p[0],!1),b=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,g=r.dense?[]:{},I=[],K=[],Y=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"行":if(p[1]==="/"){b+=q,q=1;break}if(d=Oe(p[0],!1),d.行号?b=d.行号-1:b==-1&&(b=0),q=+d["number-rows-repeated"]||1,q<10)for(G=0;G<q;++G)T>0&&(K[b+G]={level:T});E=-1;break;case"covered-table-cell":p[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[b]||(g[b]=[]),g[b][E]={t:"z"}):g[Re({r:b,c:E})]={t:"z"}),x="",S=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++E,v=Oe(p[0],!1),Q=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=M2(et(v.formula))),(v.数据类型||v["value-type"])=="string"&&(y.t="s",y.v=et(v["string-value"]||""),r.dense?(g[b]||(g[b]=[]),g[b][E]=y):g[Re({r:b,c:E})]=y),E+=Q-1;else if(p[1]!=="/"){++E,x="",w=0,S=[],Q=1;var ie=q?b+q-1:b;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),b<k.s.r&&(k.s.r=b),ie>k.e.r&&(k.e.r=ie),v=Oe(p[0],!1),le=[],D={},y={t:v.数据类型||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=et(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(j=parseInt(v["number-matrix-rows-spanned"],10)||0,z=parseInt(v["number-matrix-columns-spanned"],10)||0,H={s:{r:b,c:E},e:{r:b+j-1,c:E+z-1}},y.F=He(H),X.push([H,y.F])),v.formula)y.f=M2(v.formula);else for(G=0;G<X.length;++G)b>=X[G][0].s.r&&b<=X[G][0].e.r&&E>=X[G][0].s.c&&E<=X[G][0].e.c&&(y.F=X[G][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(j=parseInt(v["number-rows-spanned"],10)||0,z=parseInt(v["number-columns-spanned"],10)||0,H={s:{r:b,c:E},e:{r:b+j-1,c:E+z-1}},I.push(H)),v["number-columns-repeated"]&&(Q=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=wt(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=bt(v["date-value"]),r.cellDates||(y.t="n",y.v=or(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Q9(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Sm(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(x=et(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(L=!1,y.t==="s"&&(y.v=x||"",S.length&&(y.R=S),L=w==0),P.Target&&(y.l=P),le.length>0&&(y.c=le,le=[]),x&&r.cellText!==!1&&(y.w=x),L&&(y.t="z",delete y.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var se=0;se<q;++se){if(Q=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(g[b+se]||(g[b+se]=[]),g[b+se][E]=se==0?y:Et(y);--Q>0;)g[b+se][E+Q]=Et(y);else for(g[Re({r:b+se,c:E})]=y;--Q>0;)g[Re({r:b+se,c:E+Q})]=Et(y);k.e.c<=E&&(k.e.c=E)}Q=parseInt(v["number-columns-repeated"]||"1",10),E+=Q-1,Q=0,y={},x="",S=[]}P={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;D.t=x,S.length&&(D.R=S),D.a=V,le.push(D)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);V="",O=0,x="",w=0,S=[];break;case"creator":p[1]==="/"?V=n.slice(O,p.index):O=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);x="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(N[o.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Oe(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Oe(p[0],!1),l+=B2[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Oe(p[0],!1),l+=B2[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=Oe(p[0],!1),Z=$p(i["cell-range-address"]);var ae={Name:i.name,Ref:Z[0]+"!"+Z[1]};Y&&(ae.Sheet=h.length),F.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var J=bK(n.slice(w,p.index));x=(x.length>0?x+`
`:"")+J[0]}else Oe(p[0],!1),w=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Z=$p(Oe(p[0])["target-range-address"]),m[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(P=Oe(p[0],!1),!P.href)break;P.Target=et(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(Z=$p(P.Target.slice(1)),P.Target="#"+Z[0]+"!"+Z[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var A={Sheets:m,SheetNames:h,Workbook:F};return r.bookSheets&&delete A.Sheets,A}function U2(e,t){t=t||{},$n(e,"META-INF/manifest.xml")&&QB(Zt(e,"META-INF/manifest.xml"),t);var r=bn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ZC(ht(r),t);return $n(e,"meta.xml")&&(n.Props=HN(Zt(e,"meta.xml"))),n}function $2(e,t){return ZC(e,t)}var EK=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Mu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return qt+t}}(),W2=function(){var e=function(s){return ft(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+ft(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=mn(s["!ref"]||"A1"),m=s["!merges"]||[],h=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",y=s["!rows"]||[];for(u=0;u<d.s.r;++u)p=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=d.e.r;++u){for(p=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var v=!1,x={},w="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>f)&&!(m[h].s.r>u)&&!(m[h].e.c<f)&&!(m[h].e.r<u)){(m[h].s.c!=f||m[h].s.r!=u)&&(v=!0),x["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,x["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(v){l.push(r);continue}var S=Re({r:u,c:f}),b=g?(s[u]||[])[f]:s[S];if(b&&b.f&&(x["table:formula"]=ft(zz(b.f)),b.F&&b.F.slice(0,S.length)==S)){var E=mn(b.F);x["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,x["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":w=b.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=b.v?"true":"false";break;case"n":w=b.w||String(b.v||0),x["office:value-type"]="float",x["office:value"]=b.v||0;break;case"s":case"str":w=b.v==null?"":b.v,x["office:value-type"]="string";break;case"d":w=b.w||bt(b.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=bt(b.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(w);if(b.l&&b.l.Target){var T=b.l.Target;T=T.charAt(0)=="#"?"#"+Gz(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),k=ve("text:a",k,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+ve("table:table-cell",ve("text:p",k,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;yi(d),d.ods=o;var m=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[qt],u=Mu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Mu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(WN().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function e3(e,t){if(t.bookType=="fods")return W2(e,t);var r=Ov(),n="",a=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,W2(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,EK(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,qt+WN()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,eU(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,JB(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Tg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ht(Ni(e))}function TK(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):kn(za(e))}function NK(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function wi(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function H2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function CK(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function AK(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Wu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ht(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Wu(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Wu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function yr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ot(n*8+a.type)),a.type==2&&t.push(ot(a.data.length)),t.push(a.data))})}),wi(t)}function cy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Bn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Wu(e,n),s=nt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ht(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=nt(o.data),u=Ht(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=Ht(s[3][0].data)>>>0>0),r.push(i)}return r}function Uo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ot(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ot(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:ot(i.data.length)}],n[2].push({data:yr(i.meta),type:2})});var s=yr(n);t.push(ot(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),wi(t)}function PK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Wu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[wi(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var f=wi(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Un(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(PK(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return wi(t)}function $o(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=ot(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return wi(t)}function DK(e,t,r,n){var a=wo(e),s=a.getUint32(4,!0),i=(n>1?12:8)+H2(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=H2(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function jK(e,t,r){var n=wo(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(l=CK(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Hp(e,t){var r=new Uint8Array(32),n=wo(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,AK(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Vp(e,t){var r=new Uint8Array(32),n=wo(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function RK(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return DK(e,t,r,e[0]);case 5:return jK(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rr(e){var t=nt(e);return Wu(t[1][0].data)}function V2(e,t){var r=nt(t.data),n=Ht(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=nt(i.data),l=Ht(o[1][0].data)>>>0;switch(n){case 1:s[l]=Tg(o[3][0].data);break;case 8:{var u=e[Rr(o[9][0].data)][0],f=nt(u.data),d=e[Rr(f[1][0].data)][0],m=Ht(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=nt(d.data);s[l]=h[3].map(function(g){return Tg(g.data)}).join("")}break}}),s}function MK(e,t){var r,n,a,s,i,o,l,u,f,d,m,h,g,p,y=nt(e),v=Ht(y[1][0].data)>>>0,x=Ht(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Ht(y[8][0].data)>0||!1,S,b;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&t!=0)S=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,b=(u=(l=y[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(f=y[4])==null?void 0:f[0])!=null&&d.data&&t!=1)S=(h=(m=y[4])==null?void 0:m[0])==null?void 0:h.data,b=(p=(g=y[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=w?4:1,k=wo(S),T=[],N=0;N<S.length/2;++N){var I=k.getUint16(N*2,!0);I<65535&&T.push([N,I])}if(T.length!=x)throw"Expected ".concat(x," cells, found ").concat(T.length);var H=[];for(N=0;N<T.length-1;++N)H[T[N][0]]=b.subarray(T[N][1]*E,T[N+1][1]*E);return T.length>=1&&(H[T[T.length-1][0]]=b.subarray(T[T.length-1][1]*E)),{R:v,cells:H}}function IK(e,t){var r,n=nt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ht(n[7][0].data)>>>0>0?1:0:-1,s=cy(n[5],function(i){return MK(i,a)});return{nrows:Ht(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function OK(e,t,r){var n,a=nt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ht(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ht(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=He(s);var i=nt(a[4][0].data),o=V2(e,e[Rr(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?V2(e,e[Rr(i[17][0].data)][0]):[],u=nt(i[3][0].data),f=0;u[1].forEach(function(d){var m=nt(d.data),h=e[Rr(m[2][0].data)][0],g=Ht(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=IK(e,h);p.data.forEach(function(y,v){y.forEach(function(x,w){var S=Re({r:f+v,c:w}),b=RK(x,o,l);b&&(r[S]=b)})}),f+=p.nrows})}function FK(e,t){var r=nt(t.data),n={"!ref":"A1"},a=e[Rr(r[2][0].data)],s=Ht(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return OK(e,a[0],n),n}function LK(e,t){var r,n=nt(t.data),a={name:(r=n[1])!=null&&r[0]?Tg(n[1][0].data):"",sheets:[]},s=cy(n[2],Rr);return s.forEach(function(i){e[i].forEach(function(o){var l=Ht(o.meta[1][0].data);l==6e3&&a.sheets.push(FK(e,o))})}),a}function BK(e,t){var r=my(),n=nt(t.data),a=cy(n[1],Rr);if(a.forEach(function(s){e[s].forEach(function(i){var o=Ht(i.meta[1][0].data);if(o==2){var l=LK(e,i);l.sheets.forEach(function(u,f){py(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function zp(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Un(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=Bn(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ht(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(u){var f=Ht(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return BK(s,o)}function UK(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Ht(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=wo(e[7][0].data),f=0,d=[],m=wo(e[4][0].data),h=0,g=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}u.setUint16(p*2,f,!0),m.setUint16(p*2,h,!0);var y,v;switch(typeof t[p]){case"string":y=Hp({t:"s",v:t[p]},r),v=Vp({t:"s",v:t[p]},r);break;case"number":y=Hp({t:"n",v:t[p]},r),v=Vp({t:"n",v:t[p]},r);break;case"boolean":y=Hp({t:"b",v:t[p]},r),v=Vp({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}d.push(y),f+=y.length,g.push(v),h+=v.length,++l}for(e[2][0].data=ot(l);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return e[6][0].data=wi(d),e[3][0].data=wi(g),l}function $K(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=mn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(He(n)));var s=Sh(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(V){return V.forEach(function(O){typeof O=="string"&&i.push(O)})});var o={},l=[],u=Ae.read(t.numbers,{type:"base64"});u.FileIndex.map(function(V,O){return[V,u.FullPaths[O]]}).forEach(function(V){var O=V[0],L=V[1];if(O.type==2&&O.name.match(/\.iwa/)){var Y=O.content,G=Un(Y),ie=Bn(G);ie.forEach(function(se){l.push(se.id),o[se.id]={deps:[],location:L,type:Ht(se.messages[0].meta[1][0].data)}})}}),l.sort(function(V,O){return V-O});var f=l.filter(function(V){return V>1}).map(function(V){return[V,ot(V)]});u.FileIndex.map(function(V,O){return[V,u.FullPaths[O]]}).forEach(function(V){var O=V[0];if(V[1],!!O.name.match(/\.iwa/)){var L=Bn(Un(O.content));L.forEach(function(Y){Y.messages.forEach(function(G){f.forEach(function(ie){Y.messages.some(function(se){return Ht(se.meta[1][0].data)!=11006&&NK(se.data,ie[1])})&&o[ie[0]].deps.push(Y.id)})})})}});for(var d=Ae.find(u,o[1].location),m=Bn(Un(d.content)),h,g=0;g<m.length;++g){var p=m[g];p.id==1&&(h=p)}var y=Rr(nt(h.messages[0].data)[1][0].data);for(d=Ae.find(u,o[y].location),m=Bn(Un(d.content)),g=0;g<m.length;++g)p=m[g],p.id==y&&(h=p);for(y=Rr(nt(h.messages[0].data)[2][0].data),d=Ae.find(u,o[y].location),m=Bn(Un(d.content)),g=0;g<m.length;++g)p=m[g],p.id==y&&(h=p);for(y=Rr(nt(h.messages[0].data)[2][0].data),d=Ae.find(u,o[y].location),m=Bn(Un(d.content)),g=0;g<m.length;++g)p=m[g],p.id==y&&(h=p);var v=nt(h.messages[0].data);{v[6][0].data=ot(n.e.r+1),v[7][0].data=ot(n.e.c+1);var x=Rr(v[46][0].data),w=Ae.find(u,o[x].location),S=Bn(Un(w.content));{for(var b=0;b<S.length&&S[b].id!=x;++b);if(S[b].id!=x)throw"Bad ColumnRowUIDMapArchive";var E=nt(S[b].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var k=0;k<=n.e.c;++k){var T=[];T[1]=T[2]=[{type:0,data:ot(k+420690)}],E[1].push({type:2,data:yr(T)}),E[2].push({type:0,data:ot(k)}),E[3].push({type:0,data:ot(k)})}E[4]=[],E[5]=[],E[6]=[];for(var N=0;N<=n.e.r;++N)T=[],T[1]=T[2]=[{type:0,data:ot(N+726270)}],E[4].push({type:2,data:yr(T)}),E[5].push({type:0,data:ot(N)}),E[6].push({type:0,data:ot(N)});S[b].messages[0].data=yr(E)}w.content=$o(Uo(S)),w.size=w.content.length,delete v[46];var I=nt(v[4][0].data);{I[7][0].data=ot(n.e.r+1);var H=nt(I[1][0].data),j=Rr(H[2][0].data);w=Ae.find(u,o[j].location),S=Bn(Un(w.content));{if(S[0].id!=j)throw"Bad HeaderStorageBucket";var z=nt(S[0].messages[0].data);for(N=0;N<s.length;++N){var K=nt(z[2][0].data);K[1][0].data=ot(N),K[4][0].data=ot(s[N].length),z[2][N]={type:z[2][0].type,data:yr(K)}}S[0].messages[0].data=yr(z)}w.content=$o(Uo(S)),w.size=w.content.length;var q=Rr(I[2][0].data);w=Ae.find(u,o[q].location),S=Bn(Un(w.content));{if(S[0].id!=q)throw"Bad HeaderStorageBucket";for(z=nt(S[0].messages[0].data),k=0;k<=n.e.c;++k)K=nt(z[2][0].data),K[1][0].data=ot(k),K[4][0].data=ot(n.e.r+1),z[2][k]={type:z[2][0].type,data:yr(K)};S[0].messages[0].data=yr(z)}w.content=$o(Uo(S)),w.size=w.content.length;var Q=Rr(I[4][0].data);(function(){for(var V=Ae.find(u,o[Q].location),O=Bn(Un(V.content)),L,Y=0;Y<O.length;++Y){var G=O[Y];G.id==Q&&(L=G)}var ie=nt(L.messages[0].data);{ie[3]=[];var se=[];i.forEach(function(A,me){se[1]=[{type:0,data:ot(me)}],se[2]=[{type:0,data:ot(1)}],se[3]=[{type:2,data:TK(A)}],ie[3].push({type:2,data:yr(se)})})}L.messages[0].data=yr(ie);var ae=Uo(O),J=$o(ae);V.content=J,V.size=V.content.length})();var X=nt(I[3][0].data);{var F=X[1][0];delete X[2];var P=nt(F.data);{var Z=Rr(P[2][0].data);(function(){for(var V=Ae.find(u,o[Z].location),O=Bn(Un(V.content)),L,Y=0;Y<O.length;++Y){var G=O[Y];G.id==Z&&(L=G)}var ie=nt(L.messages[0].data);{delete ie[6],delete X[7];var se=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ae=0,J=0;J<=n.e.r;++J){var A=nt(se);ae+=UK(A,s[J],i),A[1][0].data=ot(J),ie[5].push({data:yr(A),type:2})}ie[1]=[{type:0,data:ot(n.e.c+1)}],ie[2]=[{type:0,data:ot(n.e.r+1)}],ie[3]=[{type:0,data:ot(ae)}],ie[4]=[{type:0,data:ot(n.e.r+1)}]}L.messages[0].data=yr(ie);var me=Uo(O),ke=$o(me);V.content=ke,V.size=V.content.length})()}F.data=yr(P)}I[3][0].data=yr(X)}v[4][0].data=yr(I)}h.messages[0].data=yr(v);var le=Uo(m),D=$o(le);return d.content=D,d.size=d.content.length,u}function t3(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function uy(e){t3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fy(e){t3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function WK(e){return Ye.WS.indexOf(e)>-1?"sheet":e==Ye.CS?"chart":e==Ye.DS?"dialog":e==Ye.MS?"macro":e&&e.length?e:"sheet"}function HK(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,WK(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function VK(e,t,r,n,a,s,i,o,l,u,f,d){try{s[n]=Qc(bn(e,r,!0),t);var m=Zt(e,t),h;switch(o){case"sheet":h=dX(m,t,a,l,s[n],u,f,d);break;case"chart":if(h=hX(m,t,a,l,s[n],u,f,d),!h||!h["!drawel"])break;var g=Ic(h["!drawel"].Target,t),p=Ou(g),y=ZH(bn(e,g,!0),Qc(bn(e,p,!0),g)),v=Ic(y,g),x=Ou(v);h=UY(bn(e,v,!0),v,l,Qc(bn(e,x,!0),v),u,h);break;case"macro":h=mX(m,t,a,l,s[n],u,f,d);break;case"dialog":h=pX(m,t,a,l,s[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var w=[];s&&s[n]&&Vt(s[n]).forEach(function(S){var b="";if(s[n][S].Type==Ye.CMNT){b=Ic(s[n][S].Target,t);var E=xX(Zt(e,b,!0),b,l);if(!E||!E.length)return;A2(h,E,!1)}s[n][S].Type==Ye.TCMNT&&(b=Ic(s[n][S].Target,t),w=w.concat(tV(Zt(e,b,!0),l)))}),w&&w.length&&A2(h,w,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function Fn(e){return e.charAt(0)=="/"?e.slice(1):e}function zK(e,t){if(nc(),t=t||{},uy(t),$n(e,"META-INF/manifest.xml")||$n(e,"objectdata.xml"))return U2(e,t);if($n(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof zp<"u"){if(e.FileIndex)return zp(e);var r=Ae.utils.cfb_new();return qw(e).forEach(function(K){ze(r,K,rB(e,K))}),zp(r)}throw new Error("Unsupported NUMBERS file")}if(!$n(e,"[Content_Types].xml"))throw $n(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$n(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=qw(e),a=KB(bn(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Zt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Zt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Jc=[],a.sst)try{Jc=yX(Zt(e,Fn(a.sst)),a.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&a.themes.length&&(l=vX(bn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=gX(Zt(e,Fn(a.style)),a.style,l,t))}a.links.map(function(K){try{var q=Qc(bn(e,Ou(Fn(K))),K);return _X(Zt(e,Fn(K)),q,K,t)}catch{}});var f=fX(Zt(e,Fn(a.workbooks[0])),a.workbooks[0],t),d={},m="";a.coreprops.length&&(m=Zt(e,Fn(a.coreprops[0]),!0),m&&(d=HN(m)),a.extprops.length!==0&&(m=Zt(e,Fn(a.extprops[0]),!0),m&&rU(m,d,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=bn(e,Fn(a.custprops[0]),!0),m&&(h=aU(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(q){return q.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=h),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var p={};t.bookDeps&&a.calcchain&&(p=wX(Zt(e,Fn(a.calcchain)),a.calcchain));var y=0,v={},x,w;{var S=f.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var b=0;b!=S.length;++b)d.SheetNames[b]=S[b].name}var E=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");$n(e,T)||(T="xl/_rels/workbook."+E+".rels");var N=Qc(bn(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=SX(Zt(e,Fn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=nV(Zt(e,Fn(a.people[0])),t)),N&&(N=HK(N,f.Sheets));var I=Zt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var H="sheet";if(N&&N[y]?(x="xl/"+N[y][1].replace(/[\/]?xl\//,""),$n(e,x)||(x=N[y][1]),$n(e,x)||(x=T.replace(/_rels\/.*$/,"")+N[y][1]),H=N[y][2]):(x="xl/worksheets/sheet"+(y+1-I)+"."+E,x=x.replace(/sheet0\./,"sheet.")),w=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==y&&(j=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==d.SheetNames[y].toLowerCase()&&(j=1);if(!j)continue e}}VK(e,x,w,d.SheetNames[y],y,v,i,H,t,f,l,u)}return g={Directory:a,Workbook:f,Props:d,Custprops:h,Deps:p,Sheets:i,SheetNames:d.SheetNames,Strings:Jc,Styles:u,Themes:l,SSF:Et(je)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(K,q){K=K.replace(/^Root Entry[\/]/,""),g.keys.push(K),g.files[K]=e.FileIndex[q]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=Zt(e,Fn(a.vba[0]),!0):a.defaults&&a.defaults.bin===fV&&(g.vbaraw=Zt(e,"xl/vbaProject.bin",!0))),g}function GK(e,t){var r=t||{},n="Workbook",a=Ae.find(e,n);try{if(n="/!DataSpaces/Version",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(SW(a.content),n="/!DataSpaces/DataSpaceMap",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=bW(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=EW(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);NW(a.content)}catch{}if(n="/EncryptionInfo",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=CW(a.content);if(n="/EncryptedPackage",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function YK(e,t){return t.bookType=="ods"?e3(e,t):t.bookType=="numbers"?$K(e,t):t.bookType=="xlsb"?XK(e,t):KK(e,t)}function XK(e,t){rl=1024,e&&!e.SSF&&(e.SSF=Et(je)),e&&e.SSF&&(nc(),xm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=CC.indexOf(t.bookType)>-1,a=qv();fy(t=t||{});var s=Ov(),i="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",ze(s,i,VN(e.Props,t)),a.coreprops.push(i),ct(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ze(s,i,YN(e.Props)),a.extprops.push(i),ct(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Vt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",ze(s,i,XN(e.Custprops)),a.custprops.push(i),ct(t.rels,4,i,Ye.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ze(s,i,bX(o-1,i,t,e,f)),a.sheets.push(i),ct(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(d){var h=d["!comments"],g=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,ze(s,p,NX(h,p)),a.comments.push(p),ct(f,-1,"../comments"+o+"."+r,Ye.CMNT),g=!0),d["!legacy"]&&g&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",TC(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ze(s,Ou(i),hl(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,ze(s,i,TX(t.Strings,i,t)),a.strs.push(i),ct(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,ze(s,i,kX(e,i)),a.workbooks.push(i),ct(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",ze(s,i,ry(e.Themes,t)),a.themes.push(i),ct(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,ze(s,i,EX(e,i,t)),a.styles.push(i),ct(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",ze(s,i,e.vbaraw),a.vba.push(i),ct(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,ze(s,i,CX(i)),a.metadata.push(i),ct(t.wbrels,-1,"metadata."+r,Ye.XLMETA),ze(s,"[Content_Types].xml",$N(a,t)),ze(s,"_rels/.rels",hl(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",hl(t.wbrels)),delete t.revssf,delete t.ssf,s}function KK(e,t){rl=1024,e&&!e.SSF&&(e.SSF=Et(je)),e&&e.SSF&&(nc(),xm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=CC.indexOf(t.bookType)>-1,a=qv();fy(t=t||{});var s=Ov(),i="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",ze(s,i,VN(e.Props,t)),a.coreprops.push(i),ct(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ze(s,i,YN(e.Props)),a.extprops.push(i),ct(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Vt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",ze(s,i,XN(e.Custprops)),a.custprops.push(i),ct(t.rels,4,i,Ye.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ze(s,i,BC(o-1,t,e,d)),a.sheets.push(i),ct(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(m){var g=m["!comments"],p=!1,y="";if(g&&g.length>0){var v=!1;g.forEach(function(x){x[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,ze(s,y,rV(g,f,t)),a.threadedcomments.push(y),ct(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ye.TCMNT)),y="xl/comments"+o+"."+r,ze(s,y,NC(g)),a.comments.push(y),ct(d,-1,"../comments"+o+"."+r,Ye.CMNT),p=!0}m["!legacy"]&&p&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",TC(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&ze(s,Ou(i),hl(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,ze(s,i,mC(t.Strings,t)),a.strs.push(i),ct(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,ze(s,i,VC(e)),a.workbooks.push(i),ct(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",ze(s,i,ry(e.Themes,t)),a.themes.push(i),ct(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,ze(s,i,SC(e,t)),a.styles.push(i),ct(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",ze(s,i,e.vbaraw),a.vba.push(i),ct(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,ze(s,i,EC()),a.metadata.push(i),ct(t.wbrels,-1,"metadata."+r,Ye.XLMETA),f.length>1&&(i="xl/persons/person.xml",ze(s,i,aV(f)),a.people.push(i),ct(t.wbrels,-1,"persons/person.xml",Ye.PEOPLE)),ze(s,"[Content_Types].xml",$N(a,t)),ze(s,"_rels/.rels",hl(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",hl(t.wbrels)),delete t.revssf,delete t.ssf,s}function dy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Dn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qK(e,t){return Ae.find(e,"EncryptedPackage")?GK(e,t):XC(e,t)}function QK(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r=gN(n,a),zK(r,a)}function r3(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bg(e.slice(r),t);default:break e}return Fl.to_workbook(e,t)}function JK(e,t){var r="",n=dy(e,t);switch(t.type){case"base64":r=Dn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=go(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ht(r)),t.type="binary",r3(r,t)}function ZK(e,t){var r=e;return t.type=="base64"&&(r=Dn(r)),r=Pu.utils.decode(1200,r.slice(2),"str"),t.type="binary",r3(r,t)}function eq(e){return e.match(/[^\x00-\x7F]/)?za(e):e}function Gp(e,t,r,n){return n?(r.type="string",Fl.to_workbook(e,r)):Fl.to_workbook(t,r)}function Hu(e,t){Dv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hu(new Uint8Array(e),(r=Et(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),pl={},r.dateNF&&(pl.dateNF=r.dateNF),r.type||(r.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ge?"buffer":"binary",n=X9(e),typeof Uint8Array<"u"&&!Ge&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=eq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Et(r),r.type="array",Hu(jv(n),r)}switch((a=dy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return qK(Ae.read(n,r),r);break;case 9:if(a[1]<=8)return XC(n,r);break;case 60:return bg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return sW(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return dC.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?QK(n,r):Gp(e,n,r,s);case 239:return a[3]===60?bg(n,r):Gp(e,n,r,s);case 255:if(a[1]===254)return ZK(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Zi.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Zi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return kg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return xC.to_workbook(n,r);break;case 10:case 13:case 32:return JK(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return aW.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?kg.to_workbook(n,r):Gp(e,n,r,s)}function n3(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mf(t.file,Ae.write(e,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ae.write(e,t)}function tq(e,t){var r=Et(t||{}),n=YK(e,r);return rq(n,r)}function rq(e,t){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ae.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(ym(a))}return t.password&&typeof encrypt_agile<"u"?n3(encrypt_agile(a,t.password),t):t.type==="file"?mf(t.file,a):t.type=="string"?ht(a):a}function nq(e,t){var r=t||{},n=eK(e,r);return n3(n,r)}function Oa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Du(za(n));case"binary":return za(n);case"string":return e;case"file":return mf(t.file,n,"utf8");case"buffer":return Ge?As(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Oa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function aq(e,t){switch(t.type){case"base64":return Du(e);case"binary":return e;case"string":return e;case"file":return mf(t.file,e,"binary");case"buffer":return Ge?As(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ld(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Du(r):t.type=="string"?ht(r):r;case"file":return mf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function a3(e,t){Dv(),qY(e);var r=Et(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=a3(e,r);return r.type="array",ym(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Oa(YX(e,r),r);case"slk":case"sylk":return Oa(fC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Oa(qC(e.Sheets[e.SheetNames[a]],r),r);case"txt":return aq(s3(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Oa(hy(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Oa(dC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return ld(kg.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Oa(Fl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Oa(xC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Oa(hC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Oa(e3(e,r),r);case"wk1":return ld(Zi.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return ld(Zi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ld(KC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function sq(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Bl(e,t,r){var n={};return n.type="file",n.file=t,sq(n),a3(e,n)}function iq(e,t,r,n,a,s,i,o){var l=Kt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=i?e[r][h]:e[n[h]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[h]!=null&&(m[s[h]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[h]!=null){if(p==null)if(g.t=="e"&&p===null)m[s[h]]=null;else if(u!==void 0)m[s[h]]=u;else if(f&&p===null)m[s[h]]=null;else continue;else m[s[h]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:Ns(g,p,o);p!=null&&(d=!1)}}return{row:m,isempty:d}}function Sh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=rt(f);break;case"number":l=rt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=Kt(l.s.r),m=[],h=[],g=0,p=0,y=Array.isArray(e),v=l.s.r,x=0,w={};y&&!e[v]&&(e[v]=[]);var S=u.skipHidden&&e["!cols"]||[],b=u.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(S[x]||{}).hidden)switch(m[x]=Mt(x),r=y?e[v][x]:e[m[x]+d],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=m[x];break;case 3:s[x]=u.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Ns(r,null,u),p=w[i]||0,!p)w[i]=1;else{do o=i+"_"+p++;while(w[o]);w[i]=p,w[o]=1}s[x]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(b[v]||{}).hidden){var E=iq(e,l,v,m,n,s,y,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[g++]=E.row)}return h.length=g,h}var z2=/"/g;function oq(e,t,r,n,a,s,i,o){for(var l=!0,u=[],f="",d=Kt(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var h=o.dense?(e[r]||[])[m]:e[n[m]+d];if(h==null)f="";else if(h.v!=null){l=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Ns(h,null,o));for(var g=0,p=0;g!==f.length;++g)if((p=f.charCodeAt(g))===a||p===s||p===34||o.forceQuotes){f='"'+f.replace(z2,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(l=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(z2,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function hy(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=rt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(m[g]||{}).hidden||(d[g]=Mt(g));for(var p=0,y=a.s.r;y<=a.e.r;++y)(h[y]||{}).hidden||(f=oq(e,a,y,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete n.dense,r.join("")}function s3(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hy(e,t);return r}function lq(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=rt(e["!ref"]),s="",i=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Mt(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=Kt(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function i3(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?It(n.origin):n.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=rt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var m=n.header||[],h=0;t.forEach(function(p,y){Vt(p).forEach(function(v){(h=m.indexOf(v))==-1&&(m[h=m.length]=v);var x=p[v],w="z",S="",b=Re({c:o+h,r:i+y+a});u=Vu(s,b),x&&typeof x=="object"&&!(x instanceof Date)?s[b]=x:(typeof x=="number"?w="n":typeof x=="boolean"?w="b":typeof x=="string"?w="s":x instanceof Date?(w="d",n.cellDates||(w="n",x=or(x)),S=n.dateNF||je[14]):x===null&&n.nullError&&(w="e",x=0),u?(u.t=w,u.v=x,delete u.w,delete u.R,S&&(u.z=S)):s[b]=u={t:w,v:x},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var g=Kt(i);if(a)for(h=0;h<m.length;++h)s[Mt(h+o)+g]={t:"s",v:m[h]};return s["!ref"]=He(f),s}function cq(e,t){return i3(null,e,t)}function Vu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=It(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Vu(e,Re(t)):Vu(e,Re({r:t,c:r||0}))}function uq(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function my(){return{SheetNames:[],Sheets:{}}}function py(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(HC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function fq(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=uq(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function dq(e,t){return e.z=t,e}function o3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function hq(e,t,r){return o3(e,"#"+t,r)}function mq(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function pq(e,t,r,n){for(var a=typeof t!="string"?t:rt(t),s=typeof t=="string"?t:He(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Vu(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Xt={encode_col:Mt,encode_row:Kt,encode_cell:Re,encode_range:He,decode_col:Vv,decode_row:Hv,split_cell:TB,decode_cell:It,decode_range:mn,format_cell:Ns,sheet_add_aoa:MN,sheet_add_json:i3,sheet_add_dom:QC,aoa_to_sheet:ac,json_to_sheet:cq,table_to_sheet:JC,table_to_book:SK,sheet_to_csv:hy,sheet_to_txt:s3,sheet_to_json:Sh,sheet_to_html:qC,sheet_to_formulae:lq,sheet_to_row_object_array:Sh,sheet_get_cell:Vu,book_new:my,book_append_sheet:py,book_set_sheet_visibility:fq,cell_set_number_format:dq,cell_set_hyperlink:o3,cell_set_internal_link:hq,cell_add_comment:mq,sheet_set_array_formula:pq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const gq=()=>{const e=()=>{const r=[{"Applicant ID":"PROSAPP250101000001","Applicant Name":"John Doe","Branch Name":"Mumbai Branch","Team Lead":"Team Lead Name","RM Name":"RM Name","Dealer Name":"Dealer Name","Lender Name":"Lender Name","Applicant Mobile Number":"9876543210","Applicant Current Address":"Sample Address","House Ownership":"Own","Co-Applicant Name":"Co-Applicant Name","Coapplicant Mobile Number":"9876543211","Coapplicant Current Address":"Co-Applicant Address","Guarantor Name":"Guarantor Name","Guarantor Mobile Number":"9876543212","Guarantor Current Address":"Guarantor Address","Reference Name":"Reference Name","Reference Mobile Number":"9876543213","Reference Address":"Reference Address","FI Submission Location":"Field Investigation Location","Demand Date":"2024-05-01","Disbursement Date":"2024-01-10","Loan Amount":5e5,"Vehicle Status":"Risky",Repayment:"Monthly","Principle Due":45e3,"Interest Due":2500,EMI:5e3,"Last Month Bounce":0,"Collection RM":"Collection RM Name","LMS Status":"Unpaid",Status:"Unpaid"}],n=Xt.book_new(),a=Xt.json_to_sheet(r),s=[{wch:20},{wch:25},{wch:20},{wch:20},{wch:15},{wch:25},{wch:25},{wch:15},{wch:30},{wch:15},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:12},{wch:15},{wch:12},{wch:12},{wch:12},{wch:15},{wch:25},{wch:20},{wch:20},{wch:15},{wch:15},{wch:15}];a["!cols"]=s,Xt.book_append_sheet(n,a,"Applications");const o=`first-time-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Bl(n,o),Se.success("First-time upload template downloaded!")},t=()=>{const r=[{"Applicant ID":"PROSAPP250101000001","Demand Date":"2024-05-01","Team Lead":"Team Lead Name","RM Name":"RM Name",Repayment:"Monthly",EMI:5e3,"Last Month Bounce":0,"LMS Status":"Unpaid","Collection RM":"Collection RM Name"}],n=Xt.book_new(),a=Xt.json_to_sheet(r),s=[{wch:20},{wch:12},{wch:20},{wch:15},{wch:12},{wch:15},{wch:15},{wch:15},{wch:20}];a["!cols"]=s,Xt.book_append_sheet(n,a,"Collection");const o=`monthly-update-template-${new Date().toISOString().split("T")[0]}.xlsx`;Bl(n,o),Se.success("Monthly update template downloaded!")};return c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"font-medium text-blue-900",children:"Step 1: Download Template"}),c.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Choose the appropriate template based on your upload type"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-gray-900",children:"First-time Upload Template"}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"For new applications. Includes all columns (static + monthly data)."})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:e,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(bs,{className:"h-4 w-4 mr-2"}),"Download"]})]}),c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-gray-900",children:"Monthly Update Template"}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"For existing applications. Only monthly columns required."})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:t,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(bs,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})]})},vq=()=>{const e=()=>{const t=[{"Applicant ID":"PROSAPP250101000001","Repayment Number":1,"Delay in Days":4},{"Applicant ID":"PROSAPP250101000001","Repayment Number":2,"Delay in Days":0},{"Applicant ID":"PROSAPP250101000001","Repayment Number":3,"Delay in Days":20},{"Applicant ID":"PROSAPP250101000002","Repayment Number":1,"Delay in Days":15}],r=Xt.book_new(),n=Xt.json_to_sheet(t),a=[{wch:20},{wch:15},{wch:15}];n["!cols"]=a,Xt.book_append_sheet(r,n,"Repayment History");const i=`repayment-history-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Bl(r,i),Se.success("Repayment history template downloaded successfully!")};return c.jsx("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-green-900",children:"Step 1: Download Repayment History Template"}),c.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Download the Excel template for repayment history data"})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:e,className:"border-green-300 text-green-700 hover:bg-green-100",children:[c.jsx(bs,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})})},yq=async(e,t)=>{console.log("Processing bulk applications:",e.length);const r={successful:0,failed:0,updated:0,statusUpdated:0,errors:[]};for(const n of e)try{const{status:a,uploadMode:s,...i}=n,o={application_id:n.applicant_id,demand_date:n.demand_date,team_lead:n.team_lead,rm_name:n.rm_name,repayment:n.repayment,emi_amount:n.emi_amount,last_month_bounce:n.last_month_bounce,lms_status:n.lms_status,collection_rm:n.collection_rm,amount_collected:n.amount_collected||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:l,error:u}=await Pe.from("applications").select("applicant_id").eq("applicant_id",n.applicant_id).maybeSingle();if(!!l)r.updated++;else{const{error:m}=await Pe.from("applications").insert([{...i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(m){r.failed++,r.errors.push(`Failed to insert application ${n.applicant_id}: ${m.message}`);continue}else r.successful++}const{error:d}=await Pe.from("collection").insert([o]);if(d){r.failed++,r.errors.push(`Failed to insert into collection for ${n.applicant_id}: ${d.message}`);continue}}catch(a){r.failed++,r.errors.push(`Unexpected error for ${n.applicant_id}: ${a}`)}return r},xq=async(e,t)=>yq(e),wq=({uploadMode:e,uploading:t,onUploadingChange:r,onApplicationsAdded:n,onDialogClose:a})=>{const{user:s}=Bt(),i=l=>{if(l==null||l==="")return null;const u=parseFloat(l);return isNaN(u)?null:u},o=async l=>{var f;const u=(f=l.target.files)==null?void 0:f[0];if(!(!u||!s)){r(!0),Se.loading("Processing file...",{id:"upload"});try{console.log("Starting file upload process with mode:",e);const d=await u.arrayBuffer(),m=Hu(d),h=m.Sheets[m.SheetNames[0]],g=Xt.sheet_to_json(h);if(console.log("Parsed applications data from file:",g.length,"rows"),g.length===0){Se.error("No application data found in the file",{id:"upload"});return}const p=g.map((v,x)=>(console.log(`Transforming application row ${x+1}:`,v),{applicant_id:v["Applicant ID"]||v.applicant_id,applicant_name:v["Applicant Name"]||v.applicant_name,branch_name:v["Branch Name"]||v.branch_name,team_lead:v["Team Lead"]||v.team_lead,rm_name:v["RM Name"]||v.rm_name,dealer_name:v["Dealer Name"]||v.dealer_name,lender_name:v["Lender Name"]||v.lender_name,lms_status:v["LMS Status"]||v.lms_status||"Unpaid",emi_amount:i(v.EMI||v["EMI Amount"]||v.emi_amount),principle_due:i(v["Principle Due"]||v.principle_due),interest_due:i(v["Interest Due"]||v.interest_due),demand_date:v["Demand Date"]||v.demand_date,disbursement_date:v["Disbursement Date"]||v.disbursement_date,loan_amount:i(v["Loan Amount"]||v.loan_amount),vehicle_status:v["Vehicle Status"]||v.vehicle_status,user_id:s.id,applicant_mobile:v["Applicant Mobile Number"]||v.applicant_mobile,applicant_address:v["Applicant Current Address"]||v.applicant_address,house_ownership:v["House Ownership"]||v.house_ownership,co_applicant_name:v["Co-Applicant Name"]||v.co_applicant_name,co_applicant_mobile:v["Coapplicant Mobile Number"]||v.co_applicant_mobile,co_applicant_address:v["Coapplicant Current Address"]||v.co_applicant_address,guarantor_name:v["Guarantor Name"]||v.guarantor_name,guarantor_mobile:v["Guarantor Mobile Number"]||v.guarantor_mobile,guarantor_address:v["Guarantor Current Address"]||v.guarantor_address,reference_name:v["Reference Name"]||v.reference_name,reference_mobile:v["Reference Mobile Number"]||v.reference_mobile,reference_address:v["Reference Address"]||v.reference_address,fi_location:v["FI Submission Location"]||v.fi_location,repayment:v.Repayment||v.repayment,last_month_bounce:i(v["Last Month Bounce"]||v.last_month_bounce),collection_rm:v["Collection RM"]||v.collection_rm,status:v.Status||v.status,uploadMode:e}));console.log("Transformed applications ready for processing:",p.length);const y=await xq(p,s);if(console.log("Bulk processing results:",y),y.errors.length>0){console.error("Upload errors:",y.errors);let v=`Upload completed with some issues:
`;v+=`✅ ${y.successful} new applications added
`,v+=`✅ ${y.updated} applications updated
`,y.statusUpdated>0&&(v+=`✅ ${y.statusUpdated} statuses updated
`),v+=`❌ ${y.failed} applications failed
`,v+=`
First few errors:
${y.errors.slice(0,3).join(`
`)}`,Se.error(v,{id:"upload",duration:1e4})}else{let v=`🎉 Upload successful!
`;v+=`✅ ${y.successful} new applications added
`,v+=`✅ ${y.updated} applications updated`,y.statusUpdated>0&&(v+=`
✅ ${y.statusUpdated} statuses updated`),Se.success(v,{id:"upload",duration:5e3})}n(),a()}catch(d){console.error("Error processing file:",d),Se.error(`Failed to process file: ${d}`,{id:"upload"})}finally{r(!1),l.target.value=""}}};return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"p-2 mb-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-900",children:[c.jsx("b",{children:"Upload Instructions:"}),c.jsx("br",{}),c.jsxs("ul",{className:"list-disc ml-4",children:[c.jsxs("li",{children:[c.jsx("b",{children:"First-time upload:"})," Fills both ",c.jsx("code",{children:"applications"})," and ",c.jsx("code",{children:"collection"})," tables. ",c.jsx("b",{children:"All columns"})," required (static + monthly)."]}),c.jsxs("li",{children:[c.jsx("b",{children:"Monthly update:"})," Fills only ",c.jsx("code",{children:"collection"})," table. ",c.jsx("b",{children:"Only monthly columns"})," required (team_lead, rm_name, demand_date, repayment, emi_amount, last_month_bounce, lms_status, collection_rm)."]})]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("b",{children:"Note:"})," ",c.jsx("code",{children:"demand_date"})," is required and must be a text value (e.g., ",c.jsx("code",{children:"2024-05-01"}),")."]})]}),c.jsx(Xe,{htmlFor:"file-upload",className:"text-sm font-medium",children:"Step 2: Select File (Excel/CSV)"}),c.jsx(Sr,{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:o,disabled:t})]})},_q=({uploadMode:e,uploading:t,onUploadingChange:r,onApplicationsAdded:n,onDialogClose:a})=>{const{user:s}=Bt(),i=l=>{if(l==null||l==="")return null;const u=parseInt(l);return isNaN(u)?null:u},o=async l=>{var f;const u=(f=l.target.files)==null?void 0:f[0];if(!(!u||!s)){r(!0),Se.loading("Processing repayment history file...",{id:"repayment-upload"});try{console.log("Starting repayment history upload process with mode:",e);const d=await u.arrayBuffer(),m=Hu(d),h=m.Sheets[m.SheetNames[0]],g=Xt.sheet_to_json(h);if(console.log("Parsed repayment history data from file:",g.length,"rows"),g.length===0){Se.error("No repayment history data found in the file",{id:"repayment-upload"});return}let p=[];for(const x of g){const w=x["Applicant ID"]||x.application_id;Object.keys(x).forEach(S=>{const b=S.match(/^Repayment Number[_ ](\d+)$/);if(b){const E=i(b[1]),k=i(x[S]);w&&E!==null&&k!==null&&p.push({application_id:w,repayment_number:E,delay_in_days:k})}})}p.length===0&&(p=g.map((x,w)=>({application_id:x["Applicant ID"]||x.application_id,repayment_number:i(x["Repayment Number"]||x.repayment_number),delay_in_days:i(x["Delay in Days"]||x.delay_in_days)}))),console.log("Transformed repayment history ready for processing:",p.length);const y=p.filter(x=>x.application_id&&x.repayment_number!==null&&x.delay_in_days!==null);if(y.length===0){Se.error("No valid repayment history records found. Please check your data.",{id:"repayment-upload"});return}let v={successful:0,failed:0,errors:[]};if(e==="add"){const{data:x,error:w}=await Pe.from("repayment_history").insert(y);w?(console.error("Error inserting repayment history:",w),v.failed=y.length,v.errors.push(`Failed to insert repayment history: ${w.message}`)):(console.log("Successfully inserted repayment history:",y.length,"records"),v.successful=y.length)}else if(e==="update")for(const x of y)try{const{error:w}=await Pe.from("repayment_history").update({repayment_number:x.repayment_number,delay_in_days:x.delay_in_days}).eq("application_id",x.application_id).eq("repayment_number",x.repayment_number);w?(console.error("Error updating repayment history:",w),v.failed++,v.errors.push(`Failed to update repayment history for ${x.application_id}: ${w.message}`)):v.successful++}catch(w){console.error("Error updating repayment history record:",w),v.failed++,v.errors.push(`Failed to update repayment history for ${x.application_id}: ${w}`)}else for(const x of y)try{const{data:w,error:S}=await Pe.from("repayment_history").select("id").eq("application_id",x.application_id).eq("repayment_number",x.repayment_number).maybeSingle();if(S){console.error("Error checking existing record:",S),v.failed++,v.errors.push(`Failed to check existing record for ${x.application_id}: ${S.message}`);continue}if(w){const{error:b}=await Pe.from("repayment_history").update({delay_in_days:x.delay_in_days}).eq("id",w.id);b?(console.error("Error updating existing repayment history:",b),v.failed++,v.errors.push(`Failed to update repayment history for ${x.application_id}: ${b.message}`)):(v.successful++,console.log(`Updated existing repayment history for ${x.application_id}`))}else{const{error:b}=await Pe.from("repayment_history").insert(x);b?(console.error("Error inserting new repayment history:",b),v.failed++,v.errors.push(`Failed to insert repayment history for ${x.application_id}: ${b.message}`)):(v.successful++,console.log(`Inserted new repayment history for ${x.application_id}`))}}catch(w){console.error("Error processing repayment history record:",w),v.failed++,v.errors.push(`Failed to process repayment history for ${x.application_id}: ${w}`)}if(v.errors.length>0){console.error("Repayment history upload errors:",v.errors);let x=`Repayment history upload completed with some issues:
`;x+=`✅ ${v.successful} records processed successfully
`,x+=`❌ ${v.failed} records failed
`,x+=`
First few errors:
${v.errors.slice(0,3).join(`
`)}`,Se.error(x,{id:"repayment-upload",duration:1e4})}else{let x=`🎉 Repayment history upload successful!
`;x+=`✅ ${v.successful} records processed`,Se.success(x,{id:"repayment-upload",duration:5e3})}n(),a()}catch(d){console.error("Error processing repayment history file:",d),Se.error(`Failed to process repayment history file: ${d}`,{id:"repayment-upload"})}finally{r(!1),l.target.value=""}}};return c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"repayment-file-upload",className:"text-sm font-medium",children:"Step 2: Select Repayment History File (Excel/CSV)"}),c.jsx(Sr,{id:"repayment-file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:o,disabled:t}),c.jsx("p",{className:"text-xs text-gray-500",children:"File should contain: Applicant ID, Repayment Number, Delay in Days"})]})},Sq=({onApplicationsAdded:e})=>{const[t,r]=_.useState(!1),[n,a]=_.useState(!1),[s,i]=_.useState("applications"),[o,l]=_.useState("mixed");return c.jsxs(Ql,{open:t,onOpenChange:r,children:[c.jsx(af,{asChild:!0,children:c.jsxs(Te,{variant:"outline",size:"sm",children:[c.jsx(P1,{className:"h-4 w-4 mr-2"}),"Upload Data"]})}),c.jsxs(To,{className:"sm:max-w-lg",children:[c.jsxs(No,{children:[c.jsxs(Jl,{className:"flex items-center gap-2",children:[c.jsx(r6,{className:"h-5 w-5"}),"Upload Data"]}),c.jsx(sf,{children:"Upload Excel/CSV files containing application data or repayment history. Choose your upload type and mode, then download the appropriate template."})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(m9,{uploadType:s,onTypeChange:i}),c.jsx(p9,{uploadMode:o,onModeChange:l}),s==="applications"?c.jsx(gq,{}):c.jsx(vq,{}),s==="applications"?c.jsx(wq,{uploadMode:o,uploading:n,onUploadingChange:a,onApplicationsAdded:e,onDialogClose:()=>r(!1)}):c.jsx(_q,{uploadMode:o,uploading:n,onUploadingChange:a,onApplicationsAdded:e,onDialogClose:()=>r(!1)}),c.jsxs("div",{className:"text-xs text-gray-500",children:[c.jsx("p",{children:"Supported formats: Excel (.xlsx, .xls) and CSV (.csv)"}),s==="applications"?c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Applications:"})," Upload application data with all fields"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Status Values:"})," Unpaid, Partially Paid, Cash Collected from Customer, Customer Deposited to Bank, Paid"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Note:"})," Invalid status values will default to 'Unpaid'"]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Repayment History:"})," Upload repayment history data only"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Required Fields:"})," Applicant ID, Repayment Number, Delay in Days"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Note:"})," All fields are required for valid records"]})]})]})]})]})]})},kq=()=>{const e=()=>{const t=[{"Email (User ID)":"user@example.com","Full Name":"John Doe",Password:"SecurePassword123",Role:"user"}],r=Xt.book_new(),n=Xt.json_to_sheet(t),a=[{wch:25},{wch:20},{wch:15},{wch:10}];n["!cols"]=a,Xt.book_append_sheet(r,n,"User Template");const i=`user-bulk-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Bl(r,i),Se.success("Template downloaded successfully!")};return c.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-blue-900",children:"Step 1: Download Template"}),c.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Download the Excel template with Role column for user management"})]}),c.jsxs(Te,{variant:"outline",size:"sm",onClick:e,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(bs,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})})},bq=({defaultRole:e,onUsersAdded:t,onDialogClose:r})=>{const[n,a]=_.useState(!1),[s,i]=_.useState(null),o=u=>{var d,m;const f=(d=u.target.files)==null?void 0:d[0];if(f){const h=(m=f.name.split(".").pop())==null?void 0:m.toLowerCase();h==="xlsx"||h==="xls"?i(f):(Se.error("Please select an Excel file (.xlsx or .xls)"),u.target.value="")}},l=async()=>{if(s){a(!0);try{const u=await s.arrayBuffer(),f=Hu(u,{type:"array"}),d=f.SheetNames[0],m=f.Sheets[d],h=Xt.sheet_to_json(m);if(console.log("Parsed Excel data:",h),h.length===0){Se.error("No data found in Excel file");return}const g=["Email (User ID)","Full Name","Password"],p=h[0],y=g.filter(b=>!(b in p));if(y.length>0){Se.error(`Missing required columns: ${y.join(", ")}`);return}const v=h.map(b=>({email:String(b["Email (User ID)"]).trim(),fullName:String(b["Full Name"]).trim(),password:String(b.Password).trim(),role:b.Role?String(b.Role).toLowerCase():e}));console.log("Calling Edge Function with users:",v.length);const{data:x,error:w}=await Pe.functions.invoke("create-bulk-users",{body:{users:v}});if(w){console.error("Edge Function error:",w),Se.error("Failed to process users. Please try again.");return}const S=x;S.successful>0&&Se.success(`Successfully created/updated ${S.successful} users with roles!`),S.failed>0&&(Se.error(`Failed to process ${S.failed} users. Check console for details.`),console.log("Failed user processing details:",S.errors)),S.successful>0&&t(),i(null),r()}catch(u){console.error("Excel processing error:",u),Se.error("Failed to process Excel file. Please check the format.")}finally{a(!1)}}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Step 2: Upload Your File"}),c.jsx(Xe,{htmlFor:"excel-file",children:"Select Excel File"}),c.jsx(Sr,{id:"excel-file",type:"file",accept:".xlsx,.xls",onChange:o,className:"mt-1"}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Supported formats: .xlsx, .xls"})]}),s&&c.jsxs("div",{className:"p-3 bg-green-50 rounded-md border border-green-200",children:[c.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Selected file: ",s.name]}),c.jsxs("p",{className:"text-xs text-green-600",children:["Size: ",(s.size/1024).toFixed(1)," KB"]})]}),c.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[c.jsx(Te,{variant:"outline",onClick:r,disabled:n,children:"Cancel"}),c.jsx(Te,{onClick:l,disabled:!s||n,children:n?"Processing...":"Upload Users"})]})]})},Eq=({onUsersAdded:e})=>{const[t,r]=_.useState(!1),[n,a]=_.useState("user");return c.jsxs(Ql,{open:t,onOpenChange:r,children:[c.jsx(af,{asChild:!0,children:c.jsxs(Te,{variant:"outline",size:"sm",children:[c.jsx(P1,{className:"h-4 w-4 mr-2"}),"Bulk Upload Users"]})}),c.jsxs(To,{className:"sm:max-w-[500px]",children:[c.jsxs(No,{children:[c.jsx(Jl,{children:"Bulk Upload Users"}),c.jsx(sf,{children:"Upload multiple users with role assignment using an Excel file. Download the template to get started."})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(kq,{}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"default-role",children:"Default Role (if not specified in Excel)"}),c.jsxs(Zn,{value:n,onValueChange:s=>a(s),children:[c.jsx(An,{children:c.jsx(ea,{placeholder:"Select default role"})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"user",children:"User"}),c.jsx(Tt,{value:"admin",children:"Admin"})]})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"This role will be assigned to users where the Role column is empty"})]}),c.jsx(bq,{defaultRole:n,onUsersAdded:e,onDialogClose:()=>r(!1)})]})]})]})},Tq=()=>{const[e,t]=_.useState(!1),[r,n]=_.useState(""),[a,s]=_.useState(""),[i,o]=_.useState(""),[l,u]=_.useState(!1),f=async()=>{u(!0),console.log("Creating test user for kanishk@prosparity.in");try{const{data:m,error:h}=await Pe.auth.signUp({email:"kanishk@prosparity.in",password:"Kanishk@123",options:{data:{full_name:"Kanishk"},emailRedirectTo:void 0}});console.log("Test user creation response:",{signUpData:m,signUpError:h}),h&&!h.message.includes("User already registered")?(console.error("Error creating test user:",h),Se.error(`Error creating test user: ${h.message}`)):(console.log("Test user created successfully or already exists"),Se.success("Test user account is ready! You can now try signing in."))}catch(m){console.error("Unexpected error creating test user:",m),Se.error("An unexpected error occurred while creating test user")}finally{u(!1)}},d=async m=>{m.preventDefault(),u(!0),console.log("Creating user with:",{email:r,fullName:i});try{const{data:h,error:g}=await Pe.auth.signUp({email:r,password:a,options:{data:{full_name:i},emailRedirectTo:void 0}});console.log("User creation response:",{data:h,error:g}),g?(console.error("User creation error:",g),g.message.includes("User already registered")?Se.error("User already exists with this email"):Se.error(g.message)):(console.log("User created successfully"),Se.success("User created successfully! They can now sign in."),n(""),s(""),o(""),t(!1))}catch(h){console.error("Unexpected error creating user:",h),Se.error("An error occurred while creating the user")}finally{u(!1)}};return c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Te,{variant:"outline",size:"sm",onClick:f,disabled:l,children:l?"Creating...":"Setup Test Account"}),c.jsxs(Ql,{open:e,onOpenChange:t,children:[c.jsx(af,{asChild:!0,children:c.jsxs(Te,{variant:"outline",size:"sm",children:[c.jsx(xu,{className:"h-4 w-4 mr-2"}),"Settings"]})}),c.jsxs(To,{className:"sm:max-w-md",children:[c.jsxs(No,{children:[c.jsxs(Jl,{className:"flex items-center gap-2",children:[c.jsx(Y0,{className:"h-5 w-5"}),"Create New User"]}),c.jsx(sf,{children:"Add a new user to the system. They will be able to log in with these credentials."})]}),c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"fullName",children:"Full Name"}),c.jsx(Sr,{id:"fullName",type:"text",placeholder:"Enter full name",value:i,onChange:m=>o(m.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"email",children:"Email"}),c.jsx(Sr,{id:"email",type:"email",placeholder:"Enter email address",value:r,onChange:m=>n(m.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"password",children:"Password"}),c.jsx(Sr,{id:"password",type:"password",placeholder:"Enter password",value:a,onChange:m=>s(m.target.value),required:!0,minLength:6})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Te,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:l,children:"Cancel"}),c.jsx(Te,{type:"submit",disabled:l,children:l?"Creating...":"Create User"})]})]})]})]})]})},Nq=({onApplicationsAdded:e,onUsersAdded:t})=>c.jsx("div",{className:"space-y-6",children:c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsxs(St,{className:"flex items-center gap-2",children:[c.jsx(Yk,{className:"h-5 w-5"}),"Data Management"]})}),c.jsx(at,{children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(P1,{className:"h-4 w-4 text-blue-600"}),c.jsx("h3",{className:"font-medium",children:"Application Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bulk upload applications from Excel files"}),c.jsx(Sq,{onApplicationsAdded:e})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(wu,{className:"h-4 w-4 text-green-600"}),c.jsx("h3",{className:"font-medium",children:"User Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bulk upload users from Excel files"}),c.jsx(Eq,{onUsersAdded:t})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(wu,{className:"h-4 w-4 text-purple-600"}),c.jsx("h3",{className:"font-medium",children:"User Creation"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create individual user accounts"}),c.jsx(Tq,{})]})]})})]})}),Cq=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!0),[a,s]=_.useState(""),[i,o]=_.useState("all"),l=async()=>{try{const{data:d,error:m}=await Pe.from("status_change_requests").select("*").order("request_timestamp",{ascending:!1});if(m){console.error("Error fetching request history:",m),Se.error("Failed to fetch request history");return}t(d||[])}catch(d){console.error("Error fetching request history:",d),Se.error("Failed to fetch request history")}finally{n(!1)}};_.useEffect(()=>{l()},[]);const u=e.filter(d=>{var g,p,y,v;const m=d.application_id.toLowerCase().includes(a.toLowerCase())||((g=d.requested_by_email)==null?void 0:g.toLowerCase().includes(a.toLowerCase()))||((p=d.requested_by_name)==null?void 0:p.toLowerCase().includes(a.toLowerCase()))||((y=d.reviewed_by_email)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||((v=d.reviewed_by_name)==null?void 0:v.toLowerCase().includes(a.toLowerCase())),h=i==="all"||d.approval_status===i;return m&&h}),f=d=>{switch(d){case"pending":return"bg-yellow-50 text-yellow-800 border-yellow-200";case"approved":return"bg-green-50 text-green-800 border-green-200";case"rejected":return"bg-red-50 text-red-800 border-red-200";default:return"bg-gray-50 text-gray-800 border-gray-200"}};return r?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading request history..."})]}):c.jsx("div",{className:"space-y-6",children:c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsxs(St,{className:"flex items-center gap-2",children:[c.jsx(qk,{className:"h-5 w-5"}),"Status Change Request History"]})}),c.jsxs(at,{children:[c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(A1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx(Sr,{placeholder:"Search by application ID, user name, or email...",value:a,onChange:d=>s(d.target.value),className:"pl-10"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Kk,{className:"h-4 w-4 text-gray-400"}),c.jsxs(Zn,{value:i,onValueChange:o,children:[c.jsx(An,{className:"w-32",children:c.jsx(ea,{})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"all",children:"All Status"}),c.jsx(Tt,{value:"pending",children:"Pending"}),c.jsx(Tt,{value:"approved",children:"Approved"}),c.jsx(Tt,{value:"rejected",children:"Rejected"})]})]})]})]}),c.jsx("div",{className:"border rounded-lg",children:c.jsxs(Zl,{children:[c.jsx(hf,{children:c.jsxs(pa,{children:[c.jsx(it,{children:"Application ID"}),c.jsx(it,{children:"Status Change"}),c.jsx(it,{children:"Requested By"}),c.jsx(it,{children:"Request Date"}),c.jsx(it,{children:"Status"}),c.jsx(it,{children:"Reviewed By"}),c.jsx(it,{children:"Review Date"}),c.jsx(it,{children:"Comments"})]})}),c.jsx(ec,{children:u.map(d=>c.jsxs(pa,{children:[c.jsx(ut,{children:c.jsx("div",{className:"font-medium text-blue-600",children:d.application_id})}),c.jsx(ut,{children:c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"px-2 py-1 bg-red-50 text-red-700 rounded",children:d.current_status}),c.jsx("span",{children:"→"}),c.jsx("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded",children:d.requested_status})]})}),c.jsx(ut,{children:c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:d.requested_by_name||"Unknown"}),c.jsx("div",{className:"text-gray-500",children:d.requested_by_email})]})}),c.jsx(ut,{children:c.jsx("div",{className:"text-sm text-gray-600",children:Ft(new Date(d.request_timestamp),"dd-MMM-yyyy HH:mm")})}),c.jsx(ut,{children:c.jsx(wa,{variant:"outline",className:f(d.approval_status),children:d.approval_status})}),c.jsx(ut,{children:d.reviewed_by_name||d.reviewed_by_email?c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:d.reviewed_by_name||"Unknown"}),c.jsx("div",{className:"text-gray-500",children:d.reviewed_by_email})]}):c.jsx("span",{className:"text-gray-400 text-sm",children:"Not reviewed"})}),c.jsx(ut,{children:d.review_timestamp?c.jsx("div",{className:"text-sm text-gray-600",children:Ft(new Date(d.review_timestamp),"dd-MMM-yyyy HH:mm")}):c.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),c.jsx(ut,{children:d.review_comments?c.jsx("div",{className:"text-sm max-w-xs truncate",title:d.review_comments,children:d.review_comments}):c.jsx("span",{className:"text-gray-400 text-sm",children:"No comments"})})]},d.id))})]})}),u.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:e.length===0?"No status change requests found":"No requests match your search criteria"})]})]})})};var Nm="Switch",[Aq,lQ]=Mn(Nm),[Pq,Dq]=Aq(Nm),l3=_.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:s,required:i,disabled:o,value:l="on",onCheckedChange:u,form:f,...d}=e,[m,h]=_.useState(null),g=Je(t,w=>h(w)),p=_.useRef(!1),y=m?f||!!m.closest("form"):!0,[v,x]=qa({prop:a,defaultProp:s??!1,onChange:u,caller:Nm});return c.jsxs(Pq,{scope:r,checked:v,disabled:o,children:[c.jsx(De.button,{type:"button",role:"switch","aria-checked":v,"aria-required":i,"data-state":d3(v),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:g,onClick:Ne(e.onClick,w=>{x(S=>!S),y&&(p.current=w.isPropagationStopped(),p.current||w.stopPropagation())})}),y&&c.jsx(f3,{control:m,bubbles:!p.current,name:n,value:l,checked:v,required:i,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});l3.displayName=Nm;var c3="SwitchThumb",u3=_.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,a=Dq(c3,r);return c.jsx(De.span,{"data-state":d3(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});u3.displayName=c3;var jq="SwitchBubbleInput",f3=_.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=_.useRef(null),o=Je(i,s),l=J1(r),u=L1(t);return _.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&h){const g=new Event("click",{bubbles:n});h.call(f,r),f.dispatchEvent(g)}},[l,r,n]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});f3.displayName=jq;function d3(e){return e?"checked":"unchecked"}var h3=l3,Rq=u3;const Oc=_.forwardRef(({className:e,...t},r)=>c.jsx(h3,{className:Ce("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:c.jsx(Rq,{className:Ce("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Oc.displayName=h3.displayName;const Mq=()=>{const[e,t]=_.useState({requireApprovalForPaid:!0,requireApprovalForOtherStatuses:!1,allowedApprovers:"admins_only",autoRejectAfterDays:7,requireApprovalComments:!1,emailNotifications:!1,approvalNotificationTemplate:"Your status change request for application {application_id} has been approved.",rejectionNotificationTemplate:"Your status change request for application {application_id} has been rejected. Reason: {comments}"}),[r,n]=_.useState(!1),a=async()=>{n(!0);try{await new Promise(i=>setTimeout(i,1e3)),Se.success("Workflow settings saved successfully")}catch(i){console.error("Error saving workflow settings:",i),Se.error("Failed to save workflow settings")}finally{n(!1)}},s=(i,o)=>{t(l=>({...l,[i]:o}))};return c.jsx("div",{className:"space-y-6",children:c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsxs(St,{className:"flex items-center gap-2",children:[c.jsx(xu,{className:"h-5 w-5"}),"Approval Workflow Configuration"]})}),c.jsxs(at,{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Approval Requirements"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Xe,{htmlFor:"require-paid-approval",children:'Require approval for "Paid" status'}),c.jsx("p",{className:"text-sm text-gray-600",children:'When enabled, changing status to "Paid" requires admin approval'})]}),c.jsx(Oc,{id:"require-paid-approval",checked:e.requireApprovalForPaid,onCheckedChange:i=>s("requireApprovalForPaid",i)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Xe,{htmlFor:"require-other-approval",children:"Require approval for other status changes"}),c.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, all status changes require admin approval"})]}),c.jsx(Oc,{id:"require-other-approval",checked:e.requireApprovalForOtherStatuses,onCheckedChange:i=>s("requireApprovalForOtherStatuses",i)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Xe,{htmlFor:"require-comments",children:"Require comments for approval/rejection"}),c.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, approvers must provide comments"})]}),c.jsx(Oc,{id:"require-comments",checked:e.requireApprovalComments,onCheckedChange:i=>s("requireApprovalComments",i)})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Approver Configuration"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"allowed-approvers",children:"Who can approve requests?"}),c.jsxs(Zn,{value:e.allowedApprovers,onValueChange:i=>s("allowedApprovers",i),children:[c.jsx(An,{children:c.jsx(ea,{})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"admins_only",children:"Admins Only"}),c.jsx(Tt,{value:"admins_and_managers",children:"Admins and Managers"})]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"auto-reject-days",children:"Auto-reject requests after (days)"}),c.jsxs(Zn,{value:e.autoRejectAfterDays.toString(),onValueChange:i=>s("autoRejectAfterDays",parseInt(i)),children:[c.jsx(An,{children:c.jsx(ea,{})}),c.jsxs(Pn,{children:[c.jsx(Tt,{value:"3",children:"3 days"}),c.jsx(Tt,{value:"7",children:"7 days"}),c.jsx(Tt,{value:"14",children:"14 days"}),c.jsx(Tt,{value:"30",children:"30 days"}),c.jsx(Tt,{value:"0",children:"Never auto-reject"})]})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Notification Settings"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Xe,{htmlFor:"email-notifications",children:"Send email notifications"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when requests are approved or rejected"})]}),c.jsx(Oc,{id:"email-notifications",checked:e.emailNotifications,onCheckedChange:i=>s("emailNotifications",i)})]}),e.emailNotifications&&c.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-gray-200",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"approval-template",children:"Approval notification template"}),c.jsx(ch,{id:"approval-template",value:e.approvalNotificationTemplate,onChange:i=>s("approvalNotificationTemplate",i.target.value),placeholder:"Template for approval notifications...",rows:3}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Available variables: ","{application_id}",", ","{requested_status}",", ","{approver_name}"]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Xe,{htmlFor:"rejection-template",children:"Rejection notification template"}),c.jsx(ch,{id:"rejection-template",value:e.rejectionNotificationTemplate,onChange:i=>s("rejectionNotificationTemplate",i.target.value),placeholder:"Template for rejection notifications...",rows:3}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Available variables: ","{application_id}",", ","{requested_status}",", ","{approver_name}",", ","{comments}"]})]})]})]}),c.jsx("div",{className:"flex justify-end pt-4 border-t",children:c.jsxs(Te,{onClick:a,disabled:r,className:"flex items-center gap-2",children:[c.jsx(G0,{className:"h-4 w-4"}),r?"Saving...":"Save Settings"]})})]})]})})},Iq=()=>{const{user:e}=Bt(),{isAdmin:t,loading:r}=d9(),n=ql(),a=()=>{Se.success("Applications data updated. Refreshing main dashboard...")},s=()=>{Se.success("Users added successfully!")};return r?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):!e||!t?c.jsx(bd,{to:"/",replace:!0}):c.jsx("div",{className:"min-h-screen bg-gray-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("div",{className:"flex items-center gap-4 mb-4",children:c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>n("/"),className:"flex items-center gap-2",children:[c.jsx(V0,{className:"h-4 w-4"}),"Back to Dashboard"]})}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Settings"}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Manage users, data, view request history, and configure workflow settings"})]}),c.jsx(Qe,{children:c.jsx(at,{className:"p-6",children:c.jsxs(dT,{defaultValue:"users",className:"w-full",children:[c.jsxs(Tv,{className:"grid w-full grid-cols-4",children:[c.jsxs(ds,{value:"users",className:"flex items-center gap-2",children:[c.jsx(wu,{className:"h-4 w-4"}),"User Management"]}),c.jsxs(ds,{value:"data",className:"flex items-center gap-2",children:[c.jsx(Yk,{className:"h-4 w-4"}),"Data Management"]}),c.jsxs(ds,{value:"history",className:"flex items-center gap-2",children:[c.jsx(qk,{className:"h-4 w-4"}),"Request History"]}),c.jsxs(ds,{value:"settings",className:"flex items-center gap-2",children:[c.jsx(xu,{className:"h-4 w-4"}),"Workflow Settings"]})]}),c.jsx(hs,{value:"users",className:"mt-6",children:c.jsx(h9,{})}),c.jsx(hs,{value:"data",className:"mt-6",children:c.jsx(Nq,{onApplicationsAdded:a,onUsersAdded:s})}),c.jsx(hs,{value:"history",className:"mt-6",children:c.jsx(Cq,{})}),c.jsx(hs,{value:"settings",className:"mt-6",children:c.jsx(Mq,{})})]})})})]})})},m3=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1),n=_.useCallback(async(i,o)=>{if(!e)return null;try{let l=Pe.from("ptp_dates").select("ptp_date").eq("application_id",i).order("created_at",{ascending:!1}).limit(1);if(o){const{start:d,end:m}=gi(o);l=l.gte("demand_date",d).lte("demand_date",m)}const{data:u,error:f}=await l.maybeSingle();return f?(console.error("Error fetching PTP date:",f),null):(u==null?void 0:u.ptp_date)||null}catch(l){return console.error("Error fetching PTP date:",l),null}},[e]),a=_.useCallback(async(i,o)=>{if(!e||i.length===0)return{};try{console.log("🔄 Fetching PTP dates for",i.length,"applications"),console.log("Demand month filter:",o||"All dates");let l=Pe.from("ptp_dates").select("application_id, ptp_date, created_at, demand_date").in("application_id",i).order("application_id",{ascending:!0}).order("created_at",{ascending:!1});if(o){const{start:h,end:g}=gi(o);l=l.gte("demand_date",h).lte("demand_date",g)}const{data:u,error:f}=await l;if(f)return console.error("Error fetching PTP dates:",f),{};const d={},m=new Set;return u==null||u.forEach(h=>{m.has(h.application_id)||(d[h.application_id]=h.ptp_date,m.add(h.application_id))}),console.log("✅ Fetched PTP dates:",Object.keys(d).length,"applications processed"),d}catch(l){return console.error("Error fetching PTP dates:",l),{}}},[e]),s=_.useCallback(async(i,o,l)=>{if(!e||!l)return console.error("PTP Update Failed: User not authenticated or demand date missing"),!1;console.log("=== PTP UPDATE ATTEMPT - USING UPSERT ==="),console.log("Application ID:",i),console.log("Demand Date:",l),console.log("User ID:",e.id),console.log("New PTP Date:",o),console.log("Is clearing date:",o===null||o===""),r(!0);try{if(!i||i.trim()==="")return console.error("PTP Update Failed: Invalid application ID"),!1;if(o&&o.trim()!==""){const h=new Date(o);if(isNaN(h.getTime()))return console.error("PTP Update Failed: Invalid PTP date format:",o),!1}const u=o&&o.trim()!==""?o:null;let f;if(l.match(/^\d{4}-\d{2}$/)){const[h,g]=l.split("-").map(Number);if(g<1||g>12)return console.error("PTP Update Failed: Invalid month in demand date:",l),!1;if(new Date(h,g-1,5).getMonth()!==g-1)return console.error("PTP Update Failed: Invalid date would be created from:",l),!1;f=`${l}-05`}else{const h=new Date(l);if(isNaN(h.getTime()))return console.error("PTP Update Failed: Invalid demand date format:",l),!1;f=l}console.log("Attempting to upsert PTP date record..."),console.log("Final PTP Date value:",u),console.log("EMI Date:",f);const{error:d,data:m}=await Pe.from("ptp_dates").upsert({application_id:i,ptp_date:u,demand_date:f,user_id:e.id},{onConflict:"application_id,demand_date",ignoreDuplicates:!1}).select().single();return d?(console.error("❌ PTP Upsert Error:",d),!1):(console.log("✅ PTP date record upserted:",m),!0)}catch(u){return console.error("PTP Update Failed: Unexpected error:",u),!1}finally{r(!1)}},[e]);return{fetchPtpDate:n,fetchPtpDates:a,updatePtpDate:s,loading:t}},Oq=()=>{const{user:e}=Bt(),[t,r]=_.useState(!1),n=_.useCallback(async i=>{if(!e)return null;try{const{data:o,error:l}=await Pe.from("payment_dates").select("paid_date").eq("application_id",i).order("created_at",{ascending:!1}).limit(1).maybeSingle();return l?(console.error("Error fetching payment date:",l),null):(o==null?void 0:o.paid_date)||null}catch(o){return console.error("Error fetching payment date:",o),null}},[e]),a=_.useCallback(async i=>{if(!e||i.length===0)return{};try{const{data:o,error:l}=await Pe.from("payment_dates").select("application_id, paid_date, created_at").in("application_id",i).order("created_at",{ascending:!1});if(l)return console.error("Error fetching payment dates:",l),{};const u={};return o==null||o.forEach(f=>{f.paid_date&&!u[f.application_id]&&(u[f.application_id]=f.paid_date)}),u}catch(o){return console.error("Error fetching payment dates:",o),{}}},[e]),s=_.useCallback(async(i,o)=>{if(!e)return!1;r(!0);try{const{error:l}=await Pe.from("payment_dates").insert({application_id:i,paid_date:o,user_id:e.id});return l?(console.error("Error updating payment date:",l),!1):!0}catch(l){return console.error("Error updating payment date:",l),!1}finally{r(!1)}},[e]);return{fetchPaymentDate:n,fetchPaymentDates:a,updatePaymentDate:s,loading:t}},Fq=({page:e=1,pageSize:t=50}={})=>{const{user:r}=Bt(),{fetchFieldStatus:n}=QT(),{fetchPtpDates:a}=m3(),{fetchPaymentDates:s}=Oq(),{fetchCommentsByApplications:i}=hT(),[o,l]=_.useState([]),[u,f]=_.useState([]),[d,m]=_.useState(0),[h,g]=_.useState(!0),p=_.useCallback(async w=>{try{const{data:S,error:b}=await Pe.from("contact_calling_status").select("application_id, contact_type, status, created_at").in("application_id",w).order("created_at",{ascending:!1});if(b)return console.error("Error fetching contact statuses:",b),{};const E={};return S==null||S.forEach(k=>{E[k.application_id]||(E[k.application_id]={});const T=k.contact_type.toLowerCase();E[k.application_id][T]||(E[k.application_id][T]=k.status)}),E}catch(S){return console.error("Error in fetchContactStatusesForApps:",S),{}}},[]),y=_.useCallback((w,S,b,E,k,T)=>w.map(N=>{const I=k[N.applicant_id]||{};return{...N,field_status:S[N.applicant_id]||"Unpaid",ptp_date:b[N.applicant_id],paid_date:E[N.applicant_id],applicant_calling_status:I.applicant||"Not Called",co_applicant_calling_status:I.co_applicant||"Not Called",guarantor_calling_status:I.guarantor||"Not Called",reference_calling_status:I.reference||"Not Called",latest_calling_status:I.latest||"No Calls",recent_comments:T[N.applicant_id]||[]}}),[]),v=_.useCallback(async()=>{if(r){g(!0);try{console.log(`Fetching applications page ${e} (${t} per page)`);const{count:w}=await Pe.from("applications").select("*",{count:"exact",head:!0});m(w||0);const[S,b]=await Promise.all([Pe.from("applications").select("*").order("applicant_name",{ascending:!0}),Pe.from("applications").select("*").order("applicant_name",{ascending:!0}).range((e-1)*t,e*t-1)]);if(S.error){console.error("Error fetching all applications:",S.error);return}if(b.error){console.error("Error fetching paginated applications:",b.error);return}const E=S.data,k=b.data,T=(E==null?void 0:E.map(Q=>Q.applicant_id))||[],[N,I,H,j,z]=await Promise.all([n(T),a(T),s(T),p(T),i(T)]),K=y(k,N,I,H,j,z),q=y(E,N,I,H,j,z);console.log("Enhanced applications with all related data"),l(K),f(q)}catch(w){console.error("Error fetching applications:",w)}finally{g(!1)}}},[r,e,t,n,a,s,p,i,y]);return _.useEffect(()=>{r&&v()},[r,v]),_.useMemo(()=>({applications:o,allApplications:u,totalCount:d,totalPages:Math.ceil(d/t),currentPage:e,loading:h,refetch:v}),[o,u,d,t,e,h,v])},Yp=new Map,Lq=(e,t)=>{const{fetchFieldStatus:r}=kv(),[n,a]=_.useState([]),[s,i]=_.useState(!1),[o,l]=_.useState(null),u=_.useMemo(()=>`payment-${t||"all"}-${e.length}`,[t,e.length]);return _.useEffect(()=>{const f=async()=>{if(Yp.has(u)){console.log("📊 Cache HIT for payment data:",u),a(Yp.get(u)),i(!1);return}i(!0),l(null);try{console.log("📊 Cache MISS - Fast-loading payment data for month:",t);let d=Pe.from("collection").select(`
            application_id,
            demand_date,
            applications!inner(
              applicant_id,
              branch_name,
              rm_name,
              collection_rm,
              lms_status
            )
          `);if(t){const w=Au(t);if(!w||!w.match(/^\d{4}-\d{2}$/))throw new Error(`Invalid month format: ${t}`);const{start:S,end:b}=gi(w);d=d.gte("demand_date",S).lte("demand_date",b)}const{data:m,error:h}=await d;if(h)throw console.error("Error fetching collection data:",h),new Error(`Failed to fetch collection data: ${h.message}`);if(!m||m.length===0){console.log("No collection data found for month:",t),a([]);return}const g=m.map(w=>w.application_id);console.log(`📊 Processing ${g.length} applications for payment analysis`);const p=t?Au(t):void 0,y=await r(g,p,!1);console.log("🔍 Field status loaded for",Object.keys(y).length,"applications");const v=new Map;m.forEach(w=>{if(!w.applications){console.warn("Missing application data for record:",w.application_id);return}const S=w.applications,b=(S==null?void 0:S.branch_name)||"Unknown Branch",E=(S==null?void 0:S.collection_rm)||(S==null?void 0:S.rm_name)||"Unknown RM";let k=y[w.application_id];k||(k=S.lms_status||"Unpaid",console.log(`🔄 Using fallback status for ${w.application_id}: ${k}`)),v.has(b)||v.set(b,{branch_name:b,total_stats:{rm_name:b,branch_name:b,unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0},rm_stats:[]});const T=v.get(b);let N=T.rm_stats.find(I=>I.rm_name===E);switch(N||(N={rm_name:E,branch_name:b,unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0},T.rm_stats.push(N)),N.total++,T.total_stats.total++,k){case"Unpaid":N.unpaid++,T.total_stats.unpaid++;break;case"Partially Paid":N.partially_paid++,T.total_stats.partially_paid++;break;case"Paid (Pending Approval)":N.paid_pending_approval++,T.total_stats.paid_pending_approval++;break;case"Paid":N.paid++,T.total_stats.paid++;break;case"Cash Collected from Customer":case"Customer Deposited to Bank":default:N.others++,T.total_stats.others++;break}});const x=Array.from(v.values()).map(w=>({...w,rm_stats:w.rm_stats.sort((S,b)=>b.total-S.total)})).sort((w,S)=>S.total_stats.total-w.total_stats.total);console.log("📈 Payment data processing complete. Final status distribution:"),x.forEach(w=>{console.log(`Branch ${w.branch_name}:`,{unpaid:w.total_stats.unpaid,partially_paid:w.total_stats.partially_paid,paid_pending_approval:w.total_stats.paid_pending_approval,paid:w.total_stats.paid,others:w.total_stats.others,total:w.total_stats.total})}),Yp.set(u,x),console.log("📊 Payment data cached with key:",u),a(x)}catch(d){console.error("Error in fetchPaymentData:",d),l(d),a([])}finally{i(!1)}};e&&e.length>0?f():(console.log("No applications provided to useBranchPaymentData"),a([]))},[t,r,e]),{data:n,loading:s,error:o}},lr=({value:e,onClick:t,className:r,colorClass:n})=>c.jsx(ut,{className:Ce("text-center cursor-pointer hover:bg-muted/50 transition-colors",n,r),onClick:t,children:e}),Bq=({applications:e,onDrillDown:t})=>{const[r,n]=_.useState("Jul-25"),[a,s]=_.useState(new Set),{data:i,loading:o,error:l}=Lq(e,r),u=h=>{const g=new Set(a);g.has(h)?g.delete(h):g.add(h),s(g)},f=["Jun-25","Jul-25"],d=(h,g,p)=>{t({branch_name:h,rm_name:g,status_type:p,selectedEmiMonth:r})},m=i.reduce((h,g)=>({unpaid:h.unpaid+g.total_stats.unpaid,partially_paid:h.partially_paid+g.total_stats.partially_paid,paid_pending_approval:h.paid_pending_approval+g.total_stats.paid_pending_approval,paid:h.paid+g.total_stats.paid,others:h.others+g.total_stats.others,total:h.total+g.total_stats.total}),{unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0});return o?c.jsxs(Qe,{children:[c.jsxs(_t,{children:[c.jsx(St,{children:"Branch Payment Status Analysis"}),c.jsx(qi,{children:"Payment status breakdown by branch and collection RM"})]}),c.jsx(at,{children:c.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-100 border-t-blue-600"}),c.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-300 animate-ping"})]}),c.jsxs("div",{className:"mt-4 text-center",children:[c.jsx("p",{className:"text-base font-medium text-gray-700 animate-pulse",children:"Loading payment data..."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analyzing branch performance metrics"})]}),c.jsx("div",{className:"mt-4 w-48 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"70%"}})})]})})]}):l?c.jsxs(Qe,{children:[c.jsxs(_t,{children:[c.jsx(St,{children:"Branch Payment Status Analysis"}),c.jsx(qi,{children:"Payment status breakdown by branch and collection RM"})]}),c.jsx(at,{children:c.jsxs("div",{className:"text-center py-8 text-red-600",children:[c.jsx("p",{className:"text-lg font-medium",children:"Error loading payment data"}),c.jsx("p",{className:"text-sm",children:l.message})]})})]}):c.jsxs(Qe,{children:[c.jsx(_t,{children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx(St,{children:"Branch Payment Status Analysis"}),c.jsxs(qi,{children:["Payment status breakdown by branch and collection RM for ",r]})]}),c.jsx("div",{className:"flex gap-4 items-center",children:c.jsxs(Zn,{value:r,onValueChange:n,children:[c.jsx(An,{className:"w-48",children:c.jsx(ea,{placeholder:"Select EMI Month"})}),c.jsx(Pn,{children:f.map(h=>c.jsx(Tt,{value:h,children:h},h))})]})})]})}),c.jsx(at,{children:i.length===0?c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No payment data available for the selected month"}):c.jsx("div",{className:"rounded-md border",children:c.jsxs(Zl,{children:[c.jsx(hf,{children:c.jsxs(pa,{children:[c.jsx(it,{className:"font-medium w-8"}),c.jsx(it,{className:"font-medium w-48",children:"Branch / RM"}),c.jsx(it,{className:"font-medium text-center w-20",children:"Unpaid"}),c.jsx(it,{className:"font-medium text-center w-24",children:"Partially Paid"}),c.jsx(it,{className:"font-medium text-center w-20",children:"Paid (Pending)"}),c.jsx(it,{className:"font-medium text-center w-16",children:"Paid"}),c.jsx(it,{className:"font-medium text-center w-20",children:"Others"}),c.jsx(it,{className:"font-medium text-center w-16",children:"Total"})]})}),c.jsxs(ec,{children:[i.map(h=>c.jsxs(ge.Fragment,{children:[c.jsxs(pa,{className:"bg-muted/30 font-medium",children:[c.jsx(ut,{children:c.jsx(Te,{variant:"ghost",size:"sm",onClick:()=>u(h.branch_name),className:"h-6 w-6 p-0",children:a.has(h.branch_name)?c.jsx(bo,{className:"h-4 w-4"}):c.jsx($h,{className:"h-4 w-4"})})}),c.jsx(ut,{className:"font-bold text-sm",children:h.branch_name}),c.jsx(lr,{value:h.total_stats.unpaid,onClick:()=>d(h.branch_name,void 0,"unpaid"),className:"text-red-600 font-medium"}),c.jsx(lr,{value:h.total_stats.partially_paid,onClick:()=>d(h.branch_name,void 0,"partially_paid"),className:"text-orange-600 font-medium"}),c.jsx(lr,{value:h.total_stats.paid_pending_approval,onClick:()=>d(h.branch_name,void 0,"paid_pending_approval"),className:"text-yellow-600 font-medium"}),c.jsx(lr,{value:h.total_stats.paid,onClick:()=>d(h.branch_name,void 0,"paid"),className:"text-green-600 font-medium"}),c.jsx(lr,{value:h.total_stats.others,onClick:()=>d(h.branch_name,void 0,"others"),className:"text-gray-600 font-medium"}),c.jsx(lr,{value:h.total_stats.total,onClick:()=>d(h.branch_name,void 0,"total"),className:"text-blue-600 font-bold"})]}),a.has(h.branch_name)&&h.rm_stats.map(g=>c.jsxs(pa,{children:[c.jsx(ut,{}),c.jsx(ut,{className:"text-sm text-muted-foreground",children:c.jsxs("div",{className:"flex items-center pl-4",children:[c.jsx("span",{className:"mr-2 text-gray-400",children:"├─"}),c.jsx("span",{className:"font-medium",children:g.rm_name})]})}),c.jsx(lr,{value:g.unpaid,onClick:()=>d(h.branch_name,g.rm_name,"unpaid"),className:"text-red-600"}),c.jsx(lr,{value:g.partially_paid,onClick:()=>d(h.branch_name,g.rm_name,"partially_paid"),className:"text-orange-600"}),c.jsx(lr,{value:g.paid_pending_approval,onClick:()=>d(h.branch_name,g.rm_name,"paid_pending_approval"),className:"text-yellow-600"}),c.jsx(lr,{value:g.paid,onClick:()=>d(h.branch_name,g.rm_name,"paid"),className:"text-green-600"}),c.jsx(lr,{value:g.others,onClick:()=>d(h.branch_name,g.rm_name,"others"),className:"text-gray-600"}),c.jsx(lr,{value:g.total,onClick:()=>d(h.branch_name,g.rm_name,"total"),className:"text-blue-600 font-medium"})]},`${h.branch_name}-${g.rm_name}`))]},h.branch_name)),i.length>0&&c.jsxs(pa,{className:"bg-primary/10 font-bold",children:[c.jsx(ut,{}),c.jsx(ut,{className:"font-bold text-sm",children:"Grand Total"}),c.jsx(lr,{value:m.unpaid,onClick:()=>d("",void 0,"unpaid"),className:"text-red-600 font-bold"}),c.jsx(lr,{value:m.partially_paid,onClick:()=>d("",void 0,"partially_paid"),className:"text-orange-600 font-bold"}),c.jsx(lr,{value:m.paid_pending_approval,onClick:()=>d("",void 0,"paid_pending_approval"),className:"text-yellow-600 font-bold"}),c.jsx(lr,{value:m.paid,onClick:()=>d("",void 0,"paid"),className:"text-green-600 font-bold"}),c.jsx(lr,{value:m.others,onClick:()=>d("",void 0,"others"),className:"text-gray-600 font-bold"}),c.jsx(lr,{value:m.total,onClick:()=>d("",void 0,"total"),className:"text-blue-600 font-bold"})]})]})]})})})]})},Uq=()=>{const e=_.useCallback((r,n="applications-report")=>{const a=Xt.book_new(),s=r.applications.map(u=>({"Applicant ID":u.applicant_id,"Branch Name":u.branch_name,"RM Name":u.rm_name,"Dealer Name":u.dealer_name,"Applicant Name":u.applicant_name,"Applicant Mobile Number":u.applicant_mobile||"","Applicant Current Address":u.applicant_address||"","House Ownership":u.house_ownership||"","Co-Applicant Name":u.co_applicant_name||"","Coapplicant Mobile Number":u.co_applicant_mobile||"","Coapplicant Current Address":u.co_applicant_address||"","Guarantor Name":u.guarantor_name||"","Guarantor Mobile Number":u.guarantor_mobile||"","Guarantor Current Address":u.guarantor_address||"","Reference Name":u.reference_name||"","Reference Mobile Number":u.reference_mobile||"","Reference Address":u.reference_address||"","FI Submission Location":u.fi_location||"","Demand Date":u.demand_date||"",Repayment:u.repayment||"","Principle Due":u.principle_due||0,"Interest Due":u.interest_due||0,EMI:u.emi_amount,"Last Month Bounce":u.last_month_bounce||0,"Lender Name":u.lender_name,Status:u.field_status||"Unpaid","Team Lead":u.team_lead})),i=Xt.json_to_sheet(s),o=[{wch:20},{wch:20},{wch:20},{wch:25},{wch:25},{wch:15},{wch:30},{wch:15},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:20},{wch:12},{wch:15},{wch:12},{wch:12},{wch:12},{wch:15},{wch:25},{wch:12},{wch:20}];i["!cols"]=o,Xt.book_append_sheet(a,i,"Applications");const l=Ft(new Date,"yyyy-MM-dd-HHmm");Bl(a,`${n}-${l}.xlsx`)},[]),t=_.useCallback((r,n="applications-report")=>{const a=r.applications.map(l=>({"Applicant ID":l.applicant_id,"Branch Name":l.branch_name,"RM Name":l.rm_name,"Dealer Name":l.dealer_name,"Applicant Name":l.applicant_name,"Applicant Mobile Number":l.applicant_mobile||"","Applicant Current Address":l.applicant_address||"","House Ownership":l.house_ownership||"","Co-Applicant Name":l.co_applicant_name||"","Coapplicant Mobile Number":l.co_applicant_mobile||"","Coapplicant Current Address":l.co_applicant_address||"","Guarantor Name":l.guarantor_name||"","Guarantor Mobile Number":l.guarantor_mobile||"","Guarantor Current Address":l.guarantor_address||"","Reference Name":l.reference_name||"","Reference Mobile Number":l.reference_mobile||"","Reference Address":l.reference_address||"","FI Submission Location":l.fi_location||"","Demand Date":l.demand_date||"",Repayment:l.repayment||"","Principle Due":l.principle_due||0,"Interest Due":l.interest_due||0,EMI:l.emi_amount,"Last Month Bounce":l.last_month_bounce||0,"Lender Name":l.lender_name,Status:l.field_status||"Unpaid","Team Lead":l.team_lead})),s=Xt.json_to_sheet(a),i=Xt.book_new();Xt.book_append_sheet(i,s,"Applications");const o=Ft(new Date,"yyyy-MM-dd-HHmm");Bl(i,`${n}-${o}.csv`)},[]);return{exportToExcel:e,exportToCSV:t}},$q=({filter:e})=>(()=>{if(!e)return"";let r=`Applications in ${e.branch_name}`;switch(e.rm_name&&(r+=` (RM: ${e.rm_name})`),e.status_type){case"unpaid":return`${r} with Unpaid status`;case"partially_paid":return`${r} with Partially Paid status`;case"paid_pending_approval":return`${r} with Paid (Pending Approval) status`;case"paid":return`${r} with Paid status`;case"others":return`${r} with Other statuses`;case"overdue":return`${r} with Overdue PTPs`;case"today":return`${r} with Today's PTPs`;case"tomorrow":return`${r} with Tomorrow's PTPs`;case"future":return`${r} with Future PTPs`;case"no_ptp_set":return`${r} with No PTP set`;default:return r}})(),Wq=({applicationsCount:e,filter:t,applications:r})=>{const{exportToExcel:n}=Uq(),a=()=>{n({applications:r},"analytics-drill-down-report")};return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-start gap-8",children:[c.jsx("div",{className:"flex-1 min-w-0",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Application Details"})}),c.jsx("div",{className:"flex-shrink-0",children:c.jsxs(Te,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-2",children:[c.jsx(bs,{className:"h-3 w-3"}),"Export"]})})]}),c.jsx("p",{className:"text-lg",children:c.jsx($q,{filter:t})}),c.jsxs("div",{className:"flex items-center gap-6 text-gray-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(C1,{className:"h-5 w-5"}),c.jsxs("span",{className:"font-medium text-lg",children:[e," applications"]})]}),(t==null?void 0:t.branch_name)&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Qk,{className:"h-5 w-5"}),c.jsx("span",{className:"text-lg",children:t.branch_name})]}),(t==null?void 0:t.rm_name)&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(wu,{className:"h-5 w-5"}),c.jsx("span",{className:"text-lg",children:t.rm_name})]})]})]})},p3=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n,preloadedStatusData:a,preloadedBatchData:s})=>{const{data:i,loading:o,error:l,fetchAllData:u,clearData:f}=bv(n),[d,m]=_.useState(!0),h=e.map(x=>x.applicant_id),g=h.join(","),p=_.useCallback(async()=>{if(s){console.log("📊 Using preloaded batch data instead of fetching");return}if(h.length===0){f();return}console.log("=== LOADING OPTIMIZED BATCH DATA ==="),console.log("Applications:",h.length),console.log("Selected EMI Month:",n);try{await u(h,{selectedEmiMonth:n,priority:d?"high":"medium"}),console.log("✅ Optimized batch data loading complete")}catch(x){console.error("❌ Error loading optimized batch data:",x)}finally{m(!1)}},[g,n,u,f,d,s]);_.useEffect(()=>{if(s)return;f();const x=setTimeout(()=>{p()},10);return()=>clearTimeout(x)},[p,s]);const y=s||i,v=s?!1:o;return console.log("=== OPTIMIZED TABLE RENDER ==="),console.log("Applications count:",e.length),console.log("Using preloaded data:",!!s),console.log("Is loading:",v),console.log("Has error:",!!l),console.log("Effective batch data keys:",{statuses:Object.keys(y.statuses||{}).length,ptpDates:Object.keys(y.ptpDates||{}).length,contactStatuses:Object.keys(y.contactStatuses||{}).length,comments:Object.keys(y.comments||{}).length}),c.jsx("div",{className:"rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:e.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(Zl,{children:[c.jsx(zE,{}),c.jsx(ec,{children:e.map(x=>{var w,S,b,E;return c.jsx(Sv,{application:x,selectedApplicationId:r,onRowClick:t,selectedEmiMonth:n,batchedStatus:(a==null?void 0:a[x.applicant_id])||((w=y.statuses)==null?void 0:w[x.applicant_id])||"Unpaid",batchedPtpDate:((S=y.ptpDates)==null?void 0:S[x.applicant_id])||null,batchedContactStatus:(b=y.contactStatuses)==null?void 0:b[x.applicant_id],batchedComments:((E=y.comments)==null?void 0:E[x.applicant_id])||[],isLoading:v},x.id)})})]})}):c.jsxs(c.Fragment,{children:[l&&!s&&c.jsxs("div",{className:"text-center py-8 text-red-600 bg-red-50",children:[c.jsx("p",{className:"text-lg font-medium",children:"Error loading data"}),c.jsx("p",{className:"text-sm",children:l.message}),c.jsx("button",{onClick:p,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}),!l&&!v&&c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No applications found"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters or search terms"})]}),v&&c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Loading applications..."})]})]})})});p3.displayName="OptimizedApplicationsTable";const Hq=({applications:e,onApplicationSelect:t,selectedEmiMonth:r,statusData:n,batchData:a})=>e.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-center space-y-4",children:c.jsxs("div",{children:[c.jsx(C1,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-medium text-gray-900",children:"No applications found"}),c.jsx("p",{className:"text-gray-500",children:"No applications match the selected criteria."})]})}):(console.log("ApplicationDetailsContent - Batch data passed:",!!a,a?{statuses:Object.keys(a.statuses||{}).length,comments:Object.keys(a.comments||{}).length,ptpDates:Object.keys(a.ptpDates||{}).length,contactStatuses:Object.keys(a.contactStatuses||{}).length}:"No batch data"),c.jsx("div",{className:"h-full overflow-auto",children:c.jsx(p3,{applications:e,onRowClick:t,selectedEmiMonth:r,preloadedStatusData:n,preloadedBatchData:a})})),Vq=({isOpen:e,onClose:t,applications:r,filter:n,loading:a=!1,statusData:s,batchData:i})=>{const[o,l]=_.useState(null),u=m=>{l(m)},f=()=>{l(null)},d=m=>{l(m)};return console.log("Modal applications count:",r.length),console.log("Filter:",n),console.log("Modal batch data available:",!!i,i?{statuses:Object.keys(i.statuses||{}).length,comments:Object.keys(i.comments||{}).length,ptpDates:Object.keys(i.ptpDates||{}).length,contactStatuses:Object.keys(i.contactStatuses||{}).length}:"No batch data"),c.jsxs(c.Fragment,{children:[c.jsx(Ql,{open:e&&!o,onOpenChange:t,children:c.jsxs(To,{className:"max-w-7xl h-[90vh] flex flex-col p-0",children:[c.jsx(No,{className:"border-b pb-4 px-6 pt-6",children:c.jsx(Wq,{applicationsCount:r.length,filter:n,applications:r})}),c.jsx("div",{className:"flex-1 overflow-hidden px-6 pb-6",children:a?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Loading applications..."})]})}):c.jsx(Hq,{applications:r,onApplicationSelect:u,selectedEmiMonth:(n==null?void 0:n.selectedEmiMonth)||null,statusData:s,batchData:i})})]})}),o&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:f}),c.jsx("div",{className:"fixed inset-y-0 right-0 w-full sm:w-96 lg:w-[500px] z-50",children:c.jsx(JT,{application:o,onClose:f,onSave:d,onDataChanged:()=>{console.log("Application data changed")},selectedEmiMonth:(n==null?void 0:n.selectedEmiMonth)||null})})]})]})},zq=()=>{const e=ql(),{allApplications:t,loading:r}=Fq(),{fetchFieldStatus:n}=kv(),{fetchPtpDates:a}=m3(),s=bv(),[i,o]=_.useState(null),[l,u]=_.useState(!1),[f,d]=_.useState([]),[m,h]=_.useState({}),[g,p]=_.useState(null),[y,v]=_.useState(!1);console.log("Analytics - Applications loaded:",(t==null?void 0:t.length)||0),console.log("Analytics - Loading state:",r);const x=async b=>{console.log("Analytics - Drill down filter:",b),o(b),v(!0),u(!0);try{const E=await S(b);if(d(E),E.length>0){console.log("📊 Fetching complete batch data for",E.length,"applications");const k=E.map(N=>N.applicant_id),T=await s.fetchAllData(k,{selectedEmiMonth:b.selectedEmiMonth,priority:"high"});p(T),console.log("✅ Batch data loaded for modal:",{statuses:Object.keys(T.statuses).length,comments:Object.keys(T.comments).length,ptpDates:Object.keys(T.ptpDates).length,contactStatuses:Object.keys(T.contactStatuses).length})}else p(null)}catch(E){console.error("Error filtering applications:",E),d([]),p(null)}finally{v(!1)}},w=()=>{u(!1),o(null),d([]),p(null)},S=async b=>{if(!t)return console.log("No applications available"),[];console.log("Filtering applications with filter:",b),console.log("Total applications:",t.length);try{let E=[],k={},T={};if(b.selectedEmiMonth&&b.selectedEmiMonth!=="All"){const j=Au(b.selectedEmiMonth),{start:z,end:K}=gi(j);console.log("Fetching collection records for date range:",{start:z,end:K});const{data:q,error:Q}=await Pe.from("collection").select(`
            application_id,
            applications!inner(*)
          `).gte("demand_date",z).lte("demand_date",K);if(Q)return console.error("Error fetching collection data:",Q),[];if(!q||q.length===0)return console.log("No collection data found for month:",b.selectedEmiMonth),[];E=q.map(F=>F.applications).filter(F=>F!=null);const X=q.map(F=>F.application_id);k=await n(X,j,!1),T=await a(X,j),console.log("Month-specific filtering - Applications with collection records:",E.length),console.log("Status map loaded:",Object.keys(k).length),console.log("PTP dates map loaded:",Object.keys(T).length)}else{E=t;const j=t.map(z=>z.applicant_id);k=await n(j,void 0,!0),T=await a(j),console.log("All months filtering - Total applications:",E.length)}const I=E.map(j=>({...j,ptp_date:T[j.applicant_id]||j.ptp_date||null,field_status:k[j.applicant_id]||j.lms_status||"Unpaid"})).filter(j=>{if(b.ptp_criteria==="date_specific"&&b.ptp_date){if(!j.ptp_date)return!1;try{if(Ft(new Date(j.ptp_date),"yyyy-MM-dd")!==b.ptp_date)return!1}catch{return!1}switch(b.status_type){case"paid":return j.field_status==="Paid";case"overdue":return j.ptp_date&&new Date(j.ptp_date)<new Date&&j.field_status!=="Paid";case"total":return!0;default:return!1}}if(b.branch_name&&j.branch_name!==b.branch_name||b.rm_name&&(j.collection_rm||j.rm_name||"Unknown RM")!==b.rm_name)return!1;const z=j.field_status;if(b.ptp_criteria){if(z==="Paid")return!1;const K=fo(new Date);switch(b.ptp_criteria){case"overdue":if(!j.ptp_date)return!1;try{const q=new Date(j.ptp_date);return av(q,K)}catch{return!1}case"today":if(!j.ptp_date)return!1;try{const q=new Date(j.ptp_date);return TO(q)}catch{return!1}case"tomorrow":if(!j.ptp_date)return!1;try{const q=new Date(j.ptp_date);return Tw(q)}catch{return!1}case"future":if(!j.ptp_date)return!1;try{const q=new Date(j.ptp_date);return sh(q,K)&&!Tw(q)}catch{return!1}case"no_ptp_set":return!j.ptp_date;case"total":return!0;default:break}}switch(b.status_type){case"unpaid":return z==="Unpaid";case"partially_paid":return z==="Partially Paid";case"paid_pending_approval":return z==="Paid (Pending Approval)";case"paid":return z==="Paid";case"others":return["Cash Collected from Customer","Customer Deposited to Bank"].includes(z||"")||!["Unpaid","Partially Paid","Paid (Pending Approval)","Paid"].includes(z||"");case"total":return!0;default:return!1}});console.log("Filtered applications count:",I.length),console.log("Sample filtered applications:",I.slice(0,3).map(j=>({applicant_id:j.applicant_id,ptp_date:j.ptp_date,field_status:j.field_status,branch_name:j.branch_name})));const H=I.reduce((j,z)=>(j[z.applicant_id]=z.field_status,j),{});return h(H),I}catch(E){return console.error("Error filtering applications:",E),[]}};return r?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Loading analytics..."})]})}):!t||t.length===0?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2 hover:bg-white/80 transition-colors",children:[c.jsx(V0,{className:"h-4 w-4"}),"Back to Dashboard"]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Analytics Dashboard"}),c.jsx("p",{className:"text-gray-600",children:"No applications data available"})]})]}),c.jsx(Qe,{className:"bg-white/95 backdrop-blur-sm shadow-xl border-0 p-8",children:c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:c.jsx("p",{className:"text-lg",children:"No applications data found. Please check your data connection."})})})]})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[c.jsxs(Te,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2 hover:bg-white/80 transition-colors",children:[c.jsx(V0,{className:"h-4 w-4"}),"Back to Dashboard"]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Analytics Dashboard"}),c.jsxs("p",{className:"text-gray-600",children:["Comprehensive insights into payment collections for ",t.length," applications"]})]})]}),c.jsx("div",{className:"relative",children:c.jsx(Qe,{className:"bg-white/95 backdrop-blur-sm shadow-xl border-0 p-8",children:c.jsx(Bq,{applications:t,onDrillDown:x})})}),c.jsx(Vq,{isOpen:l,onClose:w,applications:f,filter:i,loading:y,statusData:m,batchData:g})]})})},Gq=()=>{const e=em();return _.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),c.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),c.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Yq=new DR({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:"always",retry:2,retryDelay:e=>Math.min(1e3*2**e,3e4)},mutations:{retry:1}}}),Xq=({children:e})=>{const t=L8();return c.jsx(s4.Provider,{value:t,children:e})},Kq=()=>c.jsx(RR,{client:Yq,children:c.jsxs(aR,{children:[c.jsx(W6,{}),c.jsx(wD,{}),c.jsx(T8,{children:c.jsx(F8,{children:c.jsx(Xq,{children:c.jsxs(k8,{children:[c.jsx(Wo,{path:"/login",element:c.jsx(V8,{})}),c.jsx(Wo,{path:"/",element:c.jsx(mp,{children:c.jsx(f9,{})})}),c.jsx(Wo,{path:"/admin-settings",element:c.jsx(mp,{requireAdmin:!0,children:c.jsx(Iq,{})})}),c.jsx(Wo,{path:"/analytics",element:c.jsx(mp,{children:c.jsx(zq,{})})}),c.jsx(Wo,{path:"*",element:c.jsx(Gq,{})})]})})})})]})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered successfully: ",e)}).catch(e=>{console.warn("SW registration failed (this is non-critical): ",e)})});pk(document.getElementById("root")).render(c.jsx(_.StrictMode,{children:c.jsx(Kq,{})}));export{Rt as A,dr as g};
//# sourceMappingURL=index-DVH8n3kO.js.map
